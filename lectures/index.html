

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Lecture Notes on Fundamentals of Data Analysis</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script type="module" src="https://cdn.jsdelivr.net/npm/mermaid@11.2.0/dist/mermaid.esm.min.mjs"></script>
    <script type="module" src="https://cdn.jsdelivr.net/npm/@mermaid-js/layout-elk@0.1.4/dist/mermaid-layout-elk.esm.min.mjs"></script>
    <script type="module">import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@11.2.0/dist/mermaid.esm.min.mjs";import elkLayouts from "https://cdn.jsdelivr.net/npm/@mermaid-js/layout-elk@0.1.4/dist/mermaid-layout-elk.esm.min.mjs";mermaid.registerLayoutLoaders(elkLayouts);mermaid.initialize({startOnLoad:false});</script>
    <script src="https://cdn.jsdelivr.net/npm/d3@7.9.0/dist/d3.min.js"></script>
    <script type="module">
import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@11.2.0/dist/mermaid.esm.min.mjs";
window.addEventListener("load", () => mermaid.run());
</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'lectures/index';</script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="#">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="None - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="None - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1 current active">
                <a class="reference internal" href="#">
                    Lecture Notes on Fundamental of Data Analysis
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Lecture 1</span></p>
<ul class="nav bd-sidenav">


</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Lecture 2</span></p>
<ul class="nav bd-sidenav">


</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Lecture 3</span></p>
<ul class="nav bd-sidenav">


</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Laboratory 1</span></p>
<ul class="nav bd-sidenav">



</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Lecture 4</span></p>
<ul class="nav bd-sidenav">


</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Lecture 5</span></p>
<ul class="nav bd-sidenav">

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Laboratory 2</span></p>
<ul class="nav bd-sidenav">



</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Lecture 6</span></p>
<ul class="nav bd-sidenav">


</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Lecture 7 &amp; 8</span></p>
<ul class="nav bd-sidenav">

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Lecture 9</span></p>
<ul class="nav bd-sidenav">

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Lecture 10</span></p>
<ul class="nav bd-sidenav">

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Lecture 11</span></p>
<ul class="nav bd-sidenav">


</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Laboratory 3</span></p>
<ul class="nav bd-sidenav">



</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/antoninofurnari/fadlecturenotes" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/antoninofurnari/fadlecturenotes/issues/new?title=Issue%20on%20page%20%2Flectures/index.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Lecture Notes on Fundamental of Data Analysis</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <p aria-level="2" class="caption" role="heading"><span class="caption-text">Lecture 1</span></p>
<ul class="visible nav section-nav flex-column">
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="lectures/index.html#document-laboratories/01_setup">1. Introduzione ai laboratori e Installazione dell’Ambiente di Lavoro</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="lectures/index.html#document-laboratories/02_intro_python">2. Introduzione a Python</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Lecture 2</span></p>
<ul class="nav section-nav flex-column">
<li class="toctree-l1 nav-item toc-entry"><a class="reference internal nav-link" href="lectures/index.html#document-lectures/03_main_data_analysis_concepts">3. Introduction to Data Analysis and Key Concepts</a></li>
<li class="toctree-l1 nav-item toc-entry"><a class="reference internal nav-link" href="lectures/index.html#document-lectures/07_probability">4. Probability for Data Manipulation</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Lecture 3</span></p>
<ul class="nav section-nav flex-column">
<li class="toctree-l1 nav-item toc-entry"><a class="reference internal nav-link" href="lectures/index.html#document-lectures/08_common_distributions">5. Probability Distributions</a></li>
<li class="toctree-l1 nav-item toc-entry"><a class="reference internal nav-link" href="lectures/index.html#document-lectures/09_information_theory">6. Basic Elements of Information Theory</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Laboratory 1</span></p>
<ul class="nav section-nav flex-column">
<li class="toctree-l1 nav-item toc-entry"><a class="reference internal nav-link" href="lectures/index.html#document-laboratories/03_intro_numpy">7. Introduzione a Numpy</a></li>
<li class="toctree-l1 nav-item toc-entry"><a class="reference internal nav-link" href="lectures/index.html#document-laboratories/04_intro_matplotlib">8. Introduzione a Matplotlib</a></li>
<li class="toctree-l1 nav-item toc-entry"><a class="reference internal nav-link" href="lectures/index.html#document-laboratories/05_intro_pandas">9. Introduzione a Pandas</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Lecture 4</span></p>
<ul class="nav section-nav flex-column">
<li class="toctree-l1 nav-item toc-entry"><a class="reference internal nav-link" href="lectures/index.html#document-lectures/04_misure_di_frequenze_e_rappresentazione_grafica_dei_dati">10. Misure di Frequenze e Rappresentazione Grafica dei Dati</a></li>
<li class="toctree-l1 nav-item toc-entry"><a class="reference internal nav-link" href="lectures/index.html#document-lectures/05_misure_di_tendenza_centrale_dispersione_e_forma">11. Misure di Tendenza Centrale, Dispersione e Forma</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Lecture 5</span></p>
<ul class="nav section-nav flex-column">
<li class="toctree-l1 nav-item toc-entry"><a class="reference internal nav-link" href="lectures/index.html#document-lectures/06_associazione_variabili">12. Associazione tra Variabili</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Laboratory 2</span></p>
<ul class="nav section-nav flex-column">
<li class="toctree-l1 nav-item toc-entry"><a class="reference internal nav-link" href="lectures/index.html#document-laboratories/06_misure_di_frequenze_e_rappresentazioni_grafiche_dei_dati">13. Laboratorio su Misure di Frequenze e Rappresentazione Grafica dei Dati</a></li>
<li class="toctree-l1 nav-item toc-entry"><a class="reference internal nav-link" href="lectures/index.html#document-laboratories/07_misure_di_tendenza_centrale_dispersione_e_forma">14. Laboratorio su Misure di Tendenza Centrale, Dispersione e Forma</a></li>
<li class="toctree-l1 nav-item toc-entry"><a class="reference internal nav-link" href="lectures/index.html#document-laboratories/08_associazione_variabili">15. Associazione tra Variabili</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Lecture 6</span></p>
<ul class="nav section-nav flex-column">
<li class="toctree-l1 nav-item toc-entry"><a class="reference internal nav-link" href="lectures/index.html#document-lectures/10_statistical_inference">16. Statistical Inference</a></li>
<li class="toctree-l1 nav-item toc-entry"><a class="reference internal nav-link" href="lectures/index.html#d-agostino-s-k-squared-test">17. D’Agostino’s K-squared test</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Lecture 7 &amp; 8</span></p>
<ul class="nav section-nav flex-column">
<li class="toctree-l1 nav-item toc-entry"><a class="reference internal nav-link" href="lectures/index.html#document-lectures/11_linear_regression">18. Linear Regression</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Lecture 9</span></p>
<ul class="nav section-nav flex-column">
<li class="toctree-l1 nav-item toc-entry"><a class="reference internal nav-link" href="lectures/index.html#document-lectures/12_logistic_regression">19. Logistic Regression</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Lecture 10</span></p>
<ul class="nav section-nav flex-column">
<li class="toctree-l1 nav-item toc-entry"><a class="reference internal nav-link" href="lectures/index.html#document-lectures/13_causal_analysis">20. Causal Data Analysis</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Lecture 11</span></p>
<ul class="nav section-nav flex-column">
<li class="toctree-l1 nav-item toc-entry"><a class="reference internal nav-link" href="lectures/index.html#document-lectures/14_data_as_nd_points">21. Data as N-Dimensional Points</a></li>
<li class="toctree-l1 nav-item toc-entry"><a class="reference internal nav-link" href="lectures/index.html#document-lectures/15_clustering">22. Clustering</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Laboratory 3</span></p>
<ul class="nav section-nav flex-column">
<li class="toctree-l1 nav-item toc-entry"><a class="reference internal nav-link" href="lectures/index.html#document-laboratories/10_statistical_inference">23. Laboratory on Statistical Inference</a></li>
<li class="toctree-l1 nav-item toc-entry"><a class="reference internal nav-link" href="lectures/index.html#document-laboratories/11_regressione_lineare">24. Laboratorio su Regressione Lineare</a></li>
<li class="toctree-l1 nav-item toc-entry"><a class="reference internal nav-link" href="lectures/index.html#document-laboratories/12_regressione_logistica">25. Laboratorio su regressione logistica</a></li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="lecture-notes-on-fundamental-of-data-analysis">
<h1>Lecture Notes on Fundamental of Data Analysis<a class="headerlink" href="#lecture-notes-on-fundamental-of-data-analysis" title="Permalink to this heading">#</a></h1>
<p>This Jupyter Book contains lecture notes for the <a class="reference external" href="https://web.dmi.unict.it/corsi/lm-18/insegnamenti?seuid=90338D5D-A89C-494D-BC2B-4BD3B1D32B7E">Fundamentals of Data Analysis</a> Course, taught at the <a class="reference external" href="http://unict.it">University of Catania</a> by Prof. <a class="reference external" href="http://antoninofurnari.it">Antonino Furnari</a>.</p>
<p>The notes are informal and meant to be used as teaching material - they may contain errors.</p>
<p>To point out any mistake, you can open an issue. Introductory slides to this course are available <a class="reference external" href="https://github.com/antoninofurnari/fadlecturenotes/releases/download/latest/00_intro_course.pdf">here</a>.</p>
<div class="toctree-wrapper compound">
<span id="document-laboratories/01_setup"></span><section class="tex2jax_ignore mathjax_ignore" id="introduzione-ai-laboratori-e-installazione-dell-ambiente-di-lavoro">
<h2><span class="section-number">1. </span>Introduzione ai laboratori e Installazione dell’Ambiente di Lavoro<a class="headerlink" href="#introduzione-ai-laboratori-e-installazione-dell-ambiente-di-lavoro" title="Permalink to this heading">#</a></h2>
<p>Questo corso include ore di laboratorio in cui affronteremo manipolazioni pratiche di analisi dei dati. Tutti i laboratori verranno condotti utilizzando il linguaggio Python e il notebook Jupyter (tramite un’installazione locale o Google Colab). Inizieremo vedendo come installare l’ambiente di lavoro.</p>
<section id="installazione-di-python">
<h3><span class="section-number">1.1. </span>Installazione di Python<a class="headerlink" href="#installazione-di-python" title="Permalink to this heading">#</a></h3>
<p>Nel corso, utilizzeremo il linguaggio Python. Scegliamo Python in quanto un linguaggio moderno, diffuso, multi-piattaforma, portabile, facile da usare ed elegante e dotato di una modalità interattiva. Questa ultima caratteristica risulterà molto utile per sperimentare con il codice e apprendere bene il funzionamento del linguaggio e delle librerie.</p>
<p>Python è un linguaggio fortemente modulare: alcune funzionalità di base sono incluse nel linguaggio, mentre molte altre sono fornite da pacchetti di terze parti, gestite mediante un vero e proprio gestore dei pacchetti chiamato <code class="docutils literal notranslate"><span class="pre">pip</span></code>. Per avere un ambiente di lavoro pronto per l’utilizzo in applicazioni che richiedono l’analisi dei dati, utilizzeremo una distribuzione chiamata <a class="reference external" href="https://www.anaconda.com/">Anaconda</a>. Va notato che in passato esistevano due branch di Python: il 2.x e il 3.x. Oggi il 2.x non è più utilizzato. La distribuzione di Anaconda utilizzata nel momento in cui si scrive installerà Python 3.9.</p>
<p>Scarichiamo la distribuzione per la nostra piattaforma dal seguente link: <a class="reference external" href="https://www.anaconda.com/products/distribution">https://www.anaconda.com/products/distribution</a> e installiamola. Una volta fatto ciò, dovremmo poter accedere a un terminale con l’accesso agli eseguibili messi a disposizione da Anaconda. In particolare:</p>
<ul class="simple">
<li><p>Su windows, sarà disponbile il progamma “Anaconda Prompt”;</p></li>
<li><p>Su MacOS e su Linux gli eseguibili dovrebbero già trovarsi nel path dell’utente e dunque dovrebbe essere sufficiente aprire un semplice terminale.</p></li>
</ul>
<p>Se anaconda è stato correttamente installato, apparirà l’indicazione <code class="docutils literal notranslate"><span class="pre">(base)</span></code> prima del prompt dei comandi, come mostrato di seguito:</p>
<figure class="align-default">
<img alt="../_images/anaconda_prompt.png" src="../_images/anaconda_prompt.png" />
</figure>
<p><code class="docutils literal notranslate"><span class="pre">(base)</span></code> indica l’<code class="docutils literal notranslate"><span class="pre">environment</span></code> (di default è l’environement di base) in cui stiamo operando. Anaconta infatti permette di definire e utilizzare diversi evironment indipendenti tra di loro in cui è possibile installare pacchetti diversi (anche in termini di versioni).</p>
</section>
<section id="programmare-in-python">
<h3><span class="section-number">1.2. </span>Programmare in Python<a class="headerlink" href="#programmare-in-python" title="Permalink to this heading">#</a></h3>
<p>Con Anaconda verranno installati diversi strumenti. Tra questi:</p>
<ul class="simple">
<li><p>L’interprete python;</p></li>
<li><p>La shell interattiva ipython;</p></li>
<li><p>L’IDE Spyder;</p></li>
<li><p>Jupyter Notebook.</p></li>
</ul>
<section id="interprete-python">
<h4><span class="section-number">1.2.1. </span>Interprete Python<a class="headerlink" href="#interprete-python" title="Permalink to this heading">#</a></h4>
<p>L’interprete Python permette di eseguire un programma Python mediante un comando del genere:</p>
<p><code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">programma.py</span></code></p>
<p>Dove <code class="docutils literal notranslate"><span class="pre">programma.py</span></code> è il file di testo sorgente del programma. Alla prima esecuzione, Python compilerà il programma e genererà un file bytecode <code class="docutils literal notranslate"><span class="pre">programma.pyc</span></code>.</p>
</section>
<section id="shell-interattiva-ipython">
<h4><span class="section-number">1.2.2. </span>Shell interattiva ipython<a class="headerlink" href="#shell-interattiva-ipython" title="Permalink to this heading">#</a></h4>
<p>La shell interattiva è una versione più “evoluta” dell’interprete Python che permette di:</p>
<ul class="simple">
<li><p>Interpretare comandi;</p></li>
<li><p>Eseguire programmi Python;</p></li>
<li><p>Analizzare il contenuto delle variabili del workspace;</p></li>
</ul>
<p>Possiamo lanciare la shell interattiva con il comando <code class="docutils literal notranslate"><span class="pre">ipytyon</span></code>:</p>
<figure class="align-default">
<img alt="../_images/ipython.png" src="../_images/ipython.png" />
</figure>
</section>
<section id="ide">
<h4><span class="section-number">1.2.3. </span>IDE<a class="headerlink" href="#ide" title="Permalink to this heading">#</a></h4>
<p>Un IDE generalmente integra una shell ipython e diversi strumenti per il debugging. É un ottimo strumento per progetti di medie o grandi dimensioni. Un ide molto usato per la programmazione in Python è <a class="reference external" href="https://code.visualstudio.com/">Visual Studio Code</a>.</p>
<figure class="align-default">
<img alt="../_images/vscode.png" src="../_images/vscode.png" />
</figure>
</section>
<section id="notebook-jupyter">
<h4><span class="section-number">1.2.4. </span>Notebook Jupyter<a class="headerlink" href="#notebook-jupyter" title="Permalink to this heading">#</a></h4>
<p>È possibile avviare jupyter mediante il comando:</p>
<p><code class="docutils literal notranslate"><span class="pre">jupyter</span> <span class="pre">notebook</span></code></p>
<figure class="align-default">
<img alt="../_images/jupyter.png" src="../_images/jupyter.png" />
</figure>
<p>Jupyter permette di creare (mediante interfaccia web) dei “notebook”, ovvero degli archivi contenenti:</p>
<ul class="simple">
<li><p>Testo formattato;</p></li>
<li><p>Il codice da eseguire;</p></li>
<li><p>Le immagini ottenuti come risultati dell’esecuzione del codice.</p></li>
</ul>
<p>Si tratta di uno strumento molto potente, in quanto permette di generare dei veri e propri report delle sperimentazioni.</p>
</section>
<section id="ide-vs-notebook">
<h4><span class="section-number">1.2.5. </span>IDE vs Notebook<a class="headerlink" href="#ide-vs-notebook" title="Permalink to this heading">#</a></h4>
<p>C’è da chiedersi quando sia utile usare uno degli strumenti rispetto agli altri.</p>
<p>Gli IDE sono ottimi per:</p>
<ul class="simple">
<li><p>medi o grossi progetti, con diversi moduli e classi;</p></li>
<li><p>computazione interattiva (ad esempio elaborare un video in tempo reale).</p></li>
</ul>
<p>I Notebook di Jupyter sono ottimi per:</p>
<ul class="simple">
<li><p>documentare i processi di analisi dei dati
sperimentare nuove idee;</p></li>
<li><p>scrivere documentazione e tutorials.</p></li>
</ul>
</section>
</section>
<section id="google-colab">
<h3><span class="section-number">1.3. </span>Google Colab<a class="headerlink" href="#google-colab" title="Permalink to this heading">#</a></h3>
<p>In alternativa alla installazione di un ambiente di lavoro sul proprio computer, è possibile utilizzare un servizio gratuito messo a disposizione da Google chiamato “Colab”: <a class="reference external" href="https://colab.research.google.com/">https://colab.research.google.com/</a></p>
<p>Il servizio mette a disposizione dei notebook in Python (simili a quelli di Jupyter) con supporto GPU.</p>
<figure class="align-default">
<img alt="../_images/colab.png" src="../_images/colab.png" />
</figure>
<p>In Google Colab, troveremo i principali pacchetti installati, ma possiamo installare dei pacchetti aggiuntivi mediante comandi del tipo:</p>
<p><code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">sklearn</span></code></p>
<section id="risorse-limitate">
<h4><span class="section-number">1.3.1. </span>Risorse limitate<a class="headerlink" href="#risorse-limitate" title="Permalink to this heading">#</a></h4>
<p>Google Colab è un ottimo strumento per sperimentare o fare piccoli esperimenti. Tuttavia, tenete a mente che le risorse sono limitate e l’accesso alla GPU potrebbe essere revocato dopo alcune ore di computazione o se il computer è inattivo per diverso tempo. Pertanto, potrebbe essere diffiile usarlo per progetti medio-grandi.</p>
</section>
<section id="persistenza-dei-dati">
<h4><span class="section-number">1.3.2. </span>Persistenza dei dati<a class="headerlink" href="#persistenza-dei-dati" title="Permalink to this heading">#</a></h4>
<p>Ad ogni esecuzione di un notebook, Google Colab mette a disposizione uno spazio temporaneo su cui è possibile scrivere e dal quale è possibile leggere dei dati. Ogni volta che il notebook è chiuso e riaperto, lo spazio viene liberato e il contenuto eliminato. Se si vuole avere accesso a uno spazio persistente, è possibile montare una specifica cartella del proprio Google Drive eseguendo una cella con il seguente codice:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">drive</span>
<span class="n">drive</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="s1">&#39;/content/drive/path/to/folder&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Dove <code class="docutils literal notranslate"><span class="pre">/path/to/folder</span></code> è il path alla cartella all’interno del drive.</p>
</section>
</section>
</section>
<span id="document-laboratories/02_intro_python"></span><section class="tex2jax_ignore mathjax_ignore" id="introduzione-a-python">
<h2><span class="section-number">2. </span>Introduzione a Python<a class="headerlink" href="#introduzione-a-python" title="Permalink to this heading">#</a></h2>
<p>Python è un linguaggio di programmazione ad alto livello, interpretato e pensato per la programmazione “general purpose”. Python supporta un sistema dei tipi dimanico e diversi paradigmi di programmazione tra cui la programmazione orientata agli oggetti, la programmazione imperativa, la programmazione funzionale e la programmazione procedurale. Il linguaggio è stato ideato nel 1991 da Guido van Rossum e il suo nome è ispirato alla serie TV satirica Monty Python’s Flying Circus (<a class="reference external" href="https://en.wikipedia.org/wiki/Monty_Python%27s_Flying_Circus">https://en.wikipedia.org/wiki/Monty_Python’s_Flying_Circus</a>).</p>
<p>Benché Python non sia nato come linguaggio di programmazione per il calcolo scientifico, la sua estrema versatilità ha contribuito al nascere di una serie di librerire che rendono la computazione numerica in Python comoda ed efficiente. Buona parte di queste librerie fanno parte di “SciPy” (<a class="reference external" href="https://www.scipy.org/">https://www.scipy.org/</a>), un ecosistema di software open-source per il calcolo scientifico. In questo laboratorio, oltre a una introduzione a Python, vedremo in particolare i fondamenti di NumPy (calcolo scientifico) e Matplolib (Plot 2D).</p>
<p>Referenze importanti da consultare durante il corso, solo le seguenti documentazioni:</p>
<ul class="simple">
<li><p>Python 3: <a class="reference external" href="https://docs.python.org/3/index.html">https://docs.python.org/3/index.html</a>;</p></li>
<li><p>Numpy: <a class="reference external" href="http://www.numpy.org/">http://www.numpy.org/</a>;</p></li>
<li><p>Matplotlib: <a class="reference external" href="https://matplotlib.org/">https://matplotlib.org/</a>.</p></li>
</ul>
<section id="numeri">
<h3><span class="section-number">2.1. </span>Numeri<a class="headerlink" href="#numeri" title="Permalink to this heading">#</a></h3>
<p>I tipi di dato numerici in Python sono int, float e complex. Noi ci concentreremo su int e float. Alcuni esempi di operazioni tra numeri:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">3</span> <span class="o">+</span> <span class="mi">5</span> <span class="c1">#somma</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>8
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">2</span> <span class="o">-</span> <span class="mi">8</span> <span class="c1">#differenza</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-6
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">3</span> <span class="o">*</span> <span class="mi">5</span> <span class="c1">#prodotto</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>15
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">3</span> <span class="o">/</span> <span class="mi">2</span> <span class="c1">#divisione, da notare che in Python 3, la divisione tra numeri interi restituisce un float</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.5
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">3</span> <span class="o">//</span> <span class="mi">2</span> <span class="c1">#divisione intera</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">9</span> <span class="o">**</span> <span class="mi">2</span> <span class="c1">#elevamento a potenza</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>81
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">4</span> <span class="o">%</span> <span class="mi">2</span> <span class="c1">#modulo</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">4</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="c1">#uso delle parentesi</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5
</pre></div>
</div>
</div>
</div>
</section>
<section id="variabili-e-tipi">
<h3><span class="section-number">2.2. </span>Variabili e Tipi<a class="headerlink" href="#variabili-e-tipi" title="Permalink to this heading">#</a></h3>
<p>In generale, i numeri senza virgola vengono interpretati come int, mentre quelli con virgola come float. Dato che Python è tipizzato dinamicamente, non dobbiamo esplicitamente dichiarare il tipo di una variabile. Il tipo verrà associato alla variabile non appena vi assegniamo un valore. Possiamo controllare il tipo di una variabile mediante la funzione <code class="docutils literal notranslate"><span class="pre">type</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">y</span> <span class="o">=</span> <span class="mi">9</span>
<span class="n">z</span> <span class="o">=</span> <span class="mf">1.5</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">x</span><span class="o">/</span><span class="n">y</span>
<span class="n">l</span> <span class="o">=</span> <span class="n">x</span><span class="o">//</span><span class="n">y</span>
<span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="n">z</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="n">h</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(int, int, float, float, int)
</pre></div>
</div>
</div>
</div>
<p>E’ possibile effettuare il casting da un tipo a un altro mediante le funzioni <code class="docutils literal notranslate"><span class="pre">int</span></code> e <code class="docutils literal notranslate"><span class="pre">float</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span><span class="p">(</span><span class="mf">2.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">float</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.0
</pre></div>
</div>
</div>
</div>
<p>Come in C, sono definite le operazioni “in place” tra variabili:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">y</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">x</span><span class="o">+=</span><span class="n">y</span> <span class="c1">#del tutto equivalente a x=x+y</span>
<span class="n">x</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>20
</pre></div>
</div>
</div>
</div>
<p>Non sono definite le notazioni “++” e “–“.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="o">++</span> <span class="c1">#error!</span>
</pre></div>
</div>
<p>Per effettuare un incremento di una unità, va utilizzata la notazione +=1:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="o">=</span><span class="mi">1</span>
<span class="n">a</span><span class="o">+=</span><span class="mi">1</span>
<span class="n">a</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p><strong>🙋‍♂️ Domanda 1</strong></p>
<p>Qual è il tipo della seguente variabile?</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="o">//</span><span class="mi">2</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="mf">0.0</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</section>
<section id="booleani">
<h3><span class="section-number">2.3. </span>Booleani<a class="headerlink" href="#booleani" title="Permalink to this heading">#</a></h3>
<p>I booleani vengono rappresentati mediante le parole chiave <code class="docutils literal notranslate"><span class="pre">True</span></code> e <code class="docutils literal notranslate"><span class="pre">False</span></code> (iniziano entrambe per maiuscola).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
False
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>bool
</pre></div>
</div>
</div>
</div>
<p>E’ possibile generare booleani mediante gli operatori di confronto:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">5</span><span class="o">==</span><span class="mi">5</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">7</span><span class="o">==</span><span class="mi">5</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>False
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">5</span><span class="o">&gt;</span><span class="mi">4</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">9</span><span class="o">&gt;</span><span class="mi">10</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>False
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">9</span><span class="o">&lt;=</span><span class="mi">10</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">11</span><span class="o">&lt;=</span><span class="mi">10</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>False
</pre></div>
</div>
</div>
</div>
<p>Gli operatori logici sono <code class="docutils literal notranslate"><span class="pre">and</span></code> e <code class="docutils literal notranslate"><span class="pre">or</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="mi">5</span><span class="o">==</span><span class="mi">5</span> <span class="ow">and</span> <span class="mi">3</span><span class="o">&lt;</span><span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="mi">3</span><span class="o">&gt;</span><span class="mi">5</span> <span class="ow">or</span> <span class="mi">3</span><span class="o">&lt;</span><span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="mi">3</span><span class="o">&gt;</span><span class="mi">9</span> <span class="ow">or</span> <span class="mi">3</span><span class="o">&lt;</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
True
False
</pre></div>
</div>
</div>
</div>
<p>E’ possibile effettuare in controllo sui tipi mediante <code class="docutils literal notranslate"><span class="pre">type</span></code> e <code class="docutils literal notranslate"><span class="pre">==</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="mf">2.5</span><span class="p">)</span><span class="o">==</span><span class="nb">float</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">==</span><span class="nb">float</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>False
</pre></div>
</div>
</div>
</div>
<p>In alternativa, è possibile utilizzare la funzione <code class="docutils literal notranslate"><span class="pre">isinstance</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">isinstance</span><span class="p">(</span><span class="mf">2.5</span><span class="p">,</span><span class="nb">float</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">isinstance</span><span class="p">(</span><span class="mf">2.5</span><span class="p">,</span><span class="nb">int</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>False
</pre></div>
</div>
</div>
</div>
<p>La funzione <code class="docutils literal notranslate"><span class="pre">isinstance</span></code> è particolarmente comoda quando si vuole controllare che una variabile appartenga a uno tra una serie di tipi. Ad esempio, se vogliamo controllare che una variabile contenga un numero:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">isinstance</span><span class="p">(</span><span class="mf">2.5</span><span class="p">,(</span><span class="nb">float</span><span class="p">,</span><span class="nb">int</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">isinstance</span><span class="p">(</span><span class="mi">5</span><span class="p">,(</span><span class="nb">float</span><span class="p">,</span><span class="nb">int</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
</section>
<section id="stampa">
<h3><span class="section-number">2.4. </span>Stampa<a class="headerlink" href="#stampa" title="Permalink to this heading">#</a></h3>
<p>La stampa avviene mediante la funzione <code class="docutils literal notranslate"><span class="pre">print</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">var</span> <span class="o">=</span> <span class="mf">2.2</span>
<span class="nb">print</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.2
</pre></div>
</div>
</div>
</div>
<p>Possiamo stampare una riga vuota omettendo il parametro di print:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2

3
</pre></div>
</div>
</div>
</div>
<p>Alternativamente, possiamo specificare di inserire due “a capo” alla fine della stampa specificando il parametro <code class="docutils literal notranslate"><span class="pre">end=&quot;\n\n&quot;</span></code> (“\n\n” è una stringa - approfondiremo le stringhe in seguito):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2

3
</pre></div>
</div>
</div>
</div>
<p>Lo stesso metodo può essere usato per omettere l’inserimento di spazi tra due stampe consecutive:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="c1">#&quot;&quot; rappresenta una stringa vuota</span>
<span class="nb">print</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>23
</pre></div>
</div>
</div>
</div>
<p>Possiamo stampare più elementi di seguito separando gli argomenti di <code class="docutils literal notranslate"><span class="pre">print</span></code> con delle virgole. Inoltre, la funzione <code class="docutils literal notranslate"><span class="pre">print</span></code> permette di stampare anche numeri, oltre a stringhe:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">14</span><span class="o">%</span><span class="k">6</span>,True)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1 4.0 7 2 True
</pre></div>
</div>
</div>
</div>
</section>
<section id="liste">
<h3><span class="section-number">2.5. </span>Liste<a class="headerlink" href="#liste" title="Permalink to this heading">#</a></h3>
<p>Le liste sono una struttura dati di tipo sequenziali che possono essere utilizzate per rappresentare sequenze di valori di qualsiasi tipo. Le liste possono anche contenere elementi di tipi misti. Una lista si definisce utilizzando le parentesi quadre:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">l</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span> <span class="c1">#questa è una lista (parentesi quadre)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1, 2, 3, 4, 5]
</pre></div>
</div>
</div>
</div>
<p>Le liste possono essere indicizzate utilizzando le parentesi quadre. L’indicizzazione inizia da 0 come in C:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">l</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">8</span> <span class="c1">#assegnamento di un nuovo valore alla prima locazione di memoria</span>
<span class="nb">print</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1 3
[8, 2, 3, 4, 5]
</pre></div>
</div>
</div>
</div>
<p>E’ possibile aggiungere nuovi valori a una lista mediante la funzione <code class="docutils literal notranslate"><span class="pre">append</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">l</span> <span class="o">=</span> <span class="p">[]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
<span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">2.5</span><span class="p">)</span>
<span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="o">-</span><span class="mi">12</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[]
[1, 2.5, 8, -12]
</pre></div>
</div>
</div>
</div>
<p>Le liste possono essere concatenate mediante l’operatore somma:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">l1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
<span class="n">l2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">l1</span><span class="o">+</span><span class="n">l2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1, 5, 4, 6]
</pre></div>
</div>
</div>
</div>
<p>L’operatore di moltiplicazione può essere utilizzato per ripetere una lista. Ad esempio:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">l1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">l1</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span> <span class="c1">#concatena l1 a se stessa per due volte</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1, 3, 1, 3]
</pre></div>
</div>
</div>
</div>
<p>Utilizzando l’operatore di moltiplicazione, è possibile creare velocemente liste con un numero arbitrario di valori uguali. Ad esempio:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">([</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">5</span><span class="p">)</span> <span class="c1">#lista di 5 zeri</span>
<span class="nb">print</span><span class="p">([</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span><span class="o">+</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">1</span><span class="p">)</span> <span class="c1">#4 zeri seguiti da 1 uno</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0, 0, 0, 0, 0]
[0, 0, 0, 0, 1]
</pre></div>
</div>
</div>
</div>
<p>La lunghezza di una lista può essere ottenuta utilizzando la funzione <code class="docutils literal notranslate"><span class="pre">len</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">l2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">l2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[4, 6]
2
</pre></div>
</div>
</div>
</div>
<p>Sulle liste è definito un ordinamento che dipende dalla loro lunghezza: liste più corte sono “minori di” liste più lunghe:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span><span class="o">&lt;</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="nb">print</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span><span class="o">&gt;=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
True
</pre></div>
</div>
</div>
</div>
<p>L’operatore <code class="docutils literal notranslate"><span class="pre">==</span></code> non controlla se le lunghezze sono uguali, ma verifica che il contenuto delle due liste sia effettivamente uguale:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span><span class="o">==</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="nb">print</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span><span class="o">==</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
False
</pre></div>
</div>
</div>
</div>
<p>E’ possibile controllare che un elemento appartenga alla lista mediante la parola chiave <code class="docutils literal notranslate"><span class="pre">in</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="mi">7</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="mi">3</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>False
True
</pre></div>
</div>
</div>
</div>
<p>Le funzioni <code class="docutils literal notranslate"><span class="pre">max</span></code> e <code class="docutils literal notranslate"><span class="pre">min</span></code> possono essere utilizzate per calcolare il massimo e il minimo di una lista:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">l</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">l</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">l</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>10
-5
</pre></div>
</div>
</div>
</div>
<p>E’ possibile rimuovere un valore da una lista mediante il metodo <code class="docutils literal notranslate"><span class="pre">remove</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">l</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
<span class="n">l</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1, 2, 3, 4, 2]
[1, 3, 4, 2]
</pre></div>
</div>
</div>
</div>
<p>Tale metodo tuttavia rimuove solo <strong>la prima occorrenza</strong> del valore passato. Se vogliamo rimuovere un valore identificato da uno specifico indice, possiamo usare il costrutto <code class="docutils literal notranslate"><span class="pre">del</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">l</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
<span class="k">del</span> <span class="n">l</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1, 2, 3, 4, 2]
[1, 2, 3, 4]
</pre></div>
</div>
</div>
</div>
<p>Inoltre, per accedere all’ultimo elemento e rimuoverlo, possiamo usare il metodo <code class="docutils literal notranslate"><span class="pre">pop</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">l</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">l</span><span class="o">.</span><span class="n">pop</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1, 2, 3, 4, 5]
5
[1, 2, 3, 4]
</pre></div>
</div>
</div>
</div>
<section id="indicizzazione-e-slicing">
<h4><span class="section-number">2.5.1. </span>Indicizzazione e Slicing<a class="headerlink" href="#indicizzazione-e-slicing" title="Permalink to this heading">#</a></h4>
<p>E’ possibile estrarre una sottolista da una lista specificando il primo indice (incluso) e l’ultimo indice (escluso) separati dal simbolo <code class="docutils literal notranslate"><span class="pre">:</span></code>. Questa notazione è in qualche modo reminiscende del metodo <code class="docutils literal notranslate"><span class="pre">substr</span></code> delle stringhe di C++.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">l</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Lista l     -&gt;&quot;</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;l[0:3]      -&gt;&quot;</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span> <span class="c1">#dall&#39;indice 0 (incluso) all&#39;indice 3 (escluso)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;l[1:2]      -&gt;&quot;</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">])</span> <span class="c1">#dall&#39;indice 1 (incluso) all&#39;indice 2 (escluso)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Lista l     -&gt; [1, 2, 3, 4, 5, 6, 7, 8]
l[0:3]      -&gt; [1, 2, 3]
l[1:2]      -&gt; [2]
</pre></div>
</div>
</div>
</div>
<p>Quando il primo indice è omesso, questo viene automaticamente sostituito con “0”:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;l[:2]       -&gt;&quot;</span><span class="p">,</span> <span class="n">l</span><span class="p">[:</span><span class="mi">2</span><span class="p">])</span> <span class="c1">#dall&#39;indice 0 (incluso) all&#39;indice 2 (escluso)</span>
<span class="c1">#equivalente al seguente:</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;l[0:2]      -&gt;&quot;</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">])</span> <span class="c1">#dall&#39;indice 0 (incluso) all&#39;indice 2 (escluso)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>l[:2]       -&gt; [1, 2]
l[0:2]      -&gt; [1, 2]
</pre></div>
</div>
</div>
</div>
<p>Analogamente, se omettiamo il secondo indice, esso viene sostituito con l’ultimo indice della lista:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Ultimo indice della lista:&quot;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;l[3:]       -&gt;&quot;</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="mi">3</span><span class="p">:])</span> <span class="c1">#dall&#39;indice 3 (incluso) all&#39;indice 5 (escluso)</span>
<span class="c1">#equivalente al seguente:</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;l[3:5]      -&gt;&quot;</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">8</span><span class="p">])</span> <span class="c1">#dall&#39;indice 3 (incluso) all&#39;indice 5 (escluso)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Ultimo indice della lista: 8
l[3:]       -&gt; [4, 5, 6, 7, 8]
l[3:5]      -&gt; [4, 5, 6, 7, 8]
</pre></div>
</div>
</div>
</div>
<p>Omettendo entrambi gli indici:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;l[:]         -&gt;&quot;</span><span class="p">,</span> <span class="n">l</span><span class="p">[:])</span> <span class="c1">#dall&#39;indice 0 (incluso) all&#39;indice 5 (escluso)</span>
<span class="c1">#equivalente a:</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;l[0:8]       -&gt;&quot;</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">8</span><span class="p">])</span> <span class="c1">#dall&#39;indice 0 (incluso) all&#39;indice 5 (escluso)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>l[:]         -&gt; [1, 2, 3, 4, 5, 6, 7, 8]
l[0:8]       -&gt; [1, 2, 3, 4, 5, 6, 7, 8]
</pre></div>
</div>
</div>
</div>
<p>E’ inoltre possibile specificare il “passo”, come terzo numero separato da un altro simbolo <code class="docutils literal notranslate"><span class="pre">:</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;l[0:8:2]    -&gt;&quot;</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">8</span><span class="p">:</span><span class="mi">2</span><span class="p">])</span> 
<span class="c1">#da 0 (incluso) a 8 (escluso) a un passo di 2 (un elemento sì e uno no)</span>
<span class="c1">#equivalente a:</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;l[::2]      -&gt;&quot;</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">8</span><span class="p">:</span><span class="mi">2</span><span class="p">])</span> 
<span class="c1">#da 0 (incluso) a 8 (escluso) a un passo di 2 (un elemento sì e uno no)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>l[0:8:2]    -&gt; [1, 3, 5, 7]
l[::2]      -&gt; [1, 3, 5, 7]
</pre></div>
</div>
</div>
</div>
<p>Per invertire l’ordine degli elementi, è inoltre possibile specificare un passo negativo. In questo caso, bisogna assicurarsi che il primo indice sia maggiore del secondo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;l[5:2:-1]    -&gt;&quot;</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="mi">2</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> 
<span class="c1">#da 5 (incluso) a 2 (escluso) a un passo di -1</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;l[2:5:-1]    -&gt;&quot;</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">5</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> 
<span class="c1">#in questo caso, il primo indice è più piccolo del secondo, </span>
<span class="c1">#quindi il risultato sarà una lista vuota</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>l[5:2:-1]    -&gt; [6, 5, 4]
l[2:5:-1]    -&gt; []
</pre></div>
</div>
</div>
</div>
<p>Anche in questo caso, omettendo degli indici, questi verranno rimpiazzati con le scelte più ovvie. Nel caso dell’omissione però, cambiano le condizioni di inclusione ed esclusione degli indici. Vediamo qualche esempio:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;l[:2:-1]     -&gt;&quot;</span><span class="p">,</span> <span class="n">l</span><span class="p">[:</span><span class="mi">2</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> 
<span class="c1">#dall&#39;ultimo indice (incluso) a 2 (escluso) a un passo di -1</span>
<span class="c1">#equivalente a:</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;l[8:2:-1]    -&gt;&quot;</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="mi">8</span><span class="p">:</span><span class="mi">2</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> 

<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;l[3::-1]     -&gt;&quot;</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="mi">3</span><span class="p">::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> 
<span class="c1">#dal terzo indice (incluso) a 0 (incluso, in quanto omesso) a un passo di -1</span>
<span class="c1">#simile, ma non equivalente a:</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;l[3:0:-1]    -&gt;&quot;</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> 
<span class="c1">#dal terzo indice (incluso) a 0 (escluso) a un passo di -1</span>

<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;l[::-1]      -&gt;&quot;</span><span class="p">,</span> <span class="n">l</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="c1">#dall&#39;ultimo indice (incluso) al primo (incluso, in quanto omesso) a un passo di -1</span>
<span class="c1">#simile, ma non equivalente a:</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;l[8:0:-1]    -&gt;&quot;</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="mi">8</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> 
<span class="c1">#dall&#39;ultimo indice (incluso) al primo (escluso) a un passo di -1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>l[:2:-1]     -&gt; [8, 7, 6, 5, 4]
l[8:2:-1]    -&gt; [8, 7, 6, 5, 4]

l[3::-1]     -&gt; [4, 3, 2, 1]
l[3:0:-1]    -&gt; [4, 3, 2]

l[::-1]      -&gt; [8, 7, 6, 5, 4, 3, 2, 1]
l[8:0:-1]    -&gt; [8, 7, 6, 5, 4, 3, 2]
</pre></div>
</div>
</div>
</div>
<p>La notazione <code class="docutils literal notranslate"><span class="pre">::-1</span></code>, in particolare, è utile per invertire le liste:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">l</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1, 2, 3, 4, 5, 6, 7, 8]
[8, 7, 6, 5, 4, 3, 2, 1]
</pre></div>
</div>
</div>
</div>
<p>Indicizzazione e slicing possono essere utilizzate anche per assegnare valori agli elementi delle liste. Ad esempio:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">l</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">6</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
<span class="n">l</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">=</span><span class="mi">80</span>
<span class="nb">print</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[5, 7, 9, -1, 2, 6, 5, 4, -6]
[5, 7, 9, 80, 2, 6, 5, 4, -6]
</pre></div>
</div>
</div>
</div>
<p>E’ anche possibile assegnare più di un elemento alla volta:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">l</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="c1">#assegno 0 ai numeri di posizione dispari</span>
<span class="nb">print</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0, 7, 0, 80, 0, 6, 0, 4, 0]
</pre></div>
</div>
</div>
</div>
<p>Le liste possono anche essere annidate:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">,[</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">]],[</span><span class="mi">9</span><span class="p">],</span><span class="mi">2</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1, 2, [4, 8, [7, 5]], [9], 2]
</pre></div>
</div>
</div>
</div>
<p>L’indicizzazione di queste strutture annidate avviene concatenando gli indici come segue:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">a1</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="c1">#il primo indice seleziona la lista [4,8,...]</span>
<span class="c1">#il secondo indice seleziona la lista [7,5]</span>
<span class="c1">#il terzo indice seleziona l&#39;elemento 7</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>7
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p><strong>🙋‍♂️ Domanda 2</strong></p>
<p>Estrarre la lista <code class="docutils literal notranslate"><span class="pre">[3,</span> <span class="pre">1.2]</span></code> dalla seguente lista:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">l</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">],</span> <span class="mi">8</span><span class="p">,</span> <span class="p">[]]]</span>
</pre></div>
</div>
</div></blockquote>
</section>
</section>
<section id="tuple">
<h3><span class="section-number">2.6. </span>Tuple<a class="headerlink" href="#tuple" title="Permalink to this heading">#</a></h3>
<p>Le tuple sono simili alle liste, ma sono immutabili. Non possono cioè essere modificate dopo la loro inizializzazione. A differenza delle liste, le tuple vengono definite utilizzando le parentesi tonde:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">l</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span> <span class="c1">#questa è una lista (parentesi quadre)</span>
<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span> <span class="c1">#questa è una tupla (parentesi tonde)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1, 2, 3, 4, 5]
(1, 2, 3, 4, 5)
</pre></div>
</div>
</div>
</div>
<p>Le regole di indicizzazione e slicing viste per le liste valgono anche per tuple. Tuttavia, come accennato prima, le tuple non possono essere modificate:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">8</span> <span class="c1">#restituisce un errore in quanto le tuple sono immutabili</span>
</pre></div>
</div>
<p>Inizializzare una tupla con un solo elemento produrrà un numero. Ciò avviene in quanto le parentesi tonde vengono utilizzate anche per raggruppare i diversi termini di una operazione:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1
</pre></div>
</div>
</div>
</div>
<p>Per definire una tupla monodimensionale, dobbiamo aggiungere esplicitamente una virgola, dopo il primo elemento:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1,)
</pre></div>
</div>
</div>
</div>
<p>E’ inoltre possibile omettere le parentesi nella definizione delle tuple:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span>
<span class="n">t2</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span><span class="n">t2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1, 3, 5) (1,)
</pre></div>
</div>
</div>
</div>
<p>E’ possibile convertire tuple in liste e viceversa:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">l</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">]</span>
<span class="n">t</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="n">ttl</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="n">ltt</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">ttl</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ltt</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[4, 5, 6, 7, 4, 8, 2, 4]
(1, 2, 3, 4, 5, 6, 7, 8)
</pre></div>
</div>
</div>
</div>
<p>Le tuple possono inoltre essere create e “spacchettate” al volo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span>

<span class="nb">print</span><span class="p">(</span><span class="n">t1</span><span class="p">)</span>

<span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="n">t1</span> <span class="c1">#spacchettamento della tupla</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1, 2, 3)
1 2 3
</pre></div>
</div>
</div>
</div>
<p>Questo sistema permette di effettuare lo swap di due variabili in una sola riga di codice:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">var1</span> <span class="o">=</span> <span class="s2">&quot;Var 1&quot;</span>
<span class="n">var2</span> <span class="o">=</span> <span class="s2">&quot;Var 2&quot;</span>

<span class="nb">print</span><span class="p">(</span><span class="n">var1</span><span class="p">,</span><span class="n">var2</span><span class="p">)</span>

<span class="n">var1</span><span class="p">,</span><span class="n">var2</span><span class="o">=</span><span class="n">var2</span><span class="p">,</span><span class="n">var1</span>
<span class="nb">print</span><span class="p">(</span><span class="n">var1</span><span class="p">,</span><span class="n">var2</span><span class="p">)</span>

<span class="c1">#equivalente a:</span>
<span class="n">var1</span> <span class="o">=</span> <span class="s2">&quot;Var 1&quot;</span>
<span class="n">var2</span> <span class="o">=</span> <span class="s2">&quot;Var 2&quot;</span>
<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">var2</span><span class="p">,</span><span class="n">var1</span><span class="p">)</span>
<span class="n">var1</span><span class="o">=</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">var2</span><span class="o">=</span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">var1</span><span class="p">,</span><span class="n">var2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Var 1 Var 2
Var 2 Var 1
Var 2 Var 1
</pre></div>
</div>
</div>
</div>
<p>Le tuple annidate possono essere spacchetate come segue:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),(</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">x</span><span class="p">,(</span><span class="n">t11</span><span class="p">,</span><span class="n">t12</span><span class="p">),(</span><span class="n">t21</span><span class="p">,</span><span class="n">t22</span><span class="p">,</span><span class="n">t23</span><span class="p">)</span> <span class="o">=</span> <span class="n">t</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">t11</span><span class="p">,</span> <span class="n">t12</span><span class="p">,</span> <span class="n">t21</span><span class="p">,</span> <span class="n">t22</span><span class="p">,</span> <span class="n">t23</span><span class="p">)</span>
<span class="c1">#La notazione a,b,c,d,e,f = t restituirebbe un errore</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1, (2, 3), (4, 5, 6))
1 2 3 4 5 6
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p><strong>🙋‍♂️ Domanda 3</strong></p>
<p>Qual è la differenza principale tra tuple e liste? Si faccia l’esempio di un caso in cui una tupla è un tipo più appropriato rispetto a una lista.</p>
</div></blockquote>
</section>
<section id="stringhe">
<h3><span class="section-number">2.7. </span>Stringhe<a class="headerlink" href="#stringhe" title="Permalink to this heading">#</a></h3>
<p>In Python possiamo definire le stringhe in tre modi:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s1</span> <span class="o">=</span> <span class="s1">&#39;Singoli apici&#39;</span>
<span class="n">s2</span> <span class="o">=</span> <span class="s2">&quot;Doppi apici, possono contenere anche apici singoli &#39;&#39; &quot;</span>
<span class="n">s3</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;Tripli</span>
<span class="s2">doppi apici</span>
<span class="s2">possono essere definite su più righe&quot;&quot;&quot;</span>
<span class="nb">type</span><span class="p">(</span><span class="n">s1</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="n">s2</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="n">s3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(str, str, str)
</pre></div>
</div>
</div>
</div>
<p>La stampa avviene mediante la funzione “print”:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">s1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Singoli apici
Doppi apici, possono contenere anche apici singoli &#39;&#39; 
Tripli
doppi apici
possono essere definite su più righe
</pre></div>
</div>
</div>
</div>
<p>Le stringhe hanno inoltre una serie di metodi predefiniti:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ciao&quot;</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span> <span class="c1">#rendi tutto maiuscolo</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;CIAO&quot;</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span> <span class="c1">#tutto minuscolo</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ciao come stai&quot;</span><span class="o">.</span><span class="n">capitalize</span><span class="p">())</span> <span class="c1">#prima lettera maiuscola</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ciao come stai&quot;</span><span class="o">.</span><span class="n">split</span><span class="p">())</span> <span class="c1">#spezza una stringa e restituisce una lista</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ciao, come stai&quot;</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">))</span><span class="c1"># spezza quando trova la virgola</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;uno&quot;</span><span class="p">,</span><span class="s2">&quot;due&quot;</span><span class="p">,</span><span class="s2">&quot;tre&quot;</span><span class="p">]))</span> <span class="c1">#costruisce una stringa concatenando gli elementi </span>
<span class="c1">#della lista e separandoli mediante il delimitatore</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CIAO
ciao
Ciao come stai
[&#39;ciao&#39;, &#39;come&#39;, &#39;stai&#39;]
[&#39;ciao&#39;, &#39; come stai&#39;]
uno-due-tre
</pre></div>
</div>
</div>
</div>
<p>Le stringhe possono essere indicizzate in maniera simile agli array per ottenere delle sottostringhe:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;Hello World&quot;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">[:</span><span class="mi">4</span><span class="p">])</span> <span class="c1">#primi 4 caratteri</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">4</span><span class="p">:])</span> <span class="c1">#dal quarto carattere alla fine</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="mi">7</span><span class="p">])</span> <span class="c1">#dal quarto al sesto carattere</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="c1">#inversione della stringa</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Hell
o World
o W
dlroW olleH
</pre></div>
</div>
</div>
</div>
<p>Il metodo <code class="docutils literal notranslate"><span class="pre">split</span></code> in particolare può essere utilizzato per la tokenizzazione o per estrarre sottostringhe in maniera agevole. Ad esempio, supponiamo di voler estrarre il numero <code class="docutils literal notranslate"><span class="pre">2018</span></code> dalla stringa <code class="docutils literal notranslate"><span class="pre">A-2017-B2</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;A-2017-B2&quot;</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2017
</pre></div>
</div>
</div>
</div>
<p>L’operatore <code class="docutils literal notranslate"><span class="pre">==</span></code> controlla che due stringhe siano uguali:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ciao&quot;</span><span class="o">==</span><span class="s2">&quot;ciao&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ciao&quot;</span><span class="o">==</span><span class="s2">&quot;ciao2&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
False
</pre></div>
</div>
</div>
</div>
<p>Gli altri operatori rispecchiano l’ordinamento lessicografico tra stringhe:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;abc&quot;</span><span class="o">&lt;</span><span class="s2">&quot;def&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Abc&quot;</span><span class="o">&gt;</span><span class="s2">&quot;def&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
False
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p><strong>🙋‍♂️ Domanda 4</strong></p>
<p>Quale codice permette di manipolare la stringa <code class="docutils literal notranslate"><span class="pre">azyp-kk9-382</span></code> per ottenere la stringa <code class="docutils literal notranslate"><span class="pre">Kk9</span></code>?</p>
</div></blockquote>
</section>
<section id="formattazione-di-stringhe">
<h3><span class="section-number">2.8. </span>Formattazione di Stringhe<a class="headerlink" href="#formattazione-di-stringhe" title="Permalink to this heading">#</a></h3>
<p>Possiamo costruire stringhe formattate seguendo una sintassi simile a quella di printf:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#per costruire la stringa formattata, faccio seguire la stringa dal simbolo &quot;%&quot; e poi inserisco</span>
<span class="c1">#una tupla contenente gli argomenti</span>
<span class="n">s1</span> <span class="o">=</span> <span class="s2">&quot;Questa </span><span class="si">%s</span><span class="s2"> è formattata. Posso inserire numeri, as esempio </span><span class="si">%0.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="s2">&quot;stringa&quot;</span><span class="p">,</span><span class="mf">3.00002</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Questa stringa è formattata. Posso inserire numeri, as esempio 3.00
</pre></div>
</div>
</div>
</div>
<p>Un modo alternativo e più recente di formattare le strighe consiste nell’usare il metodo “format”:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s2</span> <span class="o">=</span> <span class="s2">&quot;Questa </span><span class="si">{}</span><span class="s2"> è formattata. Posso inserire numeri, ad esempio </span><span class="si">{}</span><span class="s2">&quot;</span>\
    <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;stringa&quot;</span><span class="p">,</span><span class="mf">3.000002</span><span class="p">)</span><span class="c1"># il carattere &quot;\&quot; permette di spezzare la riga</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Questa stringa è formattata. Posso inserire numeri, ad esempio 3.000002
</pre></div>
</div>
</div>
</div>
<p>E’ possibile specificare il tipo di ogni argomento utilizzando i due punti:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Questa </span><span class="si">{:s}</span><span class="s2"> è formattata. Posso inserire numeri, ad esempio </span><span class="si">{:0.2f}</span><span class="s2">&quot;</span>\
      <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;stringa&quot;</span><span class="p">,</span><span class="mf">3.00002</span><span class="p">))</span> <span class="c1">#parametri posizionali, senza speci</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Questa stringa è formattata. Posso inserire numeri, ad esempio 3.00
</pre></div>
</div>
</div>
</div>
<p>E’ anche possibile assegnare nomi agli argomenti in modo da richimarli in maniera non ordinata:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Questa </span><span class="si">{str:s}</span><span class="s2"> è formattata. Posso inserire numeri, ad esempio </span><span class="si">{num:0.2f}</span><span class="s2">&quot;</span>\
    <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="mf">3.00002</span><span class="p">,</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;stringa&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Questa stringa è formattata. Posso inserire numeri, ad esempio 3.00
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p><strong>🙋‍♂️ Domanda 5</strong></p>
<p>Date le variabili:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>a = &quot;hello&quot;
b = &quot;world&quot;
c = 2.0```

Usare la formattazione delle stringhe per stampare la stringa `hello 2 times world`.
</pre></div>
</div>
</div></blockquote>
</section>
<section id="dizionari">
<h3><span class="section-number">2.9. </span>Dizionari<a class="headerlink" href="#dizionari" title="Permalink to this heading">#</a></h3>
<p>I dizionari sono simili a delle liste, ma vengono indicizzate da oggetti di tipo “hashable”, ad esempio stringhe:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;val1&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;val2&quot;</span><span class="p">:</span><span class="mi">2</span><span class="p">}</span>
<span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s2">&quot;val1&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;val1&#39;: 1, &#39;val2&#39;: 2}
1
</pre></div>
</div>
</div>
</div>
<p>E’ possibile ottenere la lista delle chiavi e dei valori come segue:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="c1">#chiavi e valori sono in ordine casuale</span>
<span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dict_keys([&#39;val1&#39;, &#39;val2&#39;])
dict_values([1, 2])
</pre></div>
</div>
</div>
</div>
<p>E’ possibile indicizzare dizionari con tuple (che sono “hashable”)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="p">{(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span><span class="mi">5</span><span class="p">,</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">):</span><span class="mi">11</span><span class="p">}</span>

<span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="p">[(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5
</pre></div>
</div>
</div>
</div>
<p>I dizionari possono anche essere estesi dinamicamente:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span> <span class="c1">#dizionario vuoto</span>
<span class="n">d</span><span class="p">[</span><span class="s2">&quot;chiave&quot;</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;valore&quot;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;chiave&#39;: &#39;valore&#39;}
</pre></div>
</div>
</div>
</div>
<p>Possiamo controllare che un elemento si trovi tra le chiavi di un dizionario come segue:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span><span class="s1">&#39;ciao&#39;</span><span class="p">,</span> <span class="s1">&#39;5&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">}</span>
<span class="nb">print</span><span class="p">(</span><span class="mi">5</span> <span class="ow">in</span> <span class="n">d</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;5&#39;</span> <span class="ow">in</span> <span class="n">d</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>False
True
</pre></div>
</div>
</div>
</div>
<p>E’ possibile controllare che un elemento si trovi tra i valori di un dizionario come segue:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
</section>
<section id="set">
<h3><span class="section-number">2.10. </span>Set<a class="headerlink" href="#set" title="Permalink to this heading">#</a></h3>
<p>I set sono delle strutture dati che possono contenere solo una istanza di un dato elemento:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">}</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="c1">#può essere contenuto solo un &quot;3&quot;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{1, 2, 3}
</pre></div>
</div>
</div>
</div>
<p>Possiamo aggiungere un elemento a un set mediante il metodo “add”:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="n">s</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="n">s</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c1">#non ha effetto. 1 è già presente</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{1, 2, 3}
{1, 2, 3, 5}
{1, 2, 3, 5}
</pre></div>
</div>
</div>
</div>
<p>Anche in questo caso, possiamo controllare l’appartenenza di un elemento ad un set mediante la parola chiave <code class="docutils literal notranslate"><span class="pre">in</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="o">=</span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">}</span>
<span class="nb">print</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="ow">in</span> <span class="n">s</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="mi">8</span> <span class="ow">in</span> <span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
False
</pre></div>
</div>
</div>
</div>
<p>E’ inoltre possibile creare set da liste:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{1, 2, 3, 5}
</pre></div>
</div>
</div>
</div>
</section>
<section id="costrutti-if-elif-else">
<h3><span class="section-number">2.11. </span>Costrutti if/elif/else<a class="headerlink" href="#costrutti-if-elif-else" title="Permalink to this heading">#</a></h3>
<p>I costrutti condizionali funzionano in maniera simile ai linguaggi basati su C. A differenza di tali linguaggi tuttavia, Python sostituisce le parentesi con l’indentazione obbligatoria. Il seguente codice C++:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span>int var1 = 5;
int var2 = 10;
if(var1&lt;var2) {
    int var3 = var1+var2;
    cout &lt;&lt; &quot;Hello World &quot;&lt;&lt;var3;
}
cout &lt;&lt; &quot;End&quot;;```
viene invece scritto come segue:
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">var1</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">var2</span> <span class="o">=</span> <span class="mi">10</span>
<span class="k">if</span> <span class="n">var1</span><span class="o">&lt;</span><span class="n">var2</span><span class="p">:</span>
    <span class="n">var3</span> <span class="o">=</span> <span class="n">var1</span><span class="o">+</span><span class="n">var2</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hello World&quot;</span><span class="p">,</span><span class="n">var3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;End&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Hello World 15
End
</pre></div>
</div>
</div>
</div>
<p>In pratica:</p>
<ul class="simple">
<li><p>la condizione da verificare non è racchiusa tra parentesi;</p></li>
<li><p>i due punti indicano l’inizio del corpo dell’if;</p></li>
<li><p>l’indentazione stabilisce cosa appartiene al corpo dell’if e cosa non appartiene al corpo dell’if.</p></li>
</ul>
<p>Dal momento che l’indentazione ha valore sintattico, essa diventa obbligatoria. Inoltre, non è possibile indentare parti di codice ove ciò non è significativo. Ad esempio, il seguente codice restituisce un errore:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hello&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;World&quot;</span><span class="p">)</span> <span class="c1">#errore di indentazione</span>
</pre></div>
</div>
<p>Le regole di indentazione appena viste, valgono anche per i cicli e altri costrutti in cui è necessario deliminare blocchi di codice. Il costrutto if, permette anche di specificare un ramo <code class="docutils literal notranslate"><span class="pre">else</span></code> e un ramo <code class="docutils literal notranslate"><span class="pre">elif</span></code> per i controlli in cascata. Vediamo alcuni esempi:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">true_condition</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">false_condition</span> <span class="o">=</span> <span class="kc">False</span>

<span class="k">if</span> <span class="n">true_condition</span><span class="p">:</span> <span class="c1">#i due punti &quot;:&quot; sono obbligatori</span>
    <span class="n">word</span><span class="o">=</span><span class="s2">&quot;cool!&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="c1">#l&#39;indentazione è obbligatoria</span>
    
<span class="k">if</span> <span class="n">false_condition</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;not cool :(&quot;</span><span class="p">)</span>
    
<span class="k">if</span> <span class="ow">not</span> <span class="n">false_condition</span><span class="p">:</span> <span class="c1">#neghiamo la condizione con &quot;not&quot;</span>
    <span class="n">word</span><span class="o">=</span><span class="s2">&quot;cool&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">word</span><span class="p">,</span><span class="s2">&quot;again :)&quot;</span><span class="p">)</span>
    
<span class="k">if</span> <span class="n">false_condition</span><span class="p">:</span>
    <span class="n">word</span><span class="o">=</span><span class="s2">&quot;this&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">word</span><span class="o">+</span><span class="s2">&quot; is &quot;</span><span class="o">+</span><span class="s2">&quot;false&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span> <span class="c1">#due punti + indentazione</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;true&quot;</span><span class="p">)</span>
    
<span class="k">if</span> <span class="n">false_condition</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;false&quot;</span><span class="p">)</span>
<span class="k">elif</span> <span class="mi">5</span><span class="o">&gt;</span><span class="mi">4</span><span class="p">:</span> <span class="c1">#implementa un &quot;else if&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;5&gt;4&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;4&lt;5??&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>cool!
cool again :)
true
5&gt;4
</pre></div>
</div>
</div>
</div>
<p>E’ anche possibile verificare se un valore appartiene a una lista. Ciò è molto utile per verificare se un parametro è ammesso.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">allowed_parameters</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;single&quot;</span><span class="p">,</span> <span class="s2">&quot;double&quot;</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">]</span>

<span class="n">parameter</span> <span class="o">=</span> <span class="s2">&quot;double&quot;</span>

<span class="k">if</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="n">allowed_parameters</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">parameter</span><span class="p">,</span><span class="s2">&quot;is ok&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">parameter</span><span class="p">,</span><span class="s2">&quot;not in&quot;</span><span class="p">,</span><span class="n">allowed_parameters</span><span class="p">)</span>

<span class="n">x</span><span class="o">=</span><span class="mi">8</span>
<span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">allowed_parameters</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="s2">&quot;is not ok&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="s2">&quot;not in&quot;</span><span class="p">,</span><span class="n">allowed_parameters</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>double is ok
8 not in [&#39;single&#39;, &#39;double&#39;, 5, -2]
</pre></div>
</div>
</div>
</div>
<p>Una variante “inline” del costrutto if può essere utilizzata per gli assegnamenti condizionali:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">var1</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">var2</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">var1</span> <span class="k">if</span> <span class="n">var1</span><span class="o">&gt;</span><span class="n">var2</span> <span class="k">else</span> <span class="n">var2</span> <span class="c1">#calcola il massimo</span>
<span class="nb">print</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5
</pre></div>
</div>
</div>
</div>
<p>In Python non esiste il costrutto switch, per implementare il quale si utilizza una lista di elif in cascata:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;ciao&quot;</span>
<span class="k">if</span> <span class="n">s</span><span class="o">==</span><span class="s2">&quot;help&quot;</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;help&quot;</span><span class="p">)</span>
<span class="k">elif</span> <span class="n">s</span><span class="o">==</span><span class="s2">&quot;world&quot;</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;hello&quot;</span><span class="p">,</span><span class="n">s</span><span class="p">)</span>
<span class="k">elif</span> <span class="n">s</span><span class="o">==</span><span class="s2">&quot;ciao&quot;</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="s2">&quot;mondo&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Default&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ciao mondo
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p><strong>🙋‍♂️ Domanda 6</strong></p>
<p>Si consideri il seguente codice:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="o">=</span><span class="mi">2</span>
<span class="k">if</span> <span class="n">x</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
    <span class="n">y</span><span class="o">=</span><span class="mi">12</span>
    <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="o">+</span><span class="n">y</span>
    <span class="nb">print</span> <span class="n">y</span>
<span class="k">else</span><span class="p">:</span>
        <span class="n">z</span><span class="o">=</span><span class="mi">28</span>
        <span class="n">h</span><span class="o">=</span><span class="mi">12</span>
        <span class="nb">print</span> <span class="n">z</span><span class="o">+</span><span class="n">h</span>
</pre></div>
</div>
<p>Si evidenziino eventuali errori sintattici. Si riscriva il codice in C++ o Java e si confrontino le due versioni del codice.</p>
</div></blockquote>
</section>
<section id="cicli-while-e-for">
<h3><span class="section-number">2.12. </span>Cicli while e for<a class="headerlink" href="#cicli-while-e-for" title="Permalink to this heading">#</a></h3>
<p>I cicli while, si definiscono come segue:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">i</span><span class="o">=</span><span class="mi">0</span>
<span class="k">while</span> <span class="n">i</span><span class="o">&lt;</span><span class="mi">5</span><span class="p">:</span> <span class="c1">#due punti &quot;:&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="c1">#indentazione</span>
    <span class="n">i</span><span class="o">+=</span><span class="mi">1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
1
2
3
4
</pre></div>
</div>
</div>
</div>
<p>La sintassi dei cicli for è un po’ diversa dalla sintassi standard del C. I cicli for in Python sono più simili a dei <strong>foreach</strong> e richiedono un “iterable” (ad esempio una lista o una tupla) per essere eseguiti:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">l</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
<span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">l</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1
7
2
5
</pre></div>
</div>
</div>
</div>
<p>Per scrivere qualcosa di equivalente al seguente codice C:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="mi">5</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{...}</span>
</pre></div>
</div>
<p>possiamo utilizzare la funzione <strong>range</strong> che genera numeri sequenziali al volo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
1
2
3
4
</pre></div>
</div>
</div>
</div>
<p>Range non genera direttamente una lista, ma un “generator” di tipo range, ovvero un oggetto capace di generare numeri. Se vogliamo convertirlo in una lista, dobbiamo farlo esplicitamente:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span> <span class="c1">#oggetto di tipo range, genera numeri da 0 a 5 (escluso)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span> <span class="c1">#range non fa altro che generare numeri consecutivi</span>
<span class="c1">#convertendo range in una lista, possiamo verificare quali numeri vengono generati</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>range(0, 5)
[0, 1, 2, 3, 4]
</pre></div>
</div>
</div>
</div>
<p>Se volessimo scorrere contemporaneamente indici e valori di un array potremmo scrivere:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span> 
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">array</span><span class="p">)):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="s2">&quot;-&gt;&quot;</span><span class="p">,</span><span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0 -&gt; 1
1 -&gt; 7
2 -&gt; 2
3 -&gt; 4
4 -&gt; 5
</pre></div>
</div>
</div>
</div>
<p>In Python però, è possibile utilizzare la funzione <code class="docutils literal notranslate"><span class="pre">enumerate</span></code> per ottenere lo stesso risultato in maniera più compatta:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">index</span><span class="p">,</span><span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">array</span><span class="p">):</span> <span class="c1">#get both index and value</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">index</span><span class="p">,</span><span class="s2">&quot;-&gt;&quot;</span><span class="p">,</span><span class="n">value</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0 -&gt; 1
1 -&gt; 7
2 -&gt; 2
3 -&gt; 4
4 -&gt; 5
</pre></div>
</div>
</div>
</div>
<p>Supponiamo adesso di voler scorrere contemporaneamente tutti gli iesimi elementi di più liste. Ad esempio:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a1</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
<span class="n">a2</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">]</span>
<span class="n">a3</span><span class="o">=</span><span class="p">[</span><span class="mi">9</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a1</span><span class="p">)):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">a1</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">a2</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">a3</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1 1 9
6 8 2
2 2 5
5 7 2
</pre></div>
</div>
</div>
</div>
<p>Una funzione molto utile quando si lavora con i cicli è <code class="docutils literal notranslate"><span class="pre">zip</span></code>, che permette di raggruppare gli elementi corrispondenti di diverse liste:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">l1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
<span class="n">l2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
<span class="n">zipped</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">l1</span><span class="p">,</span><span class="n">l2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">zipped</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(1, 3), (6, 8), (5, 9), (2, 2)]
</pre></div>
</div>
</div>
</div>
<p>In pratica, <code class="docutils literal notranslate"><span class="pre">zip</span></code> raggruppa gli elementi i-esimi delle liste in tuple. La i-esima tupla di <code class="docutils literal notranslate"><span class="pre">zipped</span></code> contiene gli i-esimi elementi delle due liste. Combinando <code class="docutils literal notranslate"><span class="pre">zip</span></code> con un ciclo for, possiamo ottenere il seguente risultato:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">v1</span><span class="p">,</span><span class="n">v2</span><span class="p">,</span><span class="n">v3</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span><span class="n">a2</span><span class="p">,</span><span class="n">a3</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span><span class="n">v2</span><span class="p">,</span><span class="n">v3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1 1 9
6 8 2
2 2 5
5 7 2
</pre></div>
</div>
</div>
</div>
<p>che è equivalente al codice visto in precedenza. E’ anche possibile combinare zip e enumerate come segue:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span><span class="p">,(</span><span class="n">v1</span><span class="p">,</span><span class="n">v2</span><span class="p">,</span><span class="n">v3</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span><span class="n">a2</span><span class="p">,</span><span class="n">a3</span><span class="p">)):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="s2">&quot;-&gt;&quot;</span><span class="p">,</span><span class="n">v1</span><span class="p">,</span><span class="n">v2</span><span class="p">,</span><span class="n">v3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0 -&gt; 1 1 9
1 -&gt; 6 8 2
2 -&gt; 2 2 5
3 -&gt; 5 7 2
</pre></div>
</div>
</div>
</div>
<p>Attenzione, anche <code class="docutils literal notranslate"><span class="pre">zip</span></code>, come <code class="docutils literal notranslate"><span class="pre">range</span></code>, produce un generator. Pertanto è necessario convertirlo esplicitamente in una lista per stamparne i valori:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">l1</span><span class="p">,</span><span class="n">l2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">l1</span><span class="p">,</span><span class="n">l2</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;zip object at 0x103f7c740&gt;
[(1, 3), (6, 8), (5, 9), (2, 2)]
</pre></div>
</div>
</div>
</div>
</section>
<section id="comprensione-di-liste-e-dizionari">
<h3><span class="section-number">2.13. </span>Comprensione di liste e dizionari<a class="headerlink" href="#comprensione-di-liste-e-dizionari" title="Permalink to this heading">#</a></h3>
<p>La comprensione di liste è uno strumento sintattico che permette di definire liste al volo a partire da altre liste, in maniera iterativa. Ad esempio, è possibile moltiplicare tutti gli elementi di una lista per un valore, come segue:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span>

<span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">*</span><span class="mi">3</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">a</span><span class="p">]</span> <span class="c1">#la lista &quot;a&quot; viene iterata. La variabile &quot;x&quot; conterrà di volta in volta i valori di a</span>

<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0, 1, 2, 3, 4, 5, 6, 7]
[0, 3, 6, 9, 12, 15, 18, 21]
</pre></div>
</div>
</div>
</div>
<p>E’ anche possibile includere solo alcuni elementi selettivamente:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">a</span> <span class="k">if</span> <span class="n">x</span><span class="o">%</span><span class="k">2</span>==0]) #include solo i numeri pari
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0, 2, 4, 6]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">9</span><span class="p">]</span>
<span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span>

<span class="n">c</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">+</span><span class="n">y</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)]</span>

<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="c1">#i suoi elementi sono le somme degli elementi di a e b</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1, 3, 8, 2, 9]
[4, 9, 2, 1, 4]
[5, 12, 10, 3, 13]
</pre></div>
</div>
</div>
</div>
<p>I meccanismi di comprensione si possono utilizzare anche nel caso dei dizionari:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;one&quot;</span><span class="p">,</span><span class="s2">&quot;two&quot;</span><span class="p">,</span><span class="s2">&quot;three&quot;</span><span class="p">,</span><span class="s2">&quot;four&quot;</span><span class="p">,</span><span class="s2">&quot;five&quot;</span><span class="p">,</span><span class="s2">&quot;six&quot;</span><span class="p">,</span><span class="s2">&quot;seven&quot;</span><span class="p">]</span>
<span class="n">b</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
<span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="n">i</span><span class="p">:</span><span class="n">s</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">s</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)}</span>
<span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;one&#39;: 1, &#39;two&#39;: 2, &#39;three&#39;: 3, &#39;four&#39;: 4, &#39;five&#39;: 5, &#39;six&#39;: 6, &#39;seven&#39;: 7}
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p><strong>🙋‍♂️ Domanda 7</strong></p>
<p>Tutte le operazioni che si possono fare mediante comprensione di liste e dizionari possono essere fatte mediante un ciclo for? Quali sono i vantaggi principali di queste tecniche rispetto a l’utilizzo dei cicli for?</p>
</div></blockquote>
</section>
<section id="definizione-di-funzioni">
<h3><span class="section-number">2.14. </span>Definizione di Funzioni<a class="headerlink" href="#definizione-di-funzioni" title="Permalink to this heading">#</a></h3>
<p>Considerato quanto già detto sulla indentazione, la definizione di una funzione è molto naturale:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">fun</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="n">y</span>

<span class="nb">print</span><span class="p">(</span><span class="n">fun</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="c1">#il valore di default &quot;2&quot; viene utilizzato</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>9
</pre></div>
</div>
</div>
</div>
<p>Inoltre, in maniera simile a quanto avviene con il linguaggio C, è possibile definire valori di default per i parametri:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">fun</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="n">y</span>

<span class="nb">print</span><span class="p">(</span><span class="n">fun</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="c1">#il valore di default &quot;2&quot; viene utilizzato</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>9
</pre></div>
</div>
</div>
</div>
<p>I parametri di una funzione possono essere specificati in un ordine diverso rispetto a quello in cui essi sono stati definiti richiamandone il nome:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">fun</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>8
</pre></div>
</div>
</div>
</div>
<p>E’ possibile definire una funzione che restituisce più di un elemento utilizzando le tuple:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">soMuchFun</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="o">**</span><span class="n">x</span>

<span class="nb">print</span><span class="p">(</span><span class="n">soMuchFun</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>

<span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="o">=</span><span class="n">soMuchFun</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="c1">#posso &quot;spacchettare&quot; la tupla restituita</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(8, 9)
8 9
</pre></div>
</div>
</div>
</div>
<p>E’ inoltre possibile definire funzioni anonime come segue:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">myfun</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="c1">#un input e un output</span>
<span class="nb">print</span><span class="p">(</span><span class="n">myfun</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>

<span class="n">myfun1</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">:</span> <span class="n">x</span><span class="o">+</span><span class="n">y</span> <span class="c1">#due input e un output</span>
<span class="nb">print</span><span class="p">(</span><span class="n">myfun1</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>

<span class="n">myfun2</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="c1">#due input e due output</span>
<span class="nb">print</span><span class="p">(</span><span class="n">myfun2</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4
5
(4, 9)
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p><strong>🙋‍♂️ Domanda 8</strong></p>
<p>Qual è il vantaggio di definire una funzione mediante <strong>lambda</strong>? Quali sono i suoi limiti?</p>
</div></blockquote>
</section>
<section id="map-e-filter">
<h3><span class="section-number">2.15. </span>Map e Filter<a class="headerlink" href="#map-e-filter" title="Permalink to this heading">#</a></h3>
<p>Le funzioni <strong>map</strong> e <strong>filter</strong> permettono di eseguire operazioni sugli elementi di una lista. In particolare, <strong>map</strong> applica una funzione a tutti gli elementi di una lista:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">pow2</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="n">l1</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<span class="n">l2</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">pow2</span><span class="p">,</span><span class="n">l1</span><span class="p">))</span> <span class="c1">#applica pow2 a tutti gli elementi della lista</span>
<span class="nb">print</span><span class="p">(</span><span class="n">l1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">l2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0, 1, 2, 3, 4, 5]
[0, 1, 4, 9, 16, 25]
</pre></div>
</div>
</div>
</div>
<p>Quando si utilizzano <strong>map</strong> e <strong>filter</strong>, tornano particolarmente utili le funzioni anonime, che ci permettono di scrivere in maniera più compatta. Ad esempio, possiamo riscrivere quanto visto sopra come segue:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">l2</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">l1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">l2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0, 1, 4, 9, 16, 25]
</pre></div>
</div>
</div>
</div>
<p><strong>Filter</strong> permette di selezionare un sottoinsieme degli elementi di una lista sulla base di una condizione. La condizione viene specificata passando una funzione che prende in input l’elemento della lista e restituisce un booleano:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">%</span><span class="k">2</span>==0,l1))) #filtra solo i numeri pari
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0, 2, 4]
</pre></div>
</div>
</div>
</div>
</section>
<section id="programmazione-orientata-agli-oggetti-definizione-di-classi">
<h3><span class="section-number">2.16. </span>Programmazione Orientata agli Oggetti - Definizione di Classi<a class="headerlink" href="#programmazione-orientata-agli-oggetti-definizione-di-classi" title="Permalink to this heading">#</a></h3>
<p>La programmazione orientata agli oggetti in Python è intuitiva. Le principali differenze rispetto ai più diffusi linguaggi di programmazione orientata agli oggetti sono le seguenti:</p>
<ul class="simple">
<li><p>non esistono i modificatori di visibilità (<strong>private</strong>, <strong>protected</strong> e <strong>public</strong>). Per convenzione, tutti i simboli privati vanno preceduti da “__”;</p></li>
<li><p>ogni metodo è una funzione con un argomento di default (<strong>self</strong>) che rappresenta lo stato dell’oggetto;</p></li>
<li><p>il costruttore si chiama “__init__”.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Classe</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span> <span class="c1">#ereditiamo dalla classe standard &quot;object&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span> <span class="c1">#costruttore</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="o">=</span><span class="n">x</span> <span class="c1">#inserisco il valore x nello stato dell&#39;oggetto</span>
    
    <span class="k">def</span> <span class="nf">prt</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">power</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span>  <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="o">**</span><span class="n">y</span>
        
<span class="n">c</span> <span class="o">=</span> <span class="n">Classe</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">c</span><span class="o">.</span><span class="n">prt</span><span class="p">()</span>
<span class="n">c</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">c</span><span class="o">.</span><span class="n">prt</span><span class="p">()</span>
<span class="n">c</span><span class="o">.</span><span class="n">power</span><span class="p">()</span>
<span class="n">c</span><span class="o">.</span><span class="n">prt</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3
27
729
</pre></div>
</div>
</div>
</div>
<p>Per estendere una classe, si fa come segue:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Classe2</span><span class="p">(</span><span class="n">Classe</span><span class="p">):</span> <span class="c1">#derivo la classe &quot;Classe&quot; ed eredito metodi e proprietà</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Classe2</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="c1">#chiamo il costruttore della classe madre</span>
    <span class="k">def</span> <span class="nf">prt</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="c1">#ridefinisco il metodo prt</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;yeah&quot;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
        
<span class="n">c2</span> <span class="o">=</span> <span class="n">Classe2</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">c2</span><span class="o">.</span><span class="n">power</span><span class="p">()</span>
<span class="n">c2</span><span class="o">.</span><span class="n">prt</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>yeah 4
</pre></div>
</div>
</div>
</div>
</section>
<section id="duck-typing">
<h3><span class="section-number">2.17. </span>Duck Typing<a class="headerlink" href="#duck-typing" title="Permalink to this heading">#</a></h3>
<p>Per identificare i tipi dei dati, Python segue il principio del <a href="https://en.wikipedia.org/wiki/Duck_typing">duck typing</a>. Secondo tale principio, i tipi sono definiti utilizzando il <em>duck test</em>:</p>
<blockquote>If it looks like a duck, swims like a duck, and quacks like a duck, then it probably is a duck.</blockquote>
<p>Ciò significa che i tipi sono definiti in relazione alle operazioni che possono essere eseguite su di essi. Vediamo un esempio (preso da Wikipedia).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Sparrow</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">fly</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sparrow flying&quot;</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Airplane</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">fly</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Airplane flying&quot;</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Whale</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">swim</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Whale swimming&quot;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">lift_off</span><span class="p">(</span><span class="n">entity</span><span class="p">):</span>
    <span class="n">entity</span><span class="o">.</span><span class="n">fly</span><span class="p">()</span>

<span class="n">sparrow</span> <span class="o">=</span> <span class="n">Sparrow</span><span class="p">()</span>
<span class="n">airplane</span> <span class="o">=</span> <span class="n">Airplane</span><span class="p">()</span>
<span class="n">whale</span> <span class="o">=</span> <span class="n">Whale</span><span class="p">()</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">lift_off</span><span class="p">(</span><span class="n">sparrow</span><span class="p">)</span> 
    <span class="n">lift_off</span><span class="p">(</span><span class="n">airplane</span><span class="p">)</span> 
    <span class="n">lift_off</span><span class="p">(</span><span class="n">whale</span><span class="p">)</span> <span class="c1">#Errore, il &quot;tipo&quot; di questo oggetto non permette di eseguire il metodo &quot;fly&quot;. </span>
                    <span class="c1">#Secondo il duck test, questo tipo è incompatibile</span>
<span class="k">except</span> <span class="ne">AttributeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error:&quot;</span><span class="p">,</span><span class="n">e</span><span class="p">)</span>
        
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sparrow flying
Airplane flying
Error: &#39;Whale&#39; object has no attribute &#39;fly&#39;
</pre></div>
</div>
</div>
</div>
</section>
<section id="eccezioni">
<h3><span class="section-number">2.18. </span>Eccezioni<a class="headerlink" href="#eccezioni" title="Permalink to this heading">#</a></h3>
<p>In maniera simile a molti linguaggi moderni, Python supporta l’uso delle eccezioni. E’ possibile catturare una eccezione con il costrutto <code class="docutils literal notranslate"><span class="pre">try</span> <span class="pre">-</span> <span class="pre">except</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="mi">5</span><span class="o">/</span><span class="mi">0</span>
<span class="k">except</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Houston, abbiamo un problema!&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Houston, abbiamo un problema!
</pre></div>
</div>
</div>
</div>
<p>In Python, le eccezioni sono tipizzate. Possiamo decidere quali tipi di eccezioni catturare come segue:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="mi">5</span><span class="o">/</span><span class="mi">0</span>
<span class="k">except</span> <span class="ne">ZeroDivisionError</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Houston, abbiamo un problema!&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Houston, abbiamo un problema!
</pre></div>
</div>
</div>
</div>
<p>Possiamo avere accesso all’eccezione scatenata (ad esempio ottenere maggiori informazioni) come segue:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="mi">5</span><span class="o">/</span><span class="mi">0</span>
<span class="k">except</span> <span class="ne">ZeroDivisionError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Houston, abbiamo un problema!&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Houston, abbiamo un problema!
division by zero
</pre></div>
</div>
</div>
</div>
<p>E’ possibile lanciare una eccezione mediante <code class="docutils literal notranslate"><span class="pre">raise</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">div</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">y</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ZeroDivisionError</span><span class="p">()</span> <span class="c1">#lancia una eccezione</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">x</span><span class="o">/</span><span class="n">y</span>
<span class="n">div</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">div</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>Possiamo definire nuove eccezioni estendendo la classe <code class="docutils literal notranslate"><span class="pre">Exception</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyException</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="n">message</span>

<span class="k">raise</span> <span class="n">MyException</span><span class="p">(</span><span class="s2">&quot;Exception!&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Un modo veloce e comodo per lanciare una eccezione (un AssertionError nello specifico) quando qualcosa va male, è utilizzare <code class="docutils literal notranslate"><span class="pre">assert</span></code>, che prende in input un booleano e, opzionalmente, un messaggio di errore. Il booleano va posto uguale a <code class="docutils literal notranslate"><span class="pre">False</span></code> se qualcosa è andato storto. Vediamo un esempio:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">div</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    <span class="k">assert</span> <span class="n">y</span><span class="o">!=</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Cannot divide by zero!&quot;</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">/</span><span class="n">y</span>

<span class="n">div</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">div</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="definizione-di-moduli">
<h3><span class="section-number">2.19. </span>Definizione di Moduli<a class="headerlink" href="#definizione-di-moduli" title="Permalink to this heading">#</a></h3>
<p>Quando si costruiscono programmi complessi, può essere utile raggruppare le definizioni di funzione e classi in moduli. Il modo più semplice di definire un modulo in Python consiste nell’inserire le definizioni all’interno di un file apposito <code class="docutils literal notranslate"><span class="pre">modulo.py</span></code>. Le definizioni potranno poi essere importati mediante la sintassi <code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">modulo</span> <span class="pre">import</span> <span class="pre">funzione</span></code>, a patto che il file che richiama le funzioni e quello che definisce il modulo si trovino nella stessa cartella. Vediamo un esempio:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#file modulo.py</span>
<span class="k">def</span> <span class="nf">mysum</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">a</span><span class="o">+</span><span class="n">b</span>

<span class="k">def</span> <span class="nf">myprod</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">a</span><span class="o">*</span><span class="n">b</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#file main.py (stessa cartella di modulo.py)</span>
<span class="kn">from</span> <span class="nn">modulo</span> <span class="kn">import</span> <span class="n">mysum</span><span class="p">,</span> <span class="n">myprod</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mysum</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span> <span class="c1">#5</span>
<span class="nb">print</span><span class="p">(</span><span class="n">myprod</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span> <span class="c1">#6</span>
</pre></div>
</div>
<p>Altre informazioni su usi più avanzati di moduli e pacchetti possono essere reperite qui: <a class="reference external" href="https://docs.python.org/3/tutorial/modules.html">https://docs.python.org/3/tutorial/modules.html</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span> <span class="c1">#la notazione &quot;as&quot; ci permette di referenziare il namespace numpy semplicemente con np in futuro</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">l</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">3</span><span class="p">]]</span> <span class="c1">#una lista contenente tre liste</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;List of lists:&quot;</span><span class="p">,</span><span class="n">l</span><span class="p">)</span> <span class="c1">#viene visualizzata così come l&#39;abbiamo definita</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="c1">#costruisco un array di numpy a partire dalla lista di liste</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Numpy array:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">a</span><span class="p">)</span> <span class="c1">#ogni lista interna viene identificata come una riga di una matrice bidimensionale</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Numpy array from tuple:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(((</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),(</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">))))</span> <span class="c1">#posso creare numpy array anche da tuple</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>List of lists: [[1, 2, 3], [4, 5, 2], [1, 8, 3]]
Numpy array:
 [[1 2 3]
 [4 5 2]
 [1 8 3]]
Numpy array from tuple:
 [[1 2 3]
 [4 5 6]]
</pre></div>
</div>
</div>
</div>
<p>Ogni array di numpy ha una proprietà <em>shape</em> che ci permette di determinare il numero di dimensioni della struttura:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="c1">#si tratta di una matrice 3 x 3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(3, 3)
</pre></div>
</div>
</div>
</div>
<p>Vediamo qualche altro esempio</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span> 
<span class="n">matrice</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span> 
<span class="n">tensore</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="s1">&#39;d&#39;</span><span class="p">]],[[</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="s1">&#39;d&#39;</span><span class="p">]],[[</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="s1">&#39;d&#39;</span><span class="p">]],[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="s1">&#39;d&#39;</span><span class="p">]]])</span> 
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Array:&#39;</span><span class="p">,</span><span class="n">array</span><span class="p">,</span> <span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="c1">#array monodimensionale, avrà una sola dimensione</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Matrix:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">matrice</span><span class="p">,</span> <span class="n">matrice</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;matrix:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">tensore</span><span class="p">,</span> <span class="n">tensore</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="c1">#tensore, avrà due dimensioni</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Array: [1 2 3 4] (4,)
Matrix:
 [[1 2 3 4]
 [5 4 2 3]
 [7 5 3 2]
 [0 2 3 1]] (4, 4)
matrix:
 [[[&#39;1&#39; &#39;2&#39; &#39;3&#39; &#39;4&#39;]
  [&#39;a&#39; &#39;b&#39; &#39;c&#39; &#39;d&#39;]]

 [[&#39;5&#39; &#39;4&#39; &#39;2&#39; &#39;3&#39;]
  [&#39;a&#39; &#39;b&#39; &#39;c&#39; &#39;d&#39;]]

 [[&#39;7&#39; &#39;5&#39; &#39;3&#39; &#39;2&#39;]
  [&#39;a&#39; &#39;b&#39; &#39;c&#39; &#39;d&#39;]]

 [[&#39;0&#39; &#39;2&#39; &#39;3&#39; &#39;1&#39;]
  [&#39;a&#39; &#39;b&#39; &#39;c&#39; &#39;d&#39;]]] (4, 2, 4)
</pre></div>
</div>
</div>
</div>
<p>Vediamo qualche operazione tra numpy array:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span> 
<span class="n">a2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span> 
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sum:&quot;</span><span class="p">,</span><span class="n">a1</span><span class="o">+</span><span class="n">a2</span><span class="p">)</span> <span class="c1">#somma tra vettori</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Elementwise multiplication:&quot;</span><span class="p">,</span><span class="n">a1</span><span class="o">*</span><span class="n">a2</span><span class="p">)</span> <span class="c1">#moltiplicazione tra elementi corrispondenti</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Power of two:&quot;</span><span class="p">,</span><span class="n">a1</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="c1">#quadrato degli elementi</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Elementwise power:&quot;</span><span class="p">,</span><span class="n">a1</span><span class="o">**</span><span class="n">a2</span><span class="p">)</span> <span class="c1">#elevamento a potenza elemento per elemento</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Vector product:&quot;</span><span class="p">,</span><span class="n">a1</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">a2</span><span class="p">))</span> <span class="c1">#prodotto vettoriale</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Minimum:&quot;</span><span class="p">,</span><span class="n">a1</span><span class="o">.</span><span class="n">min</span><span class="p">())</span> <span class="c1">#minimo dell&#39;array</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Maximum:&quot;</span><span class="p">,</span><span class="n">a1</span><span class="o">.</span><span class="n">max</span><span class="p">())</span> <span class="c1">#massimo dell&#39;array</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sum:&quot;</span><span class="p">,</span><span class="n">a2</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span> <span class="c1">#somma di tutti i valori dell&#39;array</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Product:&quot;</span><span class="p">,</span><span class="n">a2</span><span class="o">.</span><span class="n">prod</span><span class="p">())</span> <span class="c1">#prodotto di tutti i valori dell&#39;array</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mean:&quot;</span><span class="p">,</span><span class="n">a1</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> <span class="c1">#media di tutti i valori dell&#39;array</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sum: [ 5  5 11  5]
Elementwise multiplication: [ 4  6 24  4]
Power of two: [ 1  4  9 16]
Elementwise power: [   1    8 6561    4]
Vector product: 38
Minimum: 1
Maximum: 4
Sum: 16
Product: 96
Mean: 2.5
</pre></div>
</div>
</div>
</div>
<p>Operazioni tra matrici:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span> 
<span class="n">m2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">8</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">]])</span> 

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sum:&quot;</span><span class="p">,</span><span class="n">m1</span><span class="o">+</span><span class="n">m2</span><span class="p">)</span> <span class="c1">#somma tra matrici</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Elementwise product:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">m1</span><span class="o">*</span><span class="n">m2</span><span class="p">)</span> <span class="c1">#prodotto elemento per elemento</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Power of two:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">m1</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="c1">#quadrato degli elementi</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Elementwise power:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">m1</span><span class="o">**</span><span class="n">m2</span><span class="p">)</span> <span class="c1">#elevamento a potenza elemento per elemento</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Matrix multiplication:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">m1</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">m2</span><span class="p">))</span> <span class="c1">#prodotto matriciale</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Minimum:&quot;</span><span class="p">,</span><span class="n">m1</span><span class="o">.</span><span class="n">min</span><span class="p">())</span> <span class="c1">#minimo</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Maximum:&quot;</span><span class="p">,</span><span class="n">m1</span><span class="o">.</span><span class="n">max</span><span class="p">())</span> <span class="c1">#massimo</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Minimum along columns:&quot;</span><span class="p">,</span><span class="n">m1</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span> <span class="c1">#minimo per colonne</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Minimum along rows:&quot;</span><span class="p">,</span><span class="n">m1</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="c1">#minimo per righe</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sum:&quot;</span><span class="p">,</span><span class="n">m1</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span> <span class="c1">#somma dei valori</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mean:&quot;</span><span class="p">,</span><span class="n">m1</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> <span class="c1">#valore medio</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Diagonal:&quot;</span><span class="p">,</span><span class="n">m1</span><span class="o">.</span><span class="n">diagonal</span><span class="p">())</span> <span class="c1">#diagonale principale della matrice</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Transposed:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">m1</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="c1">#matrice trasposta</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sum: [[ 9  4  4  8]
 [ 5  8  8  4]
 [11  9  5  2]
 [ 0  3 11  7]]
Elementwise product:
 [[ 8  4  3 16]
 [ 0 16 12  3]
 [28 20  6  0]
 [ 0  2 24  6]]
Power of two:
 [[ 1  4  9 16]
 [25 16  4  9]
 [49 25  9  4]
 [ 0  4  9  1]]
Elementwise power:
 [[   1    4    3  256]
 [   1  256   64    3]
 [2401  625    9    1]
 [   1    2 6561    1]]
Matrix multiplication:
 [[20 26 51 30]
 [48 37 57 42]
 [68 48 59 45]
 [12 21 26  8]]
Minimum: 0
Maximum: 7
Minimum along columns: [0 2 2 1]
Minimum along rows: [1 2 2 0]
Sum: 47
Mean: 2.9375
Diagonal: [1 4 3 1]
Transposed:
 [[1 5 7 0]
 [2 4 5 2]
 [3 2 3 3]
 [4 3 2 1]]
</pre></div>
</div>
</div>
</div>
</section>
<section id="esercizi">
<h3><span class="section-number">2.20. </span>Esercizi<a class="headerlink" href="#esercizi" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><p>🧑‍💻 Esercizio 1</p>
<p>Definire la lista <code class="docutils literal notranslate"><span class="pre">[1,8,2,6,15,21,76,22,0,111,23,12,24]</span></code>, dunque:</p>
<ul class="simple">
<li><p>Stampare il primo numero della lista;</p></li>
<li><p>Stampare l’ultimo numero della lista;</p></li>
<li><p>Stampare la somma dei numeri con indici dispari (e.g., 1,3,5,…) nella lista;</p></li>
<li><p>Stampare la lista ordinata in senso inverso;</p></li>
<li><p>Stampare la media dei numeri contenuti nella lista.</p></li>
</ul>
</div></blockquote>
<blockquote>
<div><p>🧑‍💻 Esercizio 2</p>
<p>Si definisca un dizionario <code class="docutils literal notranslate"><span class="pre">mesi</span></code> che mappi i nomi dei mesi nei loro corrispettivi numerici. Ad esempio, il risultato di:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span> <span class="n">mesi</span><span class="p">[</span><span class="s1">&#39;Gennaio&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>deve essere</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span>
</pre></div>
</div>
</div></blockquote>
<blockquote>
<div><p>🧑‍💻 Esercizio 3</p>
<p>Si considerino le seguenti liste:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">l1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
<span class="n">l2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]</span>
<span class="n">l3</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">]</span>
</pre></div>
</div>
<p>Si combinino un ciclo for, <strong>zip</strong> e <strong>enumerate</strong> per ottenere il seguente output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">0</span> <span class="o">-&gt;</span> <span class="mi">10</span>
<span class="mi">1</span> <span class="o">-&gt;</span> <span class="mi">9</span>
<span class="mi">2</span> <span class="o">-&gt;</span> <span class="mi">15</span>
</pre></div>
</div>
</div></blockquote>
<blockquote>
<div><p>🧑‍💻 Esercizio 4</p>
<p>Si ripeta l’esercizio <strong>2</strong> utilizzando la comprensione di dizionari. A tale scopo, si definisca prima la lista <code class="docutils literal notranslate"><span class="pre">['Gennaio','Febbraio','Marzo','Aprile','Maggio','Giugno',</span></code>
<code class="docutils literal notranslate"><span class="pre">'Luglio','Agosto','Settembre','Ottobre','Novembre','Dicembre']</span></code>.</p>
<p>Si costruisca dunque il dizionario desiderato utilizzando la comprensione di dizionari e la funzione <code class="docutils literal notranslate"><span class="pre">enum</span></code></p>
</div></blockquote>
<blockquote>
<div><p>🧑‍💻 Esercizio 5</p>
<p>Date le variabili:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">obj</span><span class="o">=</span><span class="s1">&#39;triangolo&#39;</span>
<span class="n">area</span><span class="o">=</span><span class="mf">21.167822</span>
</pre></div>
</div>
<p>stampare le stringhe:</p>
<ul class="simple">
<li><p>L’area del triangolo è 21.16</p></li>
<li><p>21.1678 è l’area del triangolo</p></li>
</ul>
<p>Utilizzare la formattazione di stringhe per ottenere il risultato.</p>
</div></blockquote>
<blockquote>
<div><p>🧑‍💻 Esercizio 6</p>
<p>Scrivere una funzione che estragga il dominio da un indirizzo email. Ad esempio, se l’indirizzo è “<a class="reference external" href="mailto:furnari&#37;&#52;&#48;dmi&#46;unict&#46;it">furnari<span>&#64;</span>dmi<span>&#46;</span>unict<span>&#46;</span>it</a>”, la funzione deve estrarre “<a class="reference external" href="http://dmi.unict.it">dmi.unict.it</a>”.</p>
</div></blockquote>
</section>
</section>
</div>
<div class="toctree-wrapper compound">
<span id="document-lectures/03_main_data_analysis_concepts"></span><section class="tex2jax_ignore mathjax_ignore" id="introduction-to-data-analysis-and-key-concepts">
<h2><span class="section-number">3. </span>Introduction to Data Analysis and Key Concepts<a class="headerlink" href="#introduction-to-data-analysis-and-key-concepts" title="Permalink to this heading">#</a></h2>
<p>In this lecture, we will consider the main data analysis concepts.</p>
<section id="what-is-data-an-informal-definition">
<h3><span class="section-number">3.1. </span>What is Data? An informal Definition<a class="headerlink" href="#what-is-data-an-informal-definition" title="Permalink to this heading">#</a></h3>
<p>We will start by giving an informal definition of data. It is not by any means a complete definition, but it will suffice as a starting point to get an intuitive understanding of what data is:</p>
<blockquote>
<div><p>Data is a <strong>set of values</strong> <strong>collected</strong> with respect to some <strong>variables</strong> which describe a given <strong>phenomenon</strong>.</p>
</div></blockquote>
<p>In the definition above, we mentioned some key concepts, which are discussed in the following sections.</p>
</section>
<section id="observations-populations-samples">
<h3><span class="section-number">3.2. </span>Observations, Populations, Samples<a class="headerlink" href="#observations-populations-samples" title="Permalink to this heading">#</a></h3>
<p>We will see three fundamental concepts: observations, populations, samples.</p>
<section id="observations">
<h4><span class="section-number">3.2.1. </span>Observations<a class="headerlink" href="#observations" title="Permalink to this heading">#</a></h4>
<p>When we deal with data, we actually deal with <em>multiple instances</em> of values associated to the same event or phenomenon. Examples:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Example</p></th>
<th class="head"><p>Comment</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>We want to study how the heights of students change with the years</p></td>
<td><p>We need sets of recorded heights, not just one height</p></td>
</tr>
<tr class="row-odd"><td><p>We want to study how a given drug affects the recovering from a disease</p></td>
<td><p>We need to record sets of values about drug assumption and recover, just one case will not be enough</p></td>
</tr>
<tr class="row-even"><td><p>We need to create a system which can generate text from a prompt</p></td>
<td><p>We need to record several examples of prompt-text generation, just one would not be enough to study how such generation should be made</p></td>
</tr>
</tbody>
</table>
<p>We will call observations, the units by which we measure data. These could be persons, cars, animals, plants, etc. We often indicate an observation as <span class="math notranslate nohighlight">\(x\)</span>. Please consider these as “abstract” entities, not necessarily numerical observations. E.g., “let’s consider a person <span class="math notranslate nohighlight">\(x\)</span>”.</p>
</section>
<section id="population">
<h4><span class="section-number">3.2.2. </span>Population<a class="headerlink" href="#population" title="Permalink to this heading">#</a></h4>
<p>When we study a given phenomenon, we will be interested in a set of observations, which is called a “population”. For instance:</p>
<ul class="simple">
<li><p>if we want to study the distribution of heights of people in the world, we will need to look at the population of all people in the world.</p></li>
<li><p>if we want to study the age of people attending a computer science course in Italy, then we need to look at the population of all students of computer science courses in Italy.</p></li>
</ul>
<p>Note that a population can sometimes be a theoretical concept and identify sets of elements which are not even finite. E.g., <em>“all movies which will ever be filmed”</em>.</p>
<p>We can denote a population with the symbol <span class="math notranslate nohighlight">\(\Omega\)</span>. Al our observations will be <span class="math notranslate nohighlight">\(\omega \in \Omega\)</span>.</p>
</section>
<section id="sample">
<h4><span class="section-number">3.2.3. </span>Sample<a class="headerlink" href="#sample" title="Permalink to this heading">#</a></h4>
<p>In practice, working with population can be very hard, as it is not always possible to obtain observations from those large sets. Intuitively, in practice, working on a large enough set of observations from a population could be good enough. We refer to a subset of a population as “a sample”: <span class="math notranslate nohighlight">\(\{\omega^{(1)}, \omega^{(2)}, \ldots, \omega^{(n)}\} \subseteq \Omega\)</span>.</p>
</section>
<section id="example">
<h4><span class="section-number">3.2.4. </span>Example<a class="headerlink" href="#example" title="Permalink to this heading">#</a></h4>
<p>We want to study how the height of people in the world changed in the years. Here the <strong>population</strong> <span class="math notranslate nohighlight">\(\Omega\)</span> is the set of people ever existed on earth, a <strong>sample</strong> <span class="math notranslate nohighlight">\(\{\omega^{(1)},\ldots,\omega^{(n)}\} \subseteq \Omega\)</span> is a subset of people for which we have some data (e.g., say we measured height of many people in most countries since the 16th century). An observation is a person <span class="math notranslate nohighlight">\(\omega^{(i)}\)</span>.</p>
</section>
</section>
<section id="variables">
<h3><span class="section-number">3.3. </span>Variables<a class="headerlink" href="#variables" title="Permalink to this heading">#</a></h3>
<p>We have identified our problem, defined a suitable population and identified a sample of observations. While observations are abstract concepts such as “a person” or “a student”, we usually want to capture specific features of such observations, such as “the person’s age” or “the student’s height”. We collect these features by means of <strong>statistical variables</strong>.</p>
<p>Statistical variables are concept similar to that of mathematical of programming variables, in that they can be seen as sort of “containers for the data”.</p>
<p>We may also be interested in different features of an observation. For instance, for each person in a population, we may want to record their age, gender, and height. We can introduce a variable to capture each of these features. For instance, given observation <span class="math notranslate nohighlight">\(\omega\)</span>, we may obtain “height = 180cm”, “weight=80Kg”, “gender=male”.</p>
<p>Formally, we’ll define a variable <span class="math notranslate nohighlight">\(X\)</span> as:</p>
<div class="math notranslate nohighlight">
\[X : \Omega \to S\]</div>
<div class="math notranslate nohighlight">
\[ \omega \mapsto x\]</div>
<p>Where <span class="math notranslate nohighlight">\(S\)</span> is the set of possible values for variable <span class="math notranslate nohighlight">\(X\)</span>. The definition above specifies that a variable maps an abstract observation <span class="math notranslate nohighlight">\(\omega\)</span> to some (possibly more concrete) value <span class="math notranslate nohighlight">\(x \in S\)</span>.</p>
<section id="id1">
<h4><span class="section-number">3.3.1. </span>Example<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h4>
<p>Given the population of all people currently living in the world <span class="math notranslate nohighlight">\(\Omega\)</span>, we define a variable <span class="math notranslate nohighlight">\(H\)</span> to collect the heights of the observed people <span class="math notranslate nohighlight">\(\omega\)</span>:</p>
<div class="math notranslate nohighlight">
\[H : \Omega \to \mathbb{R}\]</div>
<div class="math notranslate nohighlight">
\[ \omega \mapsto h \]</div>
<p>Given an observation <span class="math notranslate nohighlight">\(\omega^{(1)}\)</span>, we may obtain <span class="math notranslate nohighlight">\(H(\omega)=180\)</span>. We often say that <span class="math notranslate nohighlight">\(H\)</span> assumes the value <span class="math notranslate nohighlight">\(180\)</span> and write: <span class="math notranslate nohighlight">\(H=180\)</span>.</p>
</section>
<section id="quantitative-and-qualitative">
<h4><span class="section-number">3.3.2. </span>Quantitative and Qualitative<a class="headerlink" href="#quantitative-and-qualitative" title="Permalink to this heading">#</a></h4>
<p>Variables can be of two main kinds:</p>
<ul class="simple">
<li><p><strong>Qualitative</strong>: represent properties that can be observed and cannot generally be measured with a numerical value (e.g., ‘color’, ‘sex’);</p></li>
<li><p><strong>Quantitative</strong>: represent properties that can be quantified with a number (e.g., ‘height’, ‘weight’, ‘age’).</p></li>
</ul>
</section>
<section id="discrete-and-continuous">
<h4><span class="section-number">3.3.3. </span>Discrete and Continuous<a class="headerlink" href="#discrete-and-continuous" title="Permalink to this heading">#</a></h4>
<p>Variables can also be discrete or continues:</p>
<ul class="simple">
<li><p><strong>Discrete variables</strong> can assume a finite number (or a countable infinite number) of possible values</p></li>
<li><p><strong>Continuous variable</strong> assume a continuous, infinite number of values, which can be generally denoted with real numbers</p></li>
</ul>
</section>
<section id="scalar-and-multi-dimensional">
<h4><span class="section-number">3.3.4. </span>Scalar and Multi-Dimensional<a class="headerlink" href="#scalar-and-multi-dimensional" title="Permalink to this heading">#</a></h4>
<p>Variables can be:</p>
<ul class="simple">
<li><p><strong>scalar</strong> or uni-dimensional: they assume real numbers (e.g., <span class="math notranslate nohighlight">\(X=1\)</span>)</p></li>
<li><p><strong>multi-dimensional</strong>: they assume vector or matrix values, (e.g., <span class="math notranslate nohighlight">\(X = \binom{1}{3}\)</span>, or <span class="math notranslate nohighlight">\(X = \begin{pmatrix}
1 &amp; 2 \\
3 &amp; 4 \\
\end{pmatrix}\)</span>).</p></li>
</ul>
</section>
<section id="examples">
<h4><span class="section-number">3.3.5. </span>Examples<a class="headerlink" href="#examples" title="Permalink to this heading">#</a></h4>
<p>Let’s see some examples:</p>
<section id="discrete-scalar-variables">
<h5><span class="section-number">3.3.5.1. </span>Discrete Scalar Variables<a class="headerlink" href="#discrete-scalar-variables" title="Permalink to this heading">#</a></h5>
<p>We want to assess if a coin is fair or not.</p>
<ul class="simple">
<li><p>We consider as population all possible tosses of that coin.</p></li>
<li><p>An observation will be a specific tossing.</p></li>
<li><p>A discrete scalar variable <span class="math notranslate nohighlight">\(X\)</span> may record the outcome of a given tossing. The set of possible values will be <span class="math notranslate nohighlight">\(S=\{head,\ tail\}\)</span> (discrete values). The variable is scalar as it will contain a single value.</p></li>
<li><p>If we toss a coin, we may get <span class="math notranslate nohighlight">\(X=tail\)</span>.</p></li>
</ul>
</section>
<section id="continuous-scalar-variables">
<h5><span class="section-number">3.3.5.2. </span>Continuous Scalar Variables<a class="headerlink" href="#continuous-scalar-variables" title="Permalink to this heading">#</a></h5>
<p>We want to study the heights in centimeters of students in this class.</p>
<ul class="simple">
<li><p>Our population is the set of all students in this class.</p></li>
<li><p>We can use a continuous scalar variable <span class="math notranslate nohighlight">\(X\)</span> to record the heights of the students. In this case, we can choose <span class="math notranslate nohighlight">\(S=\mathbb{R}_+\)</span>.</p></li>
<li><p>If we pick a student, we may get <span class="math notranslate nohighlight">\(X=175\)</span>.</p></li>
</ul>
</section>
<section id="continuous-multi-dimensional-variables">
<h5><span class="section-number">3.3.5.3. </span>Continuous Multi-Dimensional Variables<a class="headerlink" href="#continuous-multi-dimensional-variables" title="Permalink to this heading">#</a></h5>
<p>We want to study the positions of all cars in the world.</p>
<ul class="simple">
<li><p>Our population is the set of all cars in the world.</p></li>
<li><p>We could use the variable <span class="math notranslate nohighlight">\(X\)</span> to denote the latitude and longitude coordinates of a car in the world. The set of possible values may be <span class="math notranslate nohighlight">\(S=\mathbb{R}^2\)</span>.</p></li>
<li><p>Once we pick a car, we may have <span class="math notranslate nohighlight">\(X = \binom{37}{15}\)</span>.</p></li>
</ul>
</section>
</section>
<section id="scales">
<h4><span class="section-number">3.3.6. </span>Scales<a class="headerlink" href="#scales" title="Permalink to this heading">#</a></h4>
<p>The values of the variables can sometimes be ordered. For instance, we can say that a student is taller than another one. In other cases, an order is not possible. For instance, it may not be meaningful to order students by color of the eyes or gender. We can classify whether and how a variable can be sorted using scales. Variables can be characterized with respect to the following scales:</p>
<ul class="simple">
<li><p><strong>Nominal scale</strong>: nominal variables cannot be ordered. Examples are the gender of a person and the color of the eyes.</p></li>
<li><p><strong>Ordinal scale</strong>: ordinal variables can be ordered, but the difference between two ordinal variables is usually not meaningful. For instance, we may have the following scale to classify the level of expertise of a basketball player: <em>novice, amateur, intermediate, expert</em>. While this scale allows to meaningful sort players, the difference between two levels may not be meaningful.</p></li>
<li><p><strong>Continuous scale</strong>: continuous variables are generally expressed with real numbers and can be ordered. For instance, the <em>height of people</em> and the <em>amount of money in the bank account</em> are examples of continuous variables.</p></li>
</ul>
</section>
</section>
<section id="data-collection">
<h3><span class="section-number">3.4. </span>Data Collection<a class="headerlink" href="#data-collection" title="Permalink to this heading">#</a></h3>
<p>Data collection is the crucial first step in the data analysis process. It involves gathering observations that will serve as the foundation for all subsequent analysis. The methods of data collection can vary widely depending on the goals of the analysis, the type of data required, and available resources.</p>
<section id="survey">
<h4><span class="section-number">3.4.1. </span>Survey<a class="headerlink" href="#survey" title="Permalink to this heading">#</a></h4>
<p>Surveys are a common method of data collection used to gather information from individuals or groups. They involve asking specific questions to respondents, often in a structured format. Surveys can be conducted through various means, such as paper questionnaires, online forms, telephone interviews, or in-person interviews. Surveys are particularly useful when seeking opinions, attitudes, preferences, or demographic information from a target population.</p>
<p>Key characteristics of surveys:</p>
<ul class="simple">
<li><p>Structured and standardized questions.</p></li>
<li><p>Can be administered in various formats.</p></li>
<li><p>Allow for quantifiable responses.</p></li>
</ul>
</section>
<section id="experiments">
<h4><span class="section-number">3.4.2. </span>Experiments<a class="headerlink" href="#experiments" title="Permalink to this heading">#</a></h4>
<p>Another way to collect data is through experiments. These allow to collect data in a <strong>controlled</strong> way and they are usually employed to establish cause-and-effect relationships between variables. In an experiment, researchers manipulate one or more independent variables to observe their effects on dependent variables. Experiments are characterized by their ability to provide evidence of causation, which is a significant advantage in many scientific and practical applications.</p>
<p>The most common form of experiments for data collection are <strong>randomized controlled experiments</strong> (or randomized controlled trials), which have the following characteristics:</p>
<ul class="simple">
<li><p>Controlled manipulation of variables.</p></li>
<li><p>Random assignment of participants (in randomized experiments).</p></li>
<li><p>Replicability to test hypotheses.</p></li>
</ul>
<section id="randomized-controlled-experiments-example">
<h5><span class="section-number">3.4.2.1. </span>Randomized Controlled Experiments - Example<a class="headerlink" href="#randomized-controlled-experiments-example" title="Permalink to this heading">#</a></h5>
<p>We want to test whether a given drug is effective in treating a disease. We will consider a suitable population (e.g., all people affected by the disease), obtain a suitable sample (a random set of people, diverse by age, gender and health conditions) and set up an experiment in which half of the people take the drug, while the remaining half take a placebo. The assignment are <strong>randomized</strong> to avoid any bias in the data. We will discuss this better when we’ll talk of causal inference.</p>
</section>
</section>
<section id="observational-data">
<h4><span class="section-number">3.4.3. </span>Observational Data<a class="headerlink" href="#observational-data" title="Permalink to this heading">#</a></h4>
<p>Observational data collection involves the passive recording of information as it naturally occurs, without any interference or manipulation by the researcher. This method is commonly used when experiments are not feasible, ethical, or practical. For instance, if we want to affect the effects of smoke on young people, it would be unethical to ask people to smoke. Observational studies can be valuable for exploring patterns, relationships, and behaviors in real-world settings.</p>
<p>Key characteristics of observational data:</p>
<ul class="simple">
<li><p>No direct manipulation of variables.</p></li>
<li><p>Captures data as it naturally occurs.</p></li>
<li><p>Useful for studying complex, uncontrolled environments.</p></li>
</ul>
</section>
</section>
<section id="data-sets-design-matrix-and-features">
<h3><span class="section-number">3.5. </span>Data Sets, Design Matrix, and Features<a class="headerlink" href="#data-sets-design-matrix-and-features" title="Permalink to this heading">#</a></h3>
<p>A set of data related to a specific phenomenon is called a “dataset”. Datasets are usually stored in tables in which <strong>columns represent the different variables</strong> and <strong>rows represent the different observations</strong>. If you have ever had a look at a spreadsheet, you probably already saw an example of a dataset!</p>
<p>Let’s consider the following example of a dataset of marks of <span class="math notranslate nohighlight">\(5\)</span> subjects obtained by three students:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p>Maths</p></th>
<th class="head"><p>Geography</p></th>
<th class="head"><p>English</p></th>
<th class="head"><p>Physics</p></th>
<th class="head"><p>Chemistry</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>x001</p></td>
<td><p>8</p></td>
<td><p>9</p></td>
<td><p>30</p></td>
<td><p>8</p></td>
<td><p>10</p></td>
</tr>
<tr class="row-odd"><td><p>x038</p></td>
<td><p>9</p></td>
<td><p>7</p></td>
<td><p>27</p></td>
<td><p>6</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>x002</p></td>
<td><p>6</p></td>
<td><p>-1</p></td>
<td><p>18</p></td>
<td><p>5</p></td>
<td><p>6</p></td>
</tr>
<tr class="row-odd"><td><p>x012</p></td>
<td><p>7</p></td>
<td><p>7</p></td>
<td><p>25</p></td>
<td><p>4</p></td>
<td><p>10</p></td>
</tr>
<tr class="row-even"><td><p>x042</p></td>
<td><p>10</p></td>
<td><p>10</p></td>
<td><p>30</p></td>
<td><p>10</p></td>
<td><p>10</p></td>
</tr>
</tbody>
</table>
<p>Each row is an <strong>observation</strong> related to a given student, while each column represents a different <strong>variable</strong> (the marks obtained in the different courses).</p>
<p>Before moving on, think for a moment what you could do with a dataset like this (maybe imagine a larger one):</p>
<ul class="simple">
<li><p>You could take the average of all marks obtained by a student (average by rows) to get a ranking of the students. This could be useful to understand which students may need help.</p></li>
<li><p>You could compute the average of the votes obtained in each course (average by column) to identify the subjects which are “more difficult” for the students than others.</p></li>
<li><p>You could group the courses into humanity-based and science-based to identify which students excel in each field.</p></li>
</ul>
<p>The examples above are all (very simple) examples of data analysis. As you can see, even with a simple dataset like this and no knowledge of complex notions of data analysis, we can already do a lot of analysis.</p>
<p>The “table” structure containing a dataset is often called a <strong>data matrix</strong> or a <strong>design matrix</strong>. In this format, each column of the matrix represents a variable, which is often also referred to as a <strong>feature</strong>, while each row is a different observation.</p>
<p>Let’s have a look at a real, but simple, dataset we’ll use often in the future, the <code class="docutils literal notranslate"><span class="pre">Titanic</span></code> dataset, which like like this:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Name</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>Cabin</th>
      <th>Embarked</th>
    </tr>
    <tr>
      <th>PassengerId</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>3</td>
      <td>Braund, Mr. Owen Harris</td>
      <td>male</td>
      <td>22.0</td>
      <td>1</td>
      <td>0</td>
      <td>A/5 21171</td>
      <td>7.2500</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>1</td>
      <td>Cumings, Mrs. John Bradley (Florence Briggs Th...</td>
      <td>female</td>
      <td>38.0</td>
      <td>1</td>
      <td>0</td>
      <td>PC 17599</td>
      <td>71.2833</td>
      <td>C85</td>
      <td>C</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>3</td>
      <td>Heikkinen, Miss. Laina</td>
      <td>female</td>
      <td>26.0</td>
      <td>0</td>
      <td>0</td>
      <td>STON/O2. 3101282</td>
      <td>7.9250</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>1</td>
      <td>Futrelle, Mrs. Jacques Heath (Lily May Peel)</td>
      <td>female</td>
      <td>35.0</td>
      <td>1</td>
      <td>0</td>
      <td>113803</td>
      <td>53.1000</td>
      <td>C123</td>
      <td>S</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0</td>
      <td>3</td>
      <td>Allen, Mr. William Henry</td>
      <td>male</td>
      <td>35.0</td>
      <td>0</td>
      <td>0</td>
      <td>373450</td>
      <td>8.0500</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>887</th>
      <td>0</td>
      <td>2</td>
      <td>Montvila, Rev. Juozas</td>
      <td>male</td>
      <td>27.0</td>
      <td>0</td>
      <td>0</td>
      <td>211536</td>
      <td>13.0000</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>888</th>
      <td>1</td>
      <td>1</td>
      <td>Graham, Miss. Margaret Edith</td>
      <td>female</td>
      <td>19.0</td>
      <td>0</td>
      <td>0</td>
      <td>112053</td>
      <td>30.0000</td>
      <td>B42</td>
      <td>S</td>
    </tr>
    <tr>
      <th>889</th>
      <td>0</td>
      <td>3</td>
      <td>Johnston, Miss. Catherine Helen "Carrie"</td>
      <td>female</td>
      <td>NaN</td>
      <td>1</td>
      <td>2</td>
      <td>W./C. 6607</td>
      <td>23.4500</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>890</th>
      <td>1</td>
      <td>1</td>
      <td>Behr, Mr. Karl Howell</td>
      <td>male</td>
      <td>26.0</td>
      <td>0</td>
      <td>0</td>
      <td>111369</td>
      <td>30.0000</td>
      <td>C148</td>
      <td>C</td>
    </tr>
    <tr>
      <th>891</th>
      <td>0</td>
      <td>3</td>
      <td>Dooley, Mr. Patrick</td>
      <td>male</td>
      <td>32.0</td>
      <td>0</td>
      <td>0</td>
      <td>370376</td>
      <td>7.7500</td>
      <td>NaN</td>
      <td>Q</td>
    </tr>
  </tbody>
</table>
<p>891 rows × 11 columns</p>
</div></div></div>
</div>
<p>The dataset shows different observations related to the passengers of the Titanic. We can see each row of this matrix as a multi-dimensional variable (a vector) summarizing the main properties of the observations. Indeed, in the example above, each passenger is a different observation, while the different column are the different <strong>features</strong>.</p>
</section>
<section id="the-data-analysis-workflow">
<h3><span class="section-number">3.6. </span>The Data Analysis Workflow<a class="headerlink" href="#the-data-analysis-workflow" title="Permalink to this heading">#</a></h3>
<p>Data Analysis can be defined following this definition adapted from wikipedia (<a class="reference external" href="https://en.wikipedia.org/wiki/Data_analysis">https://en.wikipedia.org/wiki/Data_analysis</a>):</p>
<blockquote>
<div><p>Data analysis is the <strong>process</strong> of inspecting, cleaning, transforming, and modeling data with the goal of <strong>understanding</strong> something about a given phenomenon, supporting <strong>decision-making</strong>, and <strong>making predictions on unseen data</strong>.</p>
</div></blockquote>
<p>While this definition is not very formal, it is a good starting point to get an understanding of what data analysis is. Let’s dive into the main aspects of this definition in the following sections.</p>
<section id="data-analysis-as-a-process">
<h4><span class="section-number">3.6.1. </span>Data Analysis as a Process<a class="headerlink" href="#data-analysis-as-a-process" title="Permalink to this heading">#</a></h4>
<p>In the definition above, data analysis is regarded to as the process of inspecting, cleaning, transforming and modeling data. Indeed, it is very important to understand that <strong>data analysis is a process</strong>. In this sense, data analysis is not just a single algoritm or a single technique you can apply to the data. It is instead a collection of techniques, statistical and machine learning tools can be applied to achieve a given goal. Four main set of techniques that we can usually apply when processing data are:</p>
<ul class="simple">
<li><p><strong>Inspecting</strong>: the process of looking at the data to assess some of its main properties, such as the number of observations (rows), variables (columns), what are the typical values of variables (e.g., in the previous examples of students and courses we should expects marks out of 10), etc.</p></li>
<li><p><strong>Cleaning</strong>: is the process of “fixing” some aspects of the data which are likely to be incorrect. For instance we could remove rows with missing or out of range values (students with marks over 10 or with negative marks).</p></li>
<li><p><strong>Transforming</strong>: transforming the data from a format to another one. For instance, we may add a new “mean” column to each student in the example above, or, after realizing that English marks are out of 30 while the others are out of 10, transforming that column by dividing all numbers by 3 (so that they are in the same range as other variables).</p></li>
<li><p><strong>Modeling</strong>: choosing and tuning a statistical model which can be used to summarize, explain or make predictions about the data. We will discuss more models later, but for the moment it is important to understand that a model tries to abstract away and represent such aspects of the data in a way that, in some sense, the model becomes a good explanation of the data itself. For instance, if we could create a model which can allow us to reconstruct the correct value of English from the values of the other courses, we have found some kind of mathematical explanation of how marks in other course affect marks in English and we have shown that marks in English are not independent from the other marks.</p></li>
</ul>
</section>
<section id="goals-of-data-analysis">
<h4><span class="section-number">3.6.2. </span>Goals of Data Analysis<a class="headerlink" href="#goals-of-data-analysis" title="Permalink to this heading">#</a></h4>
<p>We can simplify (as in the spirit of this introductory material) by saying that data analysis processes can aim to address three main types of goals:</p>
<ul class="simple">
<li><p>Understanding something about a given phenomenon;</p></li>
<li><p>Supporting decision-making;</p></li>
<li><p>Making predictions on unseen data.</p></li>
</ul>
<p>We’ll see some examples of each of these goals in the following sections.</p>
</section>
<section id="main-types-of-data-analysis">
<h4><span class="section-number">3.6.3. </span>Main Types of Data Analysis<a class="headerlink" href="#main-types-of-data-analysis" title="Permalink to this heading">#</a></h4>
<p>While we have discussed of broad goals of data analysis above, we can divide data analysis processes into five main types (different categorization may be possible, but we will stick to this one in this course). Each category describes a <em>mindset</em> and a <em>set of tools</em> that can be used to perform data analysis processes towards the accomplishment of one or more of the goals above. It should be clear that, during a data analysis process, one may mix the different kinds of data analysis or perform them in a sequential fashion. As we will see, the different approaches also rely on similar statistical techniques and one approach does not exclude the others.</p>
<p>Popular types of data analysis are:</p>
<ul class="simple">
<li><p>Descriptive and analysis;</p></li>
<li><p>Exploratory analysis;</p></li>
<li><p>Inferential analysis;</p></li>
<li><p>Predictive analysis.</p></li>
</ul>
<p>We will analyze each of these approaches during the course.</p>
</section>
<section id="data-analysis-workflow">
<h4><span class="section-number">3.6.4. </span>Data Analysis Workflow<a class="headerlink" href="#data-analysis-workflow" title="Permalink to this heading">#</a></h4>
<p>The typical workflow of data analysis is composed of the following stages:</p>
<ol class="arabic simple">
<li><p>Define your data analysis question</p></li>
<li><p>Collect the data needed to answer the data analysis question</p></li>
<li><p>Clean and format the data</p></li>
<li><p>Explore and describe the data</p></li>
<li><p>Choose suitable models for the analysis</p></li>
<li><p>Fit, fine-tune, evaluate, and compare the models for the considered data analysis</p></li>
<li><p>Review the data analysis when new data is available</p></li>
</ol>
<section id="non-linear-workflow">
<h5><span class="section-number">3.6.4.1. </span>Non-Linear Workflow<a class="headerlink" href="#non-linear-workflow" title="Permalink to this heading">#</a></h5>
<p>It should be noted that the process is not exactly linear. A good data analysis will iterate over the different steps and possibly jump back to any of those steps to revise it. For instance, after fitting the models on the data in step 5, one may note that some other models could give better results, and jump back to step 4 to refine the choice of the models, to then return to step 5.</p>
<p>The figure below shows the described workflow. Solid arrows illustrate the main flow, while dashed arrows show possible alternative paths after performing data exploration (step 4). Similar dashed arrows pointing to any past node may apply to the other nodes as well. In the example below, after exploratory data analysis (step 4), we may note that the data is not clean (maybe we find some outliers) or not adequately formatted, so we jump back to step 3. Similarly, we may find that we need more data, and jump back to step 2, or we may want to revisit and refine our data analysis question (step 1).</p>
<pre  class="mermaid">
        flowchart TD
    A(1. Define your data analysis question)
    B(2. Collect the data needed to answer the data analysis question)
    C(3. Clean and format the data)
    D(4. Explore and describe the data)
    E(5. Choose suitable models for the analysis)
    F(6. Fit, fine-tune, evaluate, and compare the models for the considered data analysis)
    G(7. Review the data analysis when new data is available)

    A --&gt; B --&gt; C --&gt; D --&gt; E --&gt; F --&gt; G

    D-.-&gt; A
    D -.-&gt; B
    D -.-&gt; C
    </pre></section>
<section id="id2">
<h5><span class="section-number">3.6.4.2. </span>Example<a class="headerlink" href="#id2" title="Permalink to this heading">#</a></h5>
<p>A data analyst working for an e-commerce company is tasked with analyzing customer reviews to improve product quality and customer satisfaction. The analyst starts by defining the question that the data analysis needs to answer (<strong>step 1 - define your data analysis question</strong>): “What are the common themes and issues in customer reviews, and how can we address them to improve product quality and satisfaction?” To answer this question, the analyst collects a diverse dataset of customer reviews from various sources (<strong>step 2 - collect the data needed</strong>), including the company’s website, social media, and third-party review platforms. This dataset includes text reviews, ratings, and timestamps.</p>
<p>Once the data is collected, the analyst proceeds with data cleaning and formatting (<strong>step 3 - clean and format the data</strong>) since the initial dataset is messy with spelling errors, duplicate reviews, and inconsistent formatting. This involves data preprocessing, such as removing punctuation and converting text to lowercase. After cleaning the data, the analyst explores and describes it (<strong>step 4 - explore and describe the data</strong>) using techniques like word clouds, frequency distributions, and sentiment analysis to uncover common words, sentiments, and trends within the reviews.</p>
<p>To extract more meaningful insights from the text data, the analyst decides to apply natural language processing (NLP) techniques (<strong>step 5 - choose suitable models for analysis</strong>). Specifically, Latent Dirichlet Allocation (LDA) for topic modeling is chosen to identify recurring themes within the reviews. However, upon implementing LDA and reviewing the results, the analyst realizes that some topics are unclear and overlapping (<strong>step 6 - fit, fine-tune, evaluate, and compare the models</strong>).</p>
<p>Acknowledging the need to revisit the analysis, the analyst decides to backtrack to the data exploration step (<strong>step 4 - explore and describe the data</strong>) to gain a deeper understanding of the customer feedback. During this reassessment, it becomes evident that customers frequently mention product quality issues when discussing customer service experiences, leading to topic overlap. Armed with this insight, the analyst decides to categorize reviews into “product-related” and “service-related” (<strong>step 5 - choose suitable models for analysis</strong>) before applying topic modeling.</p>
<p>With the revised approach, the analyst proceeds to categorize reviews and then applies LDA separately to the two categories (<strong>step 6 - Fit, fine-tune, evaluate, and compare the models for the considered data analysis</strong>). This results in more interpretable topics, such as “defective products,” “timely shipping,” and “responsive customer support.” The analyst then analyzes these topics to generate actionable insights for product improvement and customer service enhancements.</p>
<p>To ensure continuous improvement, the analyst commits to ongoing review and monitoring (<strong>step 7 - Review the data analysis when new data is available</strong>) of customer reviews, periodically updating the analysis to identify new emerging issues or trends. This iterative approach to data analysis allows for refining strategies and addressing evolving customer concerns over time.</p>
</section>
</section>
</section>
<section id="references">
<h3><span class="section-number">3.7. </span>References<a class="headerlink" href="#references" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Chapter 1 of <em>Heumann, Christian, and Michael Schomaker Shalabh. Introduction to statistics and data analysis. Springer International Publishing Switzerland, 2016.</em></p></li>
</ul>
</section>
</section>
<span id="document-lectures/07_probability"></span><section class="tex2jax_ignore mathjax_ignore" id="probability-for-data-manipulation">
<h2><span class="section-number">4. </span>Probability for Data Manipulation<a class="headerlink" href="#probability-for-data-manipulation" title="Permalink to this heading">#</a></h2>
<p>In this lecture, we will look at some basic elements of probability theory which will help us manipulate data in a more accurate and principled way.</p>
<section id="uncertainty-importance-of-probability-theory">
<h3><span class="section-number">4.1. </span>Uncertainty &amp; Importance of Probability Theory<a class="headerlink" href="#uncertainty-importance-of-probability-theory" title="Permalink to this heading">#</a></h3>
<p>We have seen that dealing with data means dealing with “some variables
assuming some values”.</p>
<p>However, <strong>what can we say about what values such variables will assume</strong>?</p>
<p>In some cases, it is possible to predict the values of these variables
with perfect accuracy, given a set of initial conditions. For instance,
think about a system of equations describing the <em>speed of objects
according to Newtonian laws</em>.</p>
<p>In other cases, modeling the relationship between variables in a
deterministic way is not possible. We often say that this is due to <strong>uncertainty</strong>.</p>
<p>As reported <a class="reference external" href="https://www.deeplearningbook.org/contents/prob.html">here</a>, <strong>uncertainty in a system can be due to different factors</strong>:</p>
<ul class="simple">
<li><p><strong>Inherent stochasticity in the system being modeled.</strong> Some events such as <em>drawing a card from a deck of cards</em>, <em>rolling a die</em>, or the movements of subatomic particles can be seen as truly random events. The outcomes of such events cannot be predicted with perfect accuracy, so they are stochastic (random).</p></li>
<li><p><strong>Incomplete observability.</strong> Sometimes, even in a deterministic system, we cannot observe anything. For instance, <em>in the Monty Hall problem, the participant to the game is asked to choose between three doors</em>. One of the doors contains a prize, while the others lead to a goat. Even if the event is deterministic, the game contestant cannot observe everything, so from their point of view, the outcome is uncertain.</p></li>
<li><p><strong>Incomplete modeling.</strong> Sometimes a system has to discard some of the information needed to make a decision. For instance, imagine a robotic system aiming to pick objects from a table with a single RGB camera. <em>The system cannot reconstruct the 3D position of the objects, but the RGB camera an allow to obtain an estimate of the 2D coordinates of each objects with respect to the robot’s point of view</em>. All the information which cannot be observed is uncertain, despite the problem is a deterministic one.</p></li>
</ul>
<section id="examples">
<h4><span class="section-number">4.1.1. </span>Examples<a class="headerlink" href="#examples" title="Permalink to this heading">#</a></h4>
<ul class="simple">
<li><p><strong>Tossing a coin or rolling a die</strong>: these kinds of experiments are
generally impossible to model in a deterministic way. This can be
due to our limited ability to model the event (i.e., rolling a die
might be deterministic, but deriving a set of equations to determine
the outcome given the initial motion of the hand is intractable).</p></li>
<li><p><strong>Determining if a patient has a given pathology</strong>: different
pathologies might have similar symptoms. Hence, observing some of
them does not allow to determine with perfect accuracy if the
patient has that pathology. In this case, uncertainty might arise
from incomplete observability.</p></li>
</ul>
</section>
<section id="importance-of-probability-theory">
<h4><span class="section-number">4.1.2. </span>Importance of Probability Theory<a class="headerlink" href="#importance-of-probability-theory" title="Permalink to this heading">#</a></h4>
<p>Probability theory provides a consistent framework to work with
uncertain events.</p>
<p>It allows to quantify and manipulate uncertainty with a set of axioms,
as well as to derive new uncertain statements.</p>
<p>Probability theory is hence <strong>an important tool to work with data</strong>. We
will start to revise the main concepts behind probability theory by
talking about random variables.</p>
</section>
<section id="random-experiments">
<h4><span class="section-number">4.1.3. </span>Random Experiments<a class="headerlink" href="#random-experiments" title="Permalink to this heading">#</a></h4>
<p>In practice, when the acquisition of data is affected by uncertainty, we will use the term <strong>random experiment</strong>. We will informally define a random experiment as:</p>
<blockquote>
<div><p>An experiment which can be repeated any number of times, leading to different outcomes.</p>
</div></blockquote>
<p>We will use the following terminology:</p>
<ul class="simple">
<li><p><strong>sample space</strong> <span class="math notranslate nohighlight">\(\Omega = \{\omega_1,\ldots,\omega_k\}\)</span>: the set of all possible outcomes of the experiment;</p></li>
<li><p><strong>simple event</strong> <span class="math notranslate nohighlight">\(\omega_i\)</span>: a possible outcome of a random experiment;</p></li>
<li><p><strong>event</strong> <span class="math notranslate nohighlight">\(A \subseteq \Omega\)</span>: a subset of the sample space including certain events. We usually denote <span class="math notranslate nohighlight">\(\overline A = \Omega \setminus A\)</span> as the complementary event to <span class="math notranslate nohighlight">\(A\)</span>, i.e., the event that <span class="math notranslate nohighlight">\(A\)</span> does not happen.</p></li>
</ul>
<p>Given the definitions above, <span class="math notranslate nohighlight">\(\Omega\)</span> is often called the <strong>sure event</strong> or <strong>certain event</strong>, because it contains all possible outcomes. The null set <span class="math notranslate nohighlight">\(\emptyset\)</span> is called the <strong>impossible event</strong>.</p>
<section id="example">
<h5><span class="section-number">4.1.3.1. </span>Example<a class="headerlink" href="#example" title="Permalink to this heading">#</a></h5>
<p>Let us consider the random experiment of rolling a die. Our outcomes will be numbers which we read on the top face of the die when it lands. We will have:</p>
<ul class="simple">
<li><p>Sample space: <span class="math notranslate nohighlight">\(\Omega=\{1,2,3,4,5,6\}\)</span>;</p></li>
<li><p>Simple event: an example of a simple event would be <span class="math notranslate nohighlight">\(\omega_1=1\)</span>;</p></li>
<li><p>Event: the event “we obtain 1” could be denoted by <span class="math notranslate nohighlight">\(A=\{1\}\)</span>. The event “we obtain an even number” can be denoted by <span class="math notranslate nohighlight">\(A=\{2,4,6\}\)</span>. We would have <span class="math notranslate nohighlight">\(\overline A = \{1,3,5\}\)</span>, the event that “we obtain an odd number”.</p></li>
</ul>
</section>
</section>
</section>
<section id="random-variables">
<h3><span class="section-number">4.2. </span>Random Variables<a class="headerlink" href="#random-variables" title="Permalink to this heading">#</a></h3>
<p>We have so far talked about “statistical variables”. When
dealing with uncertain events, we need to use the concept of ‘random
variables’. Informally (from wikipedia):</p>
<blockquote>
<div><p>A random variable is a variable whose values depend on outcomes of a random phenomenon.</p>
</div></blockquote>
<p>A random variable is characterized by a set of possible values often
called <em>sample space</em>, <em>probability space</em>, or <em>alphabet</em> (this last term comes from
information theory, where we often deal with sources emitting symbols
from an alphabet, in which case the values of <span class="math notranslate nohighlight">\(X\)</span> will be the symbols).</p>
<p>The definition of a random variable is very similar to that of a statistical variable. Formally, if <span class="math notranslate nohighlight">\(\Omega\)</span> is the <em>sample space</em>, we will define a random variable as a function:</p>
<div class="math notranslate nohighlight">
\[ X : \Omega \to E \]</div>
<p>Where <strong>E is a measurable space</strong> and often <span class="math notranslate nohighlight">\(E=\mathbb{R}\)</span>. This definition is similar to the one of statistical variable we have given before.</p>
<p>A random variable is generally denoted by a <em>capital letter</em>, such as
<span class="math notranslate nohighlight">\(X\)</span>.</p>
<p>Similar to statistical variables, random variables can be <em>discrete</em> or <em>continuous</em>, <em>scalar</em> or <em>multi-dimensional</em>.</p>
<p>The following table lists some examples.</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p><strong>Discrete</strong></p></th>
<th class="head"><p><strong>Continuous</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Scalar</strong></p></td>
<td><p>Tossing a coin</p></td>
<td><p>Height of a person</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Multidimensional</strong></p></td>
<td><p>Pair of dice</p></td>
<td><p>Coordinates of a car</p></td>
</tr>
</tbody>
</table>
<section id="urns-and-marble-example">
<h4><span class="section-number">4.2.1. </span>Urns and Marble Example<a class="headerlink" href="#urns-and-marble-example" title="Permalink to this heading">#</a></h4>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/0348ffb762dec1fe5d265de10b007bc1983957a2fe06ce3ace85176d34fee5f9.png" src="../_images/0348ffb762dec1fe5d265de10b007bc1983957a2fe06ce3ace85176d34fee5f9.png" />
</div>
</div>
<p>We will now introduce an example that we will use in the rest of this lecture to reason on some basic properties of probabilities. Let’s assume we have two urns urns: one green and one blue.</p>
<p>Each box contains marbles of two colors: black and white.</p>
<p>We consider the experiment of randomly drawing a marble from one of
the two urns. This happens in two stages:</p>
<ul class="simple">
<li><p>We first randomly pick one of the two urns;</p></li>
<li><p>Then we randomly pick one of the marbles in the urn;</p></li>
<li><p>After observing the type of the marble, we replace it in the same
urn.</p></li>
</ul>
<p>The outcome of the experiment can be characterized by <em>two random
variables</em>:</p>
<ul class="simple">
<li><p>U represents the color of the urn and can take values g (green) and b
(blue).</p></li>
<li><p>M represents the color of the marble and can take values b (black) and w
(white).</p></li>
<li><p>If we pick a white marble from the blue urn, then the outcome of the
experiment can be characterized by the values <span class="math notranslate nohighlight">\(M = w\)</span>, <span class="math notranslate nohighlight">\(U = b\)</span>;</p></li>
</ul>
</section>
</section>
<section id="working-definition-of-data">
<h3><span class="section-number">4.3. </span>Working Definition of Data<a class="headerlink" href="#working-definition-of-data" title="Permalink to this heading">#</a></h3>
<p>We will define “data” as follows:</p>
<blockquote>
<div><p>The values assumed by a random variable</p>
</div></blockquote>
<section id="id1">
<h4><span class="section-number">4.3.1. </span>Example<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h4>
<ul class="simple">
<li><p>For instance, if the outcome of tossing a coing is <span class="math notranslate nohighlight">\(head\)</span>, then
<span class="math notranslate nohighlight">\(X = head\)</span> <em>is data</em>;</p></li>
<li><p>It should be clear that the ‘data’ is <em>the pair</em> &lt;random variable,
value&gt; and not just the value. Indeed <span class="math notranslate nohighlight">\(head\)</span> alone would not be
very useful (we don’t know which phenomenon it is related to),
whereas <span class="math notranslate nohighlight">\(X = head\)</span> can be useful, as we know that <span class="math notranslate nohighlight">\(X\)</span> is the random
variable describing the outcome of tossing a coin;</p></li>
<li><p>In this example, the data <span class="math notranslate nohighlight">\(X = head\)</span> is representing a fact: ‘I
tossed a coin and the outcome was <span class="math notranslate nohighlight">\(head\)</span>’. This is also called ‘an
event’;</p></li>
</ul>
</section>
</section>
<section id="probability">
<h3><span class="section-number">4.4. </span>Probability<a class="headerlink" href="#probability" title="Permalink to this heading">#</a></h3>
<p>Since random variables are related to stochastic phenomena, we cannot
say much about the outcome of a single phenomenon.</p>
<p>However, we expect to be able to characterize the class of experiments
related to a random variable, to infer rules on what values the random
variable is likely to take.</p>
<p>For instance, in the case of coin tossing, we can observe that, if I
toss a coin for a large number of times, the number of heads will be
roughly similar to the number of tails.</p>
<p>This kind of observations is useful, as it can give us a prior on what
values we are likely to encounter and what are not.</p>
<p>To formally express such rules, we can define the concept of probability
on a random variable.</p>
<p>Specifically, it is possible to assign a probability value to a given
outcome. This is generally represented with a capital P:</p>
<ul class="simple">
<li><p>For instance, <span class="math notranslate nohighlight">\(P(U = b)\)</span> represents the probability of picking a
blue urn in the previous example;</p></li>
<li><p>A probability <span class="math notranslate nohighlight">\(P(U = b)\)</span> is a number comprised between 0 and 1 which
quantifies how likely we believe the event to be;</p>
<ul>
<li><p>0 means impossible;</p></li>
<li><p>1 means certain;</p></li>
</ul>
</li>
</ul>
<p>When it is clear from the context which variable we are referring to,
the probability can also be expressed simply as:</p>
<div class="math notranslate nohighlight">
\[P(b) = P(U = b)\]</div>
<section id="laplace-probability">
<h4><span class="section-number">4.4.1. </span>Laplace Probability<a class="headerlink" href="#laplace-probability" title="Permalink to this heading">#</a></h4>
<p><strong>When all outcomes in a random experiment are considered equally probable</strong>, this is called a <strong>Laplace experiment</strong>. In this case, we can calculate the probability of a given event <span class="math notranslate nohighlight">\(A\)</span> as the ratio between the favorable outcomes and the possible outcomes:</p>
<div class="math notranslate nohighlight">
\[P(A) = \frac{|A|}{|\Omega|} = \frac{\text{number of favorable outcomes}}{\text{number of possible outcomes}}\]</div>
<p>For instance, if we are tossing a die:</p>
<ul class="simple">
<li><p>The probability of obtaining any of the faces will be: <span class="math notranslate nohighlight">\(\frac{1}{6}\)</span>;</p></li>
<li><p>The probability of obtaining an even number will be: <span class="math notranslate nohighlight">\(\frac{|\{2,4,6\}|}{|\{1,2,3,4,5,6\}|} = \frac{3}{6} = \frac{1}{2}\)</span>.</p></li>
</ul>
</section>
<section id="estimating-probabilities-from-observations">
<h4><span class="section-number">4.4.2. </span>Estimating probabilities from observations<a class="headerlink" href="#estimating-probabilities-from-observations" title="Permalink to this heading">#</a></h4>
<p>What about the cases in which we cannot make any assumption on the equal probability of events? In those cases we would like to estimate probabilities from observations. There are two main approaches to do so: frequentist and Bayesian.</p>
<section id="frequentist-approach">
<h5><span class="section-number">4.4.2.1. </span>Frequentist approach<a class="headerlink" href="#frequentist-approach" title="Permalink to this heading">#</a></h5>
<p>Probability theory was initially developed to analyze the frequency of
events. For instance, it can be used to study events like drawing a
certain hand of cards in a poker game. These events are repeatable and
can be dealt with using frequencies. In this sense, when we say that an
event has probability <span class="math notranslate nohighlight">\(p\)</span> of occurring, it means that if we repeat the
experiment infinitely many times, then a proportion <span class="math notranslate nohighlight">\(p\)</span> of the
repetitions would result in that outcome.</p>
<p>According to the frequentist approach, we can estimate probabilities by
repeating an experiment for a large number of times and then computing:</p>
<ul class="simple">
<li><p>The number of trials: how many times we performed the experiment;</p></li>
<li><p>The number of favorable outcomes: how many times the outcome of the
experiment was favorable.</p></li>
</ul>
<p>The probability is hence obtained by dividing the number of favorable
outcomes by the number of trials.</p>
<p>For instance, let’s suppose we want to estimate the probability of
obtaining a ‘head’ by tossing a coin. Let’s suppose we toss the coin
1000 times and obtain 499 heads and 501 tails. We can compute the
probability of obtaining head as follows:</p>
<ul class="simple">
<li><p>Number of trials: 1000;</p></li>
<li><p>Number of favorable outcomes: 499.</p></li>
</ul>
<p>The probability of obtaining head will be 499/1000=0.49</p>
<p>This is the approach we have seen so far in the course when dealing with relative frequencies.</p>
<section id="id2">
<h6><span class="section-number">4.4.2.1.1. </span>Examples<a class="headerlink" href="#id2" title="Permalink to this heading">#</a></h6>
<ul class="simple">
<li><p>The probability of obtaining ‘head’ when tossing a coin is 0.5. We
know that because, if we toss a coin for a large number of times,
about half of the times, we will obtain ‘head’;</p></li>
<li><p>The probability of picking a red ball from a box with 40 red balls
and 60 blue balls is 0.4. We know this because, if we repeat the
experiment for a large number of times, we will observe that
proportion.</p></li>
</ul>
</section>
</section>
<section id="bayesian-approach">
<h5><span class="section-number">4.4.2.2. </span>Bayesian Approach<a class="headerlink" href="#bayesian-approach" title="Permalink to this heading">#</a></h5>
<p>The Bayesian approach to probability offers a different perspective on probability theory. Unlike the frequentist approach, which focuses on analyzing the frequency of events based on observations, the <strong>Bayesian approach allows us to incorporate prior knowledge and update our beliefs as new information becomes available</strong>.</p>
<p>In Bayesian probability, we view <strong>probability as a measure of uncertainty or belief</strong>. When we assign a probability to an event, it reflects our <strong>subjective degree of belief in the event’s likelihood</strong>. This approach is particularly useful when dealing with unique or one-time events where frequency-based analysis may not be applicable (e.g., “<strong>what is the probability that the sun will extinguish in 5 billion years?</strong>”).</p>
<p>We will discuss better the Bayesian approach when we’ll discuss Bayes theorem.</p>
</section>
</section>
<section id="example-of-probability">
<h4><span class="section-number">4.4.3. </span>Example of Probability<a class="headerlink" href="#example-of-probability" title="Permalink to this heading">#</a></h4>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/0348ffb762dec1fe5d265de10b007bc1983957a2fe06ce3ace85176d34fee5f9.png" src="../_images/0348ffb762dec1fe5d265de10b007bc1983957a2fe06ce3ace85176d34fee5f9.png" />
</div>
</div>
<p>Let’s consider the previous example of drawing marbles from the two urns.</p>
<p>Suppose we repeat this experiment for many times and observe that:</p>
<ul class="simple">
<li><p>We pick the green urn 40% of the times;</p></li>
<li><p>We pick the blue urn 60% of the times;</p></li>
<li><p>Once we selected a urn, we are equally likely to select any of the
marble contained in it, but we know that colors are not distributed evenly in the urns (see figure).</p></li>
</ul>
<p>Using a frequentist approach, we can define the probabilities:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(P(U = b) = \frac{6}{10}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(P(U = r) = \frac{4}{10}\)</span></p></li>
</ul>
<p>This is done by using the formula:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(P(X = x) = \frac{\#\ of\ times\ X = x}{\#\ trials}\)</span></p></li>
</ul>
</section>
</section>
<section id="joint-probability">
<h3><span class="section-number">4.5. </span>Joint probability<a class="headerlink" href="#joint-probability" title="Permalink to this heading">#</a></h3>
<p>We can define <strong>univariate</strong> (= with respect to only one variable)
probabilities <span class="math notranslate nohighlight">\(P(U)\)</span> and <span class="math notranslate nohighlight">\(P(M)\)</span> as we have seen in the previous
examples.</p>
<p>However, in some cases, it is useful to define probabilities on more
than one variable at the time. For instance, we could be interested in
studying the probability of picking a given fruit from a given box. In
this case, we would be interested in the <strong>joint probability</strong> <span class="math notranslate nohighlight">\(P(B,F)\)</span>.</p>
<p>In general, we can have joint probabilities with arbitrary numbers of
variable. For instance,
<span class="math notranslate nohighlight">\(P\left( X_{1},X_{2},X_{3},\ldots,X_{n} \right)\)</span>.</p>
<p>Joint probabilities are symmetric, i.e., <span class="math notranslate nohighlight">\(P(X,Y) = P(Y,X)\)</span>.</p>
<p>We should note that, when dealing with multiple unidimensional
variables, we can always define a new multi-variate variable comprising
all of them:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(X = \left\lbrack X_{1},X_{2} \right\rbrack;\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(P(X) = P\left( X_{1},X_{2} \right)\)</span>.</p></li>
</ul>
<section id="id3">
<h4><span class="section-number">4.5.1. </span>Example<a class="headerlink" href="#id3" title="Permalink to this heading">#</a></h4>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/0348ffb762dec1fe5d265de10b007bc1983957a2fe06ce3ace85176d34fee5f9.png" src="../_images/0348ffb762dec1fe5d265de10b007bc1983957a2fe06ce3ace85176d34fee5f9.png" />
</div>
</div>
<p>We can see the concept of joint probability in the context of the
examples of the two urns.</p>
<p>We have seen how to define the univariate probability <span class="math notranslate nohighlight">\(P(U)\)</span> over the
whole probability space of <span class="math notranslate nohighlight">\(U\)</span>.</p>
<p>However, we could be interested in the probability of both variables
jointly: <span class="math notranslate nohighlight">\(P(U,M)\)</span>, i.e., the joint probability of U and M.</p>
<p>To ‘measure’ the joint probability, we could repeat the experiment for
many times and observe the outcomes.</p>
<p>We can then build a table which keeps track of how many
times we observed a given combination:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p>Green Urn</p></th>
<th class="head"><p>Blue Urn</p></th>
<th class="head"><p>All</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>White</p></td>
<td><p>10</p></td>
<td><p>15</p></td>
<td><p>25</p></td>
</tr>
<tr class="row-odd"><td><p>Black</p></td>
<td><p>30</p></td>
<td><p>45</p></td>
<td><p>75</p></td>
</tr>
<tr class="row-even"><td><p>All</p></td>
<td><p>40</p></td>
<td><p>60</p></td>
<td><p>100</p></td>
</tr>
</tbody>
</table>
<p>A table like this is called a “<strong>contincency table</strong>”.</p>
<p>From the table above, we can easily derive the joint probability of a
given pair of values using the <strong>frequentist approach</strong>. For instance:</p>
<div class="math notranslate nohighlight">
\[P(U = b,M = b) = \frac{\#\ times\ (b,a)\ occurs}{\#\ trials} = \frac{15}{100}\]</div>
<p>Similarly, we can derive the other values:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(F(U = b,M = b) = \frac{45}{100}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(F(U = g,M = w) = \frac{10}{100}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(F(U = g,M = b) = \frac{30}{100}\)</span></p></li>
</ul>
<p>Note that we can also obtain the univariate probabilities by using the
values in the “sum” row and column. For instance:</p>
<div class="math notranslate nohighlight">
\[P(U = b) = \frac{\#\ times\ b\ occurred}{\#\ trials} = \frac{15 + 45}{100} = \frac{60}{100}\]</div>
<p>Similarly:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(P(U = g) = \frac{40}{100}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(P(M = w) = \frac{25}{100}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(P(M = b) = \frac{30}{100}\)</span></p></li>
</ul>
<p>These univariate probabilities computed starting from joint
probabilities are usually called “marginal probabilities” (we are using
the sums in the margin of the table).</p>
<p>We can obtain a joint probability table by dividing the table by the total number of trials (100):</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p><strong>Green Urn</strong></p></th>
<th class="head"><p><strong>Blue Urn</strong></p></th>
<th class="head"><p><strong>Sum</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>White</strong></p></td>
<td><p>10/100</p></td>
<td><p>15/100</p></td>
<td><p>25/100</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Black</strong></p></td>
<td><p>30/100</p></td>
<td><p>45/100</p></td>
<td><p>75/100</p></td>
</tr>
<tr class="row-even"><td><p><strong>Sum</strong></p></td>
<td><p>40/100</p></td>
<td><p>60/100</p></td>
<td><p>100/100</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="sum-rule-marginal-probability">
<h3><span class="section-number">4.6. </span>Sum Rule (Marginal Probability)<a class="headerlink" href="#sum-rule-marginal-probability" title="Permalink to this heading">#</a></h3>
<p>In the previous example, we have seen how we can compute <strong>marginal
(univariate) probabilities</strong> from the contingency table. This is
possible because the contingency table contains information on how the
different possible outcomes distribute over the sample space.</p>
<p>In general, we can compute marginal probabilities form joint
probabilities (i.e., we don’t need to have the non-normalized frequency
counts of the contingency table). Let us consider the general contingency table:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p>Y=<span class="math notranslate nohighlight">\(y_1\)</span></p></th>
<th class="head"><p>Y=<span class="math notranslate nohighlight">\(y_2\)</span></p></th>
<th class="head"><p>…</p></th>
<th class="head"><p>Y=<span class="math notranslate nohighlight">\(y_l\)</span></p></th>
<th class="head"><p>Total</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>X=<span class="math notranslate nohighlight">\(x_1\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(n_{11}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(n_{12}\)</span></p></td>
<td><p>…</p></td>
<td><p><span class="math notranslate nohighlight">\(n_{1l}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(n_{1+}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>X=<span class="math notranslate nohighlight">\(x_2\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(n_{21}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(n_{22}\)</span></p></td>
<td><p>…</p></td>
<td><p><span class="math notranslate nohighlight">\(n_{2l}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(n_{2+}\)</span></p></td>
</tr>
<tr class="row-even"><td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
</tr>
<tr class="row-odd"><td><p>X=<span class="math notranslate nohighlight">\(x_k\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(n_{k1}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(n_{k2}\)</span></p></td>
<td><p>…</p></td>
<td><p><span class="math notranslate nohighlight">\(n_{kl}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(n_{k+}\)</span></p></td>
</tr>
<tr class="row-even"><td><p>Total</p></td>
<td><p><span class="math notranslate nohighlight">\(n_{+1}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(n_{+2}\)</span></p></td>
<td><p>…</p></td>
<td><p><span class="math notranslate nohighlight">\(n_{+l}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(n\)</span></p></td>
</tr>
</tbody>
</table>
<p>We can compute the joint probability <span class="math notranslate nohighlight">\(P(X = x_{i},Y = y_{j})\)</span> with a
frequentist approach using the formula:</p>
<div class="math notranslate nohighlight">
\[P\left( X = x_{i},\ Y = y_{j} \right) = \frac{n_{ij}}{n}\]</div>
<p>Note that these are the joint frequencies <span class="math notranslate nohighlight">\(f_{ij}\)</span> we mentioned in the past.</p>
<p>Also, we note that we can define the marginal probabilities of X and Y
as follows:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(P\left( X = x_{i} \right) = \frac{n_{i+}}{n}\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(P\left( Y = y_{j} \right) = \frac{n_{+j}}{n}\)</span>.</p></li>
</ul>
<p>Note that <span class="math notranslate nohighlight">\(n_{i+}\)</span> can be seen as the sum of all occurrences in which
<span class="math notranslate nohighlight">\(X = x_{i}\)</span> (i.e., we are summing all values in row <span class="math notranslate nohighlight">\(i\)</span>):</p>
<div class="math notranslate nohighlight">
\[n_{i+} = \sum_{j} n_{ij}\]</div>
<p>We can write the marginal probability of <span class="math notranslate nohighlight">\(X\)</span> as follows:</p>
<div class="math notranslate nohighlight">
\[P\left( X = x_{i} \right) = \frac{n_{i+}}{n} = \frac{\sum_{j}n_{ij}}{n} = \sum_{j}\frac{n_{ij}}{n} = \sum_{j}^{}{P(X = x_{i},Y = y_{j})}\]</div>
<p>This result is known as the <strong>sum rule of probability</strong>, which allows to
estimate marginal probabilities from joint probabilities. This can be
seen in more general terms as:</p>
<div class="math notranslate nohighlight">
\[P(X = x) = \sum_{y}^{}{P(X = x,Y = y)}\]</div>
<p>The act of computing <span class="math notranslate nohighlight">\(P(X)\)</span> from <span class="math notranslate nohighlight">\(P(X,Y)\)</span> is also known as
marginalization.</p>
</section>
<section id="conditional-probability">
<h3><span class="section-number">4.7. </span>Conditional Probability<a class="headerlink" href="#conditional-probability" title="Permalink to this heading">#</a></h3>
<p><strong>In many cases, we are interested in the probability of some event,
given that some other event happened.</strong></p>
<p>This is called <strong>conditional</strong> <strong>probability</strong> and is denoted
as<span class="math notranslate nohighlight">\(\ P\left( X = x \middle| Y = y \right)\)</span> and read as “P of X=y given
that Y=y”. In this context, <span class="math notranslate nohighlight">\(Y = y\)</span> is the condition, and we are
interested in studying the probability of X only in the cases in which
the condition is verified.</p>
<p>For instance, in the case of the two urns, we could be interested in
<span class="math notranslate nohighlight">\(P(M = w|U = b)\)</span>, i.e., what is the probability of picking a white marble,
given that we know that we are drawing from the blue urn?</p>
<p>Let’s consider our example contingency table of two variables again:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p>Y=<span class="math notranslate nohighlight">\(y_1\)</span></p></th>
<th class="head"><p>Y=<span class="math notranslate nohighlight">\(y_2\)</span></p></th>
<th class="head"><p>…</p></th>
<th class="head"><p>Y=<span class="math notranslate nohighlight">\(y_l\)</span></p></th>
<th class="head"><p>Total</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>X=<span class="math notranslate nohighlight">\(x_1\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(n_{11}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(n_{12}\)</span></p></td>
<td><p>…</p></td>
<td><p><span class="math notranslate nohighlight">\(n_{1l}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(n_{1+}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>X=<span class="math notranslate nohighlight">\(x_2\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(n_{21}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(n_{22}\)</span></p></td>
<td><p>…</p></td>
<td><p><span class="math notranslate nohighlight">\(n_{2l}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(n_{2+}\)</span></p></td>
</tr>
<tr class="row-even"><td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
</tr>
<tr class="row-odd"><td><p>X=<span class="math notranslate nohighlight">\(x_k\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(n_{k1}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(n_{k2}\)</span></p></td>
<td><p>…</p></td>
<td><p><span class="math notranslate nohighlight">\(n_{kl}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(n_{k+}\)</span></p></td>
</tr>
<tr class="row-even"><td><p>Total</p></td>
<td><p><span class="math notranslate nohighlight">\(n_{+1}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(n_{+2}\)</span></p></td>
<td><p>…</p></td>
<td><p><span class="math notranslate nohighlight">\(n_{+l}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(n\)</span></p></td>
</tr>
</tbody>
</table>
<p>We can compute the conditional probability
<span class="math notranslate nohighlight">\(P(X = x_{i}|Y = y_{j})\)</span> using the frequentist approach:</p>
<div class="math notranslate nohighlight">
\[P\left( X = x_{i} \middle| Y = y_{j} \right) = \frac{\#\ cases\ in\ which\ X = x_{i}\ and\ Y = y_{i}}{\#\ cases\ in\ which\ Y = y_{j}} = \frac{n_{ij}}{n_{+j}}\]</div>
<p>If we multiply the expression above by <span class="math notranslate nohighlight">\(1 = \frac{n}{n}\)</span>, we obtain:</p>
<div class="math notranslate nohighlight">
\[P\left( X = x_{i} \middle| Y = y_{j} \right) = \frac{n_{ij}}{n}\frac{n}{n_{+j}} = \frac{\frac{n_{ij}}{n}}{\frac{n_{+j}}{n}} = \frac{P\left( X = x_{i},Y = y_{j} \right)}{P(Y = y_{j})}\]</div>
<p>This leads us to the general definition of conditional probability:</p>
<div class="math notranslate nohighlight">
\[P\left( X = x \middle| Y = y \right) = \frac{P(X = x,\ Y = y)}{P(Y = y)}\]</div>
<p>The conditional probability is defined only when <span class="math notranslate nohighlight">\(P(Y = y) &gt; 0\)</span>, that
is, we cannot define a probability conditioned on an event that never
happens. It should be noted that, in general
<span class="math notranslate nohighlight">\(P\left( X \middle| Y \right) \neq P(X)\)</span>.</p>
</section>
<section id="product-rule-factorization">
<h3><span class="section-number">4.8. </span>Product Rule (Factorization)<a class="headerlink" href="#product-rule-factorization" title="Permalink to this heading">#</a></h3>
<p>We can see the definition of conditional probability:</p>
<div class="math notranslate nohighlight">
\[P\left( X = x \middle| Y = y \right) = \frac{P(X = x,\ Y = y)}{P(Y = y)}\]</div>
<p>As follows:</p>
<div class="math notranslate nohighlight">
\[P(X = x,Y = y) = P\left( X = x \middle| Y = y \right)P(Y = y)\]</div>
<p>which is often referred to as <strong>the product rule</strong>.</p>
<p><em>The product rule allows to compute joint probabilities starting from
conditional probabilities and marginal probabilities.</em> This is useful
because measuring joint probabilities generally involves creating large
tables, whereas conditional and marginal probabilities might be easier
to derive.</p>
<p>This operation of expressing a joint probability in terms of two factors
is known as <em>factorization</em>.</p>
<section id="how-to-compute-a-conditional-probability">
<h4><span class="section-number">4.8.1. </span>How to compute a conditional probability?<a class="headerlink" href="#how-to-compute-a-conditional-probability" title="Permalink to this heading">#</a></h4>
<p>We just said that factorization can be useful for computing joint
probabilities starting from conditional probabilities. However, two
questions arise: “how can we compute a conditional probability?” and “Is
it easier than computing a joint probability?”.</p>
<p>Since conditional probabilities are obtained by <em>restricting</em> the
probability space to <em>a subset</em> of the events, we can compute
conditional probabilities by considering the observations which satisfy
the condition.</p>
<p>For example, let’s say we want to compute the conditional probability:</p>
<div class="math notranslate nohighlight">
\[P(M|U = b)\]</div>
<p>That is to say, the probability of taking a marble of a given color, given
that we know that we are considering the blue urn. Let’s consider again our contingency table:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p>Green Urn</p></th>
<th class="head"><p>Blue Urn</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>White</p></td>
<td><p>10</p></td>
<td><p>15</p></td>
</tr>
<tr class="row-odd"><td><p>Black</p></td>
<td><p>30</p></td>
<td><p>45</p></td>
</tr>
</tbody>
</table>
<p>To compute this probability, we can just <em>consider all the observations
that satisfy the condition</em> <span class="math notranslate nohighlight">\(U = b\)</span>, which is equivalent to taking the
second column of the full contingency table and compute the
probabilities in a frequentist way:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p>Blue Urn</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>White</p></td>
<td><p>15</p></td>
</tr>
<tr class="row-odd"><td><p>Black</p></td>
<td><p>45</p></td>
</tr>
</tbody>
</table>
<div class="math notranslate nohighlight">
\[ P(M=w|U=b) = \frac{15}{60} \]</div>
<div class="math notranslate nohighlight">
\[ P(M=b|U=b) = \frac{45}{60} \]</div>
<p>Note that, in general, when the number of variables is large, this
approach allows to save a lot of space and time as it is not necessary
to even build the first contingency table, but only the second,
restricted one is required (for instance, one may choose not to record
all observations in which the user has drawn from the red box).</p>
</section>
</section>
<section id="the-chain-rule-of-conditional-probabilities">
<h3><span class="section-number">4.9. </span>The Chain Rule of Conditional Probabilities<a class="headerlink" href="#the-chain-rule-of-conditional-probabilities" title="Permalink to this heading">#</a></h3>
<p>When dealing with multiple variables, the product rule can be applied in
an iterative fashion, thus obtaining the ‘chain rule’ of conditional
probabilities.</p>
<p>For instance:</p>
<div class="math notranslate nohighlight">
\[P(X,Y,Z) = P\left( X \middle| Y,Z \right)P(Y,Z)\]</div>
<p>Since:</p>
<div class="math notranslate nohighlight">
\[P(Y,Z) = P\left( Y \middle| Z \right)P(Z)\]</div>
<p>We obtain:</p>
<div class="math notranslate nohighlight">
\[P(X,Y,Z) = P\left( X \middle| Y,Z \right)P\left( Y \middle| Z \right)P(Z)\]</div>
<p>Since joint probabilities are symmetric, we could equally obtain:</p>
<div class="math notranslate nohighlight">
\[P(X,Y,Z) = P\left( Z \middle| Y,X \right)P\left( Y \middle| X \right)P(X)\]</div>
<p>This rule can be formalized as follows:</p>
<div class="math notranslate nohighlight">
\[P\left( X_{1},\ldots,\ X_{n} \right) = P\left( X_{1} \right)\prod_{i = 2}^{n}{P(X_{i}|X_{1},\ldots,\ X_{i - 1})}\]</div>
</section>
<section id="bayes-theorem">
<h3><span class="section-number">4.10. </span>Bayes’ Theorem<a class="headerlink" href="#bayes-theorem" title="Permalink to this heading">#</a></h3>
<p>Given two variables A and B, from the product rule, we obtain:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(P(A,B) = P\left( A \middle| B \right)P(B)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(P(B,A) = P\left( B \middle| A \right)P(A)\)</span></p></li>
</ul>
<p>Since joint probabilities are symmetric, we have:</p>
<div class="math notranslate nohighlight">
\[P(A,B) = P(B,A) \rightarrow P\left( A \middle| B \right)P(B) = P\left( B \middle| A \right)P(A)\]</div>
<p>Which implies:</p>
<div class="math notranslate nohighlight">
\[P\left( A \middle| B \right) = \frac{P\left( B \middle| A \right)P(A)}{P(B)}\]</div>
<p>This last expression is known as Bayes’ Theorem (or Bayes’ rule).</p>
<p>Technically speaking, the Bayes’ rule can be used to “turn”
probabilities of the kind <span class="math notranslate nohighlight">\(P(A|B)\)</span> into probabilities of the kind
<span class="math notranslate nohighlight">\(P(B|A)\)</span>.</p>
<p>More formally, the Bayes’ rule can be used to <strong>update
our expectation that some event will happen (event A) when we observe
some evidence (event B)</strong>. This links to the Bayesian interpretation of
probability, according to which probability can be seen as <strong>a
<em>reasonable expectation</em> representing <em>the quantification of a degree of
belief</em></strong> (i.e., how much we believe some event will happen).</p>
<p>The different terms in the Bayes’ rule have specific names:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(P(A)\)</span> is called ‘the prior’ – this is our expectation that A
happens when we do not have any other data to rely on</p></li>
<li><p><span class="math notranslate nohighlight">\(P(B|A)\)</span> is called ‘the likelihood’ – this quantifies how likely it
is to observe event B happening if we assume that event A has
happened</p></li>
<li><p><span class="math notranslate nohighlight">\(P(B)\)</span> is called ‘the evidence’ – this models the probability of
observing event B</p></li>
<li><p><span class="math notranslate nohighlight">\(P(A|B)\)</span> is called ‘the posterior’ – this is our updated
probability, i.e., how likely it is A to happen once we have
observed B happening</p></li>
</ul>
<p>We’ll see an example in the section below.</p>
<section id="bayesian-probability-example">
<h4><span class="section-number">4.10.1. </span>Bayesian Probability Example<a class="headerlink" href="#bayesian-probability-example" title="Permalink to this heading">#</a></h4>
<p>Let’s imagine we are trying to understand if a friend has COVID or not.
If we do not know anything about our friend’s symptoms (i.e., we don’t
know if they have any symptoms or not), then we would expect our friend
to have COVID with a “prior” probability <span class="math notranslate nohighlight">\(P(C)\)</span>. If we know that
currently one people over two has COVID, we expect:</p>
<div class="math notranslate nohighlight">
\[P(C) = \frac{1}{2}\]</div>
<p>Now, if our friend tells us he has fever, things change a bit. We are
now interested in modeling the probability:
<span class="math notranslate nohighlight">\(P\left( C \middle| F \right)\)</span>. We can try to model it using Bayes’
rule:</p>
<div class="math notranslate nohighlight">
\[P\left( C \middle| F \right) = \frac{P\left( F \middle| C \right)P(C)}{P(F)}\]</div>
<p>Note that it is not straightforward to estimate <span class="math notranslate nohighlight">\(P(C|F)\)</span> in a
frequentist way. Ideally, we should take all people with a fever on
earth and check how many of them has COVID. This is not feasible as
people with just fever may never do a COVID test. On the contrary,
measuring <span class="math notranslate nohighlight">\(P(F|C)\)</span> is easier: we take all people which we know have
COVID (these may not be all people with COVID, but probably a large
enough sample) and see how many of them have a fever. Let’s suppose that
one people with COVID out of three has a fever. Then we can expect:</p>
<div class="math notranslate nohighlight">
\[P\left( F \middle| C \right) = \frac{1}{3}\]</div>
<p>Now we need to estimate the evidence <span class="math notranslate nohighlight">\(P(F)\)</span>. This can be done by
considering how frequent it is for people to have a fever. Let’s say we
use historical data and find out that one person out of five has fever.
We finally have:</p>
<div class="math notranslate nohighlight">
\[P\left( C \middle| F \right) = \frac{\frac{1}{3}\frac{1}{2}}{\frac{1}{5}} = \frac{5}{6}\]</div>
<p>We can interpret this use of the Bayes’ theorem as follows:</p>
<ul class="simple">
<li><p>Before knowing anything about symptoms, we could only guess that our
friend had COVID with a prior probability of <span class="math notranslate nohighlight">\(P(C) = \frac{1}{2}\)</span></p></li>
<li><p>When we get to know that our friend has a fever, our expectation
changes. We know that people with COVID often get a fever, but we
also know that not all people with COVID get a fever, so we are not
going to say that we are 100% certain that our friend has fever.
Instead, we use Bayes’ rule to obtain an updated estimate
<span class="math notranslate nohighlight">\(P\left( C \middle| F \right) = \frac{5}{6}\)</span> based on our knowledge
of the likelihood <span class="math notranslate nohighlight">\(P(F|C)\)</span> (how likely it is for people with symptom
to have COVID) and the evidence <span class="math notranslate nohighlight">\(P(F)\)</span> (how common is this symptom
– if it is too common, then it is not so informative)</p></li>
</ul>
</section>
</section>
<section id="independence-and-conditional-independence">
<h3><span class="section-number">4.11. </span>Independence and Conditional Independence<a class="headerlink" href="#independence-and-conditional-independence" title="Permalink to this heading">#</a></h3>
<p>Two variables <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span> are independent if the outcome of one of the
two does not influence the outcome of the other. Formally speaking, two
variables are <strong>said to be independent</strong> if and only if:</p>
<div class="math notranslate nohighlight">
\[P(X,Y) = P(X)P(Y)\]</div>
<p>We have seen why definition this makes sense in the context of the Pearson’s <span class="math notranslate nohighlight">\(\chi^2\)</span> statistic. The same considerations apply here.</p>
<p>It should be noted that the expression above <strong>is generally not true</strong>
as we cannot always assume that two variables are independent.</p>
<p>Independence can be denoted as:</p>
<div class="math notranslate nohighlight">
\[X\bot Y\]</div>
<p>Moreover, if two variables <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span> are independent, then:</p>
<div class="math notranslate nohighlight">
\[P\left( X \middle| Y \right) = \frac{P(X,Y)}{P(Y)} = \frac{P(X)P(Y)}{P(Y)} = P(X)\]</div>
<p>This makes sense because it means that “the fact that <span class="math notranslate nohighlight">\(Y\)</span> happens does
not influence the fact that <span class="math notranslate nohighlight">\(X\)</span> happens”, which is what we would expect
of two independent variables <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span>.</p>
<section id="id4">
<h4><span class="section-number">4.11.1. </span>Examples<a class="headerlink" href="#id4" title="Permalink to this heading">#</a></h4>
<p>Intuitively, two variables are independent if the values of one of them
do not affect the values of the other one:</p>
<ul class="simple">
<li><p>Weight and height of a person are <strong>not independent</strong>. Indeed,
taller people are usually heavier.</p></li>
<li><p>Height and richness are <strong>independent</strong>, as the richness does not
depend on the height of a person.</p></li>
</ul>
</section>
<section id="conditional-independence">
<h4><span class="section-number">4.11.2. </span>Conditional independence<a class="headerlink" href="#conditional-independence" title="Permalink to this heading">#</a></h4>
<p>Two random variables <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span> are said to be <strong>conditionally
independent</strong> given a random variable <span class="math notranslate nohighlight">\(Z\)</span> if:</p>
<div class="math notranslate nohighlight">
\[P\left( X,Y \middle| Z \right) = P\left( X \middle| Z \right)P\left( Y \middle| Z \right)\]</div>
<p>Conditional independence can be denoted as:</p>
<div class="math notranslate nohighlight">
\[X\bot Y\ |\ Z\]</div>
<section id="id5">
<h5><span class="section-number">4.11.2.1. </span>Example<a class="headerlink" href="#id5" title="Permalink to this heading">#</a></h5>
<p>Height and vocabulary are not independent: taller people are usually
older, and hence they have a more sophisticated vocabulary (they know
more words). However, if we condition on age, they become independent.
Indeed, among people of the same age, height should not influence
vocabulary. Hence, height and vocabulary are <strong>conditionally
independent</strong> with respect to age.</p>
</section>
</section>
</section>
<section id="example-of-probability-manipulation">
<h3><span class="section-number">4.12. </span>Example of Probability Manipulation<a class="headerlink" href="#example-of-probability-manipulation" title="Permalink to this heading">#</a></h3>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/0348ffb762dec1fe5d265de10b007bc1983957a2fe06ce3ace85176d34fee5f9.png" src="../_images/0348ffb762dec1fe5d265de10b007bc1983957a2fe06ce3ace85176d34fee5f9.png" />
</div>
</div>
<p>Let’s get back to our example of the two boxes and let’s suppose that,
by repeating several trials, we discovered the following probabilities
(in a frequentist way):</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(P(U = g) = \frac{4}{10}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(P(U = b) = \frac{6}{10}\)</span></p></li>
</ul>
<p>We also focused on a given urn and performed different trials, observing
the following proportions:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(P\left( M = w \middle| U = g \right) = \frac{1}{4}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(P\left( M = b \middle| U = g \right) = \frac{3}{4}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(P\left( M = w \middle| U = b \right) = \frac{3}{4}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(P\left( M = b \middle| U = b \right) = \frac{1}{4}\)</span></p></li>
</ul>
<p>We shall note that these probabilities are normalized such that:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(P(U = g) + P(U = b) = 1\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(P\left( M = w \middle| U = g \right) + P\left( M = b \middle| U = g \right) = 1\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(P\left( M = w \middle| U = b \right) + P\left( M = b \middle| U = b \right) = 1\)</span></p></li>
</ul>
<p>We can now use the rules we have seen before to answer questions such
as:</p>
<ul class="simple">
<li><p>What is the overall probability of choosing a white marble?</p></li>
<li><p>What is the probability of picking a green urn, given that we have
drawn a black marble?</p></li>
</ul>
<p><strong>What is the overall probability of choosing an white marble?</strong></p>
<p>To answer this question, we need to find <span class="math notranslate nohighlight">\(P(M = w)\)</span>. We note that, by
the sum rule:</p>
<div class="math notranslate nohighlight">
\[P(M = w) = P(M = w,U = b) + P(M = w,B = g)\]</div>
<p>We also observe that the joint probabilities can be recovered using the
product rule:</p>
<div class="math notranslate nohighlight">
\[P(M = w,U = b) = P\left( M = w \middle| U = b \right)P(U = b)\]</div>
<div class="math notranslate nohighlight">
\[P(M = w,U = g) = P\left( M = w \middle| U = g \right)P(U = g)\]</div>
<p>Hence, our probability can be found using the formula:</p>
<div class="math notranslate nohighlight">
\[P(M = w) = P\left( M = w \middle| U = b \right)P(U = b) + P\left( M = w \middle| U = g \right)P(U = g) =\]</div>
<div class="math notranslate nohighlight">
\[= \frac{3}{4} \cdot \frac{6}{10} + \frac{1}{4} \cdot \frac{4}{10} = \frac{18 + 4}{40} = \frac{22}{40} = \frac{11}{20}\]</div>
<p>From the definition of probability, we have:</p>
<div class="math notranslate nohighlight">
\[P(M = w) + P(M = b) = 1\]</div>
<p>Hence:</p>
<div class="math notranslate nohighlight">
\[P(M = b) = 1 - P(M = w) = 1 - \frac{11}{20} = \frac{9}{20}\]</div>
<p><strong>What is the probability of picking a green urn, given that we have drawn
an black marble?</strong></p>
<p>To answer this question, we need to find the conditional probability
<span class="math notranslate nohighlight">\(P(U = g|M = b)\)</span>. To find this probability, we need to ‘invert’ our
conditional probabilities using the Bayes’ rule:</p>
<div class="math notranslate nohighlight">
\[P\left( U = g \middle| M = b \right) = \frac{P\left( M = b \middle| U = g \right)P(U = g)}{P(M = b)} = \frac{\frac{3}{4} \cdot \frac{4}{10}}{\frac{9}{20}} = \frac{12}{40} \cdot \frac{20}{9} = \frac{6}{9} = \frac{2}{3}\]</div>
<section id="excercise">
<h4><span class="section-number">4.12.1. </span>Excercise<a class="headerlink" href="#excercise" title="Permalink to this heading">#</a></h4>
<p>Suppose that we have three colored boxes r (red), b (blue), and g
(green). Box r contains 3 apples, 4 oranges, and 3 limes, box b contains
1 apple, 1 orange, and 0 limes, and box g contains 3 apples, 3 oranges,
and 4 limes. If a box is chosen at random with probabilities P(r)=0.2,
P(b)=0.2, P(g)=0.6, and a piece of fruit is extracted from the box (with
equal probability of selecting any of the items in the box), then what
is the probability of selecting an apple? If we observe that the
selected fruit is in fact an orange, what is the probability that it
came from the green box?</p>
</section>
</section>
<section id="references">
<h3><span class="section-number">4.13. </span>References<a class="headerlink" href="#references" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Parts of chapter 1 of [1];</p></li>
<li><p>Most of chapter 3 of [2];</p></li>
<li><p>Parts of chapters 5-7 of [3].</p></li>
</ul>
<p>[1] Bishop, Christopher M. <em>Pattern recognition and machine learning</em>.
springer, 2006.
<a class="reference external" href="https://www.microsoft.com/en-us/research/uploads/prod/2006/01/Bishop-Pattern-Recognition-and-Machine-Learning-2006.pdf">https://www.microsoft.com/en-us/research/uploads/prod/2006/01/Bishop-Pattern-Recognition-and-Machine-Learning-2006.pdf</a></p>
<p>[2] Goodfellow, Ian, Yoshua Bengio, and Aaron Courville. <em>Deep
learning</em>. MIT press, 2016. <a class="reference external" href="https://www.deeplearningbook.org/">https://www.deeplearningbook.org/</a></p>
<p>[3] Heumann, Christian, and Michael Schomaker Shalabh. Introduction to statistics and data analysis. Springer International Publishing Switzerland, 2016.</p>
</section>
</section>
</div>
<div class="toctree-wrapper compound">
<span id="document-lectures/08_common_distributions"></span><section class="tex2jax_ignore mathjax_ignore" id="probability-distributions">
<h2><span class="section-number">5. </span>Probability Distributions<a class="headerlink" href="#probability-distributions" title="Permalink to this heading">#</a></h2>
<p>We have seen how it is possible to assign a probability value to a given
outcome of a random variable.</p>
<p>In practice, it is often useful to assign probability values to <strong>all
the values</strong> that the random variable can assume.</p>
<p>To do so, we can define a <strong>function</strong>, which we will call <strong>probability
distribution</strong> which assigns a probability value to each of the possible
values of a random variable.</p>
<p>In the case of discrete variables, we will talk about “<strong>probability
mass functions</strong>”, whereas in the case of continuous variable, we will
refer to “<strong>probability density functions</strong>”.</p>
<p>A probability distribution characterizes the random variable and defines
which outcomes it is more likely to observe.</p>
<p>Once we find that a given random variable <span class="math notranslate nohighlight">\(X\)</span> is characterized by a
probability distirbution <span class="math notranslate nohighlight">\(P(X)\)</span>, we can say that <strong>“X follows P”</strong> and
write:</p>
<div class="math notranslate nohighlight">
\[X \sim P\]</div>
<section id="probability-mass-functions-pmf-discrete-variables">
<h3><span class="section-number">5.1. </span>Probability Mass Functions (PMF) - Discrete Variables<a class="headerlink" href="#probability-mass-functions-pmf-discrete-variables" title="Permalink to this heading">#</a></h3>
<p>If <span class="math notranslate nohighlight">\(X\)</span> is discrete, <span class="math notranslate nohighlight">\(P(X)\)</span> is called a “probability mass function”
(PMF). <span class="math notranslate nohighlight">\(P\)</span> maps the values of <span class="math notranslate nohighlight">\(X\)</span> to real numbers indicating whether a
given value is more or less likely.</p>
<p>A PMF on a random variable <span class="math notranslate nohighlight">\(X\)</span> is a function</p>
<div class="math notranslate nohighlight">
\[P:\Omega \rightarrow \lbrack 0,1\rbrack\]</div>
<p>Where <span class="math notranslate nohighlight">\(\Omega\)</span> is the sample space <span class="math notranslate nohighlight">\(X\)</span>, which satisfies the following property:</p>
<div class="math notranslate nohighlight">
\[\sum_{\mathbf{x}\mathbf{\in}\mathbf{\Omega}}^{}{\mathbf{P}\mathbf{(}\mathbf{x}\mathbf{)}}\mathbf{=}\mathbf{1}\]</div>
<p>This condition implies that the probability distribution is
normalized. Also, this means that at least one of the events should
happen.</p>
<p><strong>Example:</strong> Let <span class="math notranslate nohighlight">\(X\)</span> be the random variable indicating the outcome of a
coin toss.</p>
<ul class="simple">
<li><p>The space of all possible functions (the domain of <span class="math notranslate nohighlight">\(P(X)\)</span>) is
<span class="math notranslate nohighlight">\(\{ head,\ tail\}\)</span>.</p></li>
<li><p>The probabilities <span class="math notranslate nohighlight">\(P(head)\)</span> and <span class="math notranslate nohighlight">\(P(tail)\)</span> must be larger than or
equal to zero and smaller than or equal to 1.</p></li>
<li><p>Also, <span class="math notranslate nohighlight">\(P(head) + P(tail) = 1\ \)</span>. This is obvious, as one of the two
outcomes will always happen. Indeed, if we had <span class="math notranslate nohighlight">\(P(tail) = 0.3\)</span>, this
would mean that, 30 times out of 100 times we toss a coin, the
outcome will be tail. What will happen in all other cases? The
outcome will be head, hence, <span class="math notranslate nohighlight">\(P(head)\)</span>, so <span class="math notranslate nohighlight">\(P(head) + P(tail) = 1\)</span>.</p></li>
<li><p>In the case of a fair coin, we can characterize <span class="math notranslate nohighlight">\(P(X)\)</span> as a
“discrete uniform distribution”, i.e., a distribution which maps any
value <span class="math notranslate nohighlight">\(x \in X\)</span> to a constant, such that the properties of the
probability mass functions are satisfied.</p></li>
<li><p>If we have <span class="math notranslate nohighlight">\(N\)</span> possible outcomes, the discrete uniform probability
will be <span class="math notranslate nohighlight">\(P(X = x) = \frac{1}{N}\)</span> , which means that all outcomes
have the same probability.</p></li>
<li><p>This definition satisfies the constraints. Indeed,
<span class="math notranslate nohighlight">\(\frac{1}{N} \geq 0,\ \forall N\)</span> and
<span class="math notranslate nohighlight">\(\sum_{i}^{}{P\left( X = x_{i} \right)} = 1\)</span>.</p></li>
</ul>
<section id="example-probability-mass-function-for-a-fair-coin">
<h4><span class="section-number">5.1.1. </span>Example: Probability Mass Function for a Fair Coin<a class="headerlink" href="#example-probability-mass-function-for-a-fair-coin" title="Permalink to this heading">#</a></h4>
<p>A probability mass function can be plotted as a 2D diagram where the
values of the function (<span class="math notranslate nohighlight">\(P(x)\)</span>) is plotted against the values of the
independent variable <span class="math notranslate nohighlight">\(x\)</span>. This is the diagram associated to the PMF of
the previous example, where <span class="math notranslate nohighlight">\(P(head) = P(tail) = 0.5\)</span>.</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/888a70ac931c8fe0436e04741501456ef024eb997604c71fdf4d99dbff9985b2.png" src="../_images/888a70ac931c8fe0436e04741501456ef024eb997604c71fdf4d99dbff9985b2.png" />
</div>
</div>
</section>
<section id="example-probability-mass-function-for-a-biased-coin">
<h4><span class="section-number">5.1.2. </span>Example: Probability Mass Function for a Biased Coin<a class="headerlink" href="#example-probability-mass-function-for-a-biased-coin" title="Permalink to this heading">#</a></h4>
<p>Now suppose we tossed our coin for 10000 times and discovered that 6000
times the outcome was “head”, whereas 4000 times it was “tail”. We
deduce the coin is not fair.</p>
<p>Using a <strong>frequentist</strong> approach, we can manually assign values to our
PMF using the general formula:</p>
<div class="math notranslate nohighlight">
\[P(x) = \frac{\# trials\ in\ which\ X = x}{\#\ trials}\]</div>
<p>That is, in our case:</p>
<div class="math notranslate nohighlight">
\[P(head) = \frac{6000}{10000} = 0.6;P(tail) = \frac{4000}{10000} = 0.4\]</div>
<p>We shall note that the probability we just defined satisfies all
properties of probabilities, i.e.:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(0 \leq P(x) \leq 1\ \forall x\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\sum_{x}^{}{P(x) = 1}.\)</span></p></li>
</ul>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/c738a5bad6a12903b8ef1cac7fbee67d920bab1e09697f9d72cb615a10fe4226.png" src="../_images/c738a5bad6a12903b8ef1cac7fbee67d920bab1e09697f9d72cb615a10fe4226.png" />
</div>
</div>
<section id="exercise-probability-mass-function">
<h5><span class="section-number">5.1.2.1. </span>Exercise: Probability Mass Function<a class="headerlink" href="#exercise-probability-mass-function" title="Permalink to this heading">#</a></h5>
<p>Let <span class="math notranslate nohighlight">\(X\)</span> be a random variable representing the outcome of rolling a fair
dice with <span class="math notranslate nohighlight">\(6\)</span> faces:</p>
<ul class="simple">
<li><p>What is the space of possible values of <span class="math notranslate nohighlight">\(X\)</span>?</p></li>
<li><p>What is its cardinality?</p></li>
<li><p>What is the associated probability mass function <span class="math notranslate nohighlight">\(P(X)\)</span>?</p></li>
<li><p>Suppose the dice is not fair and <span class="math notranslate nohighlight">\(P(X = 1) = 0.2\)</span>, whereas all other
outcomes are equally probable. What is the probability mass function
of <span class="math notranslate nohighlight">\(P(X)\)</span>?</p></li>
<li><p>Draw the PMF obtained for the dice.</p></li>
</ul>
</section>
</section>
</section>
<section id="probability-density-functions-pdf-continuous-variables">
<h3><span class="section-number">5.2. </span>Probability Density Functions (PDF) - Continuous Variables<a class="headerlink" href="#probability-density-functions-pdf-continuous-variables" title="Permalink to this heading">#</a></h3>
<p>Probability distributions are called “probability density functions”
when the random variable is continuous.</p>
<p>A probability density function over a variable <span class="math notranslate nohighlight">\(X\)</span> is defined as follows:</p>
<div class="math notranslate nohighlight">
\[f:\Omega \rightarrow \lbrack 0,1\rbrack\]</div>
<p>and must satisfy the following property:</p>
<div class="math notranslate nohighlight">
\[\int f(x)dx = 1\]</div>
<p>This condition is equivalent to <span class="math notranslate nohighlight">\(\sum P(x) = 1\)</span> in the
case of a discrete variable. The sum turns into an integral in the
case of continuous variables.</p>
<p>Note that, in the case of continuous variables, we have:</p>
<div class="math notranslate nohighlight">
\[ P(a \leq x \leq b) = \int_{a}^b f(x) dx\]</div>
<p><strong>NOTE</strong>: In general, we say that the density function at a given value <span class="math notranslate nohighlight">\(x\)</span> is zero: <span class="math notranslate nohighlight">\(f(x)=0\)</span>. While this may seem counter-intuitive, we should consider the density function as the limit fo the probability as we narrow a neighborhood around <span class="math notranslate nohighlight">\(x\)</span>. If the neighborhood has size <span class="math notranslate nohighlight">\(0\)</span>, then the density will be zero. In practice, if we take a neighborhood which is non-zero, then we get an integral between two values and a final probability not equal to zero.</p>
<p>After all, from an intuitive point of view, the probability of having a value exactly equal to <span class="math notranslate nohighlight">\(x\)</span> is indeed zero, in the case of a continuous variable! So we should be more interested in the probability in a given range of values.</p>
<section id="example-uniform-pdf">
<h4><span class="section-number">5.2.1. </span>Example: Uniform PDF<a class="headerlink" href="#example-uniform-pdf" title="Permalink to this heading">#</a></h4>
<p>Let us consider a random number generator which outputs numbers comprised between <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span>.</p>
<p>Let <span class="math notranslate nohighlight">\(X\)</span> be a random variable assuming the values generated by the
random number generator.</p>
<p>The PDF of <span class="math notranslate nohighlight">\(X\)</span> will be a uniform distribution such that:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(P(x) = 0\ \forall x &lt; a\ \ or\ x &gt; b\)</span>;</p></li>
<li><p><span class="math notranslate nohighlight">\(P(x) = \frac{1}{b - a}\ \forall a \leq x \leq b\)</span>;</p></li>
</ul>
<p>We can see that this PDF satisfies all constraints:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(P(x) \geq 0\ \forall x.\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\int P(x)dx = 1\)</span> (prove that this is true as an exercise).</p></li>
</ul>
<p>The diagram below shows an illustration of a uniform PDF with bounds a and b,
i.e., <span class="math notranslate nohighlight">\(U(a,b)\)</span>. Of course, continuous distributions can be (and
generally are) much more complicated than that.</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/f511b722e64c3d354c9622cf02e03ef28ca948bdaf4f84407b5ce27775a9f8ea.png" src="../_images/f511b722e64c3d354c9622cf02e03ef28ca948bdaf4f84407b5ce27775a9f8ea.png" />
</div>
</div>
</section>
<section id="cumulative-distribution-functions-cdf">
<h4><span class="section-number">5.2.2. </span>Cumulative Distribution Functions (CDF)<a class="headerlink" href="#cumulative-distribution-functions-cdf" title="Permalink to this heading">#</a></h4>
<p>Similar to the Empirical Cumulative Distribution Functions, we can define Cumulative Distribution Functions for random variables, starting from the density or mass functions. A cumulative distribution function is generally defined as:</p>
<div class="math notranslate nohighlight">
\[ F(x) = f(X \leq x) \]</div>
</section>
<section id="cdf-of-continuous-random-variables">
<h4><span class="section-number">5.2.3. </span>CDF of Continuous Random Variables<a class="headerlink" href="#cdf-of-continuous-random-variables" title="Permalink to this heading">#</a></h4>
<p>In the case of continuous random variables, the definition leads to:</p>
<div class="math notranslate nohighlight">
\[F(x) = \int_{-\infty}^x P(x)dx\]</div>
<p>The CDF is useful in different ways. For instance, it’s easy to see that:</p>
<div class="math notranslate nohighlight">
\[P(a \leq X \leq b) = \int_a^b f(x)dx = \int_{-\infty}^b f(x)dx - \int_{-\infty}^a f(x)dx = F(b) - F(a)\]</div>
</section>
<section id="example">
<h4><span class="section-number">5.2.4. </span>Example<a class="headerlink" href="#example" title="Permalink to this heading">#</a></h4>
<p>The CDF of the uniform distribution will be given by:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(F(x) = 0\)</span> for <span class="math notranslate nohighlight">\(x &lt; a\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(F(x) = \frac{x - a}{b - a}\)</span> for <span class="math notranslate nohighlight">\(a \leq x \leq b\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(F(x) = 1\)</span> for <span class="math notranslate nohighlight">\(x &gt; b\)</span></p></li>
</ul>
<p>The plot below shows a diagram:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/00a4f47c84852bb09012db4118569e52f61380509db4e20454d4686e00d27f1e.png" src="../_images/00a4f47c84852bb09012db4118569e52f61380509db4e20454d4686e00d27f1e.png" />
</div>
</div>
</section>
<section id="cdf-of-discrete-random-variables">
<h4><span class="section-number">5.2.5. </span>CDF of Discrete Random Variables<a class="headerlink" href="#cdf-of-discrete-random-variables" title="Permalink to this heading">#</a></h4>
<p>In the case of discrete random variables, the definition of CDF leads to:</p>
<div class="math notranslate nohighlight">
\[F(x) = \sum_{y\leq x} P(y)\]</div>
<section id="example-pdf-and-cdf-of-a-fair-die">
<h5><span class="section-number">5.2.5.1. </span>Example - PDF and CDF of a fair die<a class="headerlink" href="#example-pdf-and-cdf-of-a-fair-die" title="Permalink to this heading">#</a></h5>
<p>In the case of a fair die, the PMF will be:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
f(x) = \begin{cases} 
\frac{1}{6} &amp; \text{if } x \in \{1, 2, 3, 4, 5, 6\} \\
0 &amp; \text{otherwise}
\end{cases}
\end{split}\]</div>
<p>The CDF will be:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
F(x) = \begin{cases} 
0 &amp; \text{if } x &lt; 1 \\
\frac{1}{6} &amp; \text{if } 1 \leq x &lt; 2 \\
\frac{1}{3} &amp; \text{if } 2 \leq x &lt; 3 \\
\frac{1}{2} &amp; \text{if } 3 \leq x &lt; 4 \\
\frac{2}{3} &amp; \text{if } 4 \leq x &lt; 5 \\
1 &amp; \text{if } x \geq 5
\end{cases}
\end{split}\]</div>
<p>The diagram below shows an example:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/b96fc33c7fc05bf59bd380dab928b8f83fdd5ee97fe60e06e6065fa77f644e77.png" src="../_images/b96fc33c7fc05bf59bd380dab928b8f83fdd5ee97fe60e06e6065fa77f644e77.png" />
</div>
</div>
</section>
</section>
</section>
<section id="expectation">
<h3><span class="section-number">5.3. </span>Expectation<a class="headerlink" href="#expectation" title="Permalink to this heading">#</a></h3>
<p>When it is known that a random variable follows a probability
distribution, <strong>it is possible to characterize that variable</strong> (and
hence the related probability distribution) <strong>with some statistics</strong>.</p>
<p>The most straightforward of them is the expectation. <strong>The concept of
expectation is very related to the concept of mean.</strong> When we compute
the mean of a given set of numbers, we usually sum all the numbers
together and then divide by the total.</p>
<p>Since a probability distribution will tell us which values will be more
frequent than others, we can compute this mean with a weighted average,
where the weights are given by the probability distribution.</p>
<p>Specifically, we can define the expectation of a random variable X as
follows:</p>
<div class="math notranslate nohighlight">
\[E_{X\sim P}\lbrack X\rbrack = \sum_{x \in \chi}^{}{xP(x)}\]</div>
<p>In the case of continuous variables, the expectation takes the form of
an integral:</p>
<div class="math notranslate nohighlight">
\[E_{X \sim P}\lbrack X\rbrack = \int xf(x)dx\]</div>
<p>This is very related to the concept of mean value (or expected value) of
a random variable.</p>
</section>
<section id="variance">
<h3><span class="section-number">5.4. </span>Variance<a class="headerlink" href="#variance" title="Permalink to this heading">#</a></h3>
<p>The variance gives a measure of how much variability there is in a
variable <span class="math notranslate nohighlight">\(X\)</span> around its mean <span class="math notranslate nohighlight">\(E\lbrack X\rbrack\)</span>.</p>
<p>The variance is defined as follows:</p>
<div class="math notranslate nohighlight">
\[var\lbrack X\rbrack = E\lbrack\left( X - E\lbrack X\rbrack \right)^{2}\rbrack\]</div>
</section>
<section id="covariance">
<h3><span class="section-number">5.5. </span>Covariance<a class="headerlink" href="#covariance" title="Permalink to this heading">#</a></h3>
<p>The covariance gives a measure of how two variables are linearly related
to each other. It allows to <strong>measure to what extent the increase of one
of the variables corresponds to an increase of the value of the other
one</strong>.</p>
<p>Given two random variables <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span>, the covariance is defined as
follows:</p>
<div class="math notranslate nohighlight">
\[Cov(X,Y) = E\lbrack\left( X - E\lbrack X\rbrack \right)\left( Y - E\lbrack Y\rbrack \right)\rbrack\]</div>
<p>We can distinguish the following terms:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(E\lbrack X\rbrack\)</span> and <span class="math notranslate nohighlight">\(E\lbrack Y\rbrack\)</span> are the expectations of
<span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y.\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\((X - E\lbrack X\rbrack)\)</span> and <span class="math notranslate nohighlight">\((Y - E\lbrack Y\rbrack)\)</span> are the
differences between the samples and the expected values.</p></li>
<li><p><span class="math notranslate nohighlight">\(\left( X - E\lbrack X\rbrack \right)\left( Y - E\lbrack Y\rbrack \right)\)</span>
computes the product between the differences.</p></li>
</ul>
<p>We have:</p>
<ul class="simple">
<li><p>If the signs of the terms agree, the product is positive.</p></li>
<li><p>If the signs of the terms disagree, the product is negative.</p></li>
</ul>
<p>In practice, if when <span class="math notranslate nohighlight">\(X\)</span> is larger than the mean, then <span class="math notranslate nohighlight">\(Y\)</span>
is larger than the mean and vice versa, when <span class="math notranslate nohighlight">\(X\)</span> is lower
than the mean then <span class="math notranslate nohighlight">\(Y\)</span> is lower than the mean, then the two
variables are <em>correlated,</em> and the covariance is high.</p>
<p>If <span class="math notranslate nohighlight">\(X\)</span> is a multi-dimensional variable
<span class="math notranslate nohighlight">\(X = \lbrack X_{1},X_{2},\ldots,X_{n}\rbrack\)</span>, we can compute all the
possible covariances between variable pairs:
<span class="math notranslate nohighlight">\(Cov\lbrack X_{i},X_{j}\rbrack\)</span>. This allows to create a matrix, which
is generally referred to as <strong>the covariance matrix</strong>. The general term
of the covariance matrix <span class="math notranslate nohighlight">\(Cov(X)\)</span> is given by:</p>
<div class="math notranslate nohighlight">
\[Cov(X)_{i,j} = \Sigma_{ij} = Cov(X_{i},X_{j})\]</div>
</section>
<section id="standardization">
<h3><span class="section-number">5.6. </span>Standardization<a class="headerlink" href="#standardization" title="Permalink to this heading">#</a></h3>
<p>Standardization transforms a random variable <span class="math notranslate nohighlight">\(X\)</span> into a variable <span class="math notranslate nohighlight">\(Z\)</span> so that it has:</p>
<ul class="simple">
<li><p>Expectation equal to zero: <span class="math notranslate nohighlight">\(E(Z) = 0\)</span>.</p></li>
<li><p>Variance equal to one: <span class="math notranslate nohighlight">\(Var(Z) = 1\)</span>.</p></li>
</ul>
<p>The standardized variable will be:</p>
<div class="math notranslate nohighlight">
\[Z = \frac{X - \mu_X}{\sigma_X} = \frac{X-E[X]}{\sqrt{Var[X]}}\]</div>
</section>
<section id="common-probability-distributions">
<h3><span class="section-number">5.7. </span>Common Probability Distributions<a class="headerlink" href="#common-probability-distributions" title="Permalink to this heading">#</a></h3>
<p>There are several common probability distributions which can be used to
describe random events. <strong>These distributions have an analytical
formulation which depends generally on one or more parameters.</strong></p>
<p>When we have <strong>enough evidence that a given random variable is well
described by one of these distributions</strong>, we can simply “fit” the
distribution to the data (i.e., choose the correct parameters for the
distribution) and use the analytical formulation to deal with the random
variable.</p>
<p>It is hence useful to know the <strong>most common probability distributions</strong>
so that we can recognize the cases in which they can be used.</p>
<section id="discrete-uniform-distribution">
<h4><span class="section-number">5.7.1. </span>Discrete Uniform Distribution<a class="headerlink" href="#discrete-uniform-distribution" title="Permalink to this heading">#</a></h4>
<p>The discrete uniform distribution is controlled by a parameter <span class="math notranslate nohighlight">\(k \in \mathbb{N}\)</span> and assumes that all outcomes have the same probability of occurring:</p>
<div class="math notranslate nohighlight">
\[P(X=a_i) = \frac{1}{k}\]</div>
<p>Where <span class="math notranslate nohighlight">\(\Omega = \{a_1,\ldots,a_k\}\)</span>.</p>
<p>It can be shown that:</p>
<div class="math notranslate nohighlight">
\[E[X] = \frac{k+1}{2}\]</div>
<div class="math notranslate nohighlight">
\[Var[X] = \frac{1}{12}(k^2-1)\]</div>
<section id="id1">
<h5><span class="section-number">5.7.1.1. </span>Example<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h5>
<p>The outcomes of rolling a fair die follow a uniform distribution with <span class="math notranslate nohighlight">\(k=6\)</span>, as shown in the diagram below:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/689d5dc078fb3b115fe23860123251ca54e9328aa880529a13032e78754d263a.png" src="../_images/689d5dc078fb3b115fe23860123251ca54e9328aa880529a13032e78754d263a.png" />
</div>
</div>
</section>
</section>
<section id="bernoulli-distribution">
<h4><span class="section-number">5.7.2. </span>Bernoulli Distribution<a class="headerlink" href="#bernoulli-distribution" title="Permalink to this heading">#</a></h4>
<p>The Bernoulli distribution is a distribution over a single binary random
variable, i.e., the variable <span class="math notranslate nohighlight">\(X\)</span> can take only two values:
<span class="math notranslate nohighlight">\(\left\{ 0,1 \right\}\)</span>.</p>
<p>The distribution is controlled by a single parameter
<span class="math notranslate nohighlight">\(\phi \in \lbrack 0,1\rbrack\)</span>, which gives the probability of the
variable to be equal to 1.</p>
<p>The analytical formulation of the Bernoulli distribution is very simple:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(P(X = 1) = \phi\)</span>;</p></li>
<li><p><span class="math notranslate nohighlight">\(P(X = 0) = 1 - \phi\)</span></p></li>
</ul>
<p>The expected value and variance of the associated random variable are:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(E\lbrack x\rbrack = \phi\)</span>;</p></li>
<li><p><span class="math notranslate nohighlight">\(Var(x) = \phi(1 - \phi)\)</span>.</p></li>
</ul>
<section id="id2">
<h5><span class="section-number">5.7.2.1. </span>Example<a class="headerlink" href="#id2" title="Permalink to this heading">#</a></h5>
<p>A skewed coin lands on “head” <span class="math notranslate nohighlight">\(60\%\)</span> of the
times. If we define <span class="math notranslate nohighlight">\(X = 1\)</span> when the outcome is head and <span class="math notranslate nohighlight">\(X = 0\)</span> when
the outcome is tail, then the variable follows a Bernoulli distribution
with <span class="math notranslate nohighlight">\(\phi = 0.6\)</span>.</p>
</section>
</section>
<section id="binomial-distribution">
<h4><span class="section-number">5.7.3. </span>Binomial Distribution<a class="headerlink" href="#binomial-distribution" title="Permalink to this heading">#</a></h4>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/b4ba486ffca81fed577fcc5d0d825a6576c5dcd4433a1eed434d02c99df6b8aa.png" src="../_images/b4ba486ffca81fed577fcc5d0d825a6576c5dcd4433a1eed434d02c99df6b8aa.png" />
</div>
</div>
<p>The binomial distribution is a discrete probability distribution (PMF)
over natural numbers with parameters <span class="math notranslate nohighlight">\(\mathbf{n}\)</span> <strong>and</strong> <span class="math notranslate nohighlight">\(\mathbf{p}\)</span></p>
<p>It models <strong>the probability of obtaining</strong> <span class="math notranslate nohighlight">\(\mathbf{k}\)</span> <strong>successes in a
sequence of</strong> <span class="math notranslate nohighlight">\(\mathbf{n}\)</span> <strong>independent experiments which follow a
Bernoulli distribution with parameter</strong>
<span class="math notranslate nohighlight">\(\mathbf{p}\mathbf{\ (}\mathbf{\phi}\mathbf{=}\mathbf{p}\mathbf{)}\)</span><strong>;</strong></p>
<p>The probability mass function of the distribution is given by:</p>
<div class="math notranslate nohighlight">
\[P(k) = \binom{n}{k}p^{k}(1 - p)^{n - k}\]</div>
<p>Where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(k\)</span> is the number of successes</p></li>
<li><p><span class="math notranslate nohighlight">\(n\)</span> is the number of independent trials</p></li>
<li><p><span class="math notranslate nohighlight">\(p\)</span> is the probability of a success in a single trial</p></li>
</ul>
<p>The expected value is <span class="math notranslate nohighlight">\(E\lbrack k\rbrack = np\)</span>;</p>
<p>The variance is <span class="math notranslate nohighlight">\(Var\lbrack k\rbrack = np(1 - p)\)</span>;</p>
<section id="id3">
<h5><span class="section-number">5.7.3.1. </span>Example<a class="headerlink" href="#id3" title="Permalink to this heading">#</a></h5>
<p>What is the probability of tossing a coin three times and obtaining
three heads? We have:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(k = 3\)</span>: number of successes (three times head)</p></li>
<li><p><span class="math notranslate nohighlight">\(n = 3\)</span>: number of trials</p></li>
<li><p><span class="math notranslate nohighlight">\(p = 0.5\)</span>: the probability of getting a head when tossing a coin</p></li>
</ul>
<p>The required probability will be given by:</p>
<div class="math notranslate nohighlight">
\[P(3) = \binom{3}{3}{0.5}^{3}(1 - 0.5)^{3 - 3} = {0.5}^{3} = 0.125\]</div>
<p><strong>Exercise</strong></p>
<p>What is the probability of tossing an unfair coin
(<span class="math notranslate nohighlight">\(P\left( 'head^{'} \right) = 0.6\)</span>) 7 times and obtaining <span class="math notranslate nohighlight">\(2\)</span> tails?</p>
</section>
</section>
<section id="categorical-distribution">
<h4><span class="section-number">5.7.4. </span>Categorical Distribution<a class="headerlink" href="#categorical-distribution" title="Permalink to this heading">#</a></h4>
<p>The <strong>multinoulli</strong> or <strong>categorical</strong> distribution is a distribution of
a <em>single discrete variable with</em> <span class="math notranslate nohighlight">\(k\)</span> <em>different states</em>, where <span class="math notranslate nohighlight">\(k\)</span> is
finite.</p>
<ul class="simple">
<li><p>The distribution is parametrized by a vector
<span class="math notranslate nohighlight">\(\mathbf{p} \in \lbrack 0,1\rbrack^k\)</span>, where <span class="math notranslate nohighlight">\(p_{i}\)</span> gives the
probability of the <span class="math notranslate nohighlight">\(i^{th}\)</span> state.</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathbf{p}\)</span> must be such that <span class="math notranslate nohighlight">\(\sum_{i = 1}^kp_{i} = 1\)</span> to
obtain a valid probability distribution.</p></li>
<li><p>The analytical form of the distribution is given by:
<span class="math notranslate nohighlight">\(p(x = i) = p_{i}\)</span>;</p></li>
</ul>
<p>This distribution is the <strong>generalization of the Bernoulli distribution
to the case of multiple states</strong>.</p>
<p><strong>Example:</strong></p>
<p>Rolling a fair die. In this case, <span class="math notranslate nohighlight">\(k = 6\)</span> and
<span class="math notranslate nohighlight">\(p_{i} = \frac{1}{k}\ ,\ i = 0,\ldots,k \ \)</span>.</p>
</section>
<section id="multinomial-distribution">
<h4><span class="section-number">5.7.5. </span>Multinomial Distribution<a class="headerlink" href="#multinomial-distribution" title="Permalink to this heading">#</a></h4>
<p>The multinomial distribution <strong>generalizes the binomial distribution to
the case in which the experiments are not binary</strong>, but they can have
multiple outcomes (e.g., <em>a dice vs a coin</em>).</p>
<p>In particular, the multinomial distribution models the probability of
obtaining exactly <span class="math notranslate nohighlight">\((n_{1},\ldots,n_{k})\)</span> occurrences (with
<span class="math notranslate nohighlight">\(n = \sum_{i}^{}n_{i}\)</span>) for each of the <span class="math notranslate nohighlight">\(k\)</span> possible outcomes in a
sequence of <span class="math notranslate nohighlight">\(n\)</span> independent experiments which follow a Categorial
distribution with probabilities <span class="math notranslate nohighlight">\(p_{1},\ldots,p_{k}\)</span>.</p>
<p>The parameters of the distribution are:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(n\)</span>: the number of trials</p></li>
<li><p><span class="math notranslate nohighlight">\(k\)</span>: the number of possible outcomes</p></li>
<li><p><span class="math notranslate nohighlight">\(p_{1},\ldots,p_{k}\)</span> the probabilities of obtaining a given class in
each trial (with <span class="math notranslate nohighlight">\(\sum_{i = 1}^{k}p_{i} = 1\)</span>)</p></li>
</ul>
<p>The PMF of the distribution is:</p>
<div class="math notranslate nohighlight">
\[P\left( n_{1},\ldots,n_{k} \right) = \frac{n!}{n_{1}!\ldots n_{k}!}p_{1}^{n_{1}} \cdot \ldots \cdot p_{k}^{n_{k}}\]</div>
<p>The mean is: <span class="math notranslate nohighlight">\(E\left\lbrack n_{i} \right\rbrack = np_{i}\)</span>.</p>
<p>The variance is:
<span class="math notranslate nohighlight">\(Var\left\lbrack n_{i} \right\rbrack = np_{i}(1 - p_{i})\)</span>.</p>
<p>The covariance between two of the input variables is:
<span class="math notranslate nohighlight">\(Cov\left( n_{i},n_{j} \right) = - np_{i}p_{j}\ (i \neq j)\)</span>.</p>
<p><strong>Example</strong></p>
<p>Given a fair die with 6 possible outcomes, what is the probability of
getting 3 times 1, 2 times 2, 4 time 3, 5 times 4, 0 times 5, and 1 time
6, rolling the dice for 15 times?</p>
<p>We have:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(n = 15\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(k = 6\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(p_{1} = p_{2} = \ldots p_{6} = \frac{1}{6}\)</span></p></li>
</ul>
<p>The required probability is given by:</p>
<div class="math notranslate nohighlight">
\[P(3,2,4,5,0,1) = \frac{15!}{3!2!4!5!0!1!} \cdot \frac{1}{6^{3}} \cdot \frac{1}{6^{2}} \cdot \frac{1}{6^{4}} \cdot \frac{1}{6^{5}} \cdot \frac{1}{6^{0}} \cdot \frac{1}{6^{1}} = 8.04 \cdot 10^{- 5}\]</div>
</section>
<section id="gaussian-distribution">
<h4><span class="section-number">5.7.6. </span>Gaussian Distribution<a class="headerlink" href="#gaussian-distribution" title="Permalink to this heading">#</a></h4>
<p>The Bernoulli and Categorical distributions are PMF, i.e., distributions
over discrete random variables.</p>
<p>A common PDF when dealing with real values is the <strong>Gaussian
distribution,</strong> also known as <strong>Normal Distribution</strong>.</p>
<p>The distribution is characterized by two parameters:</p>
<ul class="simple">
<li><p>The mean <span class="math notranslate nohighlight">\(\mu\mathfrak{\in R}\)</span></p></li>
<li><p>The standard deviation <span class="math notranslate nohighlight">\(\sigma \in (0, + \infty)\)</span></p></li>
</ul>
<p>In practice, the distribution is often <em>seen in terms of</em> <span class="math notranslate nohighlight">\(\mu\)</span> <em>and</em>
<span class="math notranslate nohighlight">\(\sigma^{2}\)</span> rather than <span class="math notranslate nohighlight">\(\sigma\)</span>, where <span class="math notranslate nohighlight">\(\sigma^{2}\)</span> is called <strong>the
variance</strong>.</p>
<p>The analytical formulation of the Normal distribution is as follows:</p>
<div class="math notranslate nohighlight">
\[N\left( x;\mu,\sigma^{2} \right) = \sqrt{\frac{1}{2\pi\sigma^{2}}}e^{- \frac{1}{2\sigma^{2}}(x - \mu)^{2}}\]</div>
<p>The term under the square root is a normalization term which ensures
that the distribution integrates to 1.</p>
<p>The expectation and variance of a variable following the Normal
distribution are as follows:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(E\lbrack x\rbrack = \mu\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(Var\lbrack x\rbrack = \sigma^{2}\)</span></p></li>
</ul>
<p>The Gaussian distribution is very used when we do not have much prior
knowledge on the real distribution we wish to model. This in mainly due
to the <strong>central limit theorem</strong>, which states that the sum of many
independent random variables with the same distribution is approximately
normally distributed.</p>
<section id="interpretation">
<h5><span class="section-number">5.7.6.1. </span>Interpretation<a class="headerlink" href="#interpretation" title="Permalink to this heading">#</a></h5>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/ff3fc200b1dac4e599d0357ac8790cdeb0b07329a61bda14eceb69124445e94e.png" src="../_images/ff3fc200b1dac4e599d0357ac8790cdeb0b07329a61bda14eceb69124445e94e.png" />
</div>
</div>
<p>If we plot the PDF of a Normal distribution, we can find that it is easy
to interpret the meaning of its parameters:</p>
<ul class="simple">
<li><p>The resulting curve has a maximum (highest probability) when
<span class="math notranslate nohighlight">\(x = \mu\)</span></p></li>
<li><p>The curve is symmetric, with the inflection points at
<span class="math notranslate nohighlight">\(x = \mu \pm \sigma\)</span></p></li>
<li><p>The example shows a normal distribution for <span class="math notranslate nohighlight">\(\mu = 0\)</span> and
<span class="math notranslate nohighlight">\(\sigma = 1\)</span></p></li>
</ul>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/f881bd32ce8ea398c660d4f1b689083eceb9caa2865df155d8674291b720b160.png" src="../_images/f881bd32ce8ea398c660d4f1b689083eceb9caa2865df155d8674291b720b160.png" />
</div>
</div>
<p>Another notable property of the Normal distribution is that:</p>
<ul class="simple">
<li><p>About <span class="math notranslate nohighlight">\(68\%\)</span> of the density is comprised in the interval
<span class="math notranslate nohighlight">\(\lbrack - \sigma,\sigma\rbrack\)</span>;</p></li>
<li><p>About <span class="math notranslate nohighlight">\(95\%\)</span> of the density is comprised in the interval
<span class="math notranslate nohighlight">\(\lbrack - 2\sigma,2\sigma\rbrack\)</span>;</p></li>
<li><p>Almost 100% of the density is comprised in the interval
<span class="math notranslate nohighlight">\(\lbrack - 3\sigma,3\sigma\rbrack\)</span>.</p></li>
</ul>
</section>
<section id="multivariate-gaussian">
<h5><span class="section-number">5.7.6.2. </span>Multivariate Gaussian<a class="headerlink" href="#multivariate-gaussian" title="Permalink to this heading">#</a></h5>
<p>The formulation of the Gaussian distribution generalizes to the
multivariate case, i.e., the case in which <span class="math notranslate nohighlight">\(X\)</span> is n-dimensional.</p>
<p>In that case, the distribution is parametrized by a <strong>n-dimensional
vector</strong> <span class="math notranslate nohighlight">\(\mathbf{\mu}\)</span> and a
<span class="math notranslate nohighlight">\(\mathbf{n}\mathbf{\times}\mathbf{n}\mathbf{\ }\)</span><strong>positive definite
symmetric matrix</strong> <span class="math notranslate nohighlight">\(\mathbf{\Sigma}\)</span>. The formulation of the
multi-variate Gaussian is:</p>
<div class="math notranslate nohighlight">
\[N\left( \mathbf{x;\mu,}\mathbf{\Sigma} \right) = \sqrt{\frac{1}{(2\pi)^{n}\det(\Sigma)}}e^{( - \frac{1}{2}\left( \mathbf{x} - \mathbf{\mu} \right)^{T}\Sigma^{- 1}\left( \mathbf{x} - \mathbf{\mu} \right))}\]</div>
<p>In the 2D case, <span class="math notranslate nohighlight">\(\mathbf{\mu}\)</span> is a 2D
point representing the center of the Gaussian (the position of the
mode), whereas the matrix <span class="math notranslate nohighlight">\(\Sigma\)</span> influences the “shape” of the
Gaussian.</p>
<p>Examples of bivariate Gaussian distributions are shown below.</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/1f251b1c4d04abd9ad75d11b2b34c3263168f41d5ce8fa485598f7bf30f7bc9e.png" src="../_images/1f251b1c4d04abd9ad75d11b2b34c3263168f41d5ce8fa485598f7bf30f7bc9e.png" />
<img alt="../_images/3616cdd0ac2346f211bdc4356b38ff015a138159409832c1a5774354c77fa7a1.png" src="../_images/3616cdd0ac2346f211bdc4356b38ff015a138159409832c1a5774354c77fa7a1.png" />
</div>
</div>
<p>The two plots above are common representations for bivariate continuous distributions:</p>
<ul class="simple">
<li><p>The plot on the top shows a 3D representation of the PDF in which the X and Y axes are the values of the variables, while the third axis reports the probability density.</p></li>
<li><p>Since it’s often hard to draw 3D graphs, we often use a contour plot to represent the 3D curves. In the 3D plot, curves of the same color represent points which have the same density in the 3D plot.</p></li>
</ul>
</section>
<section id="effect-of-sigma">
<h5><span class="section-number">5.7.6.3. </span>Effect of <span class="math notranslate nohighlight">\(\Sigma\)</span><a class="headerlink" href="#effect-of-sigma" title="Permalink to this heading">#</a></h5>
<p>Similar to how variance affects the dispersion of a 1D Gaussian, the covariance matrix <span class="math notranslate nohighlight">\(\Sigma\)</span> affects the dispersion in both axes. As a result, changing the values of the matrix will affect the shape of the distribution. Let’s consider the general covariance matrix:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\Sigma = \begin{bmatrix}
  \sigma_x^2 &amp; \sigma_{xy} \\
  \sigma_{yx} &amp; \sigma_y^2
\end{bmatrix}
\end{split}\]</div>
<p>If the matrix is diagonal (<span class="math notranslate nohighlight">\(\sigma_{xy}=\sigma_{yx}=0\)</span>), then we have an isotropic Gaussian, meaning that it is symmetric along the two axes. Adding values different from zeros in the secondary diagonal will change the shape. Some examples are shown below:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/c405ad8432a9efe42acc83cf7d6fbe84f621d3ae27880a0196c8cbe0320eea8b.png" src="../_images/c405ad8432a9efe42acc83cf7d6fbe84f621d3ae27880a0196c8cbe0320eea8b.png" />
</div>
</div>
</section>
<section id="estimation-of-the-parameters-of-a-gaussian-distribution">
<h5><span class="section-number">5.7.6.4. </span>Estimation of the Parameters of a Gaussian Distribution<a class="headerlink" href="#estimation-of-the-parameters-of-a-gaussian-distribution" title="Permalink to this heading">#</a></h5>
<p>We have noted that in many cases we can assume a random variable follows
a Gaussian distribution. However, it is not yet clear how to choose the
parameters of the Gaussian distribution.</p>
<p>Given some data (remember, data is values assumed by random variables!),
we can obtain the parameters of the Gaussian distribution related to the
data with a <strong>maximum likelihood</strong> estimation.</p>
<p>This consists in computing the mean and variance parameters using the
following formula (in the univariate case):</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\mu = \frac{1}{n}\sum_{j}^{}x_{j}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\sigma^{2} = \frac{1}{n}\sum_{j}^{}\left( x_{j} - \mu \right)^{2}\)</span></p></li>
</ul>
<p>Where <span class="math notranslate nohighlight">\(x_{j}\)</span> represent the different data points.</p>
<p>In the multi-variate case, the computation of the multi-dimensional
<span class="math notranslate nohighlight">\(\mathbf{\mu}\)</span> vector is similar:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\mathbf{\mu} = \frac{1}{n}\sum_{j}^{}\mathbf{x}_{j}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\Sigma\)</span> is instead computed as the covariance matrix related to
<span class="math notranslate nohighlight">\(X\)</span>: <span class="math notranslate nohighlight">\(\Sigma = Cov(\mathbf{X})\)</span>, i.e.,
<span class="math notranslate nohighlight">\(\Sigma_{ij} = Cov\left( \mathbf{X}_{i},\mathbf{X}_{j} \right)\)</span></p></li>
</ul>
<p>The diagram below shows an example in which we fit a Gaussian to a set of data and compare it with a 2D KDE of the data.</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/407ed8c3dbc3b9d75b2781cb4de5256c8657b136c8c7f5196ef720d3bbc78fe1.png" src="../_images/407ed8c3dbc3b9d75b2781cb4de5256c8657b136c8c7f5196ef720d3bbc78fe1.png" />
</div>
</div>
</section>
</section>
<section id="standardization-and-normal-distribution">
<h4><span class="section-number">5.7.7. </span>Standardization and Normal Distribution<a class="headerlink" href="#standardization-and-normal-distribution" title="Permalink to this heading">#</a></h4>
<p>We have seen that standardization gives rise to a new variable:</p>
<div class="math notranslate nohighlight">
\[Z = \frac{X - \mu_X}{\sigma_X} = \frac{X-E[X]}{\sqrt{Var[X]}}\]</div>
<p>The plot below shows a data distribution before and after standardization.</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/aba8db2cd10ec3fa2bd151841d5b89c89e4239402a10e698b6839d3c3978c4cd.png" src="../_images/aba8db2cd10ec3fa2bd151841d5b89c89e4239402a10e698b6839d3c3978c4cd.png" />
</div>
</div>
</section>
<section id="central-limit-theorem">
<h4><span class="section-number">5.7.8. </span>Central Limit Theorem<a class="headerlink" href="#central-limit-theorem" title="Permalink to this heading">#</a></h4>
<p>The Central Limit Theorem is a statistical principle that states that the distribution of the sum (or average) of a large number of independent, identically distributed (i.i.d.) random variables <span class="math notranslate nohighlight">\(\{X_i\}_{i=1}^n\)</span> approaches a normal distribution as <span class="math notranslate nohighlight">\(n \to \infty\)</span>, regardless of the shape of the original population’s distribution.</p>
<p>While we will not see this theorem formally, it is a fundamental result which in some sense “justifies” the pervasive use of the Gaussian distribution in data analysis.</p>
<p>In the plot below, we plot the distributions of the average outcome of rolling a given number of dice. We can see each die as described by a different and independent random variable, hence the distribution will get close to Gaussian as we increase the number of dice.</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/d3b0dcfd55343902762bdbfdf6de40e0d4d72373e1bf9592ba8247dffffb8d78.png" src="../_images/d3b0dcfd55343902762bdbfdf6de40e0d4d72373e1bf9592ba8247dffffb8d78.png" />
</div>
</div>
</section>
</section>
<section id="other-distributions-optional">
<h3><span class="section-number">5.8. </span>Other Distributions (Optional)<a class="headerlink" href="#other-distributions-optional" title="Permalink to this heading">#</a></h3>
<section id="poisson-distribution">
<h4><span class="section-number">5.8.1. </span>Poisson Distribution<a class="headerlink" href="#poisson-distribution" title="Permalink to this heading">#</a></h4>
<p>The Poisson distribution expresses the <strong>probability of a given number of events occurring in a fixed interval of time or space if they occur independently with a known rate</strong>. It is useful to model situations in which the number of events is very large and the probability of a given event happening is relatively small. The Poisson distribution is controlled by a parameter <span class="math notranslate nohighlight">\(\lambda&gt;0\)</span> (the rate at which each event occurs) and defined as:</p>
<div class="math notranslate nohighlight">
\[P(X=x) = \frac{\lambda^x}{x!}\exp(-\lambda)\]</div>
<p>with <span class="math notranslate nohighlight">\(x=0,1,2,3,\ldots\)</span> representing the number of events happening at the same time/space. The plot below shows the Poisson distribution for different choices of the <span class="math notranslate nohighlight">\(\lambda\)</span> parameter:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/26b32f3ff10869b84d807ff3b8402495ab558285601402006112a858df2434d1.png" src="../_images/26b32f3ff10869b84d807ff3b8402495ab558285601402006112a858df2434d1.png" />
</div>
</div>
<section id="id4">
<h5><span class="section-number">5.8.1.1. </span>Example<a class="headerlink" href="#id4" title="Permalink to this heading">#</a></h5>
<p>During World War II Germans bombed the south of London many times. People started to believe that some areas were more targeted by the bombing and hence started moving from one part of a city to another in an attempt to avoid those areas.</p>
<p>After the end of the war, R. D. Charles showed that the bombings were actually random and independent. To do so, he divided the interested area in <span class="math notranslate nohighlight">\(576\)</span> squares of <span class="math notranslate nohighlight">\(0.24 Km^2\)</span>. The number of total bombs was <span class="math notranslate nohighlight">\(537\)</span>, hence less than one per square (a rare event). Assuming that the bombing was uniform and casual, the probability of a square being bombed would be:</p>
<div class="math notranslate nohighlight">
\[\lambda = \frac{537}{576}\]</div>
<p>We can hence compute the expected probability that <span class="math notranslate nohighlight">\(x\)</span> squares were bombed as <span class="math notranslate nohighlight">\(P(X=x)\)</span>, where <span class="math notranslate nohighlight">\(P\)</span> is a Poisson function with <span class="math notranslate nohighlight">\(\lambda=\frac{537}{576}\)</span>. The expected number of areas being bombed <span class="math notranslate nohighlight">\(x\)</span> times will be: <span class="math notranslate nohighlight">\(P(X=x)\times576\)</span></p>
<p>Comparing the expected numbers with the measured ones, we obtain the following table:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Expected</th>
      <th>Real</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>226.742723</td>
      <td>229</td>
    </tr>
    <tr>
      <th>1</th>
      <td>211.390351</td>
      <td>211</td>
    </tr>
    <tr>
      <th>2</th>
      <td>98.538731</td>
      <td>93</td>
    </tr>
    <tr>
      <th>3</th>
      <td>30.622279</td>
      <td>35</td>
    </tr>
    <tr>
      <th>4</th>
      <td>7.137224</td>
      <td>8</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Since the numbers are very close, we can imagine that the bombing was really random.</p>
</section>
</section>
<section id="laplacian-distribution">
<h4><span class="section-number">5.8.2. </span>Laplacian Distribution<a class="headerlink" href="#laplacian-distribution" title="Permalink to this heading">#</a></h4>
<p>The Gaussian distribution assumes that the probability of an observation deviating from the mean <strong>decreases exponentially as the square of the deviation</strong>. For some types of data, this assumption is not accurate: in some cases, deviating from the mean is much more likely than prescribed by the Gaussian model. An alternative mathematical model, introduced by Laplace, posits that the probability of an observation deviating from the mean decreases exponentially with the absolute value of the deviation:</p>
<div class="math notranslate nohighlight">
\[L(x, M, b) = \frac{1}{2b} e^{-\frac{|x - M|}{b}}\]</div>
<p>Where <span class="math notranslate nohighlight">\(M\)</span> represents the c<strong>entral/mean value of the distribution</strong>, and b is a scaling parameter known as <strong>diversity</strong>. It should be noted that due to the absolute value involved, this function is not differentiable at the mean value.</p>
<p>The <strong>best fit</strong> of this function to the data occurs when <strong>M is chosen as the median of the data</strong>, and <strong>b is chosen as the mean of the absolute differences between the data points and the median</strong>:</p>
<div class="math notranslate nohighlight">
\[M=median(\{x_i\}_{i=1}^n)\]</div>
<div class="math notranslate nohighlight">
\[b=\frac{\sum_{i=1}^n|x_i-M|}{n}\]</div>
<p>In this model, values far from the central value occur more frequently than they would in a Gaussian model. This phenomenon is referred to as <strong>fat tails</strong> in contrast to the Gaussian model, which is described as having <strong>thin tails</strong>.</p>
<p>Expectation and variance of <span class="math notranslate nohighlight">\(X \sim L\)</span> are:</p>
<div class="math notranslate nohighlight">
\[E[X] = \lambda\]</div>
<div class="math notranslate nohighlight">
\[Var(X) = \lambda\]</div>
<p>The following plot shows some examples of Laplacian distributions:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/364732194241ad5e066822a4c7dc4a56aebae6f81d906fac0afbead5a714d0c2.png" src="../_images/364732194241ad5e066822a4c7dc4a56aebae6f81d906fac0afbead5a714d0c2.png" />
</div>
</div>
</section>
</section>
<section id="references">
<h3><span class="section-number">5.9. </span>References<a class="headerlink" href="#references" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Parts of chapter 1 of [1];</p></li>
<li><p>Most of chapter 3 of [2];</p></li>
<li><p>Parts of chapter 8 of [3].</p></li>
</ul>
<p>[1] Bishop, Christopher M. <em>Pattern recognition and machine learning</em>.
springer, 2006.
<a class="reference external" href="https://www.microsoft.com/en-us/research/uploads/prod/2006/01/Bishop-Pattern-Recognition-and-Machine-Learning-2006.pdf">https://www.microsoft.com/en-us/research/uploads/prod/2006/01/Bishop-Pattern-Recognition-and-Machine-Learning-2006.pdf</a></p>
<p>[2] Goodfellow, Ian, Yoshua Bengio, and Aaron Courville. <em>Deep
learning</em>. MIT press, 2016. <a class="reference external" href="https://www.deeplearningbook.org/">https://www.deeplearningbook.org/</a></p>
<p>[3] Heumann, Christian, and Michael Schomaker Shalabh. Introduction to statistics and data analysis. Springer International Publishing Switzerland, 2016.</p>
</section>
</section>
<span id="document-lectures/09_information_theory"></span><section class="tex2jax_ignore mathjax_ignore" id="basic-elements-of-information-theory">
<h2><span class="section-number">6. </span>Basic Elements of Information Theory<a class="headerlink" href="#basic-elements-of-information-theory" title="Permalink to this heading">#</a></h2>
<p>Probability Theory allows to deal with the uncertain, however, it does
not allow to quantify it. Information theory provides the tools to
<strong>quantify how much information is present in a signal</strong>.</p>
<p>When dealing with data, it can be useful to understand which data is
informative and which is not, with respect to a given goal.</p>
<p>The basic intuition behind information theory is that learning an
unlikely event has occurred is more informative than learning a likely
event has occurred.</p>
<p>For instance, the event “the sun rose this morning” is very likely and
hence it is not very informative. The message “there was a solar eclipse
this morning” is instead very unlikely, and hence informative.</p>
<section id="self-information">
<h3><span class="section-number">6.1. </span>Self-information<a class="headerlink" href="#self-information" title="Permalink to this heading">#</a></h3>
<p>We would like to quantify information in a way that formalizes the
intuition discussed before:</p>
<ul class="simple">
<li><p>Likely events should have <em>low information content</em></p></li>
<li><p>Less likely events should have <em>higher information content</em></p></li>
</ul>
<p>Moreover, <strong>independent events should have additive
information</strong>. For example, finding out that a tossed coin has
come up as heads twice should convey twice as much information
as finding out that a tossed coin has come up as heads once.</p>
<p>To satisfy these three properties, the notion of <strong>self-information</strong> is
introduced. Given a random variable <span class="math notranslate nohighlight">\(X \sim P\)</span>, the self-information of
an event <span class="math notranslate nohighlight">\(X = x\)</span> is defined as:</p>
<div class="math notranslate nohighlight">
\[I(x) = - logP(x)\]</div>
<p>If the base of the logarithm is 2, then the self-information is measured
in <strong>bits</strong>.</p>
<p>If the base of the logarithm is e, then the self-information is measures
in <strong>nats.</strong></p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/8384810674ba8a06fa7472b57dfe12d2f109b66a3681b9b10d29092dbd5a0771.png" src="../_images/8384810674ba8a06fa7472b57dfe12d2f109b66a3681b9b10d29092dbd5a0771.png" />
</div>
</div>
<p>It should be noted that this definition of self-information satisfies
the three conditions. Indeed:</p>
<ul class="simple">
<li><p>As <span class="math notranslate nohighlight">\(P(x)\)</span> gets larger, <span class="math notranslate nohighlight">\(I(x)\)</span> gets smaller and vice versa</p></li>
<li><p>The self-information for two independent variables <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span> is
given by:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[I(X = x,Y = y) = - \log P(X = x,Y = y)\]</div>
<ul class="simple">
<li><p>Since the variables are independent, <span class="math notranslate nohighlight">\(P(X,Y) = P(X)P(Y)\)</span>, hence:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[I(X = x,Y = y) = - \log\left\lbrack P(X = x)P(Y = y) \right\rbrack = - logP(X = x) - \log P(Y = y) = I(x) + I(y)\]</div>
<ul class="simple">
<li><p>Hence, also the additivity of the entropies of independent variables
is satisfied.</p></li>
</ul>
</section>
<section id="entropy">
<h3><span class="section-number">6.2. </span>Entropy<a class="headerlink" href="#entropy" title="Permalink to this heading">#</a></h3>
<p><em>Self-information is defined on a single outcome</em>. We can quantify the
amount of <strong>uncertainty</strong> in an entire probability distribution using
the <strong>Shannon entropy</strong>:</p>
<div class="math notranslate nohighlight">
\[H(X) = E_{X \sim P}\left\lbrack I(x) \right\rbrack = - E_{X \sim P}\left\lbrack \log{P(x)} \right\rbrack\]</div>
<p>In the case of a discrete variable:</p>
<div class="math notranslate nohighlight">
\[H(X) = - \sum_{x}^{}{P(x)logP(x)}\]</div>
<p>Where the summation is over all values of <span class="math notranslate nohighlight">\(x \in \ \chi\)</span>, with <span class="math notranslate nohighlight">\(\chi\)</span>
alphabet of <span class="math notranslate nohighlight">\(X\)</span>. In the case of a continuous variable, the sum is
substituted by an integral:</p>
<div class="math notranslate nohighlight">
\[H(X) = - \int_{}^{}{f(x)\log f(x)dx}\]</div>
<p>The Shannon entropy of a distribution is <strong>the expected amount of
information in an event drawn from that distribution</strong>.</p>
<p>The entropy is measured in <strong>bits</strong> or <strong>nats</strong> (depending on the base
of the logarithm) and can be interpreted as <strong>the amount of information
required on the average to describe the random variable</strong>.</p>
<p><strong>Example</strong></p>
<ul class="simple">
<li><p>Let’s consider a die with six faces.</p></li>
<li><p>We can describe the outcomes of rolling the die with a random
variable <span class="math notranslate nohighlight">\(X\)</span> with alphabet <span class="math notranslate nohighlight">\(\chi = \ \left\{ 1,\ldots,6 \right\}\)</span>.</p></li>
<li><p>If the die is fair, then <span class="math notranslate nohighlight">\(P(x) = \frac{1}{6},\ \forall x \in \chi\)</span>.</p></li>
<li><p>The entropy associated with this random variable is:
<span class="math notranslate nohighlight">\(H(X) = - \sum_{i = 1}^{6}{\frac{1}{6}\log}\frac{1}{6} = \log(6) = 2.58\ bits\)</span>.</p>
<ul>
<li><p>This makes sense as the minimum number of bits needed to
represent 8 numbers is 3 (<span class="math notranslate nohighlight">\(2^{3} = 8\)</span>). Since we have less than
8 numbers, in average we need less than 3 bits.</p></li>
</ul>
</li>
<li><p>Let’s suppose the die is not fair and in particular Let’s suppose
it follows a categorical distribution with
<span class="math notranslate nohighlight">\(\mathbf{p} = \lbrack 0.1,0.1,0.1,0.1,0.1,0.5\rbrack\)</span>.</p></li>
<li><p>Intuitively, we need less bits to represent this variable. Indeed,
since event <span class="math notranslate nohighlight">\(X = 6\)</span> is much more frequent, we can represent it with
the least number of bits, whereas we can represent less frequent
outcomes with more bits. In particular, the entropy of the variable
will be:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[H(X) = - \sum_{i = 1}^{5}{0.1\log{0.1}} - 0.5\log(0.5) = 2.16\ bits\]</div>
<ul class="simple">
<li><p>The number of bits required to represent the variable in average is
2.16 bits, smaller than in the case of the fair die.</p></li>
</ul>
<section id="entropy-of-a-bernoulli-variable">
<h4><span class="section-number">6.2.1. </span>Entropy of a Bernoulli variable<a class="headerlink" href="#entropy-of-a-bernoulli-variable" title="Permalink to this heading">#</a></h4>
<p>Let’s consider a variable <span class="math notranslate nohighlight">\(X\)</span> following a Bernoulli distribution with probability <span class="math notranslate nohighlight">\(p\)</span>, i.e.:</p>
<div class="math notranslate nohighlight">
\[\begin{split}X_p = \begin{cases}
1 &amp; \text{with probability } p\\
0 &amp; \text{with probability } 1-p
\end{cases}
\end{split}\]</div>
<p>Then the entropy of this variable will be:</p>
<div class="math notranslate nohighlight">
\[H(X_p) = -p\log p -(-1-p)\log(1-p)\]</div>
<p>If we plot <span class="math notranslate nohighlight">\(H(X_p)\)</span> with respect to <span class="math notranslate nohighlight">\(p\)</span>, we obtain the following graph:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/3eeb3c60bce46cead73ab1cf7fdf032e306d1997a51dee6136cd5ce7920b0291.png" src="../_images/3eeb3c60bce46cead73ab1cf7fdf032e306d1997a51dee6136cd5ce7920b0291.png" />
</div>
</div>
<p>The diagram above illustrates that entropy is maximum for <span class="math notranslate nohighlight">\(p=0.5\)</span>, which is coherent with our intuitive understanding of entropy.</p>
</section>
</section>
<section id="other-concepts-optional">
<h3><span class="section-number">6.3. </span>Other Concepts (Optional)<a class="headerlink" href="#other-concepts-optional" title="Permalink to this heading">#</a></h3>
<section id="joint-entropy-and-conditional-entropy">
<h4><span class="section-number">6.3.1. </span>Joint Entropy and Conditional Entropy<a class="headerlink" href="#joint-entropy-and-conditional-entropy" title="Permalink to this heading">#</a></h4>
<p>Given two random variables <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span>, we can define the <strong>joint entropy</strong> as:</p>
<div class="math notranslate nohighlight">
\[H(X,Y) = -\sum_{x \in \mathcal{X}}\sum_{y \in \mathcal{Y}} p(x,y) \log p(x,y)\]</div>
<p>We will define the <strong>conditional entropy</strong> as follows:</p>
<div class="math notranslate nohighlight">
\[H(X|Y) = -\sum_{x \in \mathcal{X}}\sum_{y \in \mathcal{Y}} p(x,y) \log p(x|y)\]</div>
<p>The conditional entropy measures the uncertainty over <span class="math notranslate nohighlight">\(X\)</span> when <span class="math notranslate nohighlight">\(Y\)</span> is known.</p>
</section>
<section id="kullback-leibler-divergence">
<h4><span class="section-number">6.3.2. </span>Kullback-Leibler Divergence<a class="headerlink" href="#kullback-leibler-divergence" title="Permalink to this heading">#</a></h4>
<p>The Kullback-Leibler divergence (also called KL-divergence) is a statistical distance measure which can be used to quantify the distance between two probability distributions (i.e., how much different they are from one another). For discrete probability distributions, this is defined as:</p>
<div class="math notranslate nohighlight">
\[D_{KL}(P || Q) = \sum_{x \in \chi} P(x)\log\left(\frac{P(x)}{Q(x)}\right)\]</div>
<p>where <span class="math notranslate nohighlight">\(P\)</span> and <span class="math notranslate nohighlight">\(Q\)</span> are the two distributions we want to compare and <span class="math notranslate nohighlight">\(\chi\)</span> is the sample space of such distributions. In practice, it is <strong>the expectation under the distribution P of the logarithmic difference (<span class="math notranslate nohighlight">\(\log\frac{P(x)}{Q(x)} = \log P(x)-\log Q(x)\)</span>) between the values of <span class="math notranslate nohighlight">\(P(x)\)</span> and <span class="math notranslate nohighlight">\(Q(x)\)</span>.</strong></p>
<p>The KL divergence measures the <strong>inefficiency of assuming that the distribution is <span class="math notranslate nohighlight">\(q\)</span> when the true distribution is <span class="math notranslate nohighlight">\(p\)</span></strong>.</p>
<p><strong>It should be noted that this distance measure is not symmetric.</strong></p>
<p>For two continuous densities <span class="math notranslate nohighlight">\(p\)</span> and <span class="math notranslate nohighlight">\(q\)</span>:</p>
<div class="math notranslate nohighlight">
\[D_{KL}(p || q) = \int_{\chi} p(x)\log\frac{p(x)}{q(x)}dx\]</div>
<p>The KL divergence is also called <strong>relative entropy</strong>.</p>
</section>
<section id="mutual-information">
<h4><span class="section-number">6.3.3. </span>Mutual Information<a class="headerlink" href="#mutual-information" title="Permalink to this heading">#</a></h4>
<p>Let us consider two random variables <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span> with a joint probability function <span class="math notranslate nohighlight">\(P(X,Y)\)</span>. We define the <strong>mutual information</strong> <span class="math notranslate nohighlight">\(I(X;Y)\)</span> as the <strong>relative entropy</strong> between the joint distribution and the product distribution:</p>
<div class="math notranslate nohighlight">
\[I(X;Y) = \sum_{x \in \mathcal{X}}\sum_{y \in \mathcal{Y}} p(x,y) \log \frac{P(x,y)}{P(x)P(y)}\]</div>
<p>if the KL divergence measures the inefficiency of using <span class="math notranslate nohighlight">\(q\)</span> when <span class="math notranslate nohighlight">\(p\)</span> is the real distribution, the mutual information measures the inefficiency of using the product <span class="math notranslate nohighlight">\(P(x)P(y)\)</span> instead of <span class="math notranslate nohighlight">\(P(x,y)\)</span>. As you may recall:</p>
<div class="math notranslate nohighlight">
\[P(X,Y)=P(X)P(Y) \Leftrightarrow X \perp Y \]</div>
<p>So:</p>
<ul class="simple">
<li><p>If the two variables are independent, then the mutual information will be equal to zero;</p></li>
<li><p>If the two variables are dependent, then the mutual information will be larger than zero.</p></li>
</ul>
<p>The mutual information allows to quantify how much information a variable will give about another one. <strong>Note that the mutual information is symmetrical.</strong></p>
<p>It can be shown that:</p>
<div class="math notranslate nohighlight">
\[I(X;Y) = H(X) - H(X|Y)\]</div>
<p>From which we observe that <strong>the mutual information between two variables X and Y is the reduction in the uncertainty about one variable when the other one is known.</strong></p>
</section>
<section id="data-processing-inequality">
<h4><span class="section-number">6.3.4. </span>Data Processing Inequality<a class="headerlink" href="#data-processing-inequality" title="Permalink to this heading">#</a></h4>
<p>We will say that random variables <span class="math notranslate nohighlight">\(X\)</span>, <span class="math notranslate nohighlight">\(Y\)</span>, and <span class="math notranslate nohighlight">\(Z\)</span> form a Markov Chain in that order (denoted as <span class="math notranslate nohighlight">\(X \to Y \to Z\)</span>) if we can write:</p>
<div class="math notranslate nohighlight">
\[P(X,Y,Z) = P(Z|Y) P(Y|X) P(X)\]</div>
<p>which means that we can obtain <span class="math notranslate nohighlight">\(Y\)</span> as a function of <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Z\)</span> as a function of only <span class="math notranslate nohighlight">\(Y\)</span> (without considering <span class="math notranslate nohighlight">\(X\)</span> anymore). In some sense, <span class="math notranslate nohighlight">\(Y\)</span> encodes whatever we need to encode about <span class="math notranslate nohighlight">\(X\)</span>.</p>
<p>Under these conditions, it can be proved that:</p>
<div class="math notranslate nohighlight">
\[I(X;Y) \geq I(X;Z)\]</div>
<p>which is known as the <strong>data processing inequality</strong>.</p>
<p>This is a fundamental results for data analysis which tells us that, no matter what if <span class="math notranslate nohighlight">\(Y\)</span> has been obtained from <span class="math notranslate nohighlight">\(X\)</span> with some process which induces information loss, there is no way to recover the lost information from <span class="math notranslate nohighlight">\(Y\)</span>.</p>
</section>
</section>
<section id="references">
<h3><span class="section-number">6.4. </span>References<a class="headerlink" href="#references" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Some parts of chapter 1 of [3].</p></li>
</ul>
<p>[3] Cover, Thomas M., and Joy A. Thomas. <em>Elements of information
theory</em>. John Wiley &amp; Sons, 2012.</p>
</section>
</section>
</div>
<div class="toctree-wrapper compound">
<span id="document-laboratories/03_intro_numpy"></span><section class="tex2jax_ignore mathjax_ignore" id="introduzione-a-numpy">
<h2><span class="section-number">7. </span>Introduzione a Numpy<a class="headerlink" href="#introduzione-a-numpy" title="Permalink to this heading">#</a></h2>
<p><strong>Numpy</strong> è la libreria di riferimento di <strong>scipy</strong> per il calcolo scientifico. Il cuore della libreria è costituito dai <strong>numpy array</strong> che permettono di gestire agevolmente operazioni tra vettori e matrici. Gli array di Python sono in generale <strong>tensori</strong>, ovvero strutture numeriche dal numero di dimensioni variabili, che possono dunque essere array monodimensionali, matrici bidimensionali, o strutture a più dimensioni (es. cuboidi 10 x 10 x 10). Per utilizzare gli array di numpy, dobbiamo prima importare il pacchetto <strong>numpy</strong>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span> <span class="c1">#la notazione &quot;as&quot; ci permette di referenziare il namespace numpy semplicemente con np in futuro</span>
</pre></div>
</div>
</div>
</div>
<section id="numpy-arrays">
<h3><span class="section-number">7.1. </span>Numpy Arrays<a class="headerlink" href="#numpy-arrays" title="Permalink to this heading">#</a></h3>
<p>Un array multidimensionale di numpy può essere definito a partire da una lista di liste, come segue:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">l</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">3</span><span class="p">]]</span> <span class="c1">#una lista contenente tre liste</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;List of lists:&quot;</span><span class="p">,</span><span class="n">l</span><span class="p">)</span> <span class="c1">#viene visualizzata così come l&#39;abbiamo definita</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="c1">#costruisco un array di numpy a partire dalla lista di liste</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Numpy array:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">a</span><span class="p">)</span> <span class="c1">#ogni lista interna viene identificata come una riga di una matrice bidimensionale</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Numpy array from tuple:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(((</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),(</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">))))</span> <span class="c1">#posso creare numpy array anche da tuple</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>List of lists: [[1, 2, 3], [4, 5, 2], [1, 8, 3]]
Numpy array:
 [[1 2 3]
 [4 5 2]
 [1 8 3]]
Numpy array from tuple:
 [[1 2 3]
 [4 5 6]]
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p><strong>🙋‍♂️ Domanda 1</strong></p>
<p>Qual è un vantaggio evidente degli array di numpy rispetto alle liste, visti gli esempi mostrati sopra?</p>
</div></blockquote>
<p>Ogni array di numpy ha una proprietà <em>shape</em> che ci permette di determinare il numero di dimensioni della struttura:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="c1">#si tratta di una matrice 3 x 3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(3, 3)
</pre></div>
</div>
</div>
</div>
<p>Vediamo qualche altro esempio:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span> 
<span class="n">matrice</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span> 
<span class="n">tensore</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="s1">&#39;d&#39;</span><span class="p">]],[[</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="s1">&#39;d&#39;</span><span class="p">]],[[</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="s1">&#39;d&#39;</span><span class="p">]],[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="s1">&#39;d&#39;</span><span class="p">]]])</span> 
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Array:&#39;</span><span class="p">,</span><span class="n">array</span><span class="p">,</span> <span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="c1">#array monodimensionale, avrà una sola dimensione</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Matrix:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">matrice</span><span class="p">,</span> <span class="n">matrice</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;matrix:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">tensore</span><span class="p">,</span> <span class="n">tensore</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="c1">#tensore, avrà due dimensioni</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Array: [1 2 3 4] (4,)
Matrix:
 [[1 2 3 4]
 [5 4 2 3]
 [7 5 3 2]
 [0 2 3 1]] (4, 4)
matrix:
 [[[&#39;1&#39; &#39;2&#39; &#39;3&#39; &#39;4&#39;]
  [&#39;a&#39; &#39;b&#39; &#39;c&#39; &#39;d&#39;]]

 [[&#39;5&#39; &#39;4&#39; &#39;2&#39; &#39;3&#39;]
  [&#39;a&#39; &#39;b&#39; &#39;c&#39; &#39;d&#39;]]

 [[&#39;7&#39; &#39;5&#39; &#39;3&#39; &#39;2&#39;]
  [&#39;a&#39; &#39;b&#39; &#39;c&#39; &#39;d&#39;]]

 [[&#39;0&#39; &#39;2&#39; &#39;3&#39; &#39;1&#39;]
  [&#39;a&#39; &#39;b&#39; &#39;c&#39; &#39;d&#39;]]] (4, 2, 4)
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p><strong>🙋‍♂️ Domanda 2</strong></p>
<p>In Numpy, esiste una differenza formale tra un array monodimensionale e una matrice contenente una unica riga (o una unica colonna)?</p>
</div></blockquote>
<p>Gli array di Numpy supportano le operazioni elemento per elemento. Vediamo le principali operazioni di questo tipo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span> 
<span class="n">a2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span> 
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sum:&quot;</span><span class="p">,</span><span class="n">a1</span><span class="o">+</span><span class="n">a2</span><span class="p">)</span> <span class="c1">#somma tra vettori</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Elementwise multiplication:&quot;</span><span class="p">,</span><span class="n">a1</span><span class="o">*</span><span class="n">a2</span><span class="p">)</span> <span class="c1">#moltiplicazione tra elementi corrispondenti</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Power of two:&quot;</span><span class="p">,</span><span class="n">a1</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="c1">#quadrato degli elementi</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Elementwise power:&quot;</span><span class="p">,</span><span class="n">a1</span><span class="o">**</span><span class="n">a2</span><span class="p">)</span> <span class="c1">#elevamento a potenza elemento per elemento</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Vector product:&quot;</span><span class="p">,</span><span class="n">a1</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">a2</span><span class="p">))</span> <span class="c1">#prodotto vettoriale</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Minimum:&quot;</span><span class="p">,</span><span class="n">a1</span><span class="o">.</span><span class="n">min</span><span class="p">())</span> <span class="c1">#minimo dell&#39;array</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Maximum:&quot;</span><span class="p">,</span><span class="n">a1</span><span class="o">.</span><span class="n">max</span><span class="p">())</span> <span class="c1">#massimo dell&#39;array</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sum:&quot;</span><span class="p">,</span><span class="n">a2</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span> <span class="c1">#somma di tutti i valori dell&#39;array</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Product:&quot;</span><span class="p">,</span><span class="n">a2</span><span class="o">.</span><span class="n">prod</span><span class="p">())</span> <span class="c1">#prodotto di tutti i valori dell&#39;array</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mean:&quot;</span><span class="p">,</span><span class="n">a1</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> <span class="c1">#media di tutti i valori dell&#39;array</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sum: [ 5  5 11  5]
Elementwise multiplication: [ 4  6 24  4]
Power of two: [ 1  4  9 16]
Elementwise power: [   1    8 6561    4]
Vector product: 38
Minimum: 1
Maximum: 4
Sum: 16
Product: 96
Mean: 2.5
</pre></div>
</div>
</div>
</div>
<p>Operazioni tra matrici:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span> 
<span class="n">m2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">8</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">]])</span> 

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sum:&quot;</span><span class="p">,</span><span class="n">m1</span><span class="o">+</span><span class="n">m2</span><span class="p">)</span> <span class="c1">#somma tra matrici</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Elementwise product:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">m1</span><span class="o">*</span><span class="n">m2</span><span class="p">)</span> <span class="c1">#prodotto elemento per elemento</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Power of two:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">m1</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="c1">#quadrato degli elementi</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Elementwise power:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">m1</span><span class="o">**</span><span class="n">m2</span><span class="p">)</span> <span class="c1">#elevamento a potenza elemento per elemento</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Matrix multiplication:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">m1</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">m2</span><span class="p">))</span> <span class="c1">#prodotto matriciale</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Minimum:&quot;</span><span class="p">,</span><span class="n">m1</span><span class="o">.</span><span class="n">min</span><span class="p">())</span> <span class="c1">#minimo</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Maximum:&quot;</span><span class="p">,</span><span class="n">m1</span><span class="o">.</span><span class="n">max</span><span class="p">())</span> <span class="c1">#massimo</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Minimum along columns:&quot;</span><span class="p">,</span><span class="n">m1</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span> <span class="c1">#minimo per colonne</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Minimum along rows:&quot;</span><span class="p">,</span><span class="n">m1</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="c1">#minimo per righe</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sum:&quot;</span><span class="p">,</span><span class="n">m1</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span> <span class="c1">#somma dei valori</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mean:&quot;</span><span class="p">,</span><span class="n">m1</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> <span class="c1">#valore medio</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Diagonal:&quot;</span><span class="p">,</span><span class="n">m1</span><span class="o">.</span><span class="n">diagonal</span><span class="p">())</span> <span class="c1">#diagonale principale della matrice</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Transposed:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">m1</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="c1">#matrice trasposta</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sum: [[ 9  4  4  8]
 [ 5  8  8  4]
 [11  9  5  2]
 [ 0  3 11  7]]
Elementwise product:
 [[ 8  4  3 16]
 [ 0 16 12  3]
 [28 20  6  0]
 [ 0  2 24  6]]
Power of two:
 [[ 1  4  9 16]
 [25 16  4  9]
 [49 25  9  4]
 [ 0  4  9  1]]
Elementwise power:
 [[   1    4    3  256]
 [   1  256   64    3]
 [2401  625    9    1]
 [   1    2 6561    1]]
Matrix multiplication:
 [[20 26 51 30]
 [48 37 57 42]
 [68 48 59 45]
 [12 21 26  8]]
Minimum: 0
Maximum: 7
Minimum along columns: [0 2 2 1]
Minimum along rows: [1 2 2 0]
Sum: 47
Mean: 2.9375
Diagonal: [1 4 3 1]
Transposed:
 [[1 5 7 0]
 [2 4 5 2]
 [3 2 3 3]
 [4 3 2 1]]
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p><strong>🙋‍♂️ Domanda 3</strong></p>
<p>Qual è il vantaggio di utilizzare le operazioni illustrate sopra? Che codice servirebbe per effettuare l’operazione <code class="docutils literal notranslate"><span class="pre">a1**a2</span></code> se <code class="docutils literal notranslate"><span class="pre">a1</span></code> e <code class="docutils literal notranslate"><span class="pre">a2</span></code> fossero delle liste di Python piuttosto che degli array di numpy?</p>
</div></blockquote>
</section>
<section id="linspace-arange-zeros-ones-eye-e-random">
<h3><span class="section-number">7.2. </span>Linspace, Arange, Zeros, Ones, Eye e Random<a class="headerlink" href="#linspace-arange-zeros-ones-eye-e-random" title="Permalink to this heading">#</a></h3>
<p>Le funzioni <strong>linspace</strong>, <strong>arange</strong>, <strong>zeros</strong>, <strong>ones</strong>, <strong>eye</strong> e <strong>random</strong> di <strong>numpy</strong> sono utili a generare array numerici al volo. In particolare, la funzione <strong>linspace</strong>, permette di generare una sequenza di <strong>n</strong> numeri equispaziati che vanno da un valore minimo a un valore massimo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span> <span class="c1"># genera 5 valori equispaziati che vanno da 10 a 20</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[10.  12.5 15.  17.5 20. ]
</pre></div>
</div>
</div>
</div>
<p><strong>arange</strong> è molto simile a <strong>range</strong>, ma restituisce direttamente un array di <strong>numpy</strong>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span> <span class="c1">#numeri da 0 a 9</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span> <span class="c1">#numeri da 1 a 5</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="c1">#numeri pari da 0 a 6</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0 1 2 3 4 5 6 7 8 9]
[1 2 3 4 5]
[0 2 4 6]
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p><strong>🙋‍♂️ Domanda 4</strong></p>
<p>È possibile ottenere lo stesso risultato di <code class="docutils literal notranslate"><span class="pre">arange</span></code> utilizzando <code class="docutils literal notranslate"><span class="pre">range</span></code>? Come?</p>
</div></blockquote>
<p>Possiamo creare array contenenti zero o uno di forme arbitrarie mediante <strong>zeros</strong> e <strong>ones</strong>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)))</span><span class="c1">#zeros e ones prendono come parametro una tupla contenente le dimensioni desiderate</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[0. 0. 0. 0.]
 [0. 0. 0. 0.]
 [0. 0. 0. 0.]]
[[1.]
 [1.]]
</pre></div>
</div>
</div>
</div>
<p>La funzione <strong>eye</strong> permette di creare una matrice quadrata identità:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[1. 0. 0.]
 [0. 1. 0.]
 [0. 0. 1.]]
[[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 0. 1. 0. 0.]
 [0. 0. 0. 1. 0.]
 [0. 0. 0. 0. 1.]]
</pre></div>
</div>
</div>
</div>
<p>Per costruire un array di valori casuali (distribuzione uniforme) tra 0 e 1 (zero incluso, uno escluso), basta scrivere:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span> <span class="c1">#un array con 5 valori casuali tra 0 e 1</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="c1">#una matrice 3x2 di valori casuali tra 0 e 1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0.4455531  0.15464262 0.73300802 0.83126699 0.4840601 ]
[[0.04519461 0.77306473]
 [0.81167333 0.33469426]
 [0.51806682 0.16306516]]
</pre></div>
</div>
</div>
</div>
<p>Possiamo generare un array di valori casuali distribuiti in maniera normale (Gaussiana) con <strong>randn</strong>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[-0.27659656 -1.47446936]
 [ 0.30758864  0.95848991]
 [-0.18955928  0.98689232]
 [-1.06568839  0.79190779]
 [ 0.63691861 -1.36459616]]
</pre></div>
</div>
</div>
</div>
<p>Parleremo più in dettaglio della distribuzione Gaussiana in seguito.</p>
<p>Possiamo generare numeri interi compresi tra un minimo (incluso) e un massimo (escluso) usando <strong>randint</strong>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="c1">#tre valori compresi tra 0 e 50 (escluso)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">50</span><span class="p">,(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span><span class="c1">#matrice 2x3 di valori interi casuali tra 0 e 50 (escluso)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[ 0 26 31]
[[ 7  9  8]
 [47  3 27]]
</pre></div>
</div>
</div>
</div>
<p>Per generare valori casuali in maniera replicabile, è possibile specificare un seed:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0.69646919 0.28613933 0.22685145 0.55131477 0.71946897]
</pre></div>
</div>
</div>
</div>
<p>Il codice sopra (inclusa la definizione del seed) restituisce gli stessi risultati se rieseguito:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0.69646919 0.28613933 0.22685145 0.55131477 0.71946897]
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p><strong>🙋‍♂️ Domanda 5</strong></p>
<p>Qual è l’effetto di ri-eseguire la cella precedente cambiando il seed?</p>
</div></blockquote>
</section>
<section id="max-min-sum-argmax-argmin">
<h3><span class="section-number">7.3. </span>max, min, sum, argmax, argmin<a class="headerlink" href="#max-min-sum-argmax-argmin" title="Permalink to this heading">#</a></h3>
<p>È possibile calcolare massimi e minimi e somme di una matrice per righe e colonne come segue:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">],[</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="o">-</span><span class="mi">12</span><span class="p">]])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mat</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span> <span class="n">mat</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span><span class="c1"># massimi per colonne</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mat</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="c1"># massimi per righe</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">mat</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span><span class="c1"># minimi per colonne</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mat</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="c1"># minimi per righe</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mat</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span><span class="c1"># somma per colonne</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mat</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="c1"># somma per righe</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mat</span><span class="o">.</span><span class="n">max</span><span class="p">())</span><span class="c1"># massimo globale</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mat</span><span class="o">.</span><span class="n">min</span><span class="p">())</span><span class="c1"># minimo globale</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mat</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span><span class="c1"># somma globale</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[  1  -5   0]
 [  4   3   6]
 [  5   8  -7]
 [ 10   6 -12]]

[10  8  6]

[ 1  6  8 10]

[  1  -5 -12]

[ -5   3  -7 -12]

[ 20  12 -13]

[-4 13  6  4]

10
-12
19
</pre></div>
</div>
</div>
</div>
<p>È inoltre possibile ottenere gli indici in corrispondenza dei quali si hanno massimi e minimi usando la funzione argmax:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">mat</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[3 2 1]
</pre></div>
</div>
</div>
</div>
<p>Abbiamo un massimo alla quarta riga nella prima colonna, uno alla terza riga nella seconda colonna e uno alla seconda riga nella terza colonna. Verifichiamolo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">mat</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mat</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mat</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mat</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>10
8
6
[10  8  6]
</pre></div>
</div>
</div>
</div>
<p>Analogamente:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">mat</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mat</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mat</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0 2 1 0]
[0 0 3]
[1 1 2 2]
</pre></div>
</div>
</div>
</div>
</section>
<section id="indicizzazione-e-slicing">
<h3><span class="section-number">7.4. </span>Indicizzazione e Slicing<a class="headerlink" href="#indicizzazione-e-slicing" title="Permalink to this heading">#</a></h3>
<p>Gli array di numpy possono essere indicizzati in maniera simile a quanto avviene per le liste di Python:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;arr[0]       -&gt;&quot;</span><span class="p">,</span><span class="n">arr</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1">#primo elemento dell&#39;array</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;arr[:3]      -&gt;&quot;</span><span class="p">,</span><span class="n">arr</span><span class="p">[:</span><span class="mi">3</span><span class="p">])</span> <span class="c1">#primi tre elementi</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;arr[1:5:2]   -&gt;&quot;</span><span class="p">,</span><span class="n">arr</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">:</span><span class="mi">2</span><span class="p">])</span> <span class="c1">#dal secondo al quarto (incluso) a passo 2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>arr[0]       -&gt; 1
arr[:3]      -&gt; [1 2 3]
arr[1:5:2]   -&gt; [2 4]
</pre></div>
</div>
</div>
</div>
<p>Quando si indicizza un array a più di una dimensioni con un unico indice, viene in automatico indicizzata la prima dimensione. Vediamo qualche esempio con le matrici bidimensionali:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(([</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]))</span> 
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Matrice:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">mat</span><span class="p">,</span><span class="n">mat</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="c1">#matrice 3 x 4</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;mat[0]     -&gt;&quot;</span><span class="p">,</span><span class="n">mat</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1">#una matrice è una collezione di righe, per cui mat[0] restituisce la prima riga</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;mat[-1]     -&gt;&quot;</span><span class="p">,</span><span class="n">mat</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="c1">#ultima riga</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;mat[::2]     -&gt;&quot;</span><span class="p">,</span><span class="n">mat</span><span class="p">[::</span><span class="mi">2</span><span class="p">])</span> <span class="c1">#righe dispari</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Matrice:
 [[1 5 2 7]
 [2 7 3 2]
 [1 5 2 1]] (3, 4)
mat[0]     -&gt; [1 5 2 7]
mat[-1]     -&gt; [1 5 2 1]
mat[::2]     -&gt; [[1 5 2 7]
 [1 5 2 1]]
</pre></div>
</div>
</div>
</div>
<p>Vediamo qualche esempio con tensori a più dimensioni:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tens</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span>
                <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span>
                <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]],</span>
                <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span>
                <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span>
                <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]]))</span> 
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Matrice:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">tens</span><span class="p">,</span><span class="n">tens</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="c1">#tensore 2x3x4</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;tens[0]    -&gt;&quot;</span><span class="p">,</span><span class="n">tens</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="c1">#si tratta della prima matrice 3x4</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;tens[-1]    -&gt;&quot;</span><span class="p">,</span><span class="n">tens</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="c1">#ultima mtraice 3x4</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Matrice:
 [[[1 5 2 7]
  [2 7 3 2]
  [1 5 2 1]]

 [[1 5 2 7]
  [2 7 3 2]
  [1 5 2 1]]] (2, 3, 4)
tens[0]    -&gt; [[1 5 2 7]
 [2 7 3 2]
 [1 5 2 1]]
tens[-1]    -&gt; [[1 5 2 7]
 [2 7 3 2]
 [1 5 2 1]]
</pre></div>
</div>
</div>
</div>
<p>L’indicizzazione può proseguire attraverso le altre dimensioni specificando un ulteriore indice in parentesi quadre o separando i vari indici con la virgola:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(([</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]))</span> 
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Matrice:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">mat</span><span class="p">,</span><span class="n">mat</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="c1">#matrice 3 x 4</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;mat[2][1]  -&gt;&quot;</span><span class="p">,</span><span class="n">mat</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="c1">#terza riga, seconda colonna</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;mat[0,0]   -&gt;&quot;</span><span class="p">,</span><span class="n">mat</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span> <span class="c1">#prima riga, prima colonna (notazione più compatta)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;mat[0]     -&gt; &quot;</span><span class="p">,</span><span class="n">mat</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1">#restituisce l&#39;intera prima riga della matrice</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;mat[:,0]   -&gt; &quot;</span><span class="p">,</span><span class="n">mat</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span> <span class="c1">#restituisce la prima colonna della matrice. </span>
                                <span class="c1">#I due punti &quot;:&quot; significano &quot;lascia tutto inalterato lungo questa dimensione&quot;</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;mat[0,:]   -&gt;&quot;</span><span class="p">,</span><span class="n">mat</span><span class="p">[</span><span class="mi">0</span><span class="p">,:])</span> <span class="c1">#notazione alternativa per ottenere la prima riga della matrice</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;mat[0:2,:] -&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">mat</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">,:])</span> <span class="c1">#prime due righe</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;mat[:,0:2] -&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">mat</span><span class="p">[:,</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">])</span> <span class="c1">#prime due colonne</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;mat[-1]    -&gt;&quot;</span><span class="p">,</span><span class="n">mat</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="c1">#ultima riga</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Matrice:
 [[1 5 2 7]
 [2 7 3 2]
 [1 5 2 1]] (3, 4)
mat[2][1]  -&gt; 5
mat[0,0]   -&gt; 1
mat[0]     -&gt;  [1 5 2 7]
mat[:,0]   -&gt;  [1 2 1]
mat[0,:]   -&gt; [1 5 2 7]
mat[0:2,:] -&gt;
 [[1 5 2 7]
 [2 7 3 2]]
mat[:,0:2] -&gt;
 [[1 5]
 [2 7]
 [1 5]]
mat[-1]    -&gt; [1 5 2 1]
</pre></div>
</div>
</div>
</div>
<p>Caso di tensori a più dimensioni:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mat</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="s1">&#39;d&#39;</span><span class="p">]],</span>
              <span class="p">[[</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="s1">&#39;d&#39;</span><span class="p">]],</span>
              <span class="p">[[</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="s1">&#39;d&#39;</span><span class="p">]],</span>
              <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="s1">&#39;d&#39;</span><span class="p">]]])</span> 
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;mat[:,:,0] -&gt;&quot;</span><span class="p">,</span> <span class="n">mat</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">])</span> <span class="c1">#matrice contenuta nel &quot;primo canale&quot; del tensore</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;mat[:,:,1] -&gt;&quot;</span><span class="p">,</span><span class="n">mat</span><span class="p">[:,:,</span><span class="mi">1</span><span class="p">])</span> <span class="c1">#matrice contenuta nel &quot;secondo canale&quot; del tensore</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;mat[...,0] -&gt;&quot;</span><span class="p">,</span> <span class="n">mat</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span> <span class="c1">#matrice contenuta nel &quot;primo canale&quot; del tensore (notazione alternativa)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;mat[...,1] -&gt;&quot;</span><span class="p">,</span><span class="n">mat</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span> <span class="c1">#matrice contenuta nel &quot;secondo canale&quot; del tensore (notazione alternativa)</span>
<span class="c1">#la notazione &quot;...&quot; serve a dire &quot;lascia tutto invariato lungo le dimensioni omesse&quot;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>mat[:,:,0] -&gt; [[&#39;1&#39; &#39;a&#39;]
 [&#39;5&#39; &#39;a&#39;]
 [&#39;7&#39; &#39;a&#39;]
 [&#39;0&#39; &#39;a&#39;]]
mat[:,:,1] -&gt; [[&#39;2&#39; &#39;b&#39;]
 [&#39;4&#39; &#39;b&#39;]
 [&#39;5&#39; &#39;b&#39;]
 [&#39;2&#39; &#39;b&#39;]]
mat[...,0] -&gt; [[&#39;1&#39; &#39;a&#39;]
 [&#39;5&#39; &#39;a&#39;]
 [&#39;7&#39; &#39;a&#39;]
 [&#39;0&#39; &#39;a&#39;]]
mat[...,1] -&gt; [[&#39;2&#39; &#39;b&#39;]
 [&#39;4&#39; &#39;b&#39;]
 [&#39;5&#39; &#39;b&#39;]
 [&#39;2&#39; &#39;b&#39;]]
</pre></div>
</div>
</div>
</div>
<p>In genere, quando da un array si estrae un sottoinsieme di dati, si parla di <strong>slicing</strong>.</p>
<blockquote>
<div><p><strong>🙋‍♂️ Domanda 6</strong></p>
<p>Le liste di Python non supportano lo slicing. Come si può implementare una istruzione del tipo <code class="docutils literal notranslate"><span class="pre">a[2:8:2]</span></code> utilizzando le liste di Python?</p>
</div></blockquote>
</section>
<section id="indicizzazione-e-slicing-logici">
<h3><span class="section-number">7.5. </span>Indicizzazione e Slicing Logici<a class="headerlink" href="#indicizzazione-e-slicing-logici" title="Permalink to this heading">#</a></h3>
<p>In numpy è inoltre possibile indicizzare gli array in maniera “logica”, ovvero passando come indici un array di valori booleani. Ad esempio, se vogliamo selezionare il primo e il terzo valore di un array, dobbiamo passare come indici l’array <code class="docutils literal notranslate"><span class="pre">[True,</span> <span class="pre">False,</span> <span class="pre">True]</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="kc">True</span><span class="p">])])</span> <span class="c1">#per selezionare solo 1 e 3</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="kc">False</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="kc">False</span><span class="p">])])</span> <span class="c1">#per selezionare solo 2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1 3]
[2]
</pre></div>
</div>
</div>
</div>
<p>L’indicizzazione logica è molto utile se combinata alla possibilità di costruire array logici “al volo” specificando una condizione che gli elementi di un array possono o non possono soddisfare. Ad esempio:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="o">&gt;</span><span class="mi">2</span><span class="p">)</span> <span class="c1">#genera un array di valori booleani</span>
<span class="c1">#che conterrà True in presenza dei valori di x</span>
<span class="c1">#che verificano la condizione x&gt;2</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span> <span class="c1">#True solo in presenza del valore 3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0 1 2 3 4 5 6 7 8 9]
[False False False  True  True  True  True  True  True  True]
[False False False  True False False False False False False]
</pre></div>
</div>
</div>
</div>
<p>Unendo questi due principi, è semplice selezionare solo alcuni valori da un array, sulla base di una condizione:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">x</span><span class="o">%</span><span class="k">2</span>==0]) #seleziona i valori pari
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">x</span><span class="o">%</span><span class="k">2</span>!=0]) #seleziona i valori dispari
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">x</span><span class="o">&gt;</span><span class="mi">2</span><span class="p">])</span> <span class="c1">#seleziona i valori maggiori di 2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0 2 4 6 8]
[1 3 5 7 9]
[3 4 5 6 7 8 9]
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p><strong>🙋‍♂️ Domanda 7</strong></p>
<p>Si considerino i due array <code class="docutils literal notranslate"><span class="pre">a=np.array([1,2,3])</span></code> e <code class="docutils literal notranslate"><span class="pre">b=np.array([5,2,4])</span></code>. Si utilizzi l’indicizzazione logica per estrarre i numeri in <code class="docutils literal notranslate"><span class="pre">a</span></code> che si trovano in posizioni contenenti valori pari in <code class="docutils literal notranslate"><span class="pre">b</span></code>.</p>
</div></blockquote>
</section>
<section id="reshape">
<h3><span class="section-number">7.6. </span>Reshape<a class="headerlink" href="#reshape" title="Permalink to this heading">#</a></h3>
<p>In alcuni casi può essere utile cambiare la “shape” di una matrice. Ad esempio, una matrice 3x2 può essere modificata riarrangiando gli elementi in modo da ottenere una matrice 2x3, una matrice 1x6 o una matrice 6x1. Ciò si può fare mediante il metodo “reshape”:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mat</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mat</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mat</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mat</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span> <span class="c1">#matrice 6 x 1</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mat</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span> <span class="c1">#vettore unidimensionale</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mat</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span><span class="c1">#equivalente al precedente, ma aparametrico</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[1 2]
 [3 4]
 [5 6]]
[[1 2 3]
 [4 5 6]]
[[1 2 3 4 5 6]]
[[1]
 [2]
 [3]
 [4]
 [5]
 [6]]
[1 2 3 4 5 6]
[1 2 3 4 5 6]
</pre></div>
</div>
</div>
</div>
<p>Notiamo che, se leggiamo per righe (da sinistra verso destra, dall’alto verso il basso), l’ordine degli elementi resta immutato. Possiamo anche lascire che numpy clacoli una delle dimensioni sostituendola con -1:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">mat</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mat</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[1 2 3]
 [4 5 6]]
[[1 2 3 4 5 6]]
</pre></div>
</div>
</div>
</div>
<p>Reshape può prendere in input le singole dimensioni o una tupla contenente la shape. Nell’ultimo caso, risulta comodo fare operazioni di questo genere:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mat1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">mat2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mat2</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">mat1</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span> <span class="c1">#diamo a mat2 la stessa shape di mat1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[0.72904971 0.43857224]
 [0.0596779  0.39804426]
 [0.73799541 0.18249173]]
</pre></div>
</div>
</div>
</div>
</section>
<section id="composizione-di-array-mediante-concatenate-e-stack">
<h3><span class="section-number">7.7. </span>Composizione di Array Mediante <code class="docutils literal notranslate"><span class="pre">concatenate</span></code> e <code class="docutils literal notranslate"><span class="pre">stack</span></code><a class="headerlink" href="#composizione-di-array-mediante-concatenate-e-stack" title="Permalink to this heading">#</a></h3>
<p>Numpy permette di unire diversi array mediante due principali funzioni: <code class="docutils literal notranslate"><span class="pre">concatenate</span></code> e <code class="docutils literal notranslate"><span class="pre">vstack</span></code>. La funzione <code class="docutils literal notranslate"><span class="pre">concatenate</span></code> prende in input una lista (o tupla) di array e permette di concatenarli lungo una dimensione (<code class="docutils literal notranslate"><span class="pre">axis</span></code>) esistente specificata, che di default è pari a zero (concatenazione per righe):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">cat</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cat</span><span class="p">,</span><span class="n">cat</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">cat2</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cat2</span><span class="p">,</span><span class="n">cat2</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[0 1 2]
 [3 4 5]
 [6 7 8]] (3, 3) 

[[0 1 2]
 [3 4 5]
 [6 7 8]
 [0 1 2]
 [3 4 5]
 [6 7 8]] (6, 3) 

[[0 1 2]
 [3 4 5]
 [6 7 8]
 [0 1 2]
 [3 4 5]
 [6 7 8]
 [0 1 2]
 [3 4 5]
 [6 7 8]] (9, 3)
</pre></div>
</div>
</div>
</div>
<p>E’ possibile concatenare array su una dimensione diversa specificandola mediante il parametro <code class="docutils literal notranslate"><span class="pre">axis</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">cat</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1">#concatenazione per colonne</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cat</span><span class="p">,</span><span class="n">cat</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">cat2</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1">#concatenazione per colonne</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cat2</span><span class="p">,</span><span class="n">cat2</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[0 1 2]
 [3 4 5]
 [6 7 8]] (3, 3) 

[[0 1 2 0 1 2]
 [3 4 5 3 4 5]
 [6 7 8 6 7 8]] (3, 6) 

[[0 1 2 0 1 2 0 1 2]
 [3 4 5 3 4 5 3 4 5]
 [6 7 8 6 7 8 6 7 8]] (3, 9)
</pre></div>
</div>
</div>
</div>
<p>Affinché la concatenazione sia compatibile, gli array della lista devono avere lo stesso numero di dimensioni lungo quelle che <strong>non vengono concatenate</strong>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">cat</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="c1">#concatenazione lungo l&#39;asse 0, le dimensioni lungo gli altri assi devono essere uguali</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(3, 6) (3, 3)
</pre></div>
</div>
</div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">cat</span><span class="p">,</span><span class="n">a</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="c1">#concatenazione per colonne #errore!</span>
</pre></div>
</div>
<p>La funzione <code class="docutils literal notranslate"><span class="pre">stack</span></code>, a differenza di <code class="docutils literal notranslate"><span class="pre">concatenate</span></code> permette di concatenare array lungo una nuova dimensione. Si confrontino gli output delle due funzioni:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cat</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cat</span><span class="p">,</span><span class="n">cat</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">stack</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">stack</span><span class="p">,</span><span class="n">stack</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[0 1 2]
 [3 4 5]
 [6 7 8]
 [0 1 2]
 [3 4 5]
 [6 7 8]] (6, 3)
[[[0 1 2]
  [3 4 5]
  [6 7 8]]

 [[0 1 2]
  [3 4 5]
  [6 7 8]]] (2, 3, 3)
</pre></div>
</div>
</div>
</div>
<p>Nel caso di <code class="docutils literal notranslate"><span class="pre">stack</span></code>, gli array sono stati concatenati lungo una nuova dimensione. E’ possibile specificare dimensioni alternative come nel caso di <code class="docutils literal notranslate"><span class="pre">concatenate</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stack</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">stack</span><span class="p">,</span><span class="n">stack</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[[0 1 2]
  [0 1 2]]

 [[3 4 5]
  [3 4 5]]

 [[6 7 8]
  [6 7 8]]] (3, 2, 3)
</pre></div>
</div>
</div>
</div>
<p>In questo caso, gli array sono stati concatenati lungo la seconda dimensione.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stack</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">stack</span><span class="p">,</span><span class="n">stack</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[[0 0]
  [1 1]
  [2 2]]

 [[3 3]
  [4 4]
  [5 5]]

 [[6 6]
  [7 7]
  [8 8]]] (3, 3, 2)
</pre></div>
</div>
</div>
</div>
<p>In questo caso, gli array sono stati concatenati lungo l’ultima dimensione.</p>
</section>
<section id="tipi">
<h3><span class="section-number">7.8. </span>Tipi<a class="headerlink" href="#tipi" title="Permalink to this heading">#</a></h3>
<p>Ogni array di numpy ha il suo tipo (si veda <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/user/basics.types.html">https://docs.scipy.org/doc/numpy-1.13.0/user/basics.types.html</a> per la lista di tipi supportati). Possiamo vedere il tipo di un array ispezionando la proprietà dtype:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">mat1</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>float64
</pre></div>
</div>
</div>
</div>
<p>Possiamo specificare il tipo in fase di costruzione dell’array:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]],</span><span class="nb">int</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mat</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>int64
</pre></div>
</div>
</div>
</div>
<p>Possiamo inoltre cambiare il tipo di un array al volo utilizzando <code class="docutils literal notranslate"><span class="pre">astype</span></code>. Questo è comodo ad esempio se vogliamo effettuare una divisione non intera:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">mat</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mat</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[0.5 1.  1.5]
 [2.  2.5 3. ]]
[[0.5 1.  1.5]
 [2.  2.5 3. ]]
</pre></div>
</div>
</div>
</div>
</section>
<section id="gestione-della-memoria-in-numpy">
<h3><span class="section-number">7.9. </span>Gestione della Memoria in Numpy<a class="headerlink" href="#gestione-della-memoria-in-numpy" title="Permalink to this heading">#</a></h3>
<p>Numpy gestisce la memoria in maniera dinamica per questioni di efficienza. Pertanto, un assegnamento o una operazione di slicing, in genere <strong>non creano una nuova copia dei dati</strong>. Si consideri ad esempio questo codice:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="n">b</span><span class="o">=</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[1 2 3]
 [4 5 6]]
[1 2]
</pre></div>
</div>
</div>
</div>
<p>L’operazione di slicing <code class="docutils literal notranslate"><span class="pre">b=a[0,0:2]</span></code> ha solo permesso di ottenere una nuova “vista” di una parte di <code class="docutils literal notranslate"><span class="pre">a</span></code>, ma i dati non sono stati replicati in memoria. Pertanto, se modifichiamo un elemento di b, la modifica verrà applicata in realtà ad <code class="docutils literal notranslate"><span class="pre">a</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=-</span><span class="mi">1</span>
<span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-1  2]
[[-1  2  3]
 [ 4  5  6]]
</pre></div>
</div>
</div>
</div>
<p>Per evitare questo genere di comportamenti, è possibile utilizzare il metodo <code class="docutils literal notranslate"><span class="pre">copy</span></code> che forza numpy a creare una nuova copia dei dati:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="n">b</span><span class="o">=</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=-</span><span class="mi">1</span>
<span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[1 2 3]
 [4 5 6]]
[1 2]
[-1  2]
[[1 2 3]
 [4 5 6]]
</pre></div>
</div>
</div>
</div>
<p>In questa nuova versione del codice, <code class="docutils literal notranslate"><span class="pre">a</span></code> non viene più modificato alla modifica di <code class="docutils literal notranslate"><span class="pre">b</span></code>.</p>
</section>
<section id="broadcasting">
<h3><span class="section-number">7.10. </span>Broadcasting<a class="headerlink" href="#broadcasting" title="Permalink to this heading">#</a></h3>
<p>Numpy gestisce in maniera intelligente le operazioni tra array che presentano shape diverse sotto determinate condizioni. Vediamo un esempio pratico: supponiamo di avere una matrice <span class="math notranslate nohighlight">\(2\times3\)</span> e un array <span class="math notranslate nohighlight">\(1\times3\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mat</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]],</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">arr</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mat</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[1. 2. 3.]
 [4. 5. 6.]]
[2 3 8]
</pre></div>
</div>
</div>
</div>
<p>Supponiamo adesso di voler dividere, elemento per elemento, tutti i valori di ogni riga della matrice per i valori dell’array. Possiamo eseguire l’operazione richiesta mediante un ciclo for:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mat2</span><span class="o">=</span><span class="n">mat</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="c1">#copia il contenuto della matrice per non sovrascriverla</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">mat2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span><span class="c1">#indicizza le righe</span>
    <span class="n">mat2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">mat2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="n">arr</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mat2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[0.5        0.66666667 0.375     ]
 [2.         1.66666667 0.75      ]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(3,)
</pre></div>
</div>
</div>
</div>
<p>Se non volessimo utilizzare cicli for, potremmo replicare <em>arr</em> in modo da ottenere una matrice <span class="math notranslate nohighlight">\(2 \times 3\)</span> e poi effettuare una semplice divisione elemento per elemento:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr2</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">arr</span><span class="p">,</span><span class="n">arr</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">arr2</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">mat</span><span class="o">/</span><span class="n">arr2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[2 3 8]
 [2 3 8]]
[[0.5        0.66666667 0.375     ]
 [2.         1.66666667 0.75      ]]
</pre></div>
</div>
</div>
</div>
<p>Lo stesso risultato si può ottenere semplicemente chiedendo a numpy di dividere mat per arr:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">mat</span><span class="o">/</span><span class="n">arr</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[0.5        0.66666667 0.375     ]
 [2.         1.66666667 0.75      ]]
</pre></div>
</div>
</div>
</div>
<p>Ciò avviene in quanto <strong>numpy</strong> confronta le dimensioni dei due operandi (<span class="math notranslate nohighlight">\(2 \times 3\)</span> e <span class="math notranslate nohighlight">\(1 \times 3\)</span>) e adatta l’operando con shape più piccola a quello con shape più grande, replicandone gli elementi lungo la dimensione unitaria (la prima). Il broadcasting in pratica generalizza le operazioni tra scalari e vettori/matrici del tipo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">mat</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">arr</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[ 2.  4.  6.]
 [ 8. 10. 12.]]
[ 4  6 16]
</pre></div>
</div>
</div>
</div>
<p>In generale, quando vengono effettuate operazioni tra due array, numpy compara le shape dimensione per dimensione, dall’ultima alla prima. Due dimensioni sono compatibili se:</p>
<ul class="simple">
<li><p>Sono uguali;</p></li>
<li><p>Una di loro è uguale a uno.</p></li>
</ul>
<p>Inoltre, le due shape non devono avere necessariamente lo stesso numero di dimensioni.</p>
<p>Ad esempio, le seguenti shape sono compatibili:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
 2 \times 3 \times 5 \\
 2 \times 3 \times 5
 \end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}
 2 \times 3 \times 5 \\
 2 \times 1 \times 5
 \end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}
 2 \times 3 \times 5 \\
 3 \times 5
 \end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}
 2 \times 3 \times 5 \\
 3 \times 1
 \end{split}\]</div>
<p>Vediamo altri esempi di broadcasting:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mat1</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">],[</span><span class="mi">7</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">2</span><span class="p">]],[[</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">9</span><span class="p">]]])</span>
<span class="n">mat2</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">7</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">2</span><span class="p">]])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mat1 shape&quot;</span><span class="p">,</span><span class="n">mat1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mat2 shape&quot;</span><span class="p">,</span><span class="n">mat2</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mat1</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">mat1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mat2</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">mat2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mat1*Mat2</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">mat1</span><span class="o">*</span><span class="n">mat2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mat1 shape (2, 2, 3)
Mat2 shape (2, 3)

Mat1
 [[[1 3 5]
  [7 6 2]]

 [[6 5 2]
  [8 9 9]]]

Mat2
 [[2 1 3]
 [7 6 2]]

Mat1*Mat2
 [[[ 2  3 15]
  [49 36  4]]

 [[12  5  6]
  [56 54 18]]]
</pre></div>
</div>
</div>
</div>
<p>Il prodotto tra i due tensori è stato effettuato moltiplicando le matrici bidimensionali <code class="docutils literal notranslate"><span class="pre">mat1[0,...]</span></code> e <code class="docutils literal notranslate"><span class="pre">mat2[0,...]</span></code> per <code class="docutils literal notranslate"><span class="pre">mat2</span></code>. Ciò è equivalente a ripetere gli elementi di <code class="docutils literal notranslate"><span class="pre">mat2</span></code> lungo la dimensione mancante ed effettuare un prodotto punto a punto tra <code class="docutils literal notranslate"><span class="pre">mat1</span></code> e la versione adattata di <code class="docutils literal notranslate"><span class="pre">mat2</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mat1</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">],[</span><span class="mi">7</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">2</span><span class="p">]],[[</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">9</span><span class="p">]]])</span>
<span class="n">mat2</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">]],[[</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">]]])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mat1 shape&quot;</span><span class="p">,</span><span class="n">mat1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mat2 shape&quot;</span><span class="p">,</span><span class="n">mat2</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mat1</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">mat1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mat2</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">mat2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mat1*Mat2</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">mat1</span><span class="o">*</span><span class="n">mat2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mat1 shape (2, 2, 3)
Mat2 shape (2, 1, 3)

Mat1
 [[[1 3 5]
  [7 6 2]]

 [[6 5 2]
  [8 9 9]]]

Mat2
 [[[1 3 5]]

 [[6 5 2]]]

Mat1*Mat2
 [[[ 1  9 25]
  [ 7 18 10]]

 [[36 25  4]
  [48 45 18]]]
</pre></div>
</div>
</div>
</div>
<p>In questo caso, il prodotto tra i due tensori è stato ottenuto moltiplicando tutte le righe delle matrici bidimensionali <code class="docutils literal notranslate"><span class="pre">mat1[0,...]</span></code> per <code class="docutils literal notranslate"><span class="pre">mat2[0]</span></code> (prima riga di mat2) e tutte le righe delle matrici bidimensionali <code class="docutils literal notranslate"><span class="pre">mat1[1,...]</span></code> per <code class="docutils literal notranslate"><span class="pre">mat2[1]</span></code> (seconda riga di mat2). Ciò è equivalente a ripetere tutti gli elementi di <code class="docutils literal notranslate"><span class="pre">mat2</span></code> lungo la seconda dimensione (quella contenente <span class="math notranslate nohighlight">\(1\)</span>) ed effettuare un prodotto punto a punto tra <code class="docutils literal notranslate"><span class="pre">mat1</span></code> e la versione adattata di <code class="docutils literal notranslate"><span class="pre">mat2</span></code>.</p>
</section>
<section id="esercizi">
<h3><span class="section-number">7.11. </span>Esercizi<a class="headerlink" href="#esercizi" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><p>🧑‍💻 Esercizio 1</p>
<p>Definire una matrice 3x4, poi:</p>
<ul class="simple">
<li><p>Stampare la prima riga della matrice;</p></li>
<li><p>Stampare la seconda colonna della matrice;</p></li>
<li><p>Sommare la prima e l’ultima colonna della matrice;</p></li>
<li><p>Sommare gli elementi lungo la diagonale principale;</p></li>
<li><p>Stampare il numero di elementi della matrice.</p></li>
</ul>
</div></blockquote>
<blockquote>
<div><p>🧑‍💻 Esercizio 2</p>
<p>Si generi un array di <span class="math notranslate nohighlight">\(100\)</span> numeri compresi tra <span class="math notranslate nohighlight">\(2\)</span> e <span class="math notranslate nohighlight">\(4\)</span> e si calcoli la somma degli elementi i cui quadrati hanno un valore maggiore di <span class="math notranslate nohighlight">\(8\)</span>.</p>
</div></blockquote>
<blockquote>
<div><p>🧑‍💻 Esercizio 3</p>
<p>Si generi la seguente matrice scrivendo la minore quantità di codice possibile:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span>
<span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span>
<span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span>
</pre></div>
</div>
<p>Si ripeta l’esercizio generando una matrice <span class="math notranslate nohighlight">\(25 \times 13\)</span> dello stesso tipo.</p>
</div></blockquote>
</section>
</section>
<span id="document-laboratories/04_intro_matplotlib"></span><section class="tex2jax_ignore mathjax_ignore" id="introduzione-a-matplotlib">
<h2><span class="section-number">8. </span>Introduzione a Matplotlib<a class="headerlink" href="#introduzione-a-matplotlib" title="Permalink to this heading">#</a></h2>
<p><strong>Matplotlib</strong> è la libreria di riferimento per la creazione di grafici in Python. Si tratta di una libreria molto potente e ben documentata (<a class="reference external" href="https://matplotlib.org/">https://matplotlib.org/</a>). Vediamo alcuni esempi classici di utilizzo della libreria.</p>
<section id="plot-bidimensionale">
<h3><span class="section-number">8.1. </span>Plot bidimensionale<a class="headerlink" href="#plot-bidimensionale" title="Permalink to this heading">#</a></h3>
<p>Vediamo come stampare la funzione:</p>
<div class="math notranslate nohighlight">
\[
y = x^2.
\]</div>
<p>Per stampare la funzione, dovremo fornire a matplotlib una serie di coppi di valori <span class="math notranslate nohighlight">\((x,y)\)</span> che verfichino l’equazione riportata sopra. Il modo più semplice per farlo consiste nel:</p>
<ul class="simple">
<li><p>Definire un vettore arbitrario di valori <span class="math notranslate nohighlight">\(x\)</span> estratti dal dominio della funzione;</p></li>
<li><p>Calcolare i rispettivi punti <span class="math notranslate nohighlight">\(y\)</span> utilizzando la forma analitica riportata sopra;</p></li>
<li><p>Eseguire il plot dei valori mediante matplotlib.</p></li>
</ul>
<p>I due vettori possono essere definiti così:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">300</span><span class="p">)</span> <span class="c1">#campioniamo in maniera lineare 300 punti tra -100 e 100</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="c1">#calcoliamo il quadrato di ognuno dei punti di x</span>
</pre></div>
</div>
</div>
</div>
<p>Procediamo alla stampa:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span> <span class="c1">#importo il modulo pyplot da matplotlib e lo chiamo plt</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="c1">#stampa le coppie x,y come punti nello spazio cartesiano</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span> <span class="c1">#imposta una etichetta per l&#39;asse x</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span> <span class="c1">#imposta una etichetta per l&#39;asse y</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Il mio grafico&#39;</span><span class="p">)</span> <span class="c1">#imposta il titolo del grafico</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> <span class="c1">#mostra il grafico</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/748a334c8fa426d74a4603d3b3fcd5a03c8747cad626f01780e6752b91d7d37d.png" src="../_images/748a334c8fa426d74a4603d3b3fcd5a03c8747cad626f01780e6752b91d7d37d.png" />
</div>
</div>
<p>E’ possibile controllare diversi aspetti del plot, tra cui i limiti degli assi x e y, la posizione dei “tick” (le lineette che orizzontali e verticali sugli assi) o aggiungere una griglia. Vediamo qualche esempio:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="c1">#stampiamo lo stesso plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span><span class="mi">50</span><span class="p">])</span> <span class="c1">#visualizziamo i valori x solo tra -20 e 40</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">2500</span><span class="p">])</span> <span class="c1">#e i valori y solo tra 0 e 4000</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([</span><span class="o">-</span><span class="mi">40</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">40</span><span class="p">])</span> <span class="c1">#inseriamo solo -40, 0 e 40 come &quot;tick&quot; sull&#39;asse x</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([</span><span class="mi">1000</span><span class="p">,</span><span class="mi">2000</span><span class="p">])</span> <span class="c1">#solo 1000 e 2000 come tick y</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span> <span class="c1">#aggiungiamo una griglia</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/31b5184ed716612e8d7c3a9e1050b4997c4bef96fe155f1ff54ed2316be9700f.png" src="../_images/31b5184ed716612e8d7c3a9e1050b4997c4bef96fe155f1ff54ed2316be9700f.png" />
</div>
</div>
</section>
<section id="subplot">
<h3><span class="section-number">8.2. </span>Subplot<a class="headerlink" href="#subplot" title="Permalink to this heading">#</a></h3>
<p>Spesso può essere utile confrontare diversi grafici. Per fare ciò, possiamo avvalerci della funzione subplot, che permette di costruire una “griglia di grafici”.</p>
<p>Vediamo ad esempio come stampare le seguenti funzioni in una griglia 2 x 2:</p>
<div class="math notranslate nohighlight">
\[
y=x^2, \ \ \ y=log(x), \ \ \  y=x^2 \cdot log(x), \ \ \  y=log(x)/x
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span> <span class="c1">#definisce una figura con una data dimensione (in pollici)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="c1">#definisce una griglia 2x2 e seleziona la prima cella come cella corrente</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">300</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="c1">#primo grafico</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;x^2&#39;</span><span class="p">)</span> <span class="c1">#imposta un titolo per la cella corrente</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="c1">#sempre nella stessa grliglia 2x2, seleziona la seconda cella</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">300</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="c1">#secondo grafico</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;log(x)&#39;</span><span class="p">)</span> <span class="c1">#imposta un titolo per la cella corrente</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="c1">#seleziona la terza cella</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">300</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="c1">#terzo grafico</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;x^2 log(x)&#39;</span><span class="p">)</span> <span class="c1">#imposta un titolo per la cella corrente</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="c1">#seleziona la quarta cella</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">300</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">x</span><span class="p">)</span> <span class="c1">#quarto grafico</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;log(x)/x&#39;</span><span class="p">)</span> <span class="c1">#imposta un titolo per la cella corrente</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> <span class="c1">#mostra la figura</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/805e66c91975c053cb568c94ca73b89882f3d0a16e7620616201eadb415a0bac.png" src="../_images/805e66c91975c053cb568c94ca73b89882f3d0a16e7620616201eadb415a0bac.png" />
</div>
</div>
</section>
<section id="colori-e-stili">
<h3><span class="section-number">8.3. </span>Colori e stili<a class="headerlink" href="#colori-e-stili" title="Permalink to this heading">#</a></h3>
<p>E’ possibile utilizzare diversi colori e stili per i grafici. Sotto alcuni esempi:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span><span class="mi">50</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">231</span><span class="p">)</span> <span class="c1">#versione abbreviata di plt.subplot(2,3,1)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="s1">&#39;--&#39;</span><span class="p">)</span> <span class="c1">#linea tratteggiata</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">232</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">)</span> <span class="c1">#solo punti</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">233</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> <span class="c1">#linea rossa, spessore 2</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">234</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="s1">&#39;o&#39;</span><span class="p">)</span> <span class="c1">#cerchietti</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">235</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="s1">&#39;o-g&#39;</span><span class="p">)</span> <span class="c1">#cerchietti uniti da linee verdi</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">236</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="s1">&#39;o--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span> <span class="c1">#cerchietti uniti da linee tratteggiate, spessore 0.5</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/e2c2425872911da283c3a6924206e01bacd6c555ba64e6f4c4cfa622b5eacb25.png" src="../_images/e2c2425872911da283c3a6924206e01bacd6c555ba64e6f4c4cfa622b5eacb25.png" />
</div>
</div>
</section>
<section id="sovrapposizione-di-linee-e-legenda">
<h3><span class="section-number">8.4. </span>Sovrapposizione di linee e legenda<a class="headerlink" href="#sovrapposizione-di-linee-e-legenda" title="Permalink to this heading">#</a></h3>
<p>E’ semplice sovrapporre più linee mediante <strong>matplotlib</strong>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="c1">#al secondo plot, matplotlib cambierà automaticamente colore</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;x^2&#39;</span><span class="p">,</span><span class="s1">&#39;x^3&#39;</span><span class="p">])</span> <span class="c1">#possiamo anche inserire una legenda. </span>
<span class="c1">#GLi elementi della legenda verranno associati alle linee nell&#39;ordine in cui sono stati plottati</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/bac78a62404d3a6e8ecea5e5d763297ef34d6f130bde1990d7834d49a94ebbe5.png" src="../_images/bac78a62404d3a6e8ecea5e5d763297ef34d6f130bde1990d7834d49a94ebbe5.png" />
</div>
</div>
</section>
<section id="griglie">
<h3><span class="section-number">8.5. </span>Griglie<a class="headerlink" href="#griglie" title="Permalink to this heading">#</a></h3>
<p>È spesso utile sovrapporre una griglia ai propri grafici. Ciò può essere fatto mediante <code class="docutils literal notranslate"><span class="pre">plt.grid()</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="c1">#al secondo plot, matplotlib cambierà automaticamente colore</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;x^2&#39;</span><span class="p">,</span><span class="s1">&#39;x^3&#39;</span><span class="p">])</span> <span class="c1">#possiamo anche inserire una legenda. </span>
<span class="c1">#GLi elementi della legenda verranno associati alle linee nell&#39;ordine in cui sono stati plottati</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/b3beed067913fbf8f7e9352f7520a1ab521526697af4f5c9629b66838c8153f3.png" src="../_images/b3beed067913fbf8f7e9352f7520a1ab521526697af4f5c9629b66838c8153f3.png" />
</div>
</div>
<p>Matplotlib è una librerira molto versatile. Sul sito ufficiale di Matplotlib è presente una galleria di esempi di plot con relativo codice (<a class="reference external" href="https://matplotlib.org/stable/gallery/index.html">https://matplotlib.org/stable/gallery/index.html</a>). Vedremo più in dettaglio come ottenere visualizzazioni più complesse durante il corso.</p>
</section>
<section id="esercizi">
<h3><span class="section-number">8.6. </span>Esercizi<a class="headerlink" href="#esercizi" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><p>🧑‍💻 Esercizio 1</p>
<p>Si scriva il codice per ottenere il seguente grafico:</p>
<p><img alt="image.png" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAYYAAAD8CAYAAABzTgP2AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAABhqADAAQAAAABAAAA/AAAAAA8yghQAAA75UlEQVR4Ae1dB5wURfZ+oCdmBV1BCQLmeOoC+vcMIwJm4czhBNNhOMV8gpHDrOcp5izoKYpgwHSeCKsohwoKKCiKiKKoYEKMp6f/79ua3p3dnZntmelQ1f3e7/emezpUvfqqu1+F916JKCkCioAioAgoAoqAIqAIKAKKgCKgCCgCioAioAgoAoqAIqAIKAKKgCKgCCgCioAioAgoAoqAIqAIKAKKgCKgCCgCioAioAgoAoqAIqAIKAKKgCKgCCgCioAioAgoAoqAIqAIKAKKgCIQNwIt4hagnPzXWGON3zp37lzOrXqPIqAIKAKpRWDatGmfo/BVzQGwbHMX2HieSmHq1Kk2iqYyKQKKgCJgLQItWrT4wI9wLf1cpNcoAoqAIqAIpAcBVQzpqWstqSKgCCgCvhBQxeALJr1IEVAEFIH0IKCKIT11rSVVBBQBRcAXAqoYfMGkFykCioAikB4EglIMdwGyReA3C0BHs9jrwHPBM8HbgD0agJ13s8x9JUVAEVAEFIEYEQhKMYxAGXYvUo49cG6DLA/E9ubstW2wvRC8LbhHdr81tuHQf/4jctllItwqKQKKgCLgEgIRfr+C8mN4Afh2LoJxX5y7B/wbeAp4dfDa4Az4WfCXYBL3qWBG8U+gRFB33VXkp59EWrUSee45kf/7v0Cz0MRSiACfq5oaPMmZhs9ToeMphEiLHAACfJ569hT5+WeR5ZYL/fsVlGJoruTtccGCnIs+wj6PFTqec2ndLnsaZFm8eHHdQd87fHn/+1+RX38V+eEHkRtuENluO5EWHOVSUgTKQMBrbPC5WhavUrduIm3QCf4S7Rye+w3toOWXD/0lLkNyvcUlBD6AT9rJJ4v8+KORms8bv2chNmxbRoRPvq8vew+FjucT6zYcxJsn3aqqmvXobno/W3TUtC1RZCqD++83L/LTT4tMnqxDTE0R0yPNIXDNNaYH+r//mZbcvHkiH6HNwy0bIFQM3kvcXFp6XhHwEGCjInfI+/LLRWbMMI2PZZYx3zF+z0KkqHoM7CF0zClHB+wvBPN4BuwRj9d4fwLdUrty+KgGye+4o8h774kMHSqy556mVRdRFy3QMmli8SHw4IMiY8aYRob3so4da1pxuT0JNkb4Ev/yi3mx45NYc3YBAe/ZYe+Az87EieY7dc45ptHB7xefpxB7C4SpJX8ioHHIoz+YPQSM38gS8CfgZ8B9wJxwJnOfx8IhgjlkiMgOO4gMGCAyZ47IkUea1h5bfdq6Cwf3pKX66KMihx9unqNnnxW56KKGw0VeI8Q7Pn68yD77mN5F0rDQ8gSLABUBh7pze5tt26JZ3dEoA36/QlYKLFBQPYZRSCsDXhPMXsCF4N+BSbeAnwKjaV5rrvo9tkeBSZx0xlslr/IPaBjYm4iuPRDqDzXywIEibP1xUpqVQaWhpAgUQuApPMoHHSTSvbvIk0+KrLKKmRRsfD1fXu8FnjVL5F//Ejn4YJGHHsKb4b0ajW/S/6lHgEqBxCFvGslkMrV/o/7JN8YftQwl51ddXf1boNFV2X3jZDTnHTi2N3hwyTLpDQlHgM9ITY2Zj1q40PQQVqdxnU+68UaRk04SOfBAM5H44ouRDAn4lE4vswGBTz4R2XRTkU6dTCNil13qGxcByYfoqtOQFOdqi1JQPYaimVh/0mvdcShp6FCRfv1ENt7YerFVwIgQ8MZ9+Xywl/nYYzC4LkEpUMy//MVYlZx5psjDDxvBmZaaTUdUiQ5kw8YpewyjR4tstFGsAqO/olSHACtmpZVEjj5ahHMOSooAEfj3v80L681DlbsWyBlniPTubSyWvLTYC1FSBIjAsGEi7EnGrBQoiioGouARJ3mGDzc26M8/7x3VbdoR+OILgwDHfdnKz2TKR+RvfzNWcJ4lUyVplS+F3mkTAvR7WbRIhM8EfWEsIB1KalwJtDbZYguR3/++8Rn9n0YEvoetBI0T+MLut1/l8wIctqQl09VXi1RXBz6GnMYqcr7MgwaJTJgA05y5IiuuaEVxtMfQuBro/OYphTfeMJZKja/R/+lB4BYY1bE1R2e2oEwFt99e5OOPRW6/3ZhIpwdNLWljBJ54QuS++0SOO84apUARVTE0rijv/5QpIltuaVqJnHxUSh8C7C1ccYVIr17BmjGz8UEjB4Y6GDkyfbhqiQ0CnLs67DCRrl1No8MiXFQxFKoMhjTgmDKdmXr21IishXBK8nFOENPPhfMCQdPuuyOecA+RSy7RXkPQ2LqQHhube+0lsnSp6T1OoxWpPaSKoVBd5E4+0/lNrUcKIZXc43Reo/cyh36CJu01BI2oW+nRw5lhUkjcWvZ9UcVgqqbpbyZjPA+9M+oR7SGRju2oUSLjEMmF3vBhEXsNhxwissYaYeWg6dqKAJ3XVljBWCJVaukWQhnVKqkQqLQeofPRTTdhdQh8JBg+WSkdCHz3ncipp5o5pn33Da/M7DXw2VJKFwIcpu7c2Xxf2FNgI9QLn2IJEtpjKFYRrKy77zZjgIyNo5QOBDxLpAsvjKa8nORmA4Se1UrJR4Dmygx7wSGkoCzdAkZNFUNzgHIBFjq+kdQb2uCQ5F/2Fq68MnhLpGKYTZpkQmaohVIxlJJz7uabEUsawaRpfGApqWLwUzFUCFwWlNpdKdkIMIAi/RYOOCC6cvbpg1XPtxW54AKRiy9WC7jokI8+pwULRB5/XOSYYxrOYUYvSdEcVTEUhSd7kq7qXLLxrrvql9fzc59e4xYCNCG89VYj82mnRfeB5lwDQ3J/+qlRDmyEqO+MW8+OX2np1EiDBjq0WUyqGPxWzgkniDBmDuPpKyUTAU4EcmKQFPWiTV4c/twFWowk+psUBDjycMcdZtVITj5bTEEpBtjdyRzwXHC+xQwQT0CmZ/kdbL8GewS06s5xpTc7ieZlG24owvFBpWQisNZaJkheHAHu+Hx5C/hYaL6YzAqPuFR8rmjpyDVfLCf0YSsmlFb4sUc84drV217F9lDwbHA+OhkHtwYfnT35LbYrZ/d9bQJfqMdXrriI8XJOPx1qDDrOi6fk9169zm4EliwxRgYMlMcgiplM9CaEDLnMieg48ra7dlS6gBCIcqEeTq2zpzAvK/sD2PYFF1IMVBoR2QFmJQpqc+SRIjQtbN8+qBQ1HVsQeOQRs7zrKaeYieA45KITJZnPmFKyEOD68uefb2JvdelifdmCGEriV3JBTkk/wn6hL+e6OEdUJuRcT8+xqeAp4H45x+3bpYnZuediZes17ZNNJaoMAUa4XG+9+E0IGVitqkqEkX2VkoMAfWMYd82SsNrNARuEYsg3HIVp97wE/38ZA+a8gkedsNMNfBj4WjDezrw0EEepQKYuXrw47wWRHOTkIOPzc3lHpWQgwLV2GQ+fkS5pIRQnbY1RVsbm4vrjSslAgD3AESNE9t+/3ifK8pIFoRjYQ+iYU84O2F+Y8z93l4phVO4B7HvXciiqBow3Iy/dhqNUIN2q2KKKk666SoTmjJdeqmaFcdZDUHmPHWuskQ7lKGfMxGebfg1UDJ6FVMwiafYVIsAIul9/LbLjjhUmFN3tQSgGTjZvAOYQ0XJgfvzzWRdthOOtwf8Be8T/rbJ/OD7zB3ChuYnsZTFv2KLki/v++2bMUG3OY66QALKnTTmj6W6ySQCJBZAEey4ffigyeXIAiWkSsSJAfxTPCunMM51pSAahGH4B8CeBnwG/BR4NngUeBs6NQMbmGCemc4eZ+CZyeGgGeCL4crDdigECSqusLmOLLmp7d+avFCwCNBPdaadg06wktX6YamPkTR1OqgRFO+6leapHDn0rYh5Q9RArbRubuaonJlsB7BbSYYUvMCvfsuiInqi6bQYBBq/7CKOh7O7HPb+QK+qdd4psvnl8FlK5suh++QjwW8FRBSoF+qfE/K2I0ly1fNBcvZNKgNZJw4ebSSVVCm7WJA0JrrtOZO217VIKRJOxdJTcR4CLPTGa6gsvOOWfEsRQkvuVV04JaJP81VcwsEW3X8lNBF57Df76c4w1ko0leBXTdxpx1caa8SfTZ5+ZNT3ouGhpeO1CBVHFUAiZ5o4zHDeHHtRypDmk7D3PMXzOL9CM0EbicNKJJ4owFLiSewh4KwDusYdzsqtiqKTKuG4rhyHefruSVPTeOBDg/NADsIXYc08TOTcOGZrLk9ZJtIHnB0bJPQToTd+1qwmx4pj0qhgqqbD11zex++nRqOQWAl9+CY+ZrUWOOMJeuRkeo2NHtU6yt4YKS/bNN2aimUPNNhk1FJa4wRlVDA3gKPEPX9pu8LlTxVAicDFfTksRhj+mAYGtw0iEqCVeTzrdPf20yHnnOWMDH3Pt2pE964yWSI7OQapiqPQx+uMfRV5+2awLXWlaen/4CHjmgzQecME5cbPNjFk0naRckDf8GnQjBw5RjoZL1/bbuyFvIylVMTQCpOS/XotAx4FLhi6WG2pqTCwizjEwJhH/20z0sWAcf3WmtLmWmspGM9UDDzR11/Ss9UdUMVRaRQyjwDUaGMNfyX4EMhkzRENJ6cHO/zYTF/ChY1QciwfZjIvNsk1BoOgrrxRZutRmKYvKpoqhKDw+TnJi6eqrTRx9H5frJTEjsN12Jmw6FXrMXqi+kKDzJEOCt21r1oNWZ0pfsMV60YgRCAg0rH5FvliFKS9zVQzl4dbwLnrQzkaIJ42h3xAXG//RtPjTT0W4II8rH9m99za+DO+9ZyOiKlMuAhzyY0h++i4sv3zuGaf2VTEEUV1UDJwYZCtByW4EnnrKyOeS0xGd8Hr3FqHsfNaU7EXglVdMw8Obe7RX0qKSqWIoCo/PkzQr7NvXmBX++KPPm/SyWBCgFRlNVTt1iiX7sjOllcvChSIzZ5adhN4YAQJ0amNUhL32iiCz8LJQxRAUtmwhMHRBbpjdoNLWdIJDgJ6oLgao2313gwHt45XsRYBWZBw9WH11e2X0IZkqBh8g+bqkZ0+RVVcVYYtByU4Epk3D+oGjjJmqnRIWloqhVwYOxHJYXQpfo2fiR4CGAo8/Hr8cFUqAPo9SIAjQpJDd/SeeMDbnHF5SsguB22834SVs9nYuhtittxY7q+fiRoATz3zvOSfkOAX19WI/dw54LnhwHkyOxLHF4OlZPhZbjwZg590sc99d4mIvjIh5xRUavsC2WuSkLSdve/UyfgG2yedXHoZ653CFkn0IbLONWQmQ3vWOUxA9Brhlyo1gmE0In1gEka9d8xn2mw3oQfzjEqC51AZ/LgQj4FDtkp/o69fei6ffQWL8dXo7WrJak4MIhifyrFkiCxYYX4Dwcgk3ZbZIN9xQZJ99RO66K9y8NPXSEGDkgxkzTMA8zjG44CNTpIRB9Bh6IH32FOaBETWqdl3nvtj6od1wEZY3EoS6FCoD7mdn2bDnGtXU1IdbcGh9V9dgLkteb9LWm8QtK5GYb+IwBeeyWBY1W425Mhpl7y2oxHpJwLsfhGJoD4jQFKsj9hp4rDFxNRTa2o0Bd8ye9Htv9nLLN5lMfWwUjjPyv5IdCLB7v+WWIh062CFPuVJwHosOetM5KqtkDQIMs01KSOiSIBQDYkI0IajNBsRp+s5gvJkyHjwSTPJzr7kSNhnYmUpevJjTFRYSPWlvu80IdtZZ7njWWghl4CKNQXvkmWcCTzbyBL0ej9cDilwAzbAJAhzio6LeDQMgF13k/DASyxeEYmAPwesBME02yRZyJ4e+wP5P2f+3Y1ud3fdzb/ZS4ReXcxHdqqqqvGP2bfv3F6F8779vn2xplojDMO3auY8AYyZV4/XxPLjdL5H7JfjhB5GjjhI5+WTn1nYuBP6yhU6UcJyTzRuAu4A/Bh8CPgycS2vjzyfZA/ti+1Z2n024S8Gts//7YDsku+/mhh8gTj6NR8eI440Ort7kJvBFpObaC/RIv+qqIhc5dIrlYFhnJTsQWGklE03VDmkCkSIIxfALJKG1ET/yy4BpLgETEBkG5tAPputlEJgKgdd+CT4STOI++l61lkz8z3t4zG1iXBuGLuCQ11pruV0W16Wncr77bhFGVU0KMRS3kj0I8F3faCMTxt0eqSqSJN8Yf0UJRnFzdXX1b1OnUudYStpTsKdi+NL+/vfGv+Too+2Rq1JJnn3WxE4aMKDSlPT+ShBgT7Q1BjxOOEHkH/+oJKVI7m3RosU0ZMQh+aKEcQ+lwBHwho+oIJTiRcCbpPUmbeOVJrjc2Qv661+Nl31wqWpKpSLw0ktmmJJmxAkiVQxhVSatk2gaSZtmpfgQ4CTtVluJrLNOfDKEkTPDhi9aJPL662Gkrmn6RYA9N0ZT3Xlnv3c4cZ0qhrCqiXMLDJOcAPf4sCAKPd3Jk0WWLEnW/IIHGk0jSYMH6zNmkIjnl4qBZuoJMwZQxRDW48QJQjq78MFRih4BKmTGRXrzTXjNjEzex5OruXHIktZvtILTBkj0z9jnn5seG41NEkaqGMKq0NVWE+nRw7y4YeWh6RZGoKbGDOP973+JCFHQpKAsn0cJCMHgFcWpLXsJTz4pcvjhTontR1hVDH5QKvcatiRefRVRoBgGSilSBDIZMzHLVjVDovN/kojl4ZrCCQnB4GTVtGpl1nbm4k8JoyD8GBIGSYDF2XdfkS++MFYLASarSflAoCOc8WkVxthC552XvPAkHNdmBE/2HKgk+F8pOgT4bF19tVEMm20WXb4R5aSKIUygGbqArBQ9AhMnmjy5RgatkpJIVAa0SrrmGlUMUdcv53gYD22FFUQSqBhaRo1n6vLjGLeaFEZf7RMmiLRpYyKqRp97dDl+iUABDz1keqbR5ao5eUYlCZx4ZuWqYgj7Eb/5ZhGu7DR/ftg5afoeAuzmUzHQMoyxq5JMnmNV7mR0kstrS9moGDp1QpS4DWyRKFA5Ev7WBIpVeYl5L67XwigvFb2rFAQYBnnIEJE//7mUu9y8tnt3EQZx84bO3CyFW1JzFIAND/YWvCgHbpWgWWlVMTQLUYUXbLKJ8bqlvblSNAjQUuf44018/GhyjC8XLgi1447mQxWfFOnK+e23Rb77ziiGhJZcFUPYFcsWBVsWtCBhS1YpfAQmTTLrO4efkx05cA3o9dbT8CtR1QYnmzm3Q6vDhJIqhigqlh64NFvVSejw0eb8wsEHi5x9dvh52ZLDiSeKPP648dewRaaky0HnNlokJZRUMURRsYzsSbNJvrwauiBcxOfMwZJQn5iJ53Bzsi91riSmFC4CnFtg7+z668PNJ+bUVTFEUQHvvity8cWGNa5NuIjzxSV5k/7mX/J/Bw1Kvmlu3LXIRh2j2s6bZ3wYEtzIC0oxoEksaKrJXDDCPTah03FkNhirpggG22VdsEeY4hespF3L47yDidrSlPCnn0SSGrfHpsqidQ7NCBMYpqAozGzFzsXr9+GHRS/TkxUgwPf4559NAr/8YrzOK0jO5luDUAzLoIA3gqFKZVPwodktNnUE98zaVYO2xHYM+Mq6MyLs/9I1lZzM2ZxMxsRsRwFrY7fzv1LwCHByn4qB/gsJNSMsCJq33KearRaEqOITue9tEuNv5QAUhGJACNHangL6V8JVaR4A9wXnEt5W+T57YAq2HXJPJn6foQvGZTtD/ftr+IKwKpzKgCtq0YchbbT55iJrrqlmq2HWuxf6gkqYVoYJjk8VhGJoj7pYkFMfH2GfxwrRMTjxdM7J5bHPBZypMPrlHG+8OxAHeN3UxYsXNz5n/38urMK1hzk+qRQOAlQMXJSdnDaihzc/WOwx0DJLKXgEPv3ULPp0wQWJVgoELoggengbm1ChJ/NPuJILUe+cc0cn7C8EdwVPAL8Bfg/cmLBWppClqqqqUPqN77HrP5f/u/12M9/AkL1KwSJw7bVmbiHB9uVFATvqKPPh4vg3Hd+UgkVgww1FuCpgCiiIHgN7CB1zsOIwET/0jakXDpwL5jwCZmLryLuWTeka8NZ1Z5K2k8lgRgVTKm9Q9ykFigA/hhdeaBZOCTRhhxKjxczpsPNQpRBOpXkTz+GkblWqQSiGV1GiDcBdwMuBDwE3ti7ix/5WMJXCIrBHrbHjNZ0xQCp/ANN6KZlEfwYuB9iNnSalQBGg8+A336TTfyEXSA6zTuGorFKgCCxdKtIanyv2+FNAQQwloakmJ4GfAdNC6S7wLPAwMOcEqCSuAq8MfghM+hBMJbEJmArjVzCV1OXg5CoGekom2FsSdRcfef4LnnVOfJLEm/Opp5qJUTr5pc0yK0zkadTA+EgpMYMOQjGwOp7Kcm7VXJDzh8NI+WgyDm6R70Rij9Ga4brrTAx9mrwpBYMAJ103hbV027bBpOdqKnTsu/9+kbfeMni4Wg7b5K6pMUN0CbZEyoWcrXSlKBFYssSYrk5lZ0opEARohcMVtdLm7ZwPPA8DrweV7xo9VjoCVAw9eoisuGLp9zp4hyqGqCttp51MjnzQlIJBgGPqtMjZb79g0nM5lS6Y6mvXTuSWWzQuV1D1+O23GBRHQy6TCSpF69NRxRB1FdEJic5Izz8fdc7JzI/xahh/irble+2lH0PiwQnoWZjm07hcwTzzDGfDaL0pMoNWxRDMo1NaKmx5cDIrReZvpQFUwtXsedEEWONQGdCIh+fg9l8EItCeaQkPU4FL11jDREfmUFJKSBVDHBVNyxkGPVu4MI7ck5XnH2jhDKIFTsLj15iCNvPLRgedJ7mKneLRDFg+T3MYKWUhzVUx+Hw2Ar2MY+EzZiDG7LqBJpvKxPgBJB12WOLj15iCNvNLqxlavh1xhAhDcafEiqYZVMo/zfmF7bYTueii8tNw8E5VDHFWmtflj1MG1/P25moYDkM/gqY2PRzuvLN+WMn1eo5LfobA4DAle2IpIlUMcVX2TTch1GB7nWeoFH8qBi+yaKVpJel+Wr/Ry3727CSVKvqycI5mWbh7bb999HnHmKMqhrjAr6oyS1C+9lpcEiQjXw7H7b9/MsoSZCkYsJHk9ajMP/0tFQHixxA2K69c6p1OX6+KIa7q815ctRqprAZuQ8DdoUMrSyOJd9OfoQPiWapiKL92GQLjlVdSN4xEwFQxlP/YVHbnWmuZkAX64paPI19cnafJjx+ttNj4mDkz/3k92jwCtOp6+mmRI49s/tqEXRFUrKSEwRJRcfji3nuvCENGcxxTqTQEDjpI5McfjRVOaXem4+obbhBZZZV0lDWMUjJ8ea9eYaRsfZraY4iziv74R5FjjzVRG+OUw8W8aSny4osi66/vovTRyLz66safIZrckpcLQ2y/+mryyuWjRKoYfIAU2iW9e4tcc43IaquFlkViE54+3ay/4M3VJLagFRbs/PNFzjmnwkRSePv334v85S8iY8aksPA6xxB/pU+aZFbdYowbJf8IeHMzqhiKY/bOOyL33KNzMcVRanqWPiAMWZPSMO7aY2j6SER3hMqgZ0/Ta9CAZ6XhTsXAsCL0BVEqjAAV58cfi7z/fuFr9ExDBPhecolU0nnnpTIwY1CKAWtWyhzwXPBgcGNC8BZ5EMzzL4M7gz0agh0e5/27eQdTsaWp6q+/mqJqwLPSqvzgg/Gk5XvUSksm8Vd7PSqvh5X4AgdQQL6XNAghpfS9DEIxLAP4bgTvAcYSWnJodotNHR2Dva/AnCnEoLpcASbx+kPAm4GpXG4CM710UCZjAp2xtC1RFfyv5A8BxkbixL1ScQS4qh1DvatiKI5T7tkddjD/UhyYMQjF0AMossU/D/xf8APgvuBc4v+R2QOczdkVDEPr2ut4/U9g9nWZDtNLBzGmDVfa4ovLkL5ejJt0lL78UnLZSq7Ypj4MzWPIj1tfvH4pWXmseUB8XLHjjua9PPfc1AZmXNYHTM1dwkHeBTkXfYT9bXP+czf3GvbRsL6lIMh57fEp2HrEewsNGg/EOTLWIcFCJEkhKgOarY4ebYJ1edFCk1K+MMrBRXnokfrBB2Gknrw077gjeWUKu0QMjU9OKQXRY0CTpAn91uhIoWsKHW90e+3f2/CLoCXSrYpxhpJExx2nliN+65O9hBdeMF69fu/R6wwC3ri54lEcgVNPFbn11uLXJPxsEIqBrfyOOTh1wP7CnP/czb1mWfxfDfxlo+P4K/nu5fFkU3W1WTZQvZ+br+e33xZZtEgVQ/NINbyCCxqdeGLDY/qvKQJcxpNKgc9ZiikIxUDXwA3AXcDLgTmZPA6cS/w/IHvgAGwxsC7sVfA4r6fVEu9nOhgjSCG9/npqnWlKqm1vEtWztinp5hRfzHmsmpoUA+Cz6ByiZJiVTMbnDcm8LAjFwDmDk8DPgDErKKPBs8DDwPuCSfAWqZ1TmIstDYQHg0m8jtfPBv8LDFdD+R84fXT99SIcUvLMV9OHgL8SUzGss47xYfB3h15FBLg+w7vvmlDvikhhBPh8ccKeE9ApJiDgHlVXV/82leuwJolGjjRRHLnk55ZbJqlkwZZl3jwz6ZziicGyAOX70r27yKhR6KOzk66UFwGGqeFQJd/DBFKLFi2moVicqy1KQfQYimagJ30i4A2NeEMlPm9L3WVdu6baWqTs+t5qKxNpVZ+vwhDSsIFWgX36FL4mJWc4EaxkAwKdO4t06mQckU4+2QaJ7JOBH7W5GI3s31+EIZGV/CNAw4a//hUzeV3835O2KzmE9C+OaCtpj8GmZyCTMaGk1XErf61cdpnIKaekNhRyflBKOMq4P+xxEUcN2tgUOH3v6jCBinSPEjnHwGpYAD9Bri3burV7lRK2xJMnizBUAV/eFVZIrUdqRTB7QRsZNZSrkz33nHrb5wK6L2xluIYFo9EmlHSOwcWK7dhRlUKhenvkkfoQGCkNbFYIGt/HGX6Fpphc5EgxbAgbnf8mTtQV77Ko6FBSw8cj/n8332y6+vFLYpcE3pwCJwfZ2uWwm1JpCDDEO4M1khRDg4P3+9prIt9+q46TWTxUMXgPhi1bLlc5fHh969gWueKWY+lS05saNkyHQMqtC8bloq8M6aGHdBjJIGF+a2rMlv4eSqKKwbaHgGarn30mwpW3lOoRuO46E6aAy1RqFNp6XErdGzDA3MGlK5XqEaDF20YbibRrV38sxXuqGGyrfPVnyF8jNCVca6385/SofwQYl4sGDhxPV6pHgO+d15uqP5raPVUMtlX9hhuadWbVEam+Zjjs8ac/mTHg+qO6Vw4C9Ge4916RQYPKuTu599DH47TTklu+EkumDm4lAhb65WwZc5Lwm29Cz8qZDB57zMwrrLSSMyJbLWi/flaLF7lwNBNv00ZEn6866FUx1EFh0c4//1lvPWKRWLGIQr8FDntkMia4WSxCJCxTmqqOHYuFdtc38ZMSVrySi3PSSWZOjysDKtUioENJNj4InkmhjbJFLRNDYCxcaBRD1HknNT8+X8cfj5jHdya1hP7LxWjGkyaJcL0KpToEVDHUQWHZDhe714VV6tcQYI9BKRgEOM/AsNKeiWYwqbqZyhtviHz1lfovNKo9VQyNALHmL7v79PZNe1wbeqQyXDQn5ZWCQ4Bhy+fMMb2x4FJ1L6W77zYy01JLqQ6BShUDZmzkWTBWAKnd5gvyg3i/8h8wF+WZCT4Y7NEI7LwPnp5lXqtEBBhp9dNPRRj4bNdd0xv07IQTsKYfVtXipLxScAh4PbA0W78xdtQNNxhMDz88ve9YnqeqUsUwGGk+B+aSnNzyf2OiJ01/8Gbg3cHXglcHe3QWdqgQyNO9g6nfMp4NiWOgaY1rw96CRrw0z0HQv1yfYbXV0v0x5FCa93yl9R0r8FxVqhj6It2R2bS57Zcnn3dwjD0KEmYRBcsjSRX/KBVB4OBsx4ot5bTGteHkaIcOZkWtIlDpqTIQYMypmejAX3ttGTcn5Bb2mlq1MovzpPUdK1CVlZqrtkW6n2TT5rY519QeuGY58HvZe7i5BHwB2Otx/MSDqafttzdLfX4CWC+8MJ1hIGimSsVYpe2IUN4HDlemmRh+/NJLRRgehHMuGmql7mnwoxjG4+p8AUTOrUvF387auOxe8AAwxkdqaQh+MZBeqyxuw/Zs8DBwPhqIg2RZvHhxvvPJO+ZNjCWvZM2XiF38mhqRXr10fqF5tMq7YskSkbMwkst1CPbeu7w0XL6Lhh0ffCAye7bLpQhFdj+KAW9mQUK0N+EHn70FbjlMlI9WxcEnwZhJlSk5F/A+0k/gu8Fn8k8BouIgowFZha9GSugnQENzurQF93r7bRNMkC05pXAQoCUOw41QCadNMXBO4YUXRI4+OhxsHU+1ZYXyj8P9A7JpcIvYBU1oORyB3aXcA8ZT2ICoTEgYL6idn3iz9p/+1CPQrZsILXPSRuwtkDKZ2o3+hIAA5xkYPC6NAfVeftkMIdHiT6kJApUqhsuRYm8wJ5e55X8SvmZyR+2eyEHY7gQ+EkyrI/JWYNJ9YHiY1PKa2F4MVspFYLvtzJCKZ6WUey7J+5tsIsJQBVyjWCk8BKh438OUH+MFpYm4rCk9wFl+pSYIsKXuHCV2zed8NfHAAyKHHmps+enopaQIBInAjBlopqGdxnWOjzgiyJTtTqtnTxOtlz4yKSJd8zkplc0HmMQWTlro889NUDPPxjwt5Y6jnFtsYRao4Qp5aaKnnhJ58ME0lbiksrYs6Wq9OHoEuDgNX940KQa+sFxNa/786PFOW44cTuFEf9rici2/vEiXLmmrbd/l9WOV5DsxvTAkBC7G1MsKK4SUuIXJjhljvHLpw6EvbzQVxPAQnIROgz3/jTeKsFdK/yClvAjoHENeWPRgbAi89JLIDjuY7KkM2VNSx6Nwq+Pxx0X6IogBnQnpCZx0zLfeGkF5Vk+lNZbOMYT7KkWf+uTJIhMmRJ9v1Dnmjvtq/Jpo0Gfoac7npCEuF3sK02EYqWaqRZ8tHUoqCo9FJ884wwjDLn+SyTPLpY29xq+JpqY5fES8iX3SMfd8NlQxFH22VDEUhceik3yQL4ebCNeCXpWO5AmlcxFpZZ116m3MdRgp/IomxoMHI2rZJSK33JLsoTsOk62yii5p2sxTpVZJzQBkzWkqBrbokh4/n0qBymHIkGR/oKx5sLKCeFZJXAMkycQQM7vtJsJV7JQKIqCKoSA0lp1gq44mdkk2W506VeTWW02oAsvgT7w4VMinnIJVU7hsSoKJgSlHj05wAYMpmiqGYHAMPxUqBVrreDGEws8x+hzuvVfktNPMMFL0uWuOXJthr72Si4PnMKmrATZbx9qfahYiiy5ga3pNhpRKKD3zjAnqRiWoFA8CjJnED2gS12o46iiRL78UGcfYn0rFENAeQzF0bDvHgHJJnXhmXHwuTs/xX6V4EKB5MD3O//73ePIPM1cqOzY8VlopzFwSk7YqBteqkt39q692Term5eVLS1LFYHCI45emqgzD7dVFHDKEledbb2FJMEysq5mqL4RVMfiCyaKLaJV0ww0WCRSQKHQ64vrOG28cUIKaTFkIUDG/807y4lR5RhuqGHw9FqoYfMFk0UV8sOfPN0syJsnZ7aabRBgCWicG433YvB7bv/8drxxB586V6lq3Nr2GoNNOYHqqGFyr1DXWMBJzOIlKIknKoU0b12ojefKyx9axY7KGk/iOTJki8vXXyXtnQnoCK1UMfJOfBXMFN26hkvMSPLPqVm/LNQnoguMvg3k/Yi0LBjmViiLw/vvmNCfTkhJLiEru8MNNrJ6ihdeToSPAHtuIEcbLPvTMIsqAJt6MA5WkdyZk6CpVDPCjF/iYywbZLf/nox9wcKss75tzwRXYvwbM+78CHwNWKoYA49p4XptJiWvDbv68eeq/UKzeozzHxaE24CuZEGIPiO+Kxt/yXaGVKgbE6pWR2dy47ec7Z4wm41o8gTIme0+p95eQVYIupQc0W0CXXpqM8Mi0K3/1VbVGsu0RHTVKZOxY26QqTx6+K1tuKXLRRcl4Z8pDoaS7KnVwa4vcPsnmyC2WG8tLy+Mo4h3IL+DLwY+COViOQb/aY9jIR+D23FFqBoE//EGE/AvhdJzGjzfdfG/S0/HiJEb86683sbn239/tIr33nghNVYcPFxk0yO2yRCi9nx4D3lx5Mw+zt+CXOuHCbuDDwNeC1wOzx9CYMHBekAbiDJXL1MWLFxe8KDUn/vY3kU02MeOmLheaNvNcNKV7d5dLkTzZ+/QxPbkvvnC7bFyEiLT33marv74Q8KMYeiGlzfPwYzj2GXhtMInbRbV7TX8WZg9hIFlqwFuDPwfjiyBer6UD9r3rsNuEbsMRKpduVVVVTU6m7gBt/ufOFeEiKy7T2nhs+vevnzdxuSxJkp09OE7Wevb/rpbtiSdENt1UhFEDlHwj4EcxFEuMFkYDshdwS2XRmFrjQKvswTWxxRiIzAazdzARfACYVOh+c1Z/GyKw557mv9cianjWnX9cz5rdfCW7EGAPjj05l72glywxYeq1t1Dys1WpYuB8QW/wu9kt/5PYsr+jdg8DHthyCGgGmIqA11AxkM4Gnw5G07d2zuFObJX8IMCWNl9etohcJU48s1WqZB8CtHzrhcECl3ukK68s8sILIscdZx++lkuUb5zfcpFFqqurf5vK2P1pp2HDRIYONd6caxWa97cYJA5X/Phj8hcfsrgKiorG1QK52pl6oxeFyaWTLVq0mAZ52XAvSpX2GIomridDRuAAjMJxSUYXW901NSITJoi0axcySJp82Qgwki89hi+7zD0Pe652eNZZIjNnll38NN+oPYY0135cZWeIAjrqcZlFOh5RSejaznHVRuF8WU877WTMoldYwS0fgJdeMgtbPfigyEEHFS5jys5ojyEtFc6PKwOecesKUREwnAeJLTv+V7IPAdYL64fkWvgVGmVwnkT9Y0z9lfirQ0klAmbd5XQQ48PPcNyuEJco5fAXx67ZY8hkXJE8XXKyXlg/pJb4VLhUTzTKYG9ntdWM/PpbEgKobSWnEWBcG3bzXTJb3W47EU6c01qEdvI6jGTnI8h64TwQzVa32cademKgyVmz1KmtgqdKFUMF4FlxK5UCzQqpGFyZhP7d70TOP1/k5pvd+dhYUdkxCLH99iJ//rPINBizfMU4lw4QlQKX8NxnHweEtVNEVQx21ktpUvEF4JrJfCFsJ8Z3+sc/EBnrI9slVfk8BA45xEzgLl3qHbF7S4c2hvJYf3275bRYOlUMFleOb9H22stc6oKzG+dCzjhD5JVXfBdPL4wZAQ4j3XefSKdOMQviI3uv19yqlY+L9ZJCCKhiKISMS8fXWUfkxRdFTjvNfqm59gK7+XvsYb+sKmFDBBil1PZew8MPmxDb7EErlY2AKoayobPsRobhtr2VxGEkvrjs4XBuRMkdBF5/3QSjY/3ZTJxr4zBl+/Y2S2m9bKoYrK8inwL+8IOJUjpggL1eqoxbw5DpBx7os1B6mTUIbLWVGUpij89Wos/FY48ZObn4k1LZCKhiKBs6y25ki+7ee0XuucfeBc/5snIYyYsMaxmEKk4RBOhzwhAsdKb8+usiF8Z46vbbjWwM/LfrrvY2kGKEyG/Wqhj8ImX7dZzU9YKd2eqlejaC6S5YILLiirajqfLlQ4A9vZ9/Fhk3Lt/Z+I/deaeR4ddf3fPUjh+9BhKoYmgAh8N/Mhk3vFRbt3YY5JSLvu22Ih07YpX2MXYCQYMG+sgss4x61FdYQ+gfukcadrtAnTHoGbv7HK55550CF8V0mCaqnBR84IH6nk1Momi2FSAweTIW5l1PpG3bChIJ8Va+A4zxxIaSetQ3AVqD6DWBJAUH+CKcd555cb/91p4Cc1KQdvDcesNd9kinkpSCAD2hbVQKjzxiPLP5DgwZokqhlDrNc22lQ0ltkOaz4Hez23zjBLvg3PQc/hH7/cCkEWAENqk7D9MHpYoQOOEEkaefFuHqVbYQfSw++0ytkWypj0rlGD3aLBBVaTpB3c/YSPvtJ3LjjUGlmPp0KlUMg4Hgc+ANslv+b0wTcYAffHJP8PdgmDbU0VnY885PrzuqO5UhwEleL7R1ZSlVfjdNHJdf3vgvVJ6aphA3AhyuuRwr9HKFNxto5EjTE6WptlIgCFSqGPpCCtRKLXHbL7tfaIMBcEFztlY5FLpGj1eKAM1C113XjoirHD4aO9aYqNrUi6kU4zTfT+skrv9hQ0RfWiCNGGECSXJiXCkQBCpVDJyB+iQrCbfNLTyMaFwyKnu9t7kEOzPB14BbeQfzbAfiGBd6nrqYTlJKhRFgbBuGybj77sLXRHWGE4EboEPJsWmlZCDAsOlrrilyCV5d9h7iJD5fDH9x1FFxSpG4vP0ohvEo9Zt5mL2FUmhtXLwF+JmcmzBLJBuDu4PbgM8GF6LbcKIbuaqqqtA1epwI0Fyvf38z1/AJ9XVMxI8GI7/SkoVhtuP+iMQEQ+Kyffll40jG2ElcDyTOeqXDHRfj6dfcYEXiaiHUAvlRDL0gweZ5GL7nghlF4QefxO2i2r38P1x49REwPGTqiF+t38A/gdm87QFWCgKBI48UYTeb3tBx0ZNPmiEHDifZ6nQXFzYu58tWOp8tEh3e+D8uuuwyNFvRbtXYW4HWgB/FUCzDcTg5IHsBt1QWhehQnBjV6KSnVFrgOFU+eyZKQSCw4YYiDKzH8VcvFHEQ6ZaSBnsr/ICow1EpqNl/bSZjAjbGXa/e8rAdOtiPmWMSLluhvDBNENiuyTHgD8GYlaolDvkcDz7W/JXO2HJm6Pnsf29zH3Y4LkTFQIsk3qMUFALDh5tlGePwHWBQP4ZOoHJiNFV+TNThKKiajTcd1iOXZGVPgftc+jMOoqcz564uuCCO3BOdZ6WKAcskya55EOIksacUeHo+uD13GlHPRv/1b5AIVFcHmVppaTGY3+efm/AJO+9c2r16tf0IUCGQd9vNTP7Oni3SsmV0cs+Zg9nKZ0ywvOhyTU1OEdZkajC1q6Bcq/fQQ2Eg/H10cnH4iMt3UjHttFN0+WpO0SNA3wF+pJ96Ktq8aXHHoawjjog235Tkpooh6RVNJyTGJ6I5X1TWI3PnmjV3GR8pjmGspNepTeWjTwP9B66+OjqpJk0SuekmEZrNtmsXXb4pykkVQ9Ire7nlzMeZYQyiilHPie8PP9QQGEl/tlg+RjM95RQz3/Daa+GXmI2bXr3MEqN05IyqsRN+yazKQRWDVdURgjBcNc0jeqtywjBM+uorEyyPay4sW+kUVpiCatqBIXAsphNXWcUESgws0QIJ8fnlErEkmkGH/TybnFL3q29u0qs8kzFximglRPO+sMf8TzwRIRXfFWFrToeRkv50mfLRweyVV0TYUwyb+DxzbXP6xbA3zP9KgSOgiiFwSC1L0DMtvP560+3vRkvikIjDRwyYd+qpqhRCgtjaZDfe2IjGVjwnhcOg774TueMORGcbKcJ5LCoFPt9KgSOgiiFwSC1M0DMtDFs0+k2QBg0yW/1NFwIPPoigNohqM2OGCVMRdOn//neRu+4yhhSc9FYKDYGWoaWsCduJAM0Kb745eNmefVbkhhtM7JxOnYJPX1O0HwGu7MaAdjSPDnpS+OOPRa680hg07LCD/Vg4LqEqBscrsGTx//lPkdNPF+F6DUERPwL0bua4Lye7g/4oBCWnphMuAoybRCc3LhQVtAXcOeeYSecrrgi3DJp6LQKqGNL2IDDoGInLHwZFtAzxgqrRYkQtRYJC1q10cuv9xx+Dew6mIpACPek5d9Wli1uYOCqtKgZHK65ssbmAD3sMXIOZliSVEicEN9/cWIjEHVSt0rLo/ZUhkMkYiyFao9ECrnPnytLz7m6PaDonnSTCXoNSJAigBt2j6urq36ayFaFUHgJLlxrTwq5dRbgec7lmpXz5Dz8coRGfN5YiNFHlx0EtRcqrlyTcxWHE8eNNYL2TT05CiRJVhhYtWiBGTu26NkXLpYqhKDwJPnn//WYugCEFevYs72NOE1haIHElL23NJfhhqaBoVBRbbCFSzrKubHDQq5o9XC48pVQxAqoYKoYw4QnwheUEoecoxDDKpbT0X3rJ9A4Y+vjRR6ONrJnwqklM8WhJxF7pfvuJsCFSSs908mQRRuXlnBUd2iZOLO35TAyIwRbEr2JoGWy2mpozCHCikEqBDkn0ih4xwr/on30mctBBIpyv4KQgLVGUFIHGCHBuYOhQE8SRvUu/xHkretB7oS/UoMEvcoFdV+kbTS+TWeBfwcVcanfH+TngueDBYI+6YOdl8LvgB8HLgZWiQCCTqZ8wZkvuzjtF6KDGeYNixJ7GddcZpfDww/Et0lJMRj1nDwJ0eNt3XxFG2r31VhFaxfEZKkQ0o2bUVDrJMdaWGjQUQirU40C+InoTd6OfKKjxgrQMztwI7g3+CIwZShkHng2+AnwNGHGh5RbwMeAQvK+QqlJDBDhs5K3CxXUTGMaY5oBTpojcfnvTMWEqDIa74FgvW3CMU8OWnZIiUAwB9iYZwoKWayecYHqXfHYKDV2usYZI27YmjDcD87Fny0ZMKcOcxeTRc74QqFQxvOUjlx64hj2FedlrqQT6gnlvT/BhYBKeHhkKVsUAECIhvmzeC8dQxnQeOu88c6x7d7M0J8MqMwbShAkNneI4DMWX1rs/EoE1EycR4NKf++9vepocuuSzQ6OFfv3MPBej/l5+uelV8DmkF703H6HPVyxVXqli8CM0BhoF/cM6+gh724LRNJCvwWh+1hKP81qlOBBgy45Ob73RsaNzEiemOfdAWnVVkT59RA45RIRjxfRwZauPLTklRcAPAnx22BP1jB2WLDGNEDZEPGIvgpZIqgw8RGLb4mvQLI3HFRwyasxs9fshDGA3IQ5kFzre5OLsgYHY0nlh6uLFiwtdo8crRYDRV7lCFl9gEsd4OU7MYSTGqmHP4aKLCg8FmLv0VxFoiAA/9vzwe8/OO++ILFpk4ip5vQN6z7MXqhQ7An56DL0qlJI9gY45aXTA/kLw52D0MYUysNfgHcduXroNR8lSVVXVzAxp3vv1oF8E2BNgj8Br3e2yS/2dfMG1RVePh+75R6Dxs1NVJUInOJo7e8+a9kL94xnilX4UQ6XZc7J5A3AX8Mdg9Clr5xX4cZ8IPgDMeYcB4MfASnEj4LXu2Hrji6qKIO4aSW7++qxZWbf5hnNKEfSPuBiDzgLVXztfMB3b3cDrgO8A7wkmcXstGOMSchf4EjCpK5hKoQ34dfCfwJiJKk4aEqM4PnpWEVAEFIF8CPh1cKtUMeTLO/RjqhhCh1gzUAQUgQQi4FcxtExg2bVIioAioAgoAhUgoIqhAvD0VkVAEVAEkoiAKoYk1qqWSRFQBBSBChBQxVABeHqrIqAIKAJJREAVQxJrVcukCCgCikAFCDhplYTy0vX5gwrKXejWNXGCjneukuvyE3fXy+C6/FoHdrz9YT1H66J4dC9QKgEBhtxwmVyXn9i7XgbX5dc6sOMLEOtzpENJdjwEKoUioAgoAtYgoIrBmqpQQRQBRUARsAMBhqhQaojAtIZ/nfvnuvwE3PUyuC6/1oEdr30SniM7kFQpFAFFQBFQBBQBRUARUAQUAUVAEQgdgZORwxzwLDBWp3GSzoTUDG1OszfX6CoI/DZ4JvgRMNftcIF2h5B8buaCB7sgcI6MXDOFYfDfAvO5PwXsInF4nJGan3BReMjMZ30MmM8/6wILoCjZgMAuEGI8uFVWmLVsEKpEGfiSPwOmr4eLiqEP5PbWCsFC1EK2nfhBeg/cFYxVjmQGeFOwK7Q2BN0mK+wq2GKJNafkz4oup2PnfrCrimEkZD82Wxg+R640irIiJ3czGkXr5Xjx2OL4PXg+2EXFALHriGt+3Ff3z94dtuyojD0agh2yq8RFs3o7JnwHyPscuCfYRcWAxdXlfXALcKyk5qpN4d8Qh3YEvwx+Htwd7BLtC2G5Uh5brEmgo1GIpx0oSHvIuCBHzo+wz2MuUmcIvTWY74BLxMXA/grG4tFOEnubjOpwN5jDYXeAVwJHTl53PfKMY86QQ0Xt8shwLo4Rk9bg7cBUCuxBsMI4Xm8LFZP/HAjZxxZBi8hRrAxsrZJYH7+AXegx5Gvl2fTMEE8/tDIuGgs+FfyNnxssuWZvyLEITBPPDNhF4reHw3mc46RSHg7mXNX5YKWYEfgX8s/kyMBx46qc/zbvbgHh+HLMzzI/qh+C8ylBHLaaBkC6/4BXtFrKeuGSMJT0OxSHw2Ecp3eNLoPA7KXNB38K/h78T7BLxPd0fo7AHLl4Mue/7saIwPHIe1g2fw4rcXggX2swe4nVm/mQzsU5Blr3zAa7opAham1Pcx62XcCcNJwB3gzsCvEZvwfM4RjXKYMCuDjHQNwngTfiDmgomBZ6ShYgwJeaLY03wa+Be4JdpfkQ3EXFMBdyUyFPz/It2LpAe0JIWvOwl8lhMJdoBwjLoa+ZYA93lsdFykBoVxXDVpB9Kpj18CiYw9pKioAioAgoAoqAIqAIKAKKgCKgCCgCioAioAgoAoqAIqAIKAKKgCKgCCgCioAioAgoAoqAIqAIKAKKgCKgCCgCioAioAgoAoqAIqAIKAKKgCKgCCgCioAioAgoAopAOhD4f/G7RMTdgm07AAAAAElFTkSuQmCC" /></p>
</div></blockquote>
</section>
</section>
<span id="document-laboratories/05_intro_pandas"></span><section class="tex2jax_ignore mathjax_ignore" id="introduzione-a-pandas">
<h2><span class="section-number">9. </span>Introduzione a Pandas<a class="headerlink" href="#introduzione-a-pandas" title="Permalink to this heading">#</a></h2>
<p>Abbiamo visto come Python, unito a numpy e matplotlib possa essere un potente strumento per il calcolo scientifico. Esistono tuttavia altre librerie che forniscono una maggiore astrazione per una più agevole gestione e analisi dei dati. In questo laboratorio vedremo le basi di della libreria Pandas, utile per l’analisi dei dati. In particolare vedremo:</p>
<ul class="simple">
<li><p>Come creare e gestire serie di dati (Pandas Series);</p></li>
<li><p>Come creare e gestire DataFrame di Pandas;</p></li>
<li><p>Esempi su com manipolare i dati di un DataFrame.</p></li>
</ul>
<p>Pandas è una libreria di alto livello che mette a disposizione diversi strumenti e strutture dati per l’analisi dei dati. In particolare, Pandas è molto utile per caricare, manipolare e visualizzare i dati i maniera veloce e conveniente prima di passare all’analisi vera e propria. Le due strutture dati principali di Pandas sono le <code class="docutils literal notranslate"><span class="pre">Series</span></code> e i <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>.</p>
<section id="series">
<h3><span class="section-number">9.1. </span>Series<a class="headerlink" href="#series" title="Permalink to this heading">#</a></h3>
<p>Una <code class="docutils literal notranslate"><span class="pre">Series</span></code> è una struttura monodimensionale (una serie di dati) molto simile a un array di numpy. A differenza di esso, i suoi elementi possono essere indicizzati mediante delle etichette, oltre che mediante numeri. I valori contenuti in una serie possono essere di qualsiasi tipo.</p>
<section id="creazione-di-series">
<h4><span class="section-number">9.1.1. </span>Creazione di Series<a class="headerlink" href="#creazione-di-series" title="Permalink to this heading">#</a></h4>
<p>E’ possibile definire una <code class="docutils literal notranslate"><span class="pre">Series</span></code> a partire da una lista o da un array di numpy:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span> <span class="c1">#impostiamo un seed per ripetibilità</span>
<span class="n">s1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span><span class="c1"># alternativamente print(pd.Series(np.array([7,5,2])))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    7
1    5
2    2
3    8
4    9
5    6
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>I numeri visualizzati sulla sinistra rappresentano le etichette dei valori contenute nella serie, che, di default sono di tipo numerico e sequenziale. Durante la definizione di una serie, è possibile specificare delle opportune etichette (una per ogni valore):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">valori</span> <span class="o">=</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">6</span><span class="p">]</span>
<span class="n">etichette</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="s1">&#39;e&#39;</span><span class="p">,</span><span class="s1">&#39;f&#39;</span><span class="p">]</span>
<span class="n">s2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">valori</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">etichette</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>a    7
b    5
c    2
d    8
e    9
f    6
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>E’ possibile definire una serie anche mediante un dizionario che specifica contemporaneamente etichette e valori:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s3</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span><span class="mi">14</span><span class="p">,</span><span class="s1">&#39;h&#39;</span><span class="p">:</span><span class="mi">18</span><span class="p">,</span><span class="s1">&#39;m&#39;</span><span class="p">:</span><span class="mi">72</span><span class="p">})</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>a    14
h    18
m    72
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Opzionalmente, è possibile assegnare un nome a una serie:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Mia Serie&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    1
1    2
2    3
Name: Mia Serie, dtype: int64
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p><strong>🙋‍♂️ Domanda 1</strong></p>
<p>Qual è la principale differenza tra <code class="docutils literal notranslate"><span class="pre">Series</span></code> di Pandas e <code class="docutils literal notranslate"><span class="pre">array</span></code> di Numpy?</p>
</div></blockquote>
</section>
<section id="indicizzazione-di-series">
<h4><span class="section-number">9.1.2. </span>Indicizzazione di Series<a class="headerlink" href="#indicizzazione-di-series" title="Permalink to this heading">#</a></h4>
<p>Quando gli indici sono numerici, le serie possono essere indicizzate come gli array di numpy:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">s1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1">#indicizzazione</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s1</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">:</span><span class="mi">2</span><span class="p">])</span> <span class="c1">#slicing</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>7
0    7
2    2
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Quando gli indici sono delle più generiche etichette, l’indicizzazione avviene in maniera simile, ma non è possibile utilizzare lo slicing:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">s2</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2
</pre></div>
</div>
</div>
</div>
<p>Chiaramente, è possibile modificare i valori di una serie mediante l’indicizzazione:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s2</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">4</span>
<span class="n">s2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>a    7
b    5
c    4
d    8
e    9
f    6
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Qualora l’indice specificato non esistesse, un nuovo elemento verrà creato:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s2</span><span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">]</span><span class="o">=-</span><span class="mi">2</span>
<span class="n">s2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>a    7
b    5
c    4
d    8
e    9
f    6
z   -2
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Qualora volessimo specificare più di una etichetta alla volta, potremmo passare una lista di etichette:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">s2</span><span class="p">[[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="s1">&#39;d&#39;</span><span class="p">]])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>a    7
c    4
d    8
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Le serie con etichette alfanumeriche possono essere indicizzate anche seguendo l’ordine in cui i dati sono inseriti nella serie, in un certo senso “scartando” le etichette alfanumeriche e indicizzando gli elementi in maniera posizionale. Questo effetti si ottiene mediante il metodo <code class="docutils literal notranslate"><span class="pre">iloc</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">s2</span><span class="p">,</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Elemento di indice &#39;a&#39;:&quot;</span><span class="p">,</span><span class="n">s2</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Primo elemento della serie:&quot;</span><span class="p">,</span><span class="n">s2</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>a    7
b    5
c    4
d    8
e    9
f    6
z   -2
dtype: int64 

Elemento di indice &#39;a&#39;: 7
Primo elemento della serie: 7
</pre></div>
</div>
</div>
</div>
<p>In certi casi, può essere utile ripristinare la numerazione degli indici. Ciò può essere fatto usando il metodo <code class="docutils literal notranslate"><span class="pre">reset_index</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">s3</span><span class="p">,</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s3</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span><span class="c1">#drop=True indica di scartare i vecchi indici</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>a    14
h    18
m    72
dtype: int64 

0    14
1    18
2    72
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Le serie ammettono anche l’indicizzazione logica:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="c1">#serie s1</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s1</span><span class="o">&gt;</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="c1">#indicizzazione logica per selezionare gli elementi maggiori di 2</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s1</span><span class="p">[</span><span class="n">s1</span><span class="o">&gt;</span><span class="mi">2</span><span class="p">],</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="c1">#applicazione dell&#39;indicizzazione logica</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    7
1    5
2    2
3    8
4    9
5    6
dtype: int64 

0     True
1     True
2    False
3     True
4     True
5     True
dtype: bool 

0    7
1    5
3    8
4    9
5    6
dtype: int64 
</pre></div>
</div>
</div>
</div>
<p>E’ possibile specificare la combinazione tra due condizione mediante gli operatori logici “|” (or) e “&amp;” (and), ricordando di racchiudere gli operandi tra parentesi tonde:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">s1</span><span class="o">&gt;</span><span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">s1</span><span class="o">&lt;</span><span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    False
1     True
2    False
3    False
4    False
5    False
dtype: bool
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s1</span><span class="p">[(</span><span class="n">s1</span><span class="o">&gt;</span><span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">s1</span><span class="o">&lt;</span><span class="mi">6</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1    5
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Analogamente per l’or:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">s1</span><span class="o">&lt;</span><span class="mi">2</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">s1</span><span class="o">&gt;</span><span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0     True
1    False
2    False
3     True
4     True
5    False
dtype: bool
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">s1</span><span class="p">[(</span><span class="n">s1</span><span class="o">&lt;</span><span class="mi">2</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">s1</span><span class="o">&gt;</span><span class="mi">6</span><span class="p">)])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    7
3    8
4    9
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Come nel caso degli array di Numpy, l’allocazione della memoria è gestita dinamicamente per le Serie. Pertanto, se assegno una serie ad una nuova variabile e modifico la seconda variabile, verrà modificata anche la prima:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s11</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">s12</span><span class="o">=</span><span class="n">s11</span>
<span class="n">s12</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=-</span><span class="mi">1</span>
<span class="n">s11</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0   -1
1    2
2    3
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Per ottenere una nuova Serie indipendente, possiamo usare il metodo <code class="docutils literal notranslate"><span class="pre">copy</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s11</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">s12</span><span class="o">=</span><span class="n">s11</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">s12</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=-</span><span class="mi">1</span>
<span class="n">s11</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    1
1    2
2    3
dtype: int64
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p><strong>🙋‍♂️ Domanda 2</strong></p>
<p>Cosa stampa a schermo il seguente codice?</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">s</span><span class="o">%</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</div></blockquote>
</section>
<section id="tipi-di-dato">
<h4><span class="section-number">9.1.3. </span>Tipi di dato<a class="headerlink" href="#tipi-di-dato" title="Permalink to this heading">#</a></h4>
<p>Le <code class="docutils literal notranslate"><span class="pre">Series</span></code> possono contenere diversi tipi di dato:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mf">2.5</span><span class="p">,</span><span class="mf">3.4</span><span class="p">,</span><span class="mf">5.2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    2.5
1    3.4
2    5.2
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Ad una <code class="docutils literal notranslate"><span class="pre">Series</span></code> viene associato un unico tipo di dato. Se specifichiamo dati di tipi eterogenei, la <code class="docutils literal notranslate"><span class="pre">Series</span></code> sarà di tipo “object”:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mf">2.5</span><span class="p">,</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="mf">5.2</span><span class="p">])</span>
<span class="n">s</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    2.5
1      A
2    5.2
dtype: object
</pre></div>
</div>
</div>
</div>
<p>E’ possibile cambiare il tipo di dato di una serie al volo con <code class="docutils literal notranslate"><span class="pre">astype</span></code> in maniera simile a quanto avviene con gli array di Numpy:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">45</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0     2
1     3
2     8
3     9
4    12
5    45
dtype: int64
0     2.0
1     3.0
2     8.0
3     9.0
4    12.0
5    45.0
dtype: float64
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p><strong>🙋‍♂️ Domanda 3</strong></p>
<p>Considerata la Series definita come segue:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mf">2.5</span><span class="p">,</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="mf">5.2</span><span class="p">])</span>
</pre></div>
</div>
<p>quali delle seguenti operazioni restituiscono un errore? Perché?</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">),</span> <span class="n">s</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</section>
<section id="dati-mancanti">
<h4><span class="section-number">9.1.4. </span>Dati Mancanti<a class="headerlink" href="#dati-mancanti" title="Permalink to this heading">#</a></h4>
<p>In Pandas, è possibile specificare Series (e come vedremo anche DataFrame) con dati mancanti. Per indicare tali valori, viene utilizzato il valore <code class="docutils literal notranslate"><span class="pre">np.nan</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">missing</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>
<span class="n">missing</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    2.0
1    5.0
2    NaN
3    8.0
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>I valori <code class="docutils literal notranslate"><span class="pre">NaN</span></code> (not a number) indicano dei valori che possono essere mancanti per diversi motivi (es. dati risultato di operazioni non validi, dati che non sono stati raccolti correttamente, ecc).</p>
<p>In molti casi, può essere utile scartare i dati <code class="docutils literal notranslate"><span class="pre">NaN</span></code>. Ciò si può fare con l’operazione <code class="docutils literal notranslate"><span class="pre">dropna()</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">missing</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    2.0
1    5.0
3    8.0
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Alternativamente, possiamo sostituire i valori <code class="docutils literal notranslate"><span class="pre">NaN</span></code> con un valore specifico con <code class="docutils literal notranslate"><span class="pre">fillna</span></code>. Sostituiamo i <code class="docutils literal notranslate"><span class="pre">NaN</span></code> con zero:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">missing</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">missing</span><span class="p">)</span>

<span class="n">missing</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    2.0
1    5.0
2    NaN
3    8.0
dtype: float64
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    2.0
1    5.0
2    0.0
3    8.0
dtype: float64
</pre></div>
</div>
</div>
</div>
</section>
<section id="operazioni-su-e-tra-series">
<h4><span class="section-number">9.1.5. </span>Operazioni su e tra Series<a class="headerlink" href="#operazioni-su-e-tra-series" title="Permalink to this heading">#</a></h4>
<p>Sono definite sulle serie le principali operazioni disponibili per gli array di numpy:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Min:&quot;</span><span class="p">,</span><span class="n">s1</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Max:&quot;</span><span class="p">,</span><span class="n">s1</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mean:&quot;</span><span class="p">,</span><span class="n">s1</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Min: 2
Max: 9
Mean: 6.166666666666667
</pre></div>
</div>
</div>
</div>
<p>Vediamo come sostiuire i valori mancanti di una serie con il valore medio:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">data</span>

<span class="n">data</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0     1.000000
1     5.000000
2     2.000000
3     3.888889
4     5.000000
5     2.000000
6     6.000000
7     3.888889
8     9.000000
9     2.000000
10    3.000000
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Si noti che la funzione <code class="docutils literal notranslate"><span class="pre">mean</span></code> ha semplicemente ignorato i valori <code class="docutils literal notranslate"><span class="pre">NaN</span></code>.</p>
<p>E’ possibile ottenere la dimensione di una serie mediante la funzione <code class="docutils literal notranslate"><span class="pre">len</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>6
</pre></div>
</div>
</div>
</div>
<p>E’ possibile ottenere delle statistiche sui valori univoci (ovvero i valori della serie, una volta rimossi i duplicati) contenuti in una serie mediante il metodo <code class="docutils literal notranslate"><span class="pre">unique</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Unique:&quot;</span><span class="p">,</span><span class="n">s1</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span> <span class="c1">#restituisce i valori univoci</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Unique: [7 5 2 8 9 6]
</pre></div>
</div>
</div>
</div>
<p>Per conoscere il numero di valori univoci in una serie, possiamo utilizzare il metodo <code class="docutils literal notranslate"><span class="pre">nunique</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s1</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>6
</pre></div>
</div>
</div>
</div>
<p>E’ possibile ottenere i valori univoci di una serie insieme alle frequenze con le quali essi appaiono nella serie mediante il metodo <code class="docutils literal notranslate"><span class="pre">value_counts</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tmp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">100</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tmp</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span> <span class="c1">#valori univoci</span>
<span class="n">tmp</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span> <span class="c1">#valori univoci con relative frequenze</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2 6 1 3 9 0 4 7 8 5]
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3    15
6    14
1    13
2    10
9    10
0    10
4    10
7     8
8     5
5     5
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Il risultato di <code class="docutils literal notranslate"><span class="pre">value_counts</span></code> è una <code class="docutils literal notranslate"><span class="pre">Series</span></code> in cui gli indici rappresentano i valori univoci, mentre i valori sono le frequenze con cui essi appaiono nella serie. La serie è ordinata per valori.</p>
<p>Il metodo <code class="docutils literal notranslate"><span class="pre">describe</span></code> permette di calcolare diverse statistiche dei valori contenuti nella serie:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tmp</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>count    100.000000
mean       4.130000
std        2.830765
min        0.000000
25%        2.000000
50%        4.000000
75%        6.000000
max        9.000000
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Nelle operazioni tra serie, gli elementi vengono associati in base agli indici. Nel caso in cui esiste una perfetta corrispondenza tra gli elementi otteniamo il seguente risultato:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span><span class="o">+</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">]),</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span><span class="o">*</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">]),</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    5
1    6
2    7
dtype: int64 

0     4
1     8
2    12
dtype: int64 
</pre></div>
</div>
</div>
</div>
<p>Nel caso in cui alcuni indici dovessero essere mancanti, le caselle corrispondenti verranno riempite con <code class="docutils literal notranslate"><span class="pre">NaN</span></code> (not a number) per indicare l’assenza del valore:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">s2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">8</span><span class="p">],</span> <span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s2</span><span class="p">,</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s1</span><span class="o">+</span><span class="n">s2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1    1
2    4
3    2
dtype: int64 

0    4
1    2
2    8
dtype: int64 

0     NaN
1     3.0
2    12.0
3     NaN
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>In questo caso, l’indice <code class="docutils literal notranslate"><span class="pre">0</span></code> era presente solo nella seconda serie (<code class="docutils literal notranslate"><span class="pre">s2</span></code>), mentre l’indice <code class="docutils literal notranslate"><span class="pre">3</span></code> era presente solo nella prima serie (<code class="docutils literal notranslate"><span class="pre">s1</span></code>).</p>
<p>Se vogliamo escludere i valori <code class="docutils literal notranslate"><span class="pre">NaN</span></code> (inclusi i relativi indici) possiamo utilizzare il metodo <code class="docutils literal notranslate"><span class="pre">dropna</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s3</span><span class="o">=</span><span class="n">s1</span><span class="o">+</span><span class="n">s2</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s3</span><span class="o">.</span><span class="n">dropna</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0     NaN
1     3.0
2    12.0
3     NaN
dtype: float64
1     3.0
2    12.0
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>E’ possibile applicare una funzione a tutti gli elementi di una serie mediante il metodo <code class="docutils literal notranslate"><span class="pre">apply</span></code>. Supponiamo ad esempio di voler trasformare delle stringhe contenute in una serie in uppercase. Possiamo specificare la funzione <code class="docutils literal notranslate"><span class="pre">str.upper</span></code> mediante il metodo <code class="docutils literal notranslate"><span class="pre">apply</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;aba&#39;</span><span class="p">,</span><span class="s1">&#39;cda&#39;</span><span class="p">,</span><span class="s1">&#39;daf&#39;</span><span class="p">,</span><span class="s1">&#39;acc&#39;</span><span class="p">])</span>
<span class="n">s</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">upper</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    ABA
1    CDA
2    DAF
3    ACC
dtype: object
</pre></div>
</div>
</div>
</div>
<p>Mediante apply possiamo applicare anche funzioni definite dall’utente mediante espressioni lambda o mediante la consueta sintassi:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">miafun</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;Stringa: &quot;</span>
    <span class="k">return</span> <span class="n">y</span><span class="o">+</span><span class="n">x</span>
<span class="n">s</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">miafun</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    Stringa: aba
1    Stringa: cda
2    Stringa: daf
3    Stringa: acc
dtype: object
</pre></div>
</div>
</div>
</div>
<p>La stessa funzione si può scrivere in maniera più compatta come espressione lambda:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s2">&quot;Stringa: &quot;</span><span class="o">+</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    Stringa: aba
1    Stringa: cda
2    Stringa: daf
3    Stringa: acc
dtype: object
</pre></div>
</div>
</div>
</div>
<p>E’ possibile modificare tutte le occorrenze di un dato valore di una serie mediante il metodo <code class="docutils literal notranslate"><span class="pre">replace</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ser</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ser</span><span class="p">)</span>
<span class="n">ser</span><span class="o">=</span><span class="n">ser</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="mi">0</span><span class="p">})</span> <span class="c1">#sostituisci tutti le occorrenze di &quot;-1&quot; con zeri</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ser</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0     1
1     2
2    15
3    -1
4     7
5     9
6     2
7    -1
dtype: int64
0     1
1     2
2    15
3     0
4     7
5     9
6     2
7     0
dtype: int64
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p><strong>🙋‍♂️ Domanda 4</strong></p>
<p>Si provi ad applicare il metodo <code class="docutils literal notranslate"><span class="pre">apply</span></code> ad una <code class="docutils literal notranslate"><span class="pre">Series</span></code> specificando una funzione che prende in unput due argomenti. E’ possibile farlo? Perché?</p>
</div></blockquote>
</section>
<section id="conversione-in-array-di-numpy">
<h4><span class="section-number">9.1.6. </span>Conversione in array di Numpy<a class="headerlink" href="#conversione-in-array-di-numpy" title="Permalink to this heading">#</a></h4>
<p>E’ possibile accedere ai valori della series in forma di array di numpy mediante la proprietà <code class="docutils literal notranslate"><span class="pre">values</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">s3</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[nan  3. 12. nan]
</pre></div>
</div>
</div>
</div>
<p>Bisogna fare attenzione al fatto che <code class="docutils literal notranslate"><span class="pre">values</span></code> non crea una copia indipendente della serie, per cui, se modifichiamo l’array di numpy accessibile mediante <code class="docutils literal notranslate"><span class="pre">values</span></code>, di fatto modifichiamo anche la serie:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">s3</span><span class="o">.</span><span class="n">values</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s3</span><span class="p">)</span>
<span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=-</span><span class="mi">1</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0     NaN
1     3.0
2    12.0
3     NaN
dtype: float64
0    -1.0
1     3.0
2    12.0
3     NaN
dtype: float64
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p><strong>🙋‍♂️ Domanda 5</strong></p>
<p>Come si può ottenere un array di Numpy da un Series in modo che le due entità siano indipendenti?</p>
</div></blockquote>
</section>
</section>
<section id="dataframe">
<h3><span class="section-number">9.2. </span>DataFrame<a class="headerlink" href="#dataframe" title="Permalink to this heading">#</a></h3>
<p>Un <strong>DataFrame</strong> è sostanzialmente una tabella di numeri in cui:</p>
<ul class="simple">
<li><p>Ogni riga rappresenta una <em>osservazione</em> diversa;</p></li>
<li><p>Ogni colonna rappresenta una variabile.</p></li>
</ul>
<p>Righe e colonne possono avere dei nomi. In particolare, è molto comune assegnare dei nomi alle colonne per indicare a quale variabile corrisponde ognuna di esse.</p>
<section id="costruzione-e-visualizzazione-di-dataframe">
<h4><span class="section-number">9.2.1. </span>Costruzione e visualizzazione di DataFrame<a class="headerlink" href="#costruzione-e-visualizzazione-di-dataframe" title="Permalink to this heading">#</a></h4>
<p>E’ possibile costruire un DataFrame a partire da un array bidimensionale (una matrice) di numpy:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dati</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="c1">#matrice di valori random 10 x 3</span>
<span class="c1">#si tratta di una matrice di 10 osservazioni, ognuna caratterizzata da 3 variabili</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">dati</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">])</span>

<span class="n">df</span> <span class="c1">#in jupyter o in una shell ipython possiamo stampare il dataframe</span>
<span class="c1">#semplicemente scrivendo &quot;df&quot;. In uno script dovremmo scrivere &quot;print df&quot;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.309884</td>
      <td>0.507204</td>
      <td>0.280793</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.763837</td>
      <td>0.108542</td>
      <td>0.511655</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.909769</td>
      <td>0.218376</td>
      <td>0.363104</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.854973</td>
      <td>0.711392</td>
      <td>0.392944</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.231301</td>
      <td>0.380175</td>
      <td>0.549162</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.556719</td>
      <td>0.004135</td>
      <td>0.638023</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.057648</td>
      <td>0.043027</td>
      <td>0.875051</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.292588</td>
      <td>0.762768</td>
      <td>0.367865</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.873502</td>
      <td>0.029424</td>
      <td>0.552044</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.240248</td>
      <td>0.884805</td>
      <td>0.460238</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Ad ogni riga è stato assegnato in automatico un indice numerico. Se vogliamo possiamo specificare nomi anche per le righe:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span><span class="c1">#imposiamo un seed per ripetitibilità</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">],</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span><span class="s1">&#39;W&#39;</span><span class="p">])</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>X</th>
      <td>0.696469</td>
      <td>0.286139</td>
      <td>0.226851</td>
    </tr>
    <tr>
      <th>Y</th>
      <td>0.551315</td>
      <td>0.719469</td>
      <td>0.423106</td>
    </tr>
    <tr>
      <th>Z</th>
      <td>0.980764</td>
      <td>0.684830</td>
      <td>0.480932</td>
    </tr>
    <tr>
      <th>W</th>
      <td>0.392118</td>
      <td>0.343178</td>
      <td>0.729050</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Analogamente a quanto visto nel caso delle serie, è possibile costruire un DataFrame mediante un dizionario che specifica nome e valori di ogni colonna:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="s1">&#39;C&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">)})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.438572</td>
      <td>0.724455</td>
      <td>0.430863</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.059678</td>
      <td>0.611024</td>
      <td>0.493685</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.398044</td>
      <td>0.722443</td>
      <td>0.425830</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.737995</td>
      <td>0.322959</td>
      <td>0.312261</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.182492</td>
      <td>0.361789</td>
      <td>0.426351</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.175452</td>
      <td>0.228263</td>
      <td>0.893389</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.531551</td>
      <td>0.293714</td>
      <td>0.944160</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.531828</td>
      <td>0.630976</td>
      <td>0.501837</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.634401</td>
      <td>0.092105</td>
      <td>0.623953</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.849432</td>
      <td>0.433701</td>
      <td>0.115618</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Nel caso di dataset molto grandi, possiamo visualizzare solo le prime righe usando il metodo <strong>head</strong>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_big</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">])</span>
<span class="n">df_big</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.317285</td>
      <td>0.414826</td>
      <td>0.866309</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.250455</td>
      <td>0.483034</td>
      <td>0.985560</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.519485</td>
      <td>0.612895</td>
      <td>0.120629</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.826341</td>
      <td>0.603060</td>
      <td>0.545068</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.342764</td>
      <td>0.304121</td>
      <td>0.417022</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>E’ anche possibile specificare il numero di righe da mostrare:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_big</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.317285</td>
      <td>0.414826</td>
      <td>0.866309</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.250455</td>
      <td>0.483034</td>
      <td>0.985560</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>In maniera simile, possiamo mostrare le ultime righe con <strong>tail</strong>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_big</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>97</th>
      <td>0.811953</td>
      <td>0.335544</td>
      <td>0.349566</td>
    </tr>
    <tr>
      <th>98</th>
      <td>0.389874</td>
      <td>0.754797</td>
      <td>0.369291</td>
    </tr>
    <tr>
      <th>99</th>
      <td>0.242220</td>
      <td>0.937668</td>
      <td>0.908011</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Possiamo ottenere il numero di righe del <strong>DataFrame</strong> mediante la funzione <strong>len</strong>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df_big</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100
</pre></div>
</div>
</div>
</div>
<p>Se vogliamo conoscere sia il numero di righe che il numero di colonne, possiamo richiamare la proprietà <strong>shape</strong>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df_big</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(100, 3)
</pre></div>
</div>
</div>
</div>
<p>Analogamente a quanto visto per le Series, possiamo visualizzare un DataFrame come un array di numpy richiamando la proprietà <code class="docutils literal notranslate"><span class="pre">values</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>          A         B         C
X  0.696469  0.286139  0.226851
Y  0.551315  0.719469  0.423106
Z  0.980764  0.684830  0.480932
W  0.392118  0.343178  0.729050 

[[0.69646919 0.28613933 0.22685145]
 [0.55131477 0.71946897 0.42310646]
 [0.9807642  0.68482974 0.4809319 ]
 [0.39211752 0.34317802 0.72904971]]
</pre></div>
</div>
</div>
</div>
<p>Anche per i DataFrame valgono le stesse considerazioni sulla memoria fatte per le Series. Per ottenere una copia indipendente di una DataFrame, è possibile utilizzare il metodo <code class="docutils literal notranslate"><span class="pre">copy</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p><strong>🙋‍♂️ Domanda 6</strong></p>
<p>In cosa differisce principalmente un DataFrame da un array bidimensionale di Numpy? Qual è il vantaggio dei DataFrame?</p>
</div></blockquote>
</section>
<section id="indicizzazione">
<h4><span class="section-number">9.2.2. </span>Indicizzazione<a class="headerlink" href="#indicizzazione" title="Permalink to this heading">#</a></h4>
<p>Pandas mette a disposizione una serie di strumenti per indicizzare i <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> selezionandone righe o colonne. Ad esempio, possiamo selezionare la colonna B come segue:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Tipo di s:&quot;</span><span class="p">,</span><span class="nb">type</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>X    0.286139
Y    0.719469
Z    0.684830
W    0.343178
Name: B, dtype: float64 

Tipo di s: &lt;class &#39;pandas.core.series.Series&#39;&gt;
</pre></div>
</div>
</div>
</div>
<p>Da notare che il risultato di questa operazione è una <code class="docutils literal notranslate"><span class="pre">Series</span></code> (un <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> è in fondo una collezione di <code class="docutils literal notranslate"><span class="pre">Series</span></code>, ognuna rappresentante una colonna) che ha come nome il nome della colonna considerata. Possiamo selezionare più di una riga specificando una lista di righe:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfAB</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">]]</span>
<span class="n">dfAB</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>X</th>
      <td>0.696469</td>
      <td>0.226851</td>
    </tr>
    <tr>
      <th>Y</th>
      <td>0.551315</td>
      <td>0.423106</td>
    </tr>
    <tr>
      <th>Z</th>
      <td>0.980764</td>
      <td>0.480932</td>
    </tr>
    <tr>
      <th>W</th>
      <td>0.392118</td>
      <td>0.729050</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Il risultato di questa operazione è invece un <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>. La selezione delle righe avviene mediante la proprietà <code class="docutils literal notranslate"><span class="pre">loc</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df5</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">]</span>
<span class="n">df5</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A    0.696469
B    0.286139
C    0.226851
Name: X, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Anche il risultato di questa operazione è una <code class="docutils literal notranslate"><span class="pre">Series</span></code>, ma in questo caso gli indici rappresentano i nomi delle colonne, mentre il nome della serie corrisponde all’indice della riga selezionata. Come nel caso delle <code class="docutils literal notranslate"><span class="pre">Series</span></code>, possiamo usare <code class="docutils literal notranslate"><span class="pre">iloc</span></code> per indicizzare le righe in maniera posizionale:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="c1">#equivalente a df.loc[&#39;Y&#39;]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A    0.551315
B    0.719469
C    0.423106
Name: Y, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>E’ anche possibile concatenare le operazioni di indicizzazione per selezionare uno specifico valore:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;A&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.5513147690828912
0.5513147690828912
</pre></div>
</div>
</div>
</div>
<p>Anche in questo caso possiamo utilizzare l’indicizzazione logica in in maniera simile a quanto visto per numpy:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_big2</span><span class="o">=</span><span class="n">df_big</span><span class="p">[</span><span class="n">df_big</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mf">0.5</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df_big</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_big2</span><span class="p">))</span>
<span class="n">df_big2</span><span class="o">.</span><span class="n">head</span><span class="p">()</span> <span class="c1">#alcuni indici sono mancanti in quanto le righe corrispondenti sono state rimosse</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100 53
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.317285</td>
      <td>0.414826</td>
      <td>0.866309</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.250455</td>
      <td>0.483034</td>
      <td>0.985560</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.826341</td>
      <td>0.603060</td>
      <td>0.545068</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.681301</td>
      <td>0.875457</td>
      <td>0.510422</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.669314</td>
      <td>0.585937</td>
      <td>0.624904</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>E’ possibile combinare quanto visto finora per manipolare i dati in maniera semplice e veloce. Supponiamo di voler selezionare le righe per le quali la somma tra i valori di B e C è minore di <span class="math notranslate nohighlight">\(0.7\)</span> e supponiamo di essere interessati solo ai valori A di tali righe (e non all’intera riga di valori A,B,C). Il risultato che ci aspettiamo è un array monodimensionale di valori. Possiamo ottenere il risultato voluto come segue:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">res</span> <span class="o">=</span> <span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">])</span><span class="o">&gt;</span><span class="mf">0.7</span><span class="p">][</span><span class="s1">&#39;A&#39;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">head</span><span class="p">(),</span> <span class="n">res</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Y    0.551315
Z    0.980764
W    0.392118
Name: A, dtype: float64 (3,)
</pre></div>
</div>
</div>
</div>
<p>Possiamo applicare l’indicizzazione anche a livello dell’intera tabella (oltre che al livello delle singole colonne):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">&gt;</span><span class="mf">0.3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>X</th>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>Y</th>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>Z</th>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>W</th>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Se applichiamo questa indicizzazione al <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> otterremo l’apparizione di alcuni <code class="docutils literal notranslate"><span class="pre">NaN</span></code>, che indicano la presenza degli elementi che non rispettano la condizione considerata:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">&gt;</span><span class="mf">0.3</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>X</th>
      <td>0.696469</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Y</th>
      <td>0.551315</td>
      <td>0.719469</td>
      <td>0.423106</td>
    </tr>
    <tr>
      <th>Z</th>
      <td>0.980764</td>
      <td>0.684830</td>
      <td>0.480932</td>
    </tr>
    <tr>
      <th>W</th>
      <td>0.392118</td>
      <td>0.343178</td>
      <td>0.729050</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Possiamo rimuovere i valori <code class="docutils literal notranslate"><span class="pre">NaN</span></code> mediante il metodo <code class="docutils literal notranslate"><span class="pre">dropna</span></code> come visto nel caso delle <code class="docutils literal notranslate"><span class="pre">Series</span></code>. Tuttavia, in questo caso, verranno rimosse <strong>tutte le righe che presentano almeno un <code class="docutils literal notranslate"><span class="pre">NaN</span></code></strong>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">&gt;</span><span class="mf">0.3</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Y</th>
      <td>0.551315</td>
      <td>0.719469</td>
      <td>0.423106</td>
    </tr>
    <tr>
      <th>Z</th>
      <td>0.980764</td>
      <td>0.684830</td>
      <td>0.480932</td>
    </tr>
    <tr>
      <th>W</th>
      <td>0.392118</td>
      <td>0.343178</td>
      <td>0.729050</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Possiamo chiedere a <code class="docutils literal notranslate"><span class="pre">dropna</span></code> di rimuovere <strong>le colonne che presentano almeno un NaN</strong> specificando <code class="docutils literal notranslate"><span class="pre">axis=1</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">&gt;</span><span class="mf">0.3</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>X</th>
      <td>0.696469</td>
    </tr>
    <tr>
      <th>Y</th>
      <td>0.551315</td>
    </tr>
    <tr>
      <th>Z</th>
      <td>0.980764</td>
    </tr>
    <tr>
      <th>W</th>
      <td>0.392118</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Alternativamente possiamo sostituire i valori <code class="docutils literal notranslate"><span class="pre">NaN</span></code> al volo mediante la funzione <code class="docutils literal notranslate"><span class="pre">fillna</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">&gt;</span><span class="mf">0.3</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;VAL&#39;</span><span class="p">)</span> <span class="c1">#sostiuisce i NaN con &#39;VAL&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>X</th>
      <td>0.696469</td>
      <td>VAL</td>
      <td>VAL</td>
    </tr>
    <tr>
      <th>Y</th>
      <td>0.551315</td>
      <td>0.719469</td>
      <td>0.423106</td>
    </tr>
    <tr>
      <th>Z</th>
      <td>0.980764</td>
      <td>0.68483</td>
      <td>0.480932</td>
    </tr>
    <tr>
      <th>W</th>
      <td>0.392118</td>
      <td>0.343178</td>
      <td>0.72905</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Anche in questo caso, come visto nel caso delle <code class="docutils literal notranslate"><span class="pre">Series</span></code> possiamo ripristinare l’ordine degli indici mediante il metodo <code class="docutils literal notranslate"><span class="pre">reset_index</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>          A         B         C
X  0.696469  0.286139  0.226851
Y  0.551315  0.719469  0.423106
Z  0.980764  0.684830  0.480932
W  0.392118  0.343178  0.729050
          A         B         C
0  0.696469  0.286139  0.226851
1  0.551315  0.719469  0.423106
2  0.980764  0.684830  0.480932
3  0.392118  0.343178  0.729050
</pre></div>
</div>
</div>
</div>
<p>Se non specifichiamo <code class="docutils literal notranslate"><span class="pre">drop=True</span></code>, i vecchi indici verranno mantenuti come nuova colonna:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  index         A         B         C
0     X  0.696469  0.286139  0.226851
1     Y  0.551315  0.719469  0.423106
2     Z  0.980764  0.684830  0.480932
3     W  0.392118  0.343178  0.729050
</pre></div>
</div>
</div>
</div>
<p>Possiamo impostare qualsiasi colonna come nuovo indice. Ad esempio:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>B</th>
      <th>C</th>
    </tr>
    <tr>
      <th>A</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0.696469</th>
      <td>0.286139</td>
      <td>0.226851</td>
    </tr>
    <tr>
      <th>0.551315</th>
      <td>0.719469</td>
      <td>0.423106</td>
    </tr>
    <tr>
      <th>0.980764</th>
      <td>0.684830</td>
      <td>0.480932</td>
    </tr>
    <tr>
      <th>0.392118</th>
      <td>0.343178</td>
      <td>0.729050</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Va notato che questa operazione non modifica di fatto il DataFrame, ma crea una nuova “vista” dei dati con la modifica richiesta:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>X</th>
      <td>0.696469</td>
      <td>0.286139</td>
      <td>0.226851</td>
    </tr>
    <tr>
      <th>Y</th>
      <td>0.551315</td>
      <td>0.719469</td>
      <td>0.423106</td>
    </tr>
    <tr>
      <th>Z</th>
      <td>0.980764</td>
      <td>0.684830</td>
      <td>0.480932</td>
    </tr>
    <tr>
      <th>W</th>
      <td>0.392118</td>
      <td>0.343178</td>
      <td>0.729050</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Per utilizzare questa versione modificata del dataframe, possiamo salvarla in un’altra variabile:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">)</span>
<span class="n">df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>B</th>
      <th>C</th>
    </tr>
    <tr>
      <th>A</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0.696469</th>
      <td>0.286139</td>
      <td>0.226851</td>
    </tr>
    <tr>
      <th>0.551315</th>
      <td>0.719469</td>
      <td>0.423106</td>
    </tr>
    <tr>
      <th>0.980764</th>
      <td>0.684830</td>
      <td>0.480932</td>
    </tr>
    <tr>
      <th>0.392118</th>
      <td>0.343178</td>
      <td>0.729050</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<blockquote>
<div><p><strong>🙋‍♂️ Domanda 7</strong></p>
<p>Si consideri il seguente DataFrame:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span><span class="s1">&#39;B&#39;</span><span class="p">:[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span><span class="s1">&#39;C&#39;</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">12</span><span class="p">]})</span>
</pre></div>
</div>
<p>Si utilizzi l’indicizzazione logica per selezionare le righe in cui la somma dei valori di ‘C’ ed ‘A’ sia maggiore di <span class="math notranslate nohighlight">\(1\)</span>.</p>
</div></blockquote>
</section>
<section id="manipolazione-di-dataframe">
<h4><span class="section-number">9.2.3. </span>Manipolazione di DataFrame<a class="headerlink" href="#manipolazione-di-dataframe" title="Permalink to this heading">#</a></h4>
<p>I valori contenuti nelle righe e nelle colonne del dataframe possono essere facilmente modificati. Il seguente esempio moltiplica tutti i valori della colonna B per 2:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">]</span><span class="o">*=</span><span class="mi">2</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>X</th>
      <td>0.696469</td>
      <td>0.572279</td>
      <td>0.226851</td>
    </tr>
    <tr>
      <th>Y</th>
      <td>0.551315</td>
      <td>1.438938</td>
      <td>0.423106</td>
    </tr>
    <tr>
      <th>Z</th>
      <td>0.980764</td>
      <td>1.369659</td>
      <td>0.480932</td>
    </tr>
    <tr>
      <th>W</th>
      <td>0.392118</td>
      <td>0.686356</td>
      <td>0.729050</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Analogamente possiamo dividere tutti i valori della riga di indice 2 per 3:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="mi">3</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>X</th>
      <td>0.696469</td>
      <td>0.572279</td>
      <td>0.226851</td>
    </tr>
    <tr>
      <th>Y</th>
      <td>0.551315</td>
      <td>1.438938</td>
      <td>0.423106</td>
    </tr>
    <tr>
      <th>Z</th>
      <td>0.326921</td>
      <td>0.456553</td>
      <td>0.160311</td>
    </tr>
    <tr>
      <th>W</th>
      <td>0.392118</td>
      <td>0.686356</td>
      <td>0.729050</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Possiamo definire una nuova colonna con una semplice operazione di assegnamento:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;D&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">]</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">))</span><span class="o">*</span><span class="mi">5</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>X</th>
      <td>0.696469</td>
      <td>0.572279</td>
      <td>0.226851</td>
      <td>0.923321</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>Y</th>
      <td>0.551315</td>
      <td>1.438938</td>
      <td>0.423106</td>
      <td>0.974421</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>Z</th>
      <td>0.326921</td>
      <td>0.456553</td>
      <td>0.160311</td>
      <td>0.487232</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>W</th>
      <td>0.392118</td>
      <td>0.686356</td>
      <td>0.729050</td>
      <td>1.121167</td>
      <td>5.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Possiamo rimuovere una colonna mediante il metodo <code class="docutils literal notranslate"><span class="pre">drop</span></code> e specificando <code class="docutils literal notranslate"><span class="pre">axis=1</span></code> per indicare che vogliamo rimuovere una colonna:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;E&#39;</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>X</th>
      <td>0.696469</td>
      <td>0.572279</td>
      <td>0.226851</td>
      <td>0.923321</td>
    </tr>
    <tr>
      <th>Y</th>
      <td>0.551315</td>
      <td>1.438938</td>
      <td>0.423106</td>
      <td>0.974421</td>
    </tr>
    <tr>
      <th>Z</th>
      <td>0.326921</td>
      <td>0.456553</td>
      <td>0.160311</td>
      <td>0.487232</td>
    </tr>
    <tr>
      <th>W</th>
      <td>0.392118</td>
      <td>0.686356</td>
      <td>0.729050</td>
      <td>1.121167</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Il metodo <code class="docutils literal notranslate"><span class="pre">drop</span></code> non modifica il DataFrame ma genera solo una nuova “vista” senza la colonna da rimuovere:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>X</th>
      <td>0.696469</td>
      <td>0.572279</td>
      <td>0.226851</td>
      <td>0.923321</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>Y</th>
      <td>0.551315</td>
      <td>1.438938</td>
      <td>0.423106</td>
      <td>0.974421</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>Z</th>
      <td>0.326921</td>
      <td>0.456553</td>
      <td>0.160311</td>
      <td>0.487232</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>W</th>
      <td>0.392118</td>
      <td>0.686356</td>
      <td>0.729050</td>
      <td>1.121167</td>
      <td>5.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Possiamo rimuovere la colonna effettivamente mediante un assegnamento:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;E&#39;</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>X</th>
      <td>0.696469</td>
      <td>0.572279</td>
      <td>0.226851</td>
      <td>0.923321</td>
    </tr>
    <tr>
      <th>Y</th>
      <td>0.551315</td>
      <td>1.438938</td>
      <td>0.423106</td>
      <td>0.974421</td>
    </tr>
    <tr>
      <th>Z</th>
      <td>0.326921</td>
      <td>0.456553</td>
      <td>0.160311</td>
      <td>0.487232</td>
    </tr>
    <tr>
      <th>W</th>
      <td>0.392118</td>
      <td>0.686356</td>
      <td>0.729050</td>
      <td>1.121167</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>La rimozione delle righe avviene allo stesso modo, ma bisogna specificare <code class="docutils literal notranslate"><span class="pre">axis</span> <span class="pre">=0</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Y</th>
      <td>0.551315</td>
      <td>1.438938</td>
      <td>0.423106</td>
      <td>0.974421</td>
    </tr>
    <tr>
      <th>Z</th>
      <td>0.326921</td>
      <td>0.456553</td>
      <td>0.160311</td>
      <td>0.487232</td>
    </tr>
    <tr>
      <th>W</th>
      <td>0.392118</td>
      <td>0.686356</td>
      <td>0.729050</td>
      <td>1.121167</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>E’ inoltre possibile aggiungere una nuova riga in coda al DataFrame mediante il metodo <code class="docutils literal notranslate"><span class="pre">append</span></code>. Dato che le righe di un DataFrame sono delle Series, dovremo costruire una serie con i giusti indici (corrispondenti alle colonne del DataFrame) e il giusto nome (corrispondente al nuovo indice):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_row</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="s1">&#39;D&#39;</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;H&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">new_row</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_row</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A    1
B    2
C    3
D    4
Name: H, dtype: int64
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>X</th>
      <td>0.696469</td>
      <td>0.572279</td>
      <td>0.226851</td>
      <td>0.923321</td>
    </tr>
    <tr>
      <th>Y</th>
      <td>0.551315</td>
      <td>1.438938</td>
      <td>0.423106</td>
      <td>0.974421</td>
    </tr>
    <tr>
      <th>Z</th>
      <td>0.326921</td>
      <td>0.456553</td>
      <td>0.160311</td>
      <td>0.487232</td>
    </tr>
    <tr>
      <th>W</th>
      <td>0.392118</td>
      <td>0.686356</td>
      <td>0.729050</td>
      <td>1.121167</td>
    </tr>
    <tr>
      <th>H</th>
      <td>1.000000</td>
      <td>2.000000</td>
      <td>3.000000</td>
      <td>4.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Possiamo aggiungere più di una riga alla volta specificando un DataFrame:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_rows</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;B&#39;</span><span class="p">:[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span><span class="s1">&#39;C&#39;</span><span class="p">:[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span><span class="s1">&#39;D&#39;</span><span class="p">:[</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">]},</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;H&#39;</span><span class="p">,</span><span class="s1">&#39;K&#39;</span><span class="p">])</span>
<span class="n">new_rows</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>H</th>
      <td>0</td>
      <td>2</td>
      <td>4</td>
      <td>6</td>
    </tr>
    <tr>
      <th>K</th>
      <td>1</td>
      <td>3</td>
      <td>5</td>
      <td>7</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_rows</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>X</th>
      <td>0.696469</td>
      <td>0.572279</td>
      <td>0.226851</td>
      <td>0.923321</td>
    </tr>
    <tr>
      <th>Y</th>
      <td>0.551315</td>
      <td>1.438938</td>
      <td>0.423106</td>
      <td>0.974421</td>
    </tr>
    <tr>
      <th>Z</th>
      <td>0.326921</td>
      <td>0.456553</td>
      <td>0.160311</td>
      <td>0.487232</td>
    </tr>
    <tr>
      <th>W</th>
      <td>0.392118</td>
      <td>0.686356</td>
      <td>0.729050</td>
      <td>1.121167</td>
    </tr>
    <tr>
      <th>H</th>
      <td>0.000000</td>
      <td>2.000000</td>
      <td>4.000000</td>
      <td>6.000000</td>
    </tr>
    <tr>
      <th>K</th>
      <td>1.000000</td>
      <td>3.000000</td>
      <td>5.000000</td>
      <td>7.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<blockquote>
<div><p><strong>🙋‍♂️ Domanda 8</strong></p>
<p>Si consideri il seguente DataFrame:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span><span class="s1">&#39;B&#39;</span><span class="p">:[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span><span class="s1">&#39;C&#39;</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">12</span><span class="p">]})</span>
</pre></div>
</div>
<p>Si inserisca nel DataFrame una nuova colonna ‘D’ che contenga il valore <span class="math notranslate nohighlight">\(1\)</span> in tutte le righe in cui il valore di B è superiore al valore di C.</p>
<p><b>Suggerimento:</b> si usi “astype(int)” per trasformare i booleani in interi.</p>
</div></blockquote>
</section>
<section id="operazioni-tra-e-su-dataframe">
<h4><span class="section-number">9.2.4. </span>Operazioni tra e su DataFrame<a class="headerlink" href="#operazioni-tra-e-su-dataframe" title="Permalink to this heading">#</a></h4>
<p>Restano definite sui DataFrame, con le opportune differenze, le operazioni viste nel caso delle serie. In genere, queste vengono applicate a tutte le colonne del DataFrame in maniera indipendente:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="c1">#media di ogni colonna</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A    0.491706
B    0.788531
C    0.384830
D    0.876535
dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="c1">#massimo di ogni colonna</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A    0.696469
B    1.438938
C    0.729050
D    1.121167
dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span> <span class="c1">#statistiche per ogni colonna</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>4.000000</td>
      <td>4.000000</td>
      <td>4.000000</td>
      <td>4.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.491706</td>
      <td>0.788531</td>
      <td>0.384830</td>
      <td>0.876535</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.165884</td>
      <td>0.443638</td>
      <td>0.255159</td>
      <td>0.272747</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.326921</td>
      <td>0.456553</td>
      <td>0.160311</td>
      <td>0.487232</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>0.375818</td>
      <td>0.543347</td>
      <td>0.210216</td>
      <td>0.814298</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.471716</td>
      <td>0.629317</td>
      <td>0.324979</td>
      <td>0.948871</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>0.587603</td>
      <td>0.874502</td>
      <td>0.499592</td>
      <td>1.011108</td>
    </tr>
    <tr>
      <th>max</th>
      <td>0.696469</td>
      <td>1.438938</td>
      <td>0.729050</td>
      <td>1.121167</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Dato che le colonne di un DataFrame sono delle serie, ad esse può essere applicato il metodo <code class="docutils literal notranslate"><span class="pre">apply</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s2">&quot;Numero: &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>X</th>
      <td>Numero: 0.6964691855978616</td>
      <td>0.572279</td>
      <td>0.226851</td>
      <td>0.923321</td>
    </tr>
    <tr>
      <th>Y</th>
      <td>Numero: 0.5513147690828912</td>
      <td>1.438938</td>
      <td>0.423106</td>
      <td>0.974421</td>
    </tr>
    <tr>
      <th>Z</th>
      <td>Numero: 0.3269213994615385</td>
      <td>0.456553</td>
      <td>0.160311</td>
      <td>0.487232</td>
    </tr>
    <tr>
      <th>W</th>
      <td>Numero: 0.3921175181941505</td>
      <td>0.686356</td>
      <td>0.729050</td>
      <td>1.121167</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>E’ possibile ordinare le righe di un DataFrame rispetto ai valori di una delle colonne mediante il metodo <code class="docutils literal notranslate"><span class="pre">sort_values</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Z</th>
      <td>Numero: 0.3269213994615385</td>
      <td>0.456553</td>
      <td>0.160311</td>
      <td>0.487232</td>
    </tr>
    <tr>
      <th>X</th>
      <td>Numero: 0.6964691855978616</td>
      <td>0.572279</td>
      <td>0.226851</td>
      <td>0.923321</td>
    </tr>
    <tr>
      <th>Y</th>
      <td>Numero: 0.5513147690828912</td>
      <td>1.438938</td>
      <td>0.423106</td>
      <td>0.974421</td>
    </tr>
    <tr>
      <th>W</th>
      <td>Numero: 0.3921175181941505</td>
      <td>0.686356</td>
      <td>0.729050</td>
      <td>1.121167</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Per rendere l’ordinamento permanente, dobbiamo effettuare un assegnamento:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Z</th>
      <td>Numero: 0.3269213994615385</td>
      <td>0.456553</td>
      <td>0.160311</td>
      <td>0.487232</td>
    </tr>
    <tr>
      <th>X</th>
      <td>Numero: 0.6964691855978616</td>
      <td>0.572279</td>
      <td>0.226851</td>
      <td>0.923321</td>
    </tr>
    <tr>
      <th>Y</th>
      <td>Numero: 0.5513147690828912</td>
      <td>1.438938</td>
      <td>0.423106</td>
      <td>0.974421</td>
    </tr>
    <tr>
      <th>W</th>
      <td>Numero: 0.3921175181941505</td>
      <td>0.686356</td>
      <td>0.729050</td>
      <td>1.121167</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<blockquote>
<div><p><strong>🙋‍♂️ Domanda 9</strong></p>
<p>Si consideri il seguente DataFrame:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span><span class="s1">&#39;B&#39;</span><span class="p">:[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span><span class="s1">&#39;C&#39;</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">12</span><span class="p">]})</span>
</pre></div>
</div>
<p>Si trasformi la colonna “B” in modo che i nuovi valori siano:</p>
<ul class="simple">
<li><p>uguali a zero se precedentemente pari;</p></li>
<li><p>uguali a -1 se precedentemente dispari.</p></li>
</ul>
</div></blockquote>
</section>
<section id="rimuovere-righe-e-colonne">
<h4><span class="section-number">9.2.5. </span>Rimuovere righe e colonne<a class="headerlink" href="#rimuovere-righe-e-colonne" title="Permalink to this heading">#</a></h4>
<p>È possibile rimuovere una riga o una colonna da un DataFrame:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span><span class="s1">&#39;B&#39;</span><span class="p">:[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span><span class="s1">&#39;C&#39;</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">12</span><span class="p">]})</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c1">#rimuoviamo la riga 1</span>
<span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1">#rimuoviamo la colonna B</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   A  B   C
0  1  3   0
1  2  2   2
2  3  6  -1
3  4  7  12
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>12</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Si noti che le operazioni viste sopra non modificano l’array di origine, ma ne restituiscono una copia modificata:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span><span class="s1">&#39;B&#39;</span><span class="p">:[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span><span class="s1">&#39;C&#39;</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">12</span><span class="p">]})</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c1">#rimuoviamo la riga 1</span>
<span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   A  B   C
0  1  3   0
1  2  2   2
2  3  6  -1
3  4  7  12
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>3</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>6</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>7</td>
      <td>12</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Possiamo effettuare una modifica persistente mediante <code class="docutils literal notranslate"><span class="pre">inplace=True</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span><span class="s1">&#39;B&#39;</span><span class="p">:[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span><span class="s1">&#39;C&#39;</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">12</span><span class="p">]})</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1">#rimuoviamo la riga 1</span>
<span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   A  B   C
0  1  3   0
1  2  2   2
2  3  6  -1
3  4  7  12
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>3</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>6</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>7</td>
      <td>12</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>O in maniera più esplicita come segue:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span><span class="s1">&#39;B&#39;</span><span class="p">:[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span><span class="s1">&#39;C&#39;</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">12</span><span class="p">]})</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c1">#rimuoviamo la riga 1</span>
<span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   A  B   C
0  1  3   0
1  2  2   2
2  3  6  -1
3  4  7  12
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>3</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>6</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>7</td>
      <td>12</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="groupby">
<h4><span class="section-number">9.2.6. </span>Groupby<a class="headerlink" href="#groupby" title="Permalink to this heading">#</a></h4>
<p>Il metodo <code class="docutils literal notranslate"><span class="pre">groupby</span></code> permette di raggruppare le righe di un <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> e richiamare delle funzioni aggreggate su di esse. Consideriamo un <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> un po’ più rappresentativo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;income&#39;</span><span class="p">:[</span><span class="mi">10000</span><span class="p">,</span><span class="mi">11000</span><span class="p">,</span><span class="mi">9000</span><span class="p">,</span><span class="mi">3000</span><span class="p">,</span><span class="mi">1000</span><span class="p">,</span><span class="mi">5000</span><span class="p">,</span><span class="mi">7000</span><span class="p">,</span><span class="mi">2000</span><span class="p">,</span><span class="mi">7000</span><span class="p">,</span><span class="mi">12000</span><span class="p">,</span><span class="mi">8000</span><span class="p">],</span>\
                 <span class="s1">&#39;age&#39;</span><span class="p">:[</span><span class="mi">32</span><span class="p">,</span><span class="mi">32</span><span class="p">,</span><span class="mi">45</span><span class="p">,</span><span class="mi">35</span><span class="p">,</span><span class="mi">28</span><span class="p">,</span><span class="mi">18</span><span class="p">,</span><span class="mi">27</span><span class="p">,</span><span class="mi">45</span><span class="p">,</span><span class="mi">39</span><span class="p">,</span><span class="mi">33</span><span class="p">,</span><span class="mi">32</span><span class="p">],</span>\
                 <span class="s1">&#39;sex&#39;</span><span class="p">:[</span><span class="s1">&#39;M&#39;</span><span class="p">,</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="s1">&#39;M&#39;</span><span class="p">,</span><span class="s1">&#39;M&#39;</span><span class="p">,</span><span class="s1">&#39;M&#39;</span><span class="p">,</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="s1">&#39;M&#39;</span><span class="p">,</span><span class="s1">&#39;M&#39;</span><span class="p">,</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="s1">&#39;F&#39;</span><span class="p">],</span>\
                 <span class="s1">&#39;company&#39;</span><span class="p">:[</span><span class="s1">&#39;CDX&#39;</span><span class="p">,</span><span class="s1">&#39;FLZ&#39;</span><span class="p">,</span><span class="s1">&#39;PTX&#39;</span><span class="p">,</span><span class="s1">&#39;CDX&#39;</span><span class="p">,</span><span class="s1">&#39;PTX&#39;</span><span class="p">,</span><span class="s1">&#39;CDX&#39;</span><span class="p">,</span><span class="s1">&#39;FLZ&#39;</span><span class="p">,</span><span class="s1">&#39;CDX&#39;</span><span class="p">,</span><span class="s1">&#39;FLZ&#39;</span><span class="p">,</span><span class="s1">&#39;PTX&#39;</span><span class="p">,</span><span class="s1">&#39;FLZ&#39;</span><span class="p">]})</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>income</th>
      <th>age</th>
      <th>sex</th>
      <th>company</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10000</td>
      <td>32</td>
      <td>M</td>
      <td>CDX</td>
    </tr>
    <tr>
      <th>1</th>
      <td>11000</td>
      <td>32</td>
      <td>F</td>
      <td>FLZ</td>
    </tr>
    <tr>
      <th>2</th>
      <td>9000</td>
      <td>45</td>
      <td>M</td>
      <td>PTX</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3000</td>
      <td>35</td>
      <td>M</td>
      <td>CDX</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1000</td>
      <td>28</td>
      <td>M</td>
      <td>PTX</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5000</td>
      <td>18</td>
      <td>F</td>
      <td>CDX</td>
    </tr>
    <tr>
      <th>6</th>
      <td>7000</td>
      <td>27</td>
      <td>F</td>
      <td>FLZ</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2000</td>
      <td>45</td>
      <td>M</td>
      <td>CDX</td>
    </tr>
    <tr>
      <th>8</th>
      <td>7000</td>
      <td>39</td>
      <td>M</td>
      <td>FLZ</td>
    </tr>
    <tr>
      <th>9</th>
      <td>12000</td>
      <td>33</td>
      <td>F</td>
      <td>PTX</td>
    </tr>
    <tr>
      <th>10</th>
      <td>8000</td>
      <td>32</td>
      <td>F</td>
      <td>FLZ</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Il metodo <code class="docutils literal notranslate"><span class="pre">groupby</span></code> ci permette di raggruppare le righe del <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> per valore, rispetto a una colonna specificata. Supponiamo di voler raggruppare tutte le righe che hanno lo stesso valore di <strong>sex</strong>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;sex&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pandas.core.groupby.groupby.DataFrameGroupBy object at 0x0000029E02F239E8&gt;
</pre></div>
</div>
</div>
</div>
<p>Questa operazione restituisce un oggetto di tipo <code class="docutils literal notranslate"><span class="pre">DataFrameGroupby</span></code> sul quale sarà possibile effettuare delle operazioni aggregate (ad esempio, somme e medie). Supponiamo adesso di voler calcolare la media di tutti i valori che ricadono nello stesso gruppo (ovvero calcoliamo la media delle righe che hanno lo stesso valore di sex):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;sex&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>income</th>
      <th>age</th>
    </tr>
    <tr>
      <th>sex</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>F</th>
      <td>8600.000000</td>
      <td>28.400000</td>
    </tr>
    <tr>
      <th>M</th>
      <td>5333.333333</td>
      <td>37.333333</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Se siamo interessati a una sola delle variabili, possiamo selezionarla prima o dopo l’operazione sui dati aggregati:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;sex&#39;</span><span class="p">)[</span><span class="s1">&#39;age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="c1">#equivalentemente: df.groupby(&#39;sex&#39;).mean()[&#39;age&#39;]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sex
F    28.400000
M    37.333333
Name: age, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>La tabella mostra il reddito medio e l’età media dei soggetti di sesso maschile e femminile. Dato che l’operazione di media si può applicare solo a valori numerici, la colonna Company è stata esclusa. Possiamo ottenere una tabella simile in cui mostriamo la somma dei redditi e la somma delle età cambiando <code class="docutils literal notranslate"><span class="pre">mean</span></code> in <code class="docutils literal notranslate"><span class="pre">sum</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;sex&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>income</th>
      <th>age</th>
    </tr>
    <tr>
      <th>sex</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>F</th>
      <td>43000</td>
      <td>142</td>
    </tr>
    <tr>
      <th>M</th>
      <td>32000</td>
      <td>224</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>In generale, è possibile utilizzare diverse funzioni aggregate oltre a <code class="docutils literal notranslate"><span class="pre">mean</span></code> e <code class="docutils literal notranslate"><span class="pre">sum</span></code>. Alcuni esempi sono <code class="docutils literal notranslate"><span class="pre">min</span></code>, <code class="docutils literal notranslate"><span class="pre">max</span></code>, <code class="docutils literal notranslate"><span class="pre">std</span></code>. Due funzioni particolarmente interessanti da usare in questo contesto sono <code class="docutils literal notranslate"><span class="pre">count</span></code> e <code class="docutils literal notranslate"><span class="pre">describe</span></code>. In particolare, <code class="docutils literal notranslate"><span class="pre">count</span></code> conta il numero di elementi interessati, mentre describe calcola diverse statistiche dei valori interessati. Vediamo due esempi:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;sex&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>income</th>
      <th>age</th>
      <th>company</th>
    </tr>
    <tr>
      <th>sex</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>F</th>
      <td>5</td>
      <td>5</td>
      <td>5</td>
    </tr>
    <tr>
      <th>M</th>
      <td>6</td>
      <td>6</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Il numero di elementi è uguale per le varie colonne in quanto non ci sono valori <code class="docutils literal notranslate"><span class="pre">NaN</span></code> nel DataFrame.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;sex&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="8" halign="left">age</th>
      <th colspan="8" halign="left">income</th>
    </tr>
    <tr>
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
    <tr>
      <th>sex</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>F</th>
      <td>5.0</td>
      <td>28.400000</td>
      <td>6.268971</td>
      <td>18.0</td>
      <td>27.00</td>
      <td>32.0</td>
      <td>32.0</td>
      <td>33.0</td>
      <td>5.0</td>
      <td>8600.000000</td>
      <td>2880.972058</td>
      <td>5000.0</td>
      <td>7000.0</td>
      <td>8000.0</td>
      <td>11000.0</td>
      <td>12000.0</td>
    </tr>
    <tr>
      <th>M</th>
      <td>6.0</td>
      <td>37.333333</td>
      <td>6.947422</td>
      <td>28.0</td>
      <td>32.75</td>
      <td>37.0</td>
      <td>43.5</td>
      <td>45.0</td>
      <td>6.0</td>
      <td>5333.333333</td>
      <td>3829.708431</td>
      <td>1000.0</td>
      <td>2250.0</td>
      <td>5000.0</td>
      <td>8500.0</td>
      <td>10000.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Per ogni variabile numerica (age e income) sono state calcolate diverse statistiche. A volte può essere più chiaro visualizzare il dataframe trasposto:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;sex&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sex</th>
      <th>F</th>
      <th>M</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="8" valign="top">age</th>
      <th>count</th>
      <td>5.000000</td>
      <td>6.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>28.400000</td>
      <td>37.333333</td>
    </tr>
    <tr>
      <th>std</th>
      <td>6.268971</td>
      <td>6.947422</td>
    </tr>
    <tr>
      <th>min</th>
      <td>18.000000</td>
      <td>28.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>27.000000</td>
      <td>32.750000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>32.000000</td>
      <td>37.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>32.000000</td>
      <td>43.500000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>33.000000</td>
      <td>45.000000</td>
    </tr>
    <tr>
      <th rowspan="8" valign="top">income</th>
      <th>count</th>
      <td>5.000000</td>
      <td>6.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>8600.000000</td>
      <td>5333.333333</td>
    </tr>
    <tr>
      <th>std</th>
      <td>2880.972058</td>
      <td>3829.708431</td>
    </tr>
    <tr>
      <th>min</th>
      <td>5000.000000</td>
      <td>1000.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>7000.000000</td>
      <td>2250.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>8000.000000</td>
      <td>5000.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>11000.000000</td>
      <td>8500.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>12000.000000</td>
      <td>10000.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Questa vista ci permette di comparare diverse statistiche delle due variabili <code class="docutils literal notranslate"><span class="pre">age</span></code> e <code class="docutils literal notranslate"><span class="pre">income</span></code> per <code class="docutils literal notranslate"><span class="pre">M</span></code> e <code class="docutils literal notranslate"><span class="pre">F</span></code>.</p>
<blockquote>
<div><p><strong>🙋‍♂️ Domanda 10</strong></p>
<p>Considerando il DataFrame precedentemente creato, si usi <code class="docutils literal notranslate"><span class="pre">groupby</span></code> per ottenere la somma dei redditi dei dipendenti di una data compagnia.</p>
</div></blockquote>
</section>
<section id="crosstab">
<h4><span class="section-number">9.2.7. </span>Crosstab<a class="headerlink" href="#crosstab" title="Permalink to this heading">#</a></h4>
<p>Le <code class="docutils literal notranslate"><span class="pre">Crosstab</span></code> permettono di descrivere le relazioni tra due o più variabili <strong>categoriche</strong>. Una volta specificata una
coppia di variabili categoriche, le righe e colonne della crosstab (nota anche come “tabella di contingenza”) enumerano indipendentemente tutti i valori univoci delle due variabili categoriche, così che ogni cella della crosstab identifica una determinata coppia di volari. All’interno delle celle, vengono dunque riportati i numeri di elementi per i quali le due variabili categoriche assumono una determinata coppia di valori.</p>
<p>Supponiamo di voler studiare le relazioni tra <code class="docutils literal notranslate"><span class="pre">company</span></code> e <code class="docutils literal notranslate"><span class="pre">sex</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;sex&#39;</span><span class="p">],</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;company&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>company</th>
      <th>CDX</th>
      <th>FLZ</th>
      <th>PTX</th>
    </tr>
    <tr>
      <th>sex</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>F</th>
      <td>1</td>
      <td>3</td>
      <td>1</td>
    </tr>
    <tr>
      <th>M</th>
      <td>3</td>
      <td>1</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>La tabella sopra ci dice ad esempio che nella compagnia CDX, <span class="math notranslate nohighlight">\(1\)</span> soggetto è di sesso femminile, mentre <span class="math notranslate nohighlight">\(3\)</span> soggetti sono di sesso maschile. Allo stesso modo, un soggetto della compagnia FLZ è di sesso maschile, mentre tre soggetti sono di sesso femminile. E’ possibile ottenere delle frequenze invece che dei conteggi, mediante <code class="docutils literal notranslate"><span class="pre">normalize=True</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;sex&#39;</span><span class="p">],</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;company&#39;</span><span class="p">],</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>company</th>
      <th>CDX</th>
      <th>FLZ</th>
      <th>PTX</th>
    </tr>
    <tr>
      <th>sex</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>F</th>
      <td>0.090909</td>
      <td>0.272727</td>
      <td>0.090909</td>
    </tr>
    <tr>
      <th>M</th>
      <td>0.272727</td>
      <td>0.090909</td>
      <td>0.181818</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Alternativamente, possiamo normalizzare la tabella solo per righe o solo per colonne specificando <code class="docutils literal notranslate"><span class="pre">normalize='index'</span></code> o <code class="docutils literal notranslate"><span class="pre">normalize='columns'</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;sex&#39;</span><span class="p">],</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;company&#39;</span><span class="p">],</span> <span class="n">normalize</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>company</th>
      <th>CDX</th>
      <th>FLZ</th>
      <th>PTX</th>
    </tr>
    <tr>
      <th>sex</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>F</th>
      <td>0.2</td>
      <td>0.600000</td>
      <td>0.200000</td>
    </tr>
    <tr>
      <th>M</th>
      <td>0.5</td>
      <td>0.166667</td>
      <td>0.333333</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Questa tabella riporta le percentuali di persone che lavorano nelle tre diverse compagnie per ciascun sesso, es., “il 20% delle donne lavora presso CDX”. Analogamente possiamo normalizzare per colonne come segue:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;sex&#39;</span><span class="p">],</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;company&#39;</span><span class="p">],</span> <span class="n">normalize</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>company</th>
      <th>CDX</th>
      <th>FLZ</th>
      <th>PTX</th>
    </tr>
    <tr>
      <th>sex</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>F</th>
      <td>0.25</td>
      <td>0.75</td>
      <td>0.333333</td>
    </tr>
    <tr>
      <th>M</th>
      <td>0.75</td>
      <td>0.25</td>
      <td>0.666667</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Questa tabella riporta le percentuali di uomini e donne che lavorano in ciascuna compagnia, es., “il 25% dei lavoratori di CDX sono donne”.</p>
<p>Se vogliamo studiare le relazioni tra più di due variabili categoriche, possiamo specificare una lista di colonne quando costruiamo la crosstab:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;sex&#39;</span><span class="p">],[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">],</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;company&#39;</span><span class="p">]])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th>age</th>
      <th>18</th>
      <th>27</th>
      <th>28</th>
      <th colspan="2" halign="left">32</th>
      <th>33</th>
      <th>35</th>
      <th>39</th>
      <th colspan="2" halign="left">45</th>
    </tr>
    <tr>
      <th>company</th>
      <th>CDX</th>
      <th>FLZ</th>
      <th>PTX</th>
      <th>CDX</th>
      <th>FLZ</th>
      <th>PTX</th>
      <th>CDX</th>
      <th>FLZ</th>
      <th>CDX</th>
      <th>PTX</th>
    </tr>
    <tr>
      <th>sex</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>F</th>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>M</th>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Ofni cella della crosstab sopra conta il numero di osservazioni che riportano una determinata terna di valori. Ad esempio, <span class="math notranslate nohighlight">\(1\)</span> soggetto è di sesso maschile, lavora per PTX e ha <span class="math notranslate nohighlight">\(28\)</span> anni, mentre <span class="math notranslate nohighlight">\(2\)</span> soggetti sono di sesso femminile, lavorano per FLZ e hanno <span class="math notranslate nohighlight">\(32\)</span> anni.</p>
<p>Oltre a riportare conteggi e frequenze, una crosstab permette di calcolare statistiche di terze variabili considerate non categoriche. Supponiamo di voler conoscere l’età media delle persone di un dato sesso che lavorano in una data azienda. Possiamo costruire una crosstab specificando una nuova variabile (age) per <code class="docutils literal notranslate"><span class="pre">values</span></code>. Dato che di questa variabile bisognerà calcolare un qualche valore aggregato, dobbiamo anche specificare <code class="docutils literal notranslate"><span class="pre">aggfunc</span></code> per esempio pari a <code class="docutils literal notranslate"><span class="pre">mean</span></code> (per calcolare la media dei valori interessati:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;sex&#39;</span><span class="p">],</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;company&#39;</span><span class="p">],</span> <span class="n">values</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">],</span> <span class="n">aggfunc</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>company</th>
      <th>CDX</th>
      <th>FLZ</th>
      <th>PTX</th>
    </tr>
    <tr>
      <th>sex</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>F</th>
      <td>18.000000</td>
      <td>30.333333</td>
      <td>33.0</td>
    </tr>
    <tr>
      <th>M</th>
      <td>37.333333</td>
      <td>39.000000</td>
      <td>36.5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>La tabella ci dice che l’età media delle persone di sesso maschile che lavorano per CDX è di <span class="math notranslate nohighlight">\(37,33\)</span> anni.</p>
<blockquote>
<div><p><strong>🙋‍♂️ Domanda 11</strong></p>
<p>Si costruisca una crosstab che, per ogni compagnia, riporti il numero di dipendenti di una data età.</p>
</div></blockquote>
</section>
<section id="manipolazione-esplicita-di-dataframe">
<h4><span class="section-number">9.2.8. </span>Manipolazione “esplicita” di DataFrame<a class="headerlink" href="#manipolazione-esplicita-di-dataframe" title="Permalink to this heading">#</a></h4>
<p>In alcuni casi può essere utile trattare i DataFrame “esplicitamente” come matrici di valori. Consideriamo ad esempio il seguente DataFrame:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df123</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Category&#39;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="s1">&#39;NumberOfElements&#39;</span><span class="p">:[</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]})</span>
<span class="n">df123</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Category</th>
      <th>NumberOfElements</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Supponiamo di voler costruire un nuovo DataFrame che, per ogni riga del dataframe <code class="docutils literal notranslate"><span class="pre">df123</span></code> contenga esattamente “NumberOfElements” righe con valore di “NumberOfElements” pari a uno. Vogliamo in pratica “espandere” il DataFrame  sopra come segue:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df123</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Category&#39;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="s1">&#39;NumberOfElements&#39;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]})</span>
<span class="n">df123</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Category</th>
      <th>NumberOfElements</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3</td>
      <td>1</td>
    </tr>
    <tr>
      <th>5</th>
      <td>3</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Per farlo in maniera automatica, possiamo trattare il DataFrame più “esplicitamente” come una matrice di valori iterandone le righe. Il nuovo DataFrame sarà dapprima costruito come una lista di Series (le righe del DataFrame) e poi trasformato in un DataFrame:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">newdat</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df123</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span> <span class="c1">#iterrows permette di iterare le righe di un DataFrame</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;NumberOfElements&#39;</span><span class="p">]):</span>
        <span class="n">newrow</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">newrow</span><span class="p">[</span><span class="s1">&#39;NumberOfElements&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span>
        <span class="n">newdat</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">newrow</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">newdat</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Category</th>
      <th>NumberOfElements</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3</td>
      <td>1</td>
    </tr>
    <tr>
      <th>5</th>
      <td>3</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Category&#39;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="s1">&#39;NumberOfElements&#39;</span><span class="p">:[</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="s1">&#39;CheckedElements&#39;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Category</th>
      <th>NumberOfElements</th>
      <th>CheckedElements</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>3</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>5</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>3</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="concatenazione-di-dataframe">
<h4><span class="section-number">9.2.9. </span>Concatenazione di DataFrame<a class="headerlink" href="#concatenazione-di-dataframe" title="Permalink to this heading">#</a></h4>
<p>I DataFrame possono essere concatenati per righe come mostrato di seguito:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span><span class="s1">&#39;B&#39;</span><span class="p">:[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span><span class="s1">&#39;C&#39;</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">12</span><span class="p">]})</span>
<span class="n">d2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:[</span><span class="mi">92</span><span class="p">,</span><span class="mi">8</span><span class="p">],</span><span class="s1">&#39;B&#39;</span><span class="p">:[</span><span class="mi">44</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span><span class="s1">&#39;C&#39;</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]})</span>
<span class="nb">print</span><span class="p">(</span><span class="n">d1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">d2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   A  B   C
0  1  3   0
1  2  2   2
2  3  6  -1
3  4  7  12
    A   B  C
0  92  44  0
1   8  -2  2
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">d1</span><span class="p">,</span><span class="n">d2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>3</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>6</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>7</td>
      <td>12</td>
    </tr>
    <tr>
      <th>0</th>
      <td>92</td>
      <td>44</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>8</td>
      <td>-2</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Se le colonne non sono compatibili, appariranno dei <code class="docutils literal notranslate"><span class="pre">NaN</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span><span class="s1">&#39;B&#39;</span><span class="p">:[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span><span class="s1">&#39;C&#39;</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">12</span><span class="p">]})</span>
<span class="n">d2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:[</span><span class="mi">92</span><span class="p">,</span><span class="mi">8</span><span class="p">],</span><span class="s1">&#39;D&#39;</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]})</span>

<span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">d1</span><span class="p">,</span><span class="n">d2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>6.0</td>
      <td>-1.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>7.0</td>
      <td>12.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0</th>
      <td>92</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>8</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>La concatenazione può avvenire anche per colonne:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="s1">&#39;B&#39;</span><span class="p">:[</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span><span class="s1">&#39;C&#39;</span><span class="p">:[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">12</span><span class="p">]})</span>
<span class="n">d2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:[</span><span class="mi">92</span><span class="p">,</span><span class="mi">8</span><span class="p">],</span><span class="s1">&#39;D&#39;</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]})</span>

<span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">d1</span><span class="p">,</span><span class="n">d2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>A</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>3</td>
      <td>-1</td>
      <td>92</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>7</td>
      <td>12</td>
      <td>8</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="merge-di-dataframe">
<h4><span class="section-number">9.2.10. </span>Merge di DataFrame<a class="headerlink" href="#merge-di-dataframe" title="Permalink to this heading">#</a></h4>
<p>Due DataFrame possono essere uniti mediante una operazione di <code class="docutils literal notranslate"><span class="pre">merge</span></code> simile a quanto avviene nei database. Consideriamo due dataframe di esempio:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;key&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;k0&#39;</span><span class="p">,</span> <span class="s1">&#39;k1&#39;</span><span class="p">,</span> <span class="s1">&#39;k2&#39;</span><span class="p">],</span>
                     <span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;v1&#39;</span><span class="p">,</span> <span class="s1">&#39;v2&#39;</span><span class="p">,</span> <span class="s1">&#39;v3&#39;</span><span class="p">],</span>
                     <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;v4&#39;</span><span class="p">,</span> <span class="s1">&#39;v5&#39;</span><span class="p">,</span> <span class="s1">&#39;v6&#39;</span><span class="p">],</span>
                     <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;v7&#39;</span><span class="p">,</span> <span class="s1">&#39;v8&#39;</span><span class="p">,</span> <span class="s1">&#39;v9&#39;</span><span class="p">]})</span>
   
<span class="n">a</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key</th>
      <th>a</th>
      <th>b</th>
      <th>c</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>k0</td>
      <td>v1</td>
      <td>v4</td>
      <td>v7</td>
    </tr>
    <tr>
      <th>1</th>
      <td>k1</td>
      <td>v2</td>
      <td>v5</td>
      <td>v8</td>
    </tr>
    <tr>
      <th>2</th>
      <td>k2</td>
      <td>v3</td>
      <td>v6</td>
      <td>v9</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;key&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;k0&#39;</span><span class="p">,</span> <span class="s1">&#39;k1&#39;</span><span class="p">,</span> <span class="s1">&#39;k2&#39;</span><span class="p">],</span>
                     <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;v9&#39;</span><span class="p">,</span> <span class="s1">&#39;v11&#39;</span><span class="p">,</span> <span class="s1">&#39;v12&#39;</span><span class="p">],</span>
                     <span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;v13&#39;</span><span class="p">,</span> <span class="s1">&#39;v4&#39;</span><span class="p">,</span> <span class="s1">&#39;v5&#39;</span><span class="p">]})</span>
<span class="n">b</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key</th>
      <th>d</th>
      <th>e</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>k0</td>
      <td>v9</td>
      <td>v13</td>
    </tr>
    <tr>
      <th>1</th>
      <td>k1</td>
      <td>v11</td>
      <td>v4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>k2</td>
      <td>v12</td>
      <td>v5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>I due dataframe hanno una colonna in comune che agisce da chiave e altre colonne che agiscono da valori. L’operazione di merge permette di unire i dataframe sulla base delle chiavi:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">on</span><span class="o">=</span><span class="s1">&#39;key&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key</th>
      <th>a</th>
      <th>b</th>
      <th>c</th>
      <th>d</th>
      <th>e</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>k0</td>
      <td>v1</td>
      <td>v4</td>
      <td>v7</td>
      <td>v9</td>
      <td>v13</td>
    </tr>
    <tr>
      <th>1</th>
      <td>k1</td>
      <td>v2</td>
      <td>v5</td>
      <td>v8</td>
      <td>v11</td>
      <td>v4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>k2</td>
      <td>v3</td>
      <td>v6</td>
      <td>v9</td>
      <td>v12</td>
      <td>v5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="join-di-dataframe">
<h4><span class="section-number">9.2.11. </span>Join di DataFrame<a class="headerlink" href="#join-di-dataframe" title="Permalink to this heading">#</a></h4>
<p>Le operazioni di <code class="docutils literal notranslate"><span class="pre">join</span></code> possono essere applicate per unire dataframe indicizzati in maniera compatibile:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;v1&#39;</span><span class="p">,</span> <span class="s1">&#39;v2&#39;</span><span class="p">,</span> <span class="s1">&#39;v3&#39;</span><span class="p">],</span>
                     <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;v4&#39;</span><span class="p">,</span> <span class="s1">&#39;v5&#39;</span><span class="p">,</span> <span class="s1">&#39;v6&#39;</span><span class="p">],</span>
                     <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;v7&#39;</span><span class="p">,</span> <span class="s1">&#39;v8&#39;</span><span class="p">,</span> <span class="s1">&#39;v9&#39;</span><span class="p">]},</span>
                     <span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;k0&#39;</span><span class="p">,</span> <span class="s1">&#39;k1&#39;</span><span class="p">,</span> <span class="s1">&#39;k2&#39;</span><span class="p">])</span>
   
<span class="n">a</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
      <th>c</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>k0</th>
      <td>v1</td>
      <td>v4</td>
      <td>v7</td>
    </tr>
    <tr>
      <th>k1</th>
      <td>v2</td>
      <td>v5</td>
      <td>v8</td>
    </tr>
    <tr>
      <th>k2</th>
      <td>v3</td>
      <td>v6</td>
      <td>v9</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;v9&#39;</span><span class="p">,</span> <span class="s1">&#39;v11&#39;</span><span class="p">,</span> <span class="s1">&#39;v12&#39;</span><span class="p">],</span>
                     <span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;v13&#39;</span><span class="p">,</span> <span class="s1">&#39;v4&#39;</span><span class="p">,</span> <span class="s1">&#39;v5&#39;</span><span class="p">]},</span>
                     <span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;k0&#39;</span><span class="p">,</span> <span class="s1">&#39;k3&#39;</span><span class="p">,</span> <span class="s1">&#39;k2&#39;</span><span class="p">],)</span>
<span class="n">b</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>d</th>
      <th>e</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>k0</th>
      <td>v9</td>
      <td>v13</td>
    </tr>
    <tr>
      <th>k3</th>
      <td>v11</td>
      <td>v4</td>
    </tr>
    <tr>
      <th>k2</th>
      <td>v12</td>
      <td>v5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
      <th>c</th>
      <th>d</th>
      <th>e</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>k0</th>
      <td>v1</td>
      <td>v4</td>
      <td>v7</td>
      <td>v9</td>
      <td>v13</td>
    </tr>
    <tr>
      <th>k1</th>
      <td>v2</td>
      <td>v5</td>
      <td>v8</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>k2</th>
      <td>v3</td>
      <td>v6</td>
      <td>v9</td>
      <td>v12</td>
      <td>v5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Come si può notare, l’operazione di join avviene solo utilizzando gli indici in comune.</p>
</section>
<section id="input-output">
<h4><span class="section-number">9.2.12. </span>Input/Output<a class="headerlink" href="#input-output" title="Permalink to this heading">#</a></h4>
<p>Pandas mette a disposizione diverse funzioni per leggere e scrivere dati. Vedremo in particolare le funzioni per leggere e scrivere file <code class="docutils literal notranslate"><span class="pre">csv</span></code>. E’ possibile leggere file csv (<a class="reference external" href="https://it.wikipedia.org/wiki/Comma-separated_values">https://it.wikipedia.org/wiki/Comma-separated_values</a>) mediante la funzione <code class="docutils literal notranslate"><span class="pre">pd.read_csv</span></code>. La lettura può avvenire da file locali passando il path relativo o da URL:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;http://iplab.dmi.unict.it/furnari/downloads/students.csv&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>admit</th>
      <th>gre</th>
      <th>gpa</th>
      <th>prestige</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>380</td>
      <td>3.61</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>660</td>
      <td>3.67</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>800</td>
      <td>4.00</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>640</td>
      <td>3.19</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>520</td>
      <td>2.93</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Allo stesso modo, è possibile scrivere un DataFrame su file csv come segue:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;file.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Dato che gli indici possono non essere sequenziali in un DataFrame, Pandas li inserisce nel csv come “colonna senza nome”. Ad esempio, le prime righe del file che abbiamo appena scritto (file.csv) sono le seguenti:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">,</span><span class="n">admit</span><span class="p">,</span><span class="n">gre</span><span class="p">,</span><span class="n">gpa</span><span class="p">,</span><span class="n">prestige</span>
<span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">380</span><span class="p">,</span><span class="mf">3.61</span><span class="p">,</span><span class="mi">3</span>
<span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">660</span><span class="p">,</span><span class="mf">3.67</span><span class="p">,</span><span class="mi">3</span>
<span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">800</span><span class="p">,</span><span class="mf">4.0</span><span class="p">,</span><span class="mi">1</span>
<span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">640</span><span class="p">,</span><span class="mf">3.19</span><span class="p">,</span><span class="mi">4</span>
<span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">520</span><span class="p">,</span><span class="mf">2.93</span><span class="p">,</span><span class="mi">4</span>
</pre></div>
</div>
<p>Come si può vedere, la prima colonna contiene i valori degli indici, ma non ha nome. Ciò può causare problemi quando carichiamo nuovamente il DataFrame:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;file.csv&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>admit</th>
      <th>gre</th>
      <th>gpa</th>
      <th>prestige</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>380</td>
      <td>3.61</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1</td>
      <td>660</td>
      <td>3.67</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>1</td>
      <td>800</td>
      <td>4.00</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>1</td>
      <td>640</td>
      <td>3.19</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>0</td>
      <td>520</td>
      <td>2.93</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Possiamo risolvere il problema di diversi modi:</p>
<ul class="simple">
<li><p>Eliminare la colonna “Unnamed: 0” dal DataFrame appena caricato (solo se gli indici sono sequenziali);</p></li>
<li><p>Specificare di usare la colonna “Unnamed: 0” come colonna degli indici durante il caricamento;</p></li>
<li><p>Salvare il DataFrame senza indici (solo se gli indici sono sequenziali).</p></li>
</ul>
<p>Vediamo i tre casi:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;file.csv&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;Unnamed: 0&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>admit</th>
      <th>gre</th>
      <th>gpa</th>
      <th>prestige</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>380</td>
      <td>3.61</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>660</td>
      <td>3.67</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>800</td>
      <td>4.00</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>640</td>
      <td>3.19</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>520</td>
      <td>2.93</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;file.csv&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="s1">&#39;Unnamed: 0&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>admit</th>
      <th>gre</th>
      <th>gpa</th>
      <th>prestige</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>380</td>
      <td>3.61</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>660</td>
      <td>3.67</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>800</td>
      <td>4.00</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>640</td>
      <td>3.19</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>520</td>
      <td>2.93</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;file.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;file.csv&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>admit</th>
      <th>gre</th>
      <th>gpa</th>
      <th>prestige</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>380</td>
      <td>3.61</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>660</td>
      <td>3.67</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>800</td>
      <td>4.00</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>640</td>
      <td>3.19</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>520</td>
      <td>2.93</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section id="esempio-di-manipolazione-dati">
<h3><span class="section-number">9.3. </span>Esempio di manipolazione dati<a class="headerlink" href="#esempio-di-manipolazione-dati" title="Permalink to this heading">#</a></h3>
<p>Spesso, i dati devono essere opportunamente trattati per poterli analizzare. Vediamo un esempio di come combinare gli strumenti discussi sopra per manipolare un dataset reale.</p>
<p>Considereremo dataset disponibile a questo URL: <a class="reference external" href="https://www.kaggle.com/lava18/google-play-store-apps">https://www.kaggle.com/lava18/google-play-store-apps</a>. Una copia del dataset è disponibile al seguente URL per scopi didattici: <a class="reference external" href="http://iplab.dmi.unict.it/furnari/downloads/googleplaystore.csv">http://iplab.dmi.unict.it/furnari/downloads/googleplaystore.csv</a>. Carichiamo il dataset e visualizziamo le prime righe per assicurarci che sia stato caricato correttamente:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;http://iplab.dmi.unict.it/furnari/downloads/googleplaystore.csv&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>App</th>
      <th>Category</th>
      <th>Rating</th>
      <th>Reviews</th>
      <th>Size</th>
      <th>Installs</th>
      <th>Type</th>
      <th>Price</th>
      <th>Content Rating</th>
      <th>Genres</th>
      <th>Last Updated</th>
      <th>Current Ver</th>
      <th>Android Ver</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Photo Editor &amp; Candy Camera &amp; Grid &amp; ScrapBook</td>
      <td>ART_AND_DESIGN</td>
      <td>4.1</td>
      <td>159</td>
      <td>19M</td>
      <td>10,000+</td>
      <td>Free</td>
      <td>0</td>
      <td>Everyone</td>
      <td>Art &amp; Design</td>
      <td>January 7, 2018</td>
      <td>1.0.0</td>
      <td>4.0.3 and up</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Coloring book moana</td>
      <td>ART_AND_DESIGN</td>
      <td>3.9</td>
      <td>967</td>
      <td>14M</td>
      <td>500,000+</td>
      <td>Free</td>
      <td>0</td>
      <td>Everyone</td>
      <td>Art &amp; Design;Pretend Play</td>
      <td>January 15, 2018</td>
      <td>2.0.0</td>
      <td>4.0.3 and up</td>
    </tr>
    <tr>
      <th>2</th>
      <td>U Launcher Lite – FREE Live Cool Themes, Hide ...</td>
      <td>ART_AND_DESIGN</td>
      <td>4.7</td>
      <td>87510</td>
      <td>8.7M</td>
      <td>5,000,000+</td>
      <td>Free</td>
      <td>0</td>
      <td>Everyone</td>
      <td>Art &amp; Design</td>
      <td>August 1, 2018</td>
      <td>1.2.4</td>
      <td>4.0.3 and up</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Sketch - Draw &amp; Paint</td>
      <td>ART_AND_DESIGN</td>
      <td>4.5</td>
      <td>215644</td>
      <td>25M</td>
      <td>50,000,000+</td>
      <td>Free</td>
      <td>0</td>
      <td>Teen</td>
      <td>Art &amp; Design</td>
      <td>June 8, 2018</td>
      <td>Varies with device</td>
      <td>4.2 and up</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Pixel Draw - Number Art Coloring Book</td>
      <td>ART_AND_DESIGN</td>
      <td>4.3</td>
      <td>967</td>
      <td>2.8M</td>
      <td>100,000+</td>
      <td>Free</td>
      <td>0</td>
      <td>Everyone</td>
      <td>Art &amp; Design;Creativity</td>
      <td>June 20, 2018</td>
      <td>1.1</td>
      <td>4.4 and up</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Visualizziamo le proprietà del dataset:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 10841 entries, 0 to 10840
Data columns (total 13 columns):
App               10841 non-null object
Category          10841 non-null object
Rating            9367 non-null float64
Reviews           10841 non-null object
Size              10841 non-null object
Installs          10841 non-null object
Type              10840 non-null object
Price             10841 non-null object
Content Rating    10840 non-null object
Genres            10841 non-null object
Last Updated      10841 non-null object
Current Ver       10833 non-null object
Android Ver       10838 non-null object
dtypes: float64(1), object(12)
memory usage: 1.1+ MB
</pre></div>
</div>
</div>
</div>
<p>Il dataset contiene <span class="math notranslate nohighlight">\(10841\)</span> osservazioni e <span class="math notranslate nohighlight">\(13\)</span> variabili. Osserviamo che molte delle variabili (tranne “Rating”) sono di tipo “object”, anche se rappresentano dei valori numerici (es., Reviews, Size, Installs e Price). Osservando le prime righe del DataFrame visualizzate sopra possiamo dedurre che:</p>
<ul class="simple">
<li><p>Size non è rappresentato come valore numerico in quanto contiene l’unità di misura “M”;</p></li>
<li><p>Installs è in realtà una variabile categorica (riporta un “+” alla fine, quindi indica la classe “più di xxxx installazioni”);</p></li>
</ul>
<p>Non ci sono motivazioni apparenti per cui Reviews e Rating non siano stati interpretati come numeri. Costruiamo una funzione filtro che identifichi se un valori è convertibile in un dato tipo o meno:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">cannot_convert</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="nb">float</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">t</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">True</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cannot_convert</span><span class="p">(</span><span class="s1">&#39;12&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cannot_convert</span><span class="p">(</span><span class="s1">&#39;12f&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>False
True
</pre></div>
</div>
</div>
</div>
<p>Applichiamo il filtro alla colonna Review per visualizzare i valori che non possono essere convertiti:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="n">cannot_convert</span><span class="p">,</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Reviews&#39;</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;3.0M&#39;]
</pre></div>
</div>
</div>
</div>
<p>Possiamo sostituire questo valore con la sua versione per esteso mediante il metodo <code class="docutils literal notranslate"><span class="pre">replace</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Reviews&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Reviews&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="s1">&#39;3.0M&#39;</span><span class="p">:</span><span class="mi">3000000</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<p>A questo punto possiamo convertire i tipi dei valori della colonna in interi:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Reviews&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Reviews&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Visualizziamo nuovamente le informazioni del DataFrame:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 10841 entries, 0 to 10840
Data columns (total 13 columns):
App               10841 non-null object
Category          10841 non-null object
Rating            9367 non-null float64
Reviews           10841 non-null int32
Size              10841 non-null object
Installs          10841 non-null object
Type              10840 non-null object
Price             10841 non-null object
Content Rating    10840 non-null object
Genres            10841 non-null object
Last Updated      10841 non-null object
Current Ver       10833 non-null object
Android Ver       10838 non-null object
dtypes: float64(1), int32(1), object(11)
memory usage: 1.0+ MB
</pre></div>
</div>
</div>
</div>
<p>Reviews è adesso un intero. Eseguiamo una analisi simile sulla variabile Price:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="n">cannot_convert</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]))[:</span><span class="mi">10</span><span class="p">]</span> <span class="c1">#visualizziamo solo i primi 10 elementi</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;$4.99&#39;,
 &#39;$4.99&#39;,
 &#39;$4.99&#39;,
 &#39;$4.99&#39;,
 &#39;$3.99&#39;,
 &#39;$3.99&#39;,
 &#39;$6.99&#39;,
 &#39;$1.49&#39;,
 &#39;$2.99&#39;,
 &#39;$3.99&#39;]
</pre></div>
</div>
</div>
</div>
<p>Possiamo convertire le stringhe in float eliminando il dollaro iniziale mediante <code class="docutils literal notranslate"><span class="pre">apply</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">strip_dollar</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;$&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">x</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">strip_dollar</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Vediamo se ci sono ancora valori che non possono essere convertiti:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="n">cannot_convert</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;Everyone&#39;]
</pre></div>
</div>
</div>
</div>
<p>Dato che non sappiamo come interpretare il valore “Everyone”, sostituiamolo con un NaN:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="s1">&#39;Everyone&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<p>Adesso possiamo procedere alla conversione:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 10841 entries, 0 to 10840
Data columns (total 13 columns):
App               10841 non-null object
Category          10841 non-null object
Rating            9367 non-null float64
Reviews           10841 non-null int32
Size              10841 non-null object
Installs          10841 non-null object
Type              10840 non-null object
Price             10840 non-null float64
Content Rating    10840 non-null object
Genres            10841 non-null object
Last Updated      10841 non-null object
Current Ver       10833 non-null object
Android Ver       10838 non-null object
dtypes: float64(2), int32(1), object(10)
memory usage: 1.0+ MB
</pre></div>
</div>
</div>
</div>
<p>Modifichiamo anche “Size” eliminando la “M” finale:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Size&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Size&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Verifichiamo l’esistenza di valori non convertibili:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="n">cannot_convert</span><span class="p">,</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Size&#39;</span><span class="p">]))[:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;Varies with devic&#39;,
 &#39;Varies with devic&#39;,
 &#39;Varies with devic&#39;,
 &#39;Varies with devic&#39;,
 &#39;Varies with devic&#39;,
 &#39;Varies with devic&#39;,
 &#39;Varies with devic&#39;,
 &#39;Varies with devic&#39;,
 &#39;Varies with devic&#39;,
 &#39;Varies with devic&#39;]
</pre></div>
</div>
</div>
</div>
<p>Sostituiamo questi valori con NaN:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Size&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Size&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="s1">&#39;Varies with devic&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<p>Verifichiamo nuovamente la presenza di valori che non possono essere convertiti:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="n">cannot_convert</span><span class="p">,</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Size&#39;</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;1,000&#39;]
</pre></div>
</div>
</div>
</div>
<p>Possiamo rimuovere la virgola usata per indicare le migliaia e convertire in float:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Size&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Size&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 10841 entries, 0 to 10840
Data columns (total 13 columns):
App               10841 non-null object
Category          10841 non-null object
Rating            9367 non-null float64
Reviews           10841 non-null int32
Size              9146 non-null float64
Installs          10841 non-null object
Type              10840 non-null object
Price             10840 non-null float64
Content Rating    10840 non-null object
Genres            10841 non-null object
Last Updated      10841 non-null object
Current Ver       10833 non-null object
Android Ver       10838 non-null object
dtypes: float64(3), int32(1), object(9)
memory usage: 1.0+ MB
</pre></div>
</div>
</div>
</div>
<p>Valutiamo se è il caso di trasformare anche “Installs” in un valore numerico. Vediamo quanti valori univoci di “Installs” ci sono nel dataset:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Installs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>22
</pre></div>
</div>
</div>
</div>
<p>Abbiamo solo <span class="math notranslate nohighlight">\(22\)</span> valori, che paragonati alle 10841 osservazioni, indicano che “Installs” è una variabile molto quantizzata, per cui probabilmente ha senso considerarla come categorica, piuttosto che come un valore numerico.</p>
<p>Il DataFrame contiene dei <code class="docutils literal notranslate"><span class="pre">NaN</span></code>. A seconda dei casi può avere senso tenerli o rimuoverli. Dato che i dati sono molti, possiamo rimuoverli con <code class="docutils literal notranslate"><span class="pre">dropna</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Possiamo quindi iniziare a esplorare i dati con gli strumenti visti. Visualizziamo ad esempio i valori medi delle variabili numeriche per categoria:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Category&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Rating</th>
      <th>Reviews</th>
      <th>Size</th>
      <th>Price</th>
    </tr>
    <tr>
      <th>Category</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>ART_AND_DESIGN</th>
      <td>4.381034</td>
      <td>1.874517e+04</td>
      <td>12.939655</td>
      <td>0.102931</td>
    </tr>
    <tr>
      <th>AUTO_AND_VEHICLES</th>
      <td>4.147619</td>
      <td>1.575057e+04</td>
      <td>24.728571</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>BEAUTY</th>
      <td>4.291892</td>
      <td>5.020243e+03</td>
      <td>15.513514</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>BOOKS_AND_REFERENCE</th>
      <td>4.320139</td>
      <td>2.815291e+04</td>
      <td>23.543750</td>
      <td>0.145069</td>
    </tr>
    <tr>
      <th>BUSINESS</th>
      <td>4.119919</td>
      <td>2.497765e+04</td>
      <td>26.217480</td>
      <td>0.249593</td>
    </tr>
    <tr>
      <th>COMICS</th>
      <td>4.130612</td>
      <td>1.254822e+04</td>
      <td>34.626531</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>COMMUNICATION</th>
      <td>4.102844</td>
      <td>5.549962e+05</td>
      <td>60.765403</td>
      <td>0.197773</td>
    </tr>
    <tr>
      <th>DATING</th>
      <td>3.957803</td>
      <td>2.254489e+04</td>
      <td>18.312717</td>
      <td>0.086590</td>
    </tr>
    <tr>
      <th>EDUCATION</th>
      <td>4.387273</td>
      <td>6.435159e+04</td>
      <td>30.588182</td>
      <td>0.163273</td>
    </tr>
    <tr>
      <th>ENTERTAINMENT</th>
      <td>4.146667</td>
      <td>1.621530e+05</td>
      <td>21.853333</td>
      <td>0.033222</td>
    </tr>
    <tr>
      <th>EVENTS</th>
      <td>4.478947</td>
      <td>3.321605e+03</td>
      <td>23.213158</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>FAMILY</th>
      <td>4.190347</td>
      <td>1.801297e+05</td>
      <td>37.459963</td>
      <td>1.390074</td>
    </tr>
    <tr>
      <th>FINANCE</th>
      <td>4.112030</td>
      <td>3.903023e+04</td>
      <td>31.249624</td>
      <td>9.172444</td>
    </tr>
    <tr>
      <th>FOOD_AND_DRINK</th>
      <td>4.097619</td>
      <td>5.103793e+04</td>
      <td>24.163095</td>
      <td>0.059405</td>
    </tr>
    <tr>
      <th>GAME</th>
      <td>4.269507</td>
      <td>1.386276e+06</td>
      <td>46.827823</td>
      <td>0.281704</td>
    </tr>
    <tr>
      <th>HEALTH_AND_FITNESS</th>
      <td>4.223767</td>
      <td>4.519072e+04</td>
      <td>29.658296</td>
      <td>0.154350</td>
    </tr>
    <tr>
      <th>HOUSE_AND_HOME</th>
      <td>4.162500</td>
      <td>2.935998e+04</td>
      <td>17.505357</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>LIBRARIES_AND_DEMO</th>
      <td>4.204918</td>
      <td>1.632359e+04</td>
      <td>225.267213</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>LIFESTYLE</th>
      <td>4.093571</td>
      <td>3.109027e+04</td>
      <td>28.650714</td>
      <td>6.976429</td>
    </tr>
    <tr>
      <th>MAPS_AND_NAVIGATION</th>
      <td>4.013684</td>
      <td>3.858909e+04</td>
      <td>26.282105</td>
      <td>0.157474</td>
    </tr>
    <tr>
      <th>MEDICAL</th>
      <td>4.184259</td>
      <td>4.392454e+03</td>
      <td>49.643827</td>
      <td>3.077901</td>
    </tr>
    <tr>
      <th>NEWS_AND_MAGAZINES</th>
      <td>4.143787</td>
      <td>5.826802e+04</td>
      <td>14.948521</td>
      <td>0.023550</td>
    </tr>
    <tr>
      <th>PARENTING</th>
      <td>4.347727</td>
      <td>1.999950e+04</td>
      <td>21.579545</td>
      <td>0.113409</td>
    </tr>
    <tr>
      <th>PERSONALIZATION</th>
      <td>4.323381</td>
      <td>1.257211e+05</td>
      <td>50.115827</td>
      <td>0.427338</td>
    </tr>
    <tr>
      <th>PHOTOGRAPHY</th>
      <td>4.147034</td>
      <td>3.260313e+05</td>
      <td>18.970763</td>
      <td>0.331992</td>
    </tr>
    <tr>
      <th>PRODUCTIVITY</th>
      <td>4.143830</td>
      <td>1.854692e+05</td>
      <td>38.899149</td>
      <td>0.225362</td>
    </tr>
    <tr>
      <th>SHOPPING</th>
      <td>4.227933</td>
      <td>2.624461e+05</td>
      <td>33.397207</td>
      <td>0.030615</td>
    </tr>
    <tr>
      <th>SOCIAL</th>
      <td>4.257062</td>
      <td>1.830882e+05</td>
      <td>24.317514</td>
      <td>0.011186</td>
    </tr>
    <tr>
      <th>SPORTS</th>
      <td>4.204858</td>
      <td>2.128411e+05</td>
      <td>30.159109</td>
      <td>0.324818</td>
    </tr>
    <tr>
      <th>TOOLS</th>
      <td>4.010742</td>
      <td>1.663130e+05</td>
      <td>47.929068</td>
      <td>0.290047</td>
    </tr>
    <tr>
      <th>TRAVEL_AND_LOCAL</th>
      <td>4.043125</td>
      <td>4.824554e+04</td>
      <td>25.357500</td>
      <td>0.165687</td>
    </tr>
    <tr>
      <th>VIDEO_PLAYERS</th>
      <td>4.025862</td>
      <td>2.074172e+05</td>
      <td>22.881897</td>
      <td>0.008534</td>
    </tr>
    <tr>
      <th>WEATHER</th>
      <td>4.241176</td>
      <td>7.639225e+04</td>
      <td>24.805882</td>
      <td>0.459608</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<blockquote>
<div><p><strong>🙋‍♂️ Domanda 12</strong></p>
<p>Visualizzare il numero medio di review per tipo (variabile Type).</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/agconti/kaggle-titanic/master/data/train.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Ticket&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;345779&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Name</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>Cabin</th>
      <th>Embarked</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>81</th>
      <td>82</td>
      <td>1</td>
      <td>3</td>
      <td>Sheerlinck, Mr. Jan Baptist</td>
      <td>male</td>
      <td>29.0</td>
      <td>0</td>
      <td>0</td>
      <td>345779</td>
      <td>9.5</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="esercizi">
<h3><span class="section-number">9.4. </span>Esercizi<a class="headerlink" href="#esercizi" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><p>🧑‍💻 Esercizio 1</p>
<p>Si carichi il dataset disponibile al seguente URL: <a class="reference external" href="https://raw.githubusercontent.com/agconti/kaggle-titanic/master/data/train.csv">https://raw.githubusercontent.com/agconti/kaggle-titanic/master/data/train.csv</a> in modo da utilizzare i valori della colonna “PassengerId” come indici e si applichino le seguenti trasfromazioni:</p>
<ul class="simple">
<li><p>Si rimuovano le righe che contengono dei valori NaN;</p></li>
<li><p>Si modifichi il DataFrame sostituendo nella colonna “Sex” ogni occorrenza di “male” con “M” e ogni occorrenza di “female” con “F”;</p></li>
<li><p>Si inserisca una nuova colonna “Old” con valore pari a “1” se Age è superiore all’età media dei passeggeri e “0” altrimenti;</p></li>
<li><p>Si convertano i valori della colonna “Age” in interi.</p></li>
</ul>
</div></blockquote>
<blockquote>
<div><p>🧑‍💻 Esercizio 2</p>
<p>Si consideri il dataset caricato e modificato nell’esercizio precedente. Si trovi il nome del passeggero con ticket dal codice “345779”.</p>
</div></blockquote>
<blockquote>
<div><p>🧑‍💻 Esercizio 3</p>
<p>Quali sono i nomei dei 5 passeggeri più giovani?</p>
</div></blockquote>
<blockquote>
<div><p>🧑‍💻 Esercizio 4</p>
<p>Si consideri il dataset caricato e modificato nell’esercizio precedente. Si selezionino tutte le osservazioni relative a passeggeri di età compresa tra 20 e 30 anni.</p>
</div></blockquote>
<blockquote>
<div><p>🧑‍💻 Esercizio 5</p>
<p>Si consideri il dataset caricato e modificato negli esercizi precedenti. Si calcoli la tariffa media pagata dai passeggeri di sesso femminile in seconda classe.</p>
</div></blockquote>
<blockquote>
<div><p>🧑‍💻 Esercizio 6</p>
<p>Si consideri il dataset caricato e modificato negli esercizi precedenti. Si costruisca una crosstab che permetta di rispondere alle seguenti domande:</p>
<ul class="simple">
<li><p>Quanti passeggeri di sesso maschile sono sopravvisuti?</p></li>
<li><p>Quanti passeggeri di sesso femminile non sono sopravvisuti?</p></li>
</ul>
</div></blockquote>
<blockquote>
<div><p>🧑‍💻 Esercizio 7</p>
<p>Si consideri il dataset caricato e modificato negli esercizi precedenti. Si costruisca una crosstab che permetta di rispondere alle seguenti domande:</p>
<ul class="simple">
<li><p>Quanti passeggeri di sesso maschile sono sopravvisuti in prima classe?</p></li>
<li><p>Quanti passeggeri di sesso femminile sono sopravvisuti in terza classe?</p></li>
<li><p>Quanti passeggeri di sesso maschile sono sopravvisuti in terza classe?</p></li>
</ul>
</div></blockquote>
<blockquote>
<div><p>🧑‍💻 Esercizio 8</p>
<p>Si consideri il seguente DataFrame:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Category&#39;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="s1">&#39;NumberOfElements&#39;</span><span class="p">:[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="s1">&#39;CheckedElements&#39;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]})</span>
</pre></div>
</div>
<p>Si costruisca un nuovo DataFrame che contenga le stesse colonne del DataFrame considerato e che per ogni riga di esso contenga <code class="docutils literal notranslate"><span class="pre">NumberOfElements</span></code> nuove righe con categoria uguale a <code class="docutils literal notranslate"><span class="pre">Category</span></code>  di cui <code class="docutils literal notranslate"><span class="pre">CheckedElements</span></code> con valore di <code class="docutils literal notranslate"><span class="pre">CheckedElements</span></code> pari a uno e le restanti con valore di <code class="docutils literal notranslate"><span class="pre">CheckedElements</span></code> pari a zero.</p>
<p>Il risultato della manipolazione dovrà essere uguale al seguente dataset:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Category&#39;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> 
              <span class="s1">&#39;NumberOfElements&#39;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> 
              <span class="s1">&#39;CheckedElements&#39;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]})</span>
</pre></div>
</div>
</div></blockquote>
</section>
<section id="referenze">
<h3><span class="section-number">9.5. </span>Referenze<a class="headerlink" href="#referenze" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Documentazione di Pandas: <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/">https://pandas.pydata.org/pandas-docs/stable/</a></p></li>
<li><p>Sito Kaggle (dove trovare dati da analizzare): <a class="reference external" href="http://kaggle.com/">http://kaggle.com/</a></p></li>
<li><p>Pagina dalla quale scaricare diversi csv di dataset della libreria R: <a class="reference external" href="https://vincentarelbundock.github.io/Rdatasets/datasets.html">https://vincentarelbundock.github.io/Rdatasets/datasets.html</a></p></li>
</ul>
</section>
</section>
</div>
<div class="toctree-wrapper compound">
<span id="document-lectures/04_misure_di_frequenze_e_rappresentazione_grafica_dei_dati"></span><section class="tex2jax_ignore mathjax_ignore" id="misure-di-frequenze-e-rappresentazione-grafica-dei-dati">
<h2><span class="section-number">10. </span>Misure di Frequenze e Rappresentazione Grafica dei Dati<a class="headerlink" href="#misure-di-frequenze-e-rappresentazione-grafica-dei-dati" title="Permalink to this heading">#</a></h2>
<p>In questa lezione, inizieremo a vedere dei primi strumenti per riassumere le caratteristiche fondamentali dei dati.</p>
<section id="frequenze-assolute-e-relative">
<h3><span class="section-number">10.1. </span>Frequenze Assolute e Relative<a class="headerlink" href="#frequenze-assolute-e-relative" title="Permalink to this heading">#</a></h3>
<section id="frequenze-assolute">
<h4><span class="section-number">10.1.1. </span>Frequenze Assolute<a class="headerlink" href="#frequenze-assolute" title="Permalink to this heading">#</a></h4>
<p>Un primo modo di descrivere i dati consiste nel calcolare il numero di volte in cui ciascun valore appare. Queste sono chiamate “frequenze assolute”. Le frequenze assolute sono in genere calcolate per variabili discrete in cui le osservazioni assumono un numero finito di valori.</p>
<p>Siano</p>
<div class="math notranslate nohighlight">
\[a_1, a_2, \ldots, a_3\]</div>
<p>i valori che la variabile in considerazione può assumere.</p>
<p>Le frequenze assolute <span class="math notranslate nohighlight">\(n_i\)</span> sono definite come il numero di volte che <span class="math notranslate nohighlight">\(a_i\)</span> appare nel campione. Si noti che:</p>
<div class="math notranslate nohighlight">
\[\sum_i n_i = n\]</div>
<p>Dove <span class="math notranslate nohighlight">\(n\)</span> è il numero totale di elementi nel campione.</p>
<section id="esempi">
<h5><span class="section-number">10.1.1.1. </span>Esempi<a class="headerlink" href="#esempi" title="Permalink to this heading">#</a></h5>
<p>Consideriamo un semplice campione di 10 pazienti per i quali sono stati rilevati dei dati. Consideriamo una variabile <code class="docutils literal notranslate"><span class="pre">gender</span></code> che indica il genere dei pazienti:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    M
1    F
2    M
3    M
4    M
5    F
6    F
7    F
8    F
9    F
dtype: object
</pre></div>
</div>
</div>
</div>
<p>I valori univoci in questo semplici esempi saranno due:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    M
1    F
dtype: object
</pre></div>
</div>
</div>
</div>
<p>Le frequenze assolute del campione in oggetto sono riassunte nella tabella seguente:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>F    6
M    4
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Consideriamo un dataset un po’ più complesso, contenente pesi (in libbre), altezze (in pollici) e sesso di diversi soggetti. Il dataset avrà il seguente aspetto:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sex</th>
      <th>height</th>
      <th>weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>M</td>
      <td>74</td>
      <td>53.484771</td>
    </tr>
    <tr>
      <th>1</th>
      <td>M</td>
      <td>70</td>
      <td>38.056472</td>
    </tr>
    <tr>
      <th>2</th>
      <td>F</td>
      <td>61</td>
      <td>34.970812</td>
    </tr>
    <tr>
      <th>3</th>
      <td>M</td>
      <td>68</td>
      <td>35.999365</td>
    </tr>
    <tr>
      <th>4</th>
      <td>F</td>
      <td>66</td>
      <td>34.559390</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>4226</th>
      <td>F</td>
      <td>69</td>
      <td>23.862436</td>
    </tr>
    <tr>
      <th>4227</th>
      <td>M</td>
      <td>69</td>
      <td>38.262182</td>
    </tr>
    <tr>
      <th>4228</th>
      <td>F</td>
      <td>64</td>
      <td>34.970812</td>
    </tr>
    <tr>
      <th>4229</th>
      <td>F</td>
      <td>64</td>
      <td>28.388071</td>
    </tr>
    <tr>
      <th>4230</th>
      <td>F</td>
      <td>61</td>
      <td>22.628172</td>
    </tr>
  </tbody>
</table>
<p>4231 rows × 3 columns</p>
</div></div></div>
</div>
<p>Notiamo che i valori delle altezze sono quantizzate. I valori univoci in questo caso saranno i seguenti:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([74, 70, 61, 68, 66, 65, 64, 67, 72, 71, 76, 69, 63, 75, 60, 59, 73])
</pre></div>
</div>
</div>
</div>
<p>Le frequenze assolute in questo caso saranno le seguenti:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>59     52
60    130
61    411
63    291
64    435
65    351
66    391
67    377
68    355
69    302
70    272
71    235
72    260
73    146
74    104
75     72
76     47
Name: height, dtype: int64
</pre></div>
</div>
</div>
</div>
</section>
<section id="diagramma-a-barre-delle-frequenze-assolute">
<h5><span class="section-number">10.1.1.2. </span>Diagramma a Barre delle Frequenze Assolute<a class="headerlink" href="#diagramma-a-barre-delle-frequenze-assolute" title="Permalink to this heading">#</a></h5>
<p>Le frequenze dei dati possono essere rappresentate graficamente mediante un diagramma a barre che pone sull’asse delle <span class="math notranslate nohighlight">\(x\)</span> il valore univoco (<span class="math notranslate nohighlight">\(a_i\)</span>) e che rappresenta la frequenza assoluta <span class="math notranslate nohighlight">\(n_i\)</span> come altezza della barra.</p>
<section id="id1">
<h6><span class="section-number">10.1.1.2.1. </span>Esempi<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h6>
<p>Nel caso del campione <code class="docutils literal notranslate"><span class="pre">gender</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:&gt;
</pre></div>
</div>
<img alt="../_images/dd6422424a7e86c6cc34b85062a26cee4b28b1df917c3c1c9f1415f56914beab.png" src="../_images/dd6422424a7e86c6cc34b85062a26cee4b28b1df917c3c1c9f1415f56914beab.png" />
</div>
</div>
<p>Il diagramma a barre delle frequenze assolute delle altezze nel nostro campione di pesi e altezze è il seguente:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/bcf638ff094561c97b255a89f216fd8b8f112bba038681bacda8821431394f4a.png" src="../_images/bcf638ff094561c97b255a89f216fd8b8f112bba038681bacda8821431394f4a.png" />
</div>
</div>
<p>Il grafico sopra ci dice qualcosa sul numero di occorrenze di un dato valore e ci da anche una idea di quali valori siano più o meno frequenti. Vediamo che i dati seguono una forma “a campana”. Troveremo spesso questo tipo di forma e ne parleremo meglio in seguito.</p>
</section>
</section>
</section>
<section id="frequenze-relative-probability-mass-function">
<h4><span class="section-number">10.1.2. </span>Frequenze Relative (Probability Mass Function)<a class="headerlink" href="#frequenze-relative-probability-mass-function" title="Permalink to this heading">#</a></h4>
<p>Le frequenze assolute ci permettono di farci un’idea più precisa su come i dati sono distribuiti, indipendentemente dalla dimensione del nostro campione. Sappiamo ad esempio che il campione contiene più individui di altezza pari a <span class="math notranslate nohighlight">\(167.64\ cm\)</span> che individui di altezza pari a <span class="math notranslate nohighlight">\(193.04\ cm\)</span>. Tuttavia, tale rappresentazione è legata al numero totale di elementi contenuti nel campione. Ad esempio, un campione distribuito in maniera simile, ma con più osservazioni, darà luogo a frequenze assolute più grandi. Possiamo ottenere una rappresentazione indipendente rispetto alla dimensione del campione mediante l’analisi delle frequenze relative, definite come seguono:</p>
<div class="math notranslate nohighlight">
\[f_j = f(a_j) = \frac{n_j}{n}, j=1,2,\ldots,k\]</div>
<p>Si noti che, vista la definizione, si avrà:</p>
<div class="math notranslate nohighlight">
\[ n_j \leq n \Rightarrow f_j \leq 1\ \forall j \]</div>
<div class="math notranslate nohighlight">
\[ \sum_j f_j = \sum_j \frac{n_j}{n} = \frac{1}{n}\sum_j n_j = \frac{n}{n} = 1\]</div>
<section id="id2">
<h5><span class="section-number">10.1.2.1. </span>Esempi<a class="headerlink" href="#id2" title="Permalink to this heading">#</a></h5>
<p>Nel caso del nostro piccolo campione <code class="docutils literal notranslate"><span class="pre">gender</span></code> avremo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>F    0.6
M    0.4
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Nel caso del nostro dataset di altezze, avremo:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>59    0.012290
60    0.030726
61    0.097140
63    0.068778
64    0.102813
65    0.082959
66    0.092413
67    0.089104
68    0.083905
69    0.071378
70    0.064287
71    0.055542
72    0.061451
73    0.034507
74    0.024580
75    0.017017
76    0.011108
Name: height, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>È possibile verificare che tutti i numeri sono compresi tra zero e uno e che la somma dei valori è pari a 1.</p>
<p>Come abbiamo visto, questa rappresentazione è nota anche come <strong>probability mass function (PMF)</strong> e associa ad <strong>ogni valore discreto</strong> presente nel campione una <strong>probabilità</strong>. Possiamo ad esempio dire che la probabilità di trovare un individuo di altezza <span class="math notranslate nohighlight">\(67 inches\)</span> (circa <span class="math notranslate nohighlight">\(170.18 cm\)</span>) è pari a <span class="math notranslate nohighlight">\(0.089104\)</span>.</p>
</section>
<section id="diagramma-a-barre-delle-frequenze-relative">
<h5><span class="section-number">10.1.2.2. </span>Diagramma a Barre delle Frequenze Relative<a class="headerlink" href="#diagramma-a-barre-delle-frequenze-relative" title="Permalink to this heading">#</a></h5>
<p>Plottando le frequenze relative con un diagramma a barre, otteniamo un grafico molto simile a quello delle frequenze relative, ma con una differente scala sull’asse delle <span class="math notranslate nohighlight">\(y\)</span>.</p>
<section id="id3">
<h6><span class="section-number">10.1.2.2.1. </span>Esempi<a class="headerlink" href="#id3" title="Permalink to this heading">#</a></h6>
<p>Nel caso del campione <code class="docutils literal notranslate"><span class="pre">gender</span></code> avremo:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:&gt;
</pre></div>
</div>
<img alt="../_images/32edea448c951584d9d802a1a6b82af0fa28eb4cb22ae17e35b216609513fae6.png" src="../_images/32edea448c951584d9d802a1a6b82af0fa28eb4cb22ae17e35b216609513fae6.png" />
</div>
</div>
<p>Nel caso del campione pesi-altezze, avremo:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/57b17bf9535c760b48fb6eff28a20d82468d94f9873c175fe614afcb4fa5e16a.png" src="../_images/57b17bf9535c760b48fb6eff28a20d82468d94f9873c175fe614afcb4fa5e16a.png" />
</div>
</div>
<p>I diagrammi a barre delle frequenze relative sono utili per confrontare tra di loro campioni diversi. Ad esempio, possiamo considerare le altezze di uomini e donne nel dataset pesi-altezze:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/53da4cd4a510b7ef73386425fd4ea9dfac8de3b9bf96258de1a15f766f99024f.png" src="../_images/53da4cd4a510b7ef73386425fd4ea9dfac8de3b9bf96258de1a15f766f99024f.png" />
</div>
</div>
<p>Dal confronto sopra, possiamo già fare delle considerazioni qualitative sui due campioni. In particolare notiamo (poco sorprendentemente) che gli uomini sono generalmente più alti delle donne. Ciò non vuol dire che non esistano uomini più bassi di alcune donne o viceversa, ma ragionevolmente si tratta di casi meno frequenti.</p>
</section>
</section>
<section id="grafici-a-torta">
<h5><span class="section-number">10.1.2.3. </span>Grafici a Torta<a class="headerlink" href="#grafici-a-torta" title="Permalink to this heading">#</a></h5>
<p>In alternativa ai grafici a barre, le frequenze relative possono essere visualizzate anche mediante dei grafici a torta.</p>
<section id="id4">
<h6><span class="section-number">10.1.2.3.1. </span>Esempi<a class="headerlink" href="#id4" title="Permalink to this heading">#</a></h6>
<p>Nel caso del campione <code class="docutils literal notranslate"><span class="pre">gender</span></code>:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:ylabel=&#39;None&#39;&gt;
</pre></div>
</div>
<img alt="../_images/493348f1929dc5c369be87f057cc206fb2eb6b8ab88be7b74b4999a386c4efa5.png" src="../_images/493348f1929dc5c369be87f057cc206fb2eb6b8ab88be7b74b4999a386c4efa5.png" />
</div>
</div>
<p>Nel caso del campione pesi-altezze:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/94cb6f07df626992be09967525c94d7ad0b864459036f942ec8d811b26e7b19f.png" src="../_images/94cb6f07df626992be09967525c94d7ad0b864459036f942ec8d811b26e7b19f.png" />
</div>
</div>
</section>
</section>
</section>
</section>
<section id="empirical-cumulative-distribution-function-ecdf">
<h3><span class="section-number">10.2. </span>Empirical Cumulative Distribution Function (ECDF)<a class="headerlink" href="#empirical-cumulative-distribution-function-ecdf" title="Permalink to this heading">#</a></h3>
<p>Le frequenze relative funzionano particolarmente bene quando i valori unici sono pochi. Quando invece il numero di valori univoci cresce, le frequenze discrete calcolate per i valori diventano molto piccole e dunque soggette a rumore (ad esempio dovuto ad errori di misura).</p>
<p>Torniamo al nostro esempio di dataset di pesi e altezze:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sex</th>
      <th>height</th>
      <th>weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>M</td>
      <td>74</td>
      <td>53.484771</td>
    </tr>
    <tr>
      <th>1</th>
      <td>M</td>
      <td>70</td>
      <td>38.056472</td>
    </tr>
    <tr>
      <th>2</th>
      <td>F</td>
      <td>61</td>
      <td>34.970812</td>
    </tr>
    <tr>
      <th>3</th>
      <td>M</td>
      <td>68</td>
      <td>35.999365</td>
    </tr>
    <tr>
      <th>4</th>
      <td>F</td>
      <td>66</td>
      <td>34.559390</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>4226</th>
      <td>F</td>
      <td>69</td>
      <td>23.862436</td>
    </tr>
    <tr>
      <th>4227</th>
      <td>M</td>
      <td>69</td>
      <td>38.262182</td>
    </tr>
    <tr>
      <th>4228</th>
      <td>F</td>
      <td>64</td>
      <td>34.970812</td>
    </tr>
    <tr>
      <th>4229</th>
      <td>F</td>
      <td>64</td>
      <td>28.388071</td>
    </tr>
    <tr>
      <th>4230</th>
      <td>F</td>
      <td>61</td>
      <td>22.628172</td>
    </tr>
  </tbody>
</table>
<p>4231 rows × 3 columns</p>
</div></div></div>
</div>
<p>I valori dei pesi, a differenza di quelli delle altezze, non sono quantizzati. Un grafico a barre delle frequenze relative (o Probability Mass Function) avrebbe questo aspetto:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/4b43281830ceb014851b9078c2c78e6133a3a063ab89823019bac7e986eb3a4c.png" src="../_images/4b43281830ceb014851b9078c2c78e6133a3a063ab89823019bac7e986eb3a4c.png" />
</div>
</div>
<p>Come possiamo notare, abbiamo ottenuto una rappresentazione grafica più “rumorosa”. Supponiamo adesso di voler confrontare le distribuzioni dei pesi di donne e uomini:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/0d45258e85fda3d595f4f3e5b6bd15d766e8423fa0c41023107e09c011578ec4.png" src="../_images/0d45258e85fda3d595f4f3e5b6bd15d766e8423fa0c41023107e09c011578ec4.png" />
</div>
</div>
<p>Le due rappresentazioni sono affette da rumore dovuto alla natura discreta dei dati per cui due valori molto vicini vengono trattati come due casi distinti nel calcolo delle probabilità. Vedremo alcuni modi per ovviare a questo problema. Uno di essi consiste nel calcolare una <strong>Empirical Cumulative Distribution Function (ECDF)</strong>. Una <strong>ECDF</strong> calcola per un valore <span class="math notranslate nohighlight">\(x\)</span> la somma delle frequenze relative di tutti i valori <span class="math notranslate nohighlight">\(y\)</span> minori o uguali a <span class="math notranslate nohighlight">\(x\)</span>:</p>
<div class="math notranslate nohighlight">
\[ECDF(x) = \sum_{a_j: a_j\leq x} f(a_j)\]</div>
<p>Dove <span class="math notranslate nohighlight">\(a_j\)</span> sono i valori univoci all’interno del campione, mentre in generale <span class="math notranslate nohighlight">\(x\in \mathbb{R}\)</span>.</p>
<p>Consideriamo un semplice dataset di valori numerici:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0     1
1     5
2     2
3     6
4     5
5     4
6     3
7     5
8     4
9     2
10    4
11    5
12    6
13    4
14    4
15    3
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Le frequenze relative saranno le seguenti:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1    0.0625
2    0.1250
3    0.1250
4    0.3125
5    0.2500
6    0.1250
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>La ECDF calcolata sui valori univoci sarà la seguente:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1    0.0625
2    0.1875
3    0.3125
4    0.6250
5    0.8750
6    1.0000
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Da notare che i valori della ECDF sono sempre crescenti e l’ultimo valore è pari a 1 (la somma di tutte le frequenze relative).</p>
<p>Una ECDF può essere rappresentata graficamente mettendo i valori di <span class="math notranslate nohighlight">\(x\)</span> sulle ascisse e i valori di <span class="math notranslate nohighlight">\(ECDF(x)\)</span> sulle ordinate. Ad esempio, la ECDF dei pesi nel nostro dataset di pesi-altezze sarà la seguente:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/0486d2eec4c593f5a8d4e3ca6500537ced7ef6127e899a0aeca0783fd43dd09b.png" src="../_images/0486d2eec4c593f5a8d4e3ca6500537ced7ef6127e899a0aeca0783fd43dd09b.png" />
</div>
</div>
<p>La definizione della ECDF ci dice che, dato un punto di coordinate <span class="math notranslate nohighlight">\((x,y)\)</span>, la somma delle frequenze degli elementi minori o uguali a <span class="math notranslate nohighlight">\(x\)</span> è pari a <span class="math notranslate nohighlight">\(y\)</span>. Alternativamente, possiamo dire che l’<span class="math notranslate nohighlight">\(y\%\)</span> degli elementi ha un valore inferiore a <span class="math notranslate nohighlight">\(x\)</span>.</p>
<p>Osservando il grafico sopra, possiamo dire che:</p>
<ul class="simple">
<li><p>Circa il <span class="math notranslate nohighlight">\(40\%\)</span> dei soggetti ha un peso inferiore alle <span class="math notranslate nohighlight">\(\approx 33\)</span> libre (circa <span class="math notranslate nohighlight">\(66kg\)</span>);</p></li>
<li><p>Circa l’<span class="math notranslate nohighlight">\(80\%\)</span> dei soggetti ha un peso inferiore <span class="math notranslate nohighlight">\(\approx 42\)</span> libre (circa <span class="math notranslate nohighlight">\(84Kg\)</span>);</p></li>
</ul>
<p>Le ECDF tornano utili per verificare graficamente se due fenomeni hanno distribuzioni simili. Possiamo ad esempio usarle per confrontare le distribuzioni dei pesi di uomini e donne:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/829bf5414a5ced7ec03d79454ca958564b251c4e961c2585168f3b9bb0b111d5.png" src="../_images/829bf5414a5ced7ec03d79454ca958564b251c4e961c2585168f3b9bb0b111d5.png" />
</div>
</div>
<p>Osservando il grafico sopra, possiamo dire che:</p>
<ul class="simple">
<li><p>Circa il <span class="math notranslate nohighlight">\(40\%\)</span> degli uomini ha un peso inferiore agli <span class="math notranslate nohighlight">\(80Kg\)</span>;</p></li>
<li><p>Circa il <span class="math notranslate nohighlight">\(40\%\)</span> delle donne ha un peso inferiore ai <span class="math notranslate nohighlight">\(60Kg\)</span>;</p></li>
<li><p>Il <span class="math notranslate nohighlight">\(100\%\)</span> degli uomini ha un peso inferiore ai <span class="math notranslate nohighlight">\(140Kg\)</span>;</p></li>
<li><p>Il <span class="math notranslate nohighlight">\(100\%\)</span> delle donne ha un peso inferiore ai <span class="math notranslate nohighlight">\(130Kg\)</span>.</p></li>
</ul>
<p>In generale, il grafico sopra ci dice che gli uomini tendono a essere più pesanti delle donne.</p>
</section>
<section id="istogrammi">
<h3><span class="section-number">10.3. </span>Istogrammi<a class="headerlink" href="#istogrammi" title="Permalink to this heading">#</a></h3>
<p>Abbiamo visto che i diagrammi a barre delle frequenze diventano poco chiari quando le variabili sono continue (es. nel caso dei pesi). In questi casi, per ridurre l’influenza del rumore, è possibile utilizzare gli istogrammi. Un istogramma divide il range dei dati in un certo numero di “bin” e riporta per ogni bin il numero di valori che ricadono in quell’intervallo. Di seguito l’istogramma dei pesi nel dataset pesi-altezze:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/58b47ec6466d3f435fa38bc161a20faf895d652384c1714769df7f8a165f5a43.png" src="../_images/58b47ec6466d3f435fa38bc161a20faf895d652384c1714769df7f8a165f5a43.png" />
</div>
</div>
<p>Ogni “bin” dell’istogramma copre un determinato range. Pratica comune è quella di suddividere il range dei dati, dal minimo al massimo, in un determinato numero di bin della stessa larghezza.</p>
<section id="scegliere-il-numero-di-bin-struges-e-rice">
<h4><span class="section-number">10.3.1. </span>Scegliere il numero di bin: Struges e Rice<a class="headerlink" href="#scegliere-il-numero-di-bin-struges-e-rice" title="Permalink to this heading">#</a></h4>
<p>Il numero di bin può essere specificato arbitrariamente o determinato a seconda del risultato grafico che si vuole ottenere. Esistono due criteri euristici per trovare dei valori di partenza:</p>
<ul class="simple">
<li><p>Struges: <span class="math notranslate nohighlight">\(\#bins=3.3\log(n)\)</span></p></li>
<li><p>Rice: <span class="math notranslate nohighlight">\(\#bins=2\cdot n^{1/3}\)</span></p></li>
</ul>
<p>Dove <span class="math notranslate nohighlight">\(n\)</span> è il numero di elementi.</p>
<p>Va notato che il numero di bin, può cambiare il risultato grafico. Di seguito due esempi ottenuti calcolando il numero di bin con i due criteri considerati:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/fc535dee25a697124fb8308a99e85cd706d576b504eda185e66ac778136a4852.png" src="../_images/fc535dee25a697124fb8308a99e85cd706d576b504eda185e66ac778136a4852.png" />
</div>
</div>
<p>Alternativamente, possiamo definire dei range arbitrari per i nostri bin. Ad esempio, considerando i seguenti limiti per i bin <code class="docutils literal notranslate"><span class="pre">[20,25,30,35,40,45,50,55,60,65]</span></code>, otterremmo il seguente istogramma:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/3f41927ff506a9894b6649861a3e238a54950b4d0a1d0867c485d7cb5da253c9.png" src="../_images/3f41927ff506a9894b6649861a3e238a54950b4d0a1d0867c485d7cb5da253c9.png" />
</div>
</div>
<p>L’istogramma mostrato sopra riporta le frequenze assolute per ogni bin e ci permette di rispondere a domande del genere “quanti soggetti hanno un peso compreso tra <span class="math notranslate nohighlight">\(30\)</span> e <span class="math notranslate nohighlight">\(35\)</span> libbre”?</p>
<p>In casi particolari, è possibile anche definire istogrammi con bin di dimensioni variabili. Ad esempio:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/65275d156d36686e1b0a894fb597d948a3f151280f090e10722d3ef9df9c90d7.png" src="../_images/65275d156d36686e1b0a894fb597d948a3f151280f090e10722d3ef9df9c90d7.png" />
</div>
</div>
</section>
<section id="istogrammi-di-densita">
<h4><span class="section-number">10.3.2. </span>Istogrammi di densità<a class="headerlink" href="#istogrammi-di-densita" title="Permalink to this heading">#</a></h4>
<p>Un istogramma può essere utilizzato anche per approssimare una Probability Density Function. L’istogramma delle frequenze assolute mostrato sopra, tuttavia, non ci permette di ragionare in termini probabilistici.</p>
<p>Ad esempio, non ci permette di dire qual è la probabilità che un soggetto abbia un peso contenuto tra <span class="math notranslate nohighlight">\(30\)</span> e <span class="math notranslate nohighlight">\(40\)</span> libbre. Se avessimo la PDF della popolazione dalla quale è stata estratto il campione, potremmo rispondere a questa domanda calcolando l’integrale:</p>
<div class="math notranslate nohighlight">
\[
\int_{30}^{40} pdf(x) dx
\]</div>
<p>Possiamo costruire un <strong>istogramma di densità</strong>, che approssimi in maniera discreta la PDF che cerchiamo. In pratica, vogliamo che l’area sottesa dal bin di “bordi” <span class="math notranslate nohighlight">\([30, 40[\)</span> contenga un valore che approssimi l’integrale della PDF:</p>
<div class="math notranslate nohighlight">
\[
\int_{30}^{40} pdf(x) dx \approx b_j \cdot w_j
\]</div>
<p>dove <span class="math notranslate nohighlight">\(j\)</span> indica il bin di bordi <span class="math notranslate nohighlight">\([30, 40[\)</span>, <span class="math notranslate nohighlight">\(w_j\)</span> rappresenta la sua larghezza (<span class="math notranslate nohighlight">\(40-30=10\)</span>) e <span class="math notranslate nohighlight">\(b_j\)</span> rappresenta la sua altezza (il valore del bin). Sotto queste condizioni, vale dunque la seguente proprietà:</p>
<div class="math notranslate nohighlight">
\[
\sum_{i=0}^{n} b_i \cdot w_i = \int pdf(x) dx = 1
\]</div>
<p>dove <span class="math notranslate nohighlight">\(n\)</span> è il numero totale di bin.</p>
<p>Il risultato è graficamente molto simile a quello ottenuto in precedenza, ma cambia la scala sull’asse delle y:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/97bb08ffda8bc8b99c85f7345b4e555eaee66342f09a25c86f723088f9e123e8.png" src="../_images/97bb08ffda8bc8b99c85f7345b4e555eaee66342f09a25c86f723088f9e123e8.png" />
</div>
</div>
</section>
<section id="stima-della-densita">
<h4><span class="section-number">10.3.3. </span>Stima della densità<a class="headerlink" href="#stima-della-densita" title="Permalink to this heading">#</a></h4>
<p>Uno svantaggio degli istogrammi è che categorizzano dei dati continui in maniera arbitraria mediante dei bin. La scelta degli intervalli dei bin cambia l’aspetto finale dell’istogramma.</p>
<p>La stima della densità cerca di risolvere questo problema ottenendo una versione “continua” dell’istogramma. Invece di suddividere l’asse delle <span class="math notranslate nohighlight">\(x\)</span> in bin, la stima della densità calcola un valore per ciascun punto dell’asse delle <span class="math notranslate nohighlight">\(x\)</span>, ottenendo così una rappresentazione continua.</p>
<p>Vedremo meglio come si effettua la stima di densità più in là nel corso. Nel caso uni-dimensionale, può essere calcolata come mostrato nell’approfondimento di seguito (opzionale). Per adesso, sappiamo che si può calcolare la stima della densità con una funzione apposita (lo vedremo a laboratorio) che dipende da un unico parametro di <strong>bandwith</strong> che determina la “sensibilità ai dettagli” della stima della densità.</p>
<p>Confrontiamo la stima di densità dei pesi nel nostro dataset di pesi-altezze con il relativo istogramma:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/8e9fdb9d8a80cc9619a21984072c114d2f5189a8cc8433ecd5f562afcd501a6b.png" src="../_images/8e9fdb9d8a80cc9619a21984072c114d2f5189a8cc8433ecd5f562afcd501a6b.png" />
</div>
</div>
<p>Se nel caso degli istogrammi cambiare il numero di bin cambiava il risultato grafico, qui è cambiare la bandwidth a cambiare il risultato grafico. Il grafico seguente mostra diversi esempi di stima di densità con diversi valori di bandwidth:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/e542885b91740f6a6f79532aabedf52870d66366ccb0977a1a72fb7c0c50f383.png" src="../_images/e542885b91740f6a6f79532aabedf52870d66366ccb0977a1a72fb7c0c50f383.png" />
</div>
</div>
<section id="calcolo-della-stima-di-densita-con-kernel-di-epanechnikov-opzionale">
<h5><span class="section-number">10.3.3.1. </span>Calcolo della stima di densità con Kernel di Epanechnikov (Opzionale)<a class="headerlink" href="#calcolo-della-stima-di-densita-con-kernel-di-epanechnikov-opzionale" title="Permalink to this heading">#</a></h5>
<p>Il calcolo avviene mediante la seguente formula:</p>
<div class="math notranslate nohighlight">
\[\hat f_n(x)=\frac{1}{nh}\sum_{i=1}^n K(\frac{x-x_i}{h}), h&gt;0\]</div>
<p>Dove <span class="math notranslate nohighlight">\(n\)</span> è la dimensione del campione, <span class="math notranslate nohighlight">\(h\)</span> è un parametro detto “bandwidth” e <span class="math notranslate nohighlight">\(K\)</span> è una funzione “kernel” che determina quanto gli elementi del campione devono contribuire alla stima nel punto <span class="math notranslate nohighlight">\(x\)</span>, dipendentemente dalla loro distanza da <span class="math notranslate nohighlight">\(x\)</span>. Una scelta comune di kernel è quello di Epanechnikov:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
K(x) = \begin{cases}
\frac{3}{4}(1-x^2) &amp; \text{if } |x| \leq 1 \\
    0 &amp; \text{otherwise.}
\end{cases}
\end{split}\]</div>
<p>In pratica il Kernel di Epanechnikov ha la seguente forma:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(-4.0, 4.0)
</pre></div>
</div>
<img alt="../_images/dfec68187868a997ee58eb76847d5f2d99de85fbcf4661fb71ac098602bf1bd3.png" src="../_images/dfec68187868a997ee58eb76847d5f2d99de85fbcf4661fb71ac098602bf1bd3.png" />
</div>
</div>
<p>Facendo “scorrere” questo kernel su diversi punti dell’asse delle x e sommando i contributi, si ottiene la stima di densità finale:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/80cdbf635452d38f429e7c71965ce711ba37901c73828eb484dbeb40abdb0460.png" src="../_images/80cdbf635452d38f429e7c71965ce711ba37901c73828eb484dbeb40abdb0460.png" />
</div>
</div>
</section>
</section>
<section id="confrontare-campioni-mediante-istogrammi">
<h4><span class="section-number">10.3.4. </span>Confrontare campioni mediante istogrammi<a class="headerlink" href="#confrontare-campioni-mediante-istogrammi" title="Permalink to this heading">#</a></h4>
<p>Gli istogrammi possono essere utili per comparare campioni. In grafico che segue confronta i pesi di uomini e donne nel nostro campione pesi-altezze:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/84071ed97d1dba96ac8461823f0612c5218c291acb4c93866de842da236aa52f.png" src="../_images/84071ed97d1dba96ac8461823f0612c5218c291acb4c93866de842da236aa52f.png" />
</div>
</div>
</section>
</section>
<section id="referenze">
<h3><span class="section-number">10.4. </span>Referenze<a class="headerlink" href="#referenze" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Capitolo 2 di: Heumann, Christian, and Michael Schomaker Shalabh. Introduction to statistics and data analysis. Springer International Publishing Switzerland, 2016.</p></li>
</ul>
</section>
</section>
<span id="document-lectures/05_misure_di_tendenza_centrale_dispersione_e_forma"></span><section class="tex2jax_ignore mathjax_ignore" id="misure-di-tendenza-centrale-dispersione-e-forma">
<h2><span class="section-number">11. </span>Misure di Tendenza Centrale, Dispersione e Forma<a class="headerlink" href="#misure-di-tendenza-centrale-dispersione-e-forma" title="Permalink to this heading">#</a></h2>
<p>La statistica descrittiva si occupa di descrivere, rappresentare e sintetizzare un campione di dati relativo ad una popolazione. Gli strumenti della statistica descrittiva possono essere sia numerici che grafici. I dati analizzati possono essere descritti secondo diversi aspetti. Esistono pertanto diversi “indicatori” oggettivi:</p>
<ul class="simple">
<li><p><strong>numerosità</strong> del campione;</p></li>
<li><p><strong>indicatori centrali</strong>: media, mediana, moda;</p></li>
<li><p><strong>Indicatori di dispersione</strong>: estremi, range, quantili, percentili, quartili, distanza inter-quartile, varianza;</p></li>
</ul>
<p>Per esaminare questi strumenti, iniziamo considerando un semplice campione univariato:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    3.0
1    4.0
2    NaN
3    4.0
4    4.0
5    1.0
6    2.0
7    2.0
8    NaN
9    4.0
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Il campione contiene dei valori <code class="docutils literal notranslate"><span class="pre">NaN</span></code>. Si tratta di valori mancanti che per qualche motivo non sono stati rilevati e andranno gestiti opportunamente.</p>
<section id="numerosita">
<h3><span class="section-number">11.1. </span>Numerosità<a class="headerlink" href="#numerosita" title="Permalink to this heading">#</a></h3>
<p>La numerosità di un campione univariato <span class="math notranslate nohighlight">\(\{x^{(i)}\}_i^N\)</span> è data dal numero di valori in esso contenuto: <span class="math notranslate nohighlight">\(|\{x^{(i)}\}_i^N| = N\)</span>. La numerosità di ciascuna colonna può anche essere diversa in quanto possono essistere dei valori mancanti, indicati in genere con <code class="docutils literal notranslate"><span class="pre">NA</span></code> o <code class="docutils literal notranslate"><span class="pre">NaN</span></code>. Nel nostro caso:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.series.Series&#39;&gt;
RangeIndex: 10 entries, 0 to 9
Series name: None
Non-Null Count  Dtype  
--------------  -----  
8 non-null      float64
dtypes: float64(1)
memory usage: 208.0 bytes
</pre></div>
</div>
</div>
</div>
<p>Il sommario sopra indica che, sebbene abbiamo <span class="math notranslate nohighlight">\(10\)</span> valori, solo <span class="math notranslate nohighlight">\(8\)</span> di questi sono non nulli.</p>
</section>
<section id="indicatori-di-tendenza-centrale">
<h3><span class="section-number">11.2. </span>Indicatori di tendenza centrale<a class="headerlink" href="#indicatori-di-tendenza-centrale" title="Permalink to this heading">#</a></h3>
<p>Gli indicatori centrali danno un’idea approssimata dell’ordine di grandezza dei valori del campione.</p>
<section id="media">
<h4><span class="section-number">11.2.1. </span>Media<a class="headerlink" href="#media" title="Permalink to this heading">#</a></h4>
<p>La media di un campione è definita come la somma dei suoi valori diviso la sua numerosità:</p>
<div class="math notranslate nohighlight">
\[\overline X = \frac{1}{N}\sum_i^N x^{(i)}\]</div>
<p>La media del nostro campione sarà:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.0
</pre></div>
</div>
</div>
</div>
</section>
<section id="mediana">
<h4><span class="section-number">11.2.2. </span>Mediana<a class="headerlink" href="#mediana" title="Permalink to this heading">#</a></h4>
<p>Quando gli elementi di un campione possono essere ordinati (ad esempio se sono valori numerici), la mediana di un campione (o l’elemento mediano) è l’elemento che divide in due parti uguali l’insieme ordinato dei valori del campione.</p>
<p>L’elemento mediano si può ottenere ordinando i valori del campione e procedendo come segue:</p>
<ul class="simple">
<li><p>Se il numero di elementi è dispari, si prende l’elemento centrale. Ad esempio <span class="math notranslate nohighlight">\([1,2,\mathbf{2},3,5] \to 2\)</span>.</p></li>
<li><p>Se il numero di elementi è pari, si prende la media tra i due centrali. Ad esempio <span class="math notranslate nohighlight">\([1,2,\mathbf{2},\mathbf{3},3,5] \to \frac{2+3}{2} = 2.5\)</span>.</p></li>
</ul>
<p>Nel caso del nostro campione:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5    1.0
6    2.0
7    2.0
0    3.0
1    4.0
3    4.0
4    4.0
9    4.0
2    NaN
8    NaN
dtype: float64
Valore mediano: 3.5
</pre></div>
</div>
</div>
</div>
<p>Da un punto di vista formale, se abbiamo <span class="math notranslate nohighlight">\(n\)</span> osservazioni <span class="math notranslate nohighlight">\(x^{(1)}, \ldots, x^{(1)}\)</span>, che possono essere ordinate come <span class="math notranslate nohighlight">\(x^{(i_i)},\ldots, x^{(i_n)}\)</span>, il calcolo della mediana può essere espresso come segue:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\tilde x_{0.5} = \begin{cases}
x_{(n+1)/2} &amp; \text{if } n \textit{ is odd}\\
    \frac{1}{2}(x_{n/2}+x_{n/2+1}) &amp; \text{otherwise.}
\end{cases}
\end{split}\]</div>
</section>
<section id="quantili-percentili-e-quartili">
<h4><span class="section-number">11.2.3. </span>Quantili, Percentili e Quartili<a class="headerlink" href="#quantili-percentili-e-quartili" title="Permalink to this heading">#</a></h4>
<p>Quantili, percentili e quartili generalizzano il concetto di mediana.</p>
<section id="quantili">
<h5><span class="section-number">11.2.3.1. </span>Quantili<a class="headerlink" href="#quantili" title="Permalink to this heading">#</a></h5>
<p>Un quantile di ordine <span class="math notranslate nohighlight">\(\alpha\)</span> è un valore <span class="math notranslate nohighlight">\(q_\alpha\)</span> che divide un campione in due parti di dimensioni proprozionali a <span class="math notranslate nohighlight">\(\alpha\)</span> e <span class="math notranslate nohighlight">\(1-\alpha\)</span>. Valori più piccoli o uguali a <span class="math notranslate nohighlight">\(q_\alpha\)</span> appartengono alla prima parte della suddivisione, mentre valori maggiori a <span class="math notranslate nohighlight">\(q_\alpha\)</span> appartengono alla seconda parte.</p>
<p>Ad esempio, dato il campione già ordinato <code class="docutils literal notranslate"><span class="pre">[1,2,3,3,4,5,6,6,7,8,8,9]</span></code>, un quantile <span class="math notranslate nohighlight">\(q_{0.25}\)</span> dividerà il campione in due parti di dimensione proporzionale a <span class="math notranslate nohighlight">\(0.25\)</span> e <span class="math notranslate nohighlight">\(1-0.25=0.75\)</span>. In questo caso <span class="math notranslate nohighlight">\(q_{0.25}=3\)</span> e le due parti saranno <code class="docutils literal notranslate"><span class="pre">[1,2,3,3]</span></code> e <code class="docutils literal notranslate"><span class="pre">[4,5,6,6,7,8,8,9]</span></code>.</p>
<p>Anche in questo caso, come nel caso della mediana, si effettuano medie di valori adiacenti ove opportuno.</p>
<p>I quantili vanno interpretati così:</p>
<blockquote>
<div><p>Se un quantile di ordine <span class="math notranslate nohighlight">\(\alpha\)</span> è pari al numero <span class="math notranslate nohighlight">\(x\)</span>, allora vuole dire che <span class="math notranslate nohighlight">\(\alpha \times n\)</span> elementi hanno un valore inferiore o uguale a <span class="math notranslate nohighlight">\(x\)</span>, dove <span class="math notranslate nohighlight">\(n\)</span> è il numero di elementi nel campione.</p>
</div></blockquote>
<p>Va notato che:</p>
<ul class="simple">
<li><p>Il minimo è un quantile di ordine 0;</p></li>
<li><p>Il massimo è un quantile di ordine 1;</p></li>
<li><p>La mediana è un quantile di ordine 0.5.</p></li>
</ul>
<p>Vediamo alcuni esempi sul nostro piccolo campione:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Quantile di ordine 0 (minimo): 1.0
Quantile di ordine 0.5 (mediana): 3.5
Quantile di ordine 1 (massimo): 4.0
Quantile di ordine 0.15: 2.0
</pre></div>
</div>
</div>
</div>
<p>Dai dati sopra deduciamo che:</p>
<ul class="simple">
<li><p>Il <span class="math notranslate nohighlight">\(50\%\)</span> dei valori sono inferiori o uguali a 3;</p></li>
<li><p>Il <span class="math notranslate nohighlight">\(15\%\)</span> dei valori sono minori o ugualei a 2.</p></li>
</ul>
</section>
<section id="percentili">
<h5><span class="section-number">11.2.3.2. </span>Percentili<a class="headerlink" href="#percentili" title="Permalink to this heading">#</a></h5>
<p>I percentili sono semplicemente quantili espressi in precentuale. Un quantile di ordine <span class="math notranslate nohighlight">\(0.25\)</span> è un percentile di ordine <span class="math notranslate nohighlight">\(25\%\)</span>.</p>
</section>
<section id="quartili">
<h5><span class="section-number">11.2.3.3. </span>Quartili<a class="headerlink" href="#quartili" title="Permalink to this heading">#</a></h5>
<p>I quartili sono degli specifici quantili che suddividono il campione in quattro parti. In particolare:</p>
<ul class="simple">
<li><p>Il quartile di ordine 0 è un quantile di ordine 0;</p></li>
<li><p>Il quartile di ordine 1 è un quantile di ordine <span class="math notranslate nohighlight">\(1/4=0.25\)</span>;</p></li>
<li><p>Il quartile di ordine 2 è un quantile di ordine <span class="math notranslate nohighlight">\(2/4=0.5\)</span>;</p></li>
<li><p>Il quartile di ordine 3 è un quantile di ordine <span class="math notranslate nohighlight">\(3/4=0.75\)</span>;</p></li>
<li><p>Il quartile di ordine 4 è un qauntile di ordine <span class="math notranslate nohighlight">\(4/4=1\)</span>.</p></li>
</ul>
<p>Vediamo qualche esempio sul nostro piccolo campione:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Quartile di ordine 0 (minimo): 1.0
Quartile di ordine 1: 2.0
Quartile di ordine 2 (mediana): 3.5
Quartile di ordine 3: 4.0
Quartile di ordine 4 (massimo): 4.0
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="moda">
<h4><span class="section-number">11.2.4. </span>Moda<a class="headerlink" href="#moda" title="Permalink to this heading">#</a></h4>
<p>La moda di un campione è l’elemento che si ripete più spesso. Ad esempio, consideriamo il seguente campione:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0     1
1     2
2     3
3     4
4     2
5     5
6     4
7     2
8     6
9     5
10    8
11    4
12    3
13    2
14    3
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Consideriamo dunque le frequenze assolute:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2    4
3    3
4    3
5    2
1    1
6    1
8    1
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>La moda sarà pari a <span class="math notranslate nohighlight">\(4\)</span>.</p>
<p>In termini formali, la moda <span class="math notranslate nohighlight">\(\overline x_M\)</span> del campione visto prima sarà data da:</p>
<div class="math notranslate nohighlight">
\[\overline x_M = a_j \Leftrightarrow n_j = \max\{n_1,\ldots,n_k\}\]</div>
<p>Dove <span class="math notranslate nohighlight">\(a_j\)</span> sono i valori univoci del campione e <span class="math notranslate nohighlight">\(n_j\)</span> sono le relative frequenze.</p>
</section>
</section>
<section id="indicatori-di-dispersione">
<h3><span class="section-number">11.3. </span>Indicatori di dispersione<a class="headerlink" href="#indicatori-di-dispersione" title="Permalink to this heading">#</a></h3>
<p>Gli indici di dispersione hanno il compito di quantificare in quale misura i valori di una distribuzione sono “dispersi”, ovvero “lontani tra loro”.</p>
<section id="minimo-massimo-e-range">
<h4><span class="section-number">11.3.1. </span>Minimo, Massimo e Range<a class="headerlink" href="#minimo-massimo-e-range" title="Permalink to this heading">#</a></h4>
<p>Semplici indici di dispersione sono il minimo (<span class="math notranslate nohighlight">\(min \{x^{(i)}\}_i^N\)</span>), il massimo (<span class="math notranslate nohighlight">\(max \{x^{(i)}\}_i^N\)</span>) e il range (<span class="math notranslate nohighlight">\(max \{x^{(i)}\}_i^N\)</span> - <span class="math notranslate nohighlight">\(min \{x^{(i)}\}_i^N\)</span>). Tornando al ultimo esempio:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0     1
1     2
2     3
3     4
4     2
5     5
6     4
7     2
8     6
9     5
10    8
11    4
12    3
13    2
14    3
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Avremo che:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Minimo: 1
Massimo: 8
Range: 7
</pre></div>
</div>
</div>
</div>
</section>
<section id="distanza-interquartile">
<h4><span class="section-number">11.3.2. </span>Distanza interquartile<a class="headerlink" href="#distanza-interquartile" title="Permalink to this heading">#</a></h4>
<p>Il range non è un indice di dispersione molto robusto, in quanto non tiene conto della presenza di evenutali outliers. Si considerino ad esempio i seguenti campioni “artificiali”:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>         s1         s2
0  3.000000  -5.000000
1  3.444444   3.444444
2  3.888889   3.888889
3  4.333333   4.333333
4  4.777778   4.777778
5  5.222222   5.222222
6  5.666667   5.666667
7  6.111111   6.111111
8  6.555556   6.555556
9  7.000000  15.000000
Range sample 1: 4.0
Range sample 2: 20.0
</pre></div>
</div>
</div>
</div>
<p>I campioni sono simili, ma la presenza di due outliers (-5 e 15) nel secondo campione rende i range molto diversi (4 e 20).</p>
<p>Confrontando i due boxplot mostrati sopra, notiamo che le posizioni del terzo e del primo quartile sono più “robuste” agli outliers. Una misura di dispersione un po’ più espressiva è dunque lo <strong>scarto interquartile</strong> (o <strong>distanza interquartile</strong>), che si misura come la differenza tra il terzo e il primo quartile:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Lo scarto interquartile di sample 1 è: 2.0
Lo scarto interquartile di sample 2 è: 2.0
</pre></div>
</div>
</div>
</div>
</section>
<section id="varianza-e-deviazione-standard">
<h4><span class="section-number">11.3.3. </span>Varianza e Deviazione Standard<a class="headerlink" href="#varianza-e-deviazione-standard" title="Permalink to this heading">#</a></h4>
<p>La varianza (detto anche scarto quadratico medio) fornisce una stima di quanto i dati osservati si allontanano dalla media. La varianza calcola la media dei quadrati degli scarti dei valori rispetto alla media, penalizzando i grandi scostamenti dal valore medio (dovuti agli outliers) maggiormente rispetto ai piccoli scostamenti:</p>
<div class="math notranslate nohighlight">
\[s^2 = \frac{\sum_{i=1}^n(x_i-\overline x)^2}{n}\]</div>
<p>Possiamo attribuire un significato geometrico alla varianza, come mostrato nel grafico sotto:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/9e4ff5c1b616fcaaedd34373591c540ee35de20e4eb28d5ebc4a5ab12e4bb443.png" src="../_images/9e4ff5c1b616fcaaedd34373591c540ee35de20e4eb28d5ebc4a5ab12e4bb443.png" />
</div>
</div>
<p>Nel grafico, il plot in basso mostra un campione univariato <span class="math notranslate nohighlight">\(\{x_i\}_i^N\)</span>. Il plot in alto, mostra lo stesso campione “esploso” sull’asse <span class="math notranslate nohighlight">\(y\)</span> per questioni di visualizzazione. Nel plot in alto, la linea nera tratteggiata indica la media di del campione, mentre le linee rosse sono i termini <span class="math notranslate nohighlight">\((x_i-\overline x)\)</span> che appaiono nella formula della varianza. La varianza calcola la media delle lunghezze di questi segmenti.</p>
<p>Il grafico che segue mostra un campione meno “disperso”:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/4638cbd05c980edb22df69ce34912f3d5b4827eb71ea8659487157da0d48fb1b.png" src="../_images/4638cbd05c980edb22df69ce34912f3d5b4827eb71ea8659487157da0d48fb1b.png" />
</div>
</div>
<p>La varianza del nostro piccolo campione sarà:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.3999999999999995
</pre></div>
</div>
</div>
</div>
<p>Gli indici di dispersione visti fino ad ora (esclusa la varianza) hanno come unità di misura la stessa dei dati di input. Nel caso dei pesi, i dati vengono misurati in libbre. E’ pertanto corretto dire che <strong>minimo</strong>, <strong>massimo</strong>, <strong>range</strong>, <strong>scarto interquartile</strong> e <strong>scarto medio assoluto</strong> calcolati sui pesi si misurano in libbre.</p>
<p>Lo stesso discorso non vale per la varianza, che si misurerà in <strong>libbre al quadrato</strong>. Se vogliamo ottenere una misura di dispersione <strong>commensurabile</strong>, possiamo calcolare la radice quadrata della varianza, ottenendo così la <strong>deviazione standard</strong> (o <strong>scarto quadratico medio</strong>), che si definisce come segue:</p>
<div class="math notranslate nohighlight">
\[s = \sqrt{s^2}=\sqrt{\frac{\sum_{i=1}{n}(x_i-x^2)}{n}}\]</div>
<p>Consideriamo nuovamente il nostro dataset di pesi e altezze. Le medie e deviazioni standard delle della variabile peso per i due sessi sono:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>sex</th>
      <th>F</th>
      <th>M</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>mean</th>
      <td>64.179431</td>
      <td>69.933710</td>
    </tr>
    <tr>
      <th>std</th>
      <td>2.686187</td>
      <td>2.911766</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Dal confronto notiamo che le altezze degli uomini sono “più disperse” (hanno cioè una deviazione standard più alta). Confrontiamo le stime di densità dei due campioni:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/3e1d342ea774c5638c00bffa719e95fd1f28aab04b141f49bc0fa5707434a51b.png" src="../_images/3e1d342ea774c5638c00bffa719e95fd1f28aab04b141f49bc0fa5707434a51b.png" />
</div>
</div>
<p>Notiamo che in effetti la stima di densità per gli uomini ha individuato una curva più “spanciata”, che si correla bene con la più alta devizione standard.</p>
</section>
<section id="normalizzazioni-dei-dati">
<h4><span class="section-number">11.3.4. </span>Normalizzazioni dei Dati<a class="headerlink" href="#normalizzazioni-dei-dati" title="Permalink to this heading">#</a></h4>
<p>Gli indicatori di dispersione dei dati visti dipendono fortemente dalla natura dei dati e dalla loro unità di misura. Ad esempio, le età si misurano in anni, mentre i pesi in Kg o libbre. Pertanto, esistono delle tecniche di normalizzazione dei dati che permettono di rendere dati basati su unità di misura diverse comparabili tra di loro.</p>
<section id="normalizzazione-tra-0-e-1">
<h5><span class="section-number">11.3.4.1. </span>Normalizzazione tra 0 e 1<a class="headerlink" href="#normalizzazione-tra-0-e-1" title="Permalink to this heading">#</a></h5>
<p>Questa normalizzazione scala i dati in modo che i valori minimo e massimo risultino esattamente pari a <span class="math notranslate nohighlight">\(0\)</span> e <span class="math notranslate nohighlight">\(1\)</span>, usando la seguente formula:</p>
<div class="math notranslate nohighlight">
\[
x_{norm} = (x-x_{min})/(x_{max}-x_{min})
\]</div>
<p>Nel caso del nostro campione, otterremmo:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0     0.000000
1     0.142857
2     0.285714
3     0.428571
4     0.142857
5     0.571429
6     0.428571
7     0.142857
8     0.714286
9     0.571429
10    1.000000
11    0.428571
12    0.285714
13    0.142857
14    0.285714
dtype: float64
</pre></div>
</div>
</div>
</div>
</section>
<section id="normalizzazione-tra-1-e-1">
<h5><span class="section-number">11.3.4.2. </span>Normalizzazione tra -1 e 1<a class="headerlink" href="#normalizzazione-tra-1-e-1" title="Permalink to this heading">#</a></h5>
<p>In questo caso, i dati vengono riscalati in modo che i nuovi minimo e massimo siano <span class="math notranslate nohighlight">\(-1\)</span> e <span class="math notranslate nohighlight">\(1\)</span>, usando la seguente formula:</p>
<div class="math notranslate nohighlight">
\[
x_{norm} = (x_{max}+x_{min}-2\cdot x)/(x_{max}-x_{min})
\]</div>
<p>Possiamo effettuare questa trasformazione in Pandas come segue:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0     1.000000
1     0.714286
2     0.428571
3     0.142857
4     0.714286
5    -0.142857
6     0.142857
7     0.714286
8    -0.428571
9    -0.142857
10   -1.000000
11    0.142857
12    0.428571
13    0.714286
14    0.428571
dtype: float64
</pre></div>
</div>
</div>
</div>
</section>
<section id="standardizzazione-z-scoring">
<h5><span class="section-number">11.3.4.3. </span>Standardizzazione (z-scoring)<a class="headerlink" href="#standardizzazione-z-scoring" title="Permalink to this heading">#</a></h5>
<p>In molti casi è utile normalizzare i dati in modo che essi presentino media nulla e deviazione standard unitaria. Questo tipo di normalizzazione viene detta “z-scoring” e viene effettuata sottraendo ai dati la media e dividendo per la deviazione standard.</p>
<div class="math notranslate nohighlight">
\[
z_i = \frac{x_i-\overline x}{s_x}
\]</div>
<p>dove <span class="math notranslate nohighlight">\(s_x\)</span> è la deviazione standard della popolazione alla quale appartiene <span class="math notranslate nohighlight">\(X\)</span>. Si noti che gli zeta scores sono <strong>adimensionali</strong> (ovvero, non hanno unità di misura).</p>
<p>Per capire qual è l’effetto di questa normalizzazione, osserviamo le stime di densità dei campioni prima e dopo la normalizzazione:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/e88731b86854f66f80115bbfa82151cea18f1b6aa9d4279ad3cac4b8e9ae0891.png" src="../_images/e88731b86854f66f80115bbfa82151cea18f1b6aa9d4279ad3cac4b8e9ae0891.png" />
<img alt="../_images/b7095ad32f4c247eb6b4af50ad31b0448fdbc5160e57533c1f9867d18d147b33.png" src="../_images/b7095ad32f4c247eb6b4af50ad31b0448fdbc5160e57533c1f9867d18d147b33.png" />
</div>
</div>
</section>
</section>
<section id="indicatori-di-forma">
<h4><span class="section-number">11.3.5. </span>Indicatori di Forma<a class="headerlink" href="#indicatori-di-forma" title="Permalink to this heading">#</a></h4>
<p>Vediamo adesso alcuni indicatori che permettono di farsi un’idea su determinati aspetti della “forma” della distribuzione dei dati.</p>
<section id="asimmetria-skewness">
<h5><span class="section-number">11.3.5.1. </span>Asimmetria (skewness)<a class="headerlink" href="#asimmetria-skewness" title="Permalink to this heading">#</a></h5>
<p>La skewness è indice dello “sbilanciamento” a sinistra (valore negativo) o a destra (valore positivo) di un campione di dati rispetto al valore centrale. La formula della skewness è la seguente:</p>
<div class="math notranslate nohighlight">
\[ \sum_i^n \frac{(x_i-\overline x)^3}{n \cdot s_x^3}\]</div>
<p>I valori della skeweness saranno:</p>
<ul class="simple">
<li><p><strong>Negativi</strong> se la distribuzione è sbilanciata a sinistra;</p></li>
<li><p><strong>Positivi</strong> se la distribuzione è sbilanciata a destra;</p></li>
<li><p><strong>Prossimi allo zero</strong> in caso di distribuzioni non sbilanciate.</p></li>
</ul>
<p>Vediamo degli esempi:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/a0162381b60be69f42ad6b8dec0d6ff9a3cc31ef61efc3738e6ffddb3a650c89.png" src="../_images/a0162381b60be69f42ad6b8dec0d6ff9a3cc31ef61efc3738e6ffddb3a650c89.png" />
</div>
</div>
<p>I valori di skewness di pesi e altezze sarnno:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Skweness pesi: 0.57
Skweness altezza: 0.14
</pre></div>
</div>
</div>
</div>
</section>
<section id="curtosi-kurtosis">
<h5><span class="section-number">11.3.5.2. </span>Curtosi (kurtosis)<a class="headerlink" href="#curtosi-kurtosis" title="Permalink to this heading">#</a></h5>
<p>L’indice di curtosi misura lo “spessore” delle code di una misura di densità. Esso è definito come segue:</p>
<div class="math notranslate nohighlight">
\[
K = \frac{1}{n} \sum_{i=1}^{n} \left(\frac{X_i - \bar{X}}{s}\right)^4 - 3
\]</div>
<p>L’indice va interpretato così:</p>
<ul class="simple">
<li><p>Se è maggiore di zero, la distribuzione è <em>leptocurtica</em>, ovvero più “appuntita” di una distribuzione Normale;</p></li>
<li><p>Se è minore di zero, la distribuzione è <em>platicurtica</em>, ovvero più “piatta” di una distribuzione Normale;</p></li>
<li><p>Se è uguale a zero, la distribuzione è <em>normocurtica</em>, ovvero le code sono simili a quelle di una normale.</p></li>
</ul>
<p>Vedremo meglio cosa è una funzione normale più in là nel corso. Vediamo degli esempi di valori di Kurtosi:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/faa729d80401ac66250bb746be76c37a17459d0930f202e4b6ad17f81481d6b5.png" src="../_images/faa729d80401ac66250bb746be76c37a17459d0930f202e4b6ad17f81481d6b5.png" />
</div>
</div>
</section>
</section>
</section>
<section id="boxplot">
<h3><span class="section-number">11.4. </span>Boxplot<a class="headerlink" href="#boxplot" title="Permalink to this heading">#</a></h3>
<p>I boxplot costituiscono un metodo di visualizzazione compatto per rappresentare alcune caratteristiche descrittive dei dati sotto analisi. In particolare, dato un campione, un boxplot riesce a rappresentarne efficacemente le seguenti quantità:</p>
<ul class="simple">
<li><p>Valore mediano;</p></li>
<li><p>Primo e terzo quartile;</p></li>
<li><p>Minimo e massimo (a seconda della “versione” del boxplot, come discusso di seguito).</p></li>
</ul>
<p>Un boxplot si presenta come segue:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/5004484ce00a9c30f9b0bc7ec37cc12935a458b31532a5ef18a8d2dd4ff37e30.png" src="../_images/5004484ce00a9c30f9b0bc7ec37cc12935a458b31532a5ef18a8d2dd4ff37e30.png" />
</div>
</div>
<p>Il boxplot si mostra come una “scatola” con dei “baffi” in cui:</p>
<ul class="simple">
<li><p>l’estremo inferiore della scatola indica il primo quartile;</p></li>
<li><p>l’estremo superiore della scatola indica il terzo quartile;</p></li>
<li><p>la linea orizzontale in mezzo alla scatola rappresenta il valore mediano del campione;</p></li>
<li><p>il baffo inferiore rappresenta il primo valore nel campione che risulta essere maggiore o uguale al primo quartile meno una volta e mezza la distanza tra i il terzo e il primo quartile;</p></li>
<li><p>il baffo superiore rappresenta il primo valore nel campione che risulta essere minore o uguale al terzo quartile più una volta e mezza la distanza tra i il terzo e il primo quartile;</p></li>
<li><p>i tondini rappresentano i valori “fuori limite” che ricadono fuori dall’intervallo contrassegnato dai baffi. Vengono in genere considerati come “outliers”.</p></li>
</ul>
<p>Per illustrare l’utilità dei boxplot, considereremo il dataset di pesi e altezze visto in precedenza:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sex</th>
      <th>height</th>
      <th>weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>M</td>
      <td>74</td>
      <td>53.484771</td>
    </tr>
    <tr>
      <th>1</th>
      <td>M</td>
      <td>70</td>
      <td>38.056472</td>
    </tr>
    <tr>
      <th>2</th>
      <td>F</td>
      <td>61</td>
      <td>34.970812</td>
    </tr>
    <tr>
      <th>3</th>
      <td>M</td>
      <td>68</td>
      <td>35.999365</td>
    </tr>
    <tr>
      <th>4</th>
      <td>F</td>
      <td>66</td>
      <td>34.559390</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>4226</th>
      <td>F</td>
      <td>69</td>
      <td>23.862436</td>
    </tr>
    <tr>
      <th>4227</th>
      <td>M</td>
      <td>69</td>
      <td>38.262182</td>
    </tr>
    <tr>
      <th>4228</th>
      <td>F</td>
      <td>64</td>
      <td>34.970812</td>
    </tr>
    <tr>
      <th>4229</th>
      <td>F</td>
      <td>64</td>
      <td>28.388071</td>
    </tr>
    <tr>
      <th>4230</th>
      <td>F</td>
      <td>61</td>
      <td>22.628172</td>
    </tr>
  </tbody>
</table>
<p>4231 rows × 3 columns</p>
</div></div></div>
</div>
<p>Mostriamo un il <strong>sommario statistico</strong>, ovvero la lista di tutti gli indicatori di statistica descrittiva discussi finora:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>count    4231.000000
mean       35.818062
std         7.987908
min        20.571066
25%        29.828045
50%        34.970812
75%        41.142132
max        61.301776
Name: weight, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Il boxplot delle altezze si presenta come segue:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/db9870db93f43d1f5fad5b884eb5a5ef92962c8a9bb875fa1febbea3a817d64c.png" src="../_images/db9870db93f43d1f5fad5b884eb5a5ef92962c8a9bb875fa1febbea3a817d64c.png" />
</div>
</div>
<p>I boxplot possono essere utili a comparare campioni. Ad esempio, i seguenti boxplot comparano le distribuzioni dei pesi tra uomini e donne:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/2e92b6a7c2b0516dd1727221d8ebbf77b8b30f496962aed000dc876d3f0c6657.png" src="../_images/2e92b6a7c2b0516dd1727221d8ebbf77b8b30f496962aed000dc876d3f0c6657.png" />
</div>
</div>
<p>Dal grafico sopra possiamo notare che, mentre weight contiene degli outliers nella parte alta, height non li contiene. Questo non è particolarmente sorprendente, perché è più facile trovare un certo numero di persone sovrappeso che persone molto più alte della norma.</p>
</section>
<section id="referenze">
<h3><span class="section-number">11.5. </span>Referenze<a class="headerlink" href="#referenze" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Capitolo 3 di: Heumann, Christian, and Michael Schomaker Shalabh. Introduction to statistics and data analysis. Springer International Publishing Switzerland, 2016.</p></li>
</ul>
</section>
</section>
</div>
<div class="toctree-wrapper compound">
<span id="document-lectures/06_associazione_variabili"></span><section class="tex2jax_ignore mathjax_ignore" id="associazione-tra-variabili">
<h2><span class="section-number">12. </span>Associazione tra Variabili<a class="headerlink" href="#associazione-tra-variabili" title="Permalink to this heading">#</a></h2>
<p>Abbiamo finora analizzato campioni “univariati”, ovvero composti di una sola variabile. Più precisamente, anche quando diverse variabili erano disponibili, abbiamo analizzato le variabili ad una ad una. In pratica, capita spesso che le osservazioni sotto analisi siano costituite da più variabili. In questi casi è utile considerare dei metodi per descrivere e visualizzare i dati in maniera “multivariata”, in modo da studiare le interazioni tra i vari fattori che descrivono il fenomeno in analisi.</p>
<p>Utilizzeremo come esempio nuovamente il dataset Titanic:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Name</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>Cabin</th>
      <th>Embarked</th>
    </tr>
    <tr>
      <th>PassengerId</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>3</td>
      <td>Braund, Mr. Owen Harris</td>
      <td>male</td>
      <td>22.0</td>
      <td>1</td>
      <td>0</td>
      <td>A/5 21171</td>
      <td>7.2500</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>1</td>
      <td>Cumings, Mrs. John Bradley (Florence Briggs Th...</td>
      <td>female</td>
      <td>38.0</td>
      <td>1</td>
      <td>0</td>
      <td>PC 17599</td>
      <td>71.2833</td>
      <td>C85</td>
      <td>C</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>3</td>
      <td>Heikkinen, Miss. Laina</td>
      <td>female</td>
      <td>26.0</td>
      <td>0</td>
      <td>0</td>
      <td>STON/O2. 3101282</td>
      <td>7.9250</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>1</td>
      <td>Futrelle, Mrs. Jacques Heath (Lily May Peel)</td>
      <td>female</td>
      <td>35.0</td>
      <td>1</td>
      <td>0</td>
      <td>113803</td>
      <td>53.1000</td>
      <td>C123</td>
      <td>S</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0</td>
      <td>3</td>
      <td>Allen, Mr. William Henry</td>
      <td>male</td>
      <td>35.0</td>
      <td>0</td>
      <td>0</td>
      <td>373450</td>
      <td>8.0500</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>887</th>
      <td>0</td>
      <td>2</td>
      <td>Montvila, Rev. Juozas</td>
      <td>male</td>
      <td>27.0</td>
      <td>0</td>
      <td>0</td>
      <td>211536</td>
      <td>13.0000</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>888</th>
      <td>1</td>
      <td>1</td>
      <td>Graham, Miss. Margaret Edith</td>
      <td>female</td>
      <td>19.0</td>
      <td>0</td>
      <td>0</td>
      <td>112053</td>
      <td>30.0000</td>
      <td>B42</td>
      <td>S</td>
    </tr>
    <tr>
      <th>889</th>
      <td>0</td>
      <td>3</td>
      <td>Johnston, Miss. Catherine Helen "Carrie"</td>
      <td>female</td>
      <td>NaN</td>
      <td>1</td>
      <td>2</td>
      <td>W./C. 6607</td>
      <td>23.4500</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>890</th>
      <td>1</td>
      <td>1</td>
      <td>Behr, Mr. Karl Howell</td>
      <td>male</td>
      <td>26.0</td>
      <td>0</td>
      <td>0</td>
      <td>111369</td>
      <td>30.0000</td>
      <td>C148</td>
      <td>C</td>
    </tr>
    <tr>
      <th>891</th>
      <td>0</td>
      <td>3</td>
      <td>Dooley, Mr. Patrick</td>
      <td>male</td>
      <td>32.0</td>
      <td>0</td>
      <td>0</td>
      <td>370376</td>
      <td>7.7500</td>
      <td>NaN</td>
      <td>Q</td>
    </tr>
  </tbody>
</table>
<p>891 rows × 11 columns</p>
</div></div></div>
</div>
<p>Dato il dataset sopra, potremmo chiederci se delle variabili influenzano i valori di altre. Ad esempio, trovarsi in prima, seconda o terza classe (variabile <code class="docutils literal notranslate"><span class="pre">Pclass</span></code>) influenza in qualche modo la probabilità di sopravvivere (variabile <code class="docutils literal notranslate"><span class="pre">Survived</span></code>)?, o ancora, l’età (variabile <code class="docutils literal notranslate"><span class="pre">Age</span></code>) o il prezzo pagato (<code class="docutils literal notranslate"><span class="pre">Fare</span></code>) influenza in qualche modo la probabilità di salvarsi (<code class="docutils literal notranslate"><span class="pre">Survived</span></code>)?</p>
<p>In questa lezione, vedremo diversi modi per riassumere le distribuzioni di due variabili e verificare eventuali associazioni (o correlazioni) tra le variabili.</p>
<section id="tabelle-di-contingenza-e-probabilita">
<h3><span class="section-number">12.1. </span>Tabelle di contingenza e probabilità<a class="headerlink" href="#tabelle-di-contingenza-e-probabilita" title="Permalink to this heading">#</a></h3>
<p>Se entrambe le variabili che stiamo studiando sono discrete, possiamo enumerare tutte le possibili combinazioni di valori e riassumerle in una <strong>tabella di contingenza</strong> che indica i valori di una variabile sulle righe e quelli dell’altra variabile sulle colonne. Ogni cella indicherà il numero di volte in cui osserviamo una data coppia di valori.</p>
<p>La tabella di contingenza per le variabili <code class="docutils literal notranslate"><span class="pre">Sex</span></code> e <code class="docutils literal notranslate"><span class="pre">Pclass</span></code> avrà questo aspetto:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Pclass</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
    <tr>
      <th>Sex</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>female</th>
      <td>94</td>
      <td>76</td>
      <td>144</td>
    </tr>
    <tr>
      <th>male</th>
      <td>122</td>
      <td>108</td>
      <td>347</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>La tabella sopra indica ad esempio che <span class="math notranslate nohighlight">\(94\)</span> passeggeri in classe <span class="math notranslate nohighlight">\(1\)</span> erano di sesso femminile. Una tabella di contingenza è spesso mostrata con dei valori a margine che mostrano le somme di righe e colonne:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Pclass</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>All</th>
    </tr>
    <tr>
      <th>Sex</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>female</th>
      <td>94</td>
      <td>76</td>
      <td>144</td>
      <td>314</td>
    </tr>
    <tr>
      <th>male</th>
      <td>122</td>
      <td>108</td>
      <td>347</td>
      <td>577</td>
    </tr>
    <tr>
      <th>All</th>
      <td>216</td>
      <td>184</td>
      <td>491</td>
      <td>891</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Si noti che i valori “All” indicano le frequenze assolute delle due variabili, mentre il valore in basso a destra indica la numerosità del campione.</p>
<p>A partire dalla tabella di contingenza, è possibile ragionare in termini dei vari concetti che abbiamo visto quando abbiamo parlato di probabilità nel caso di variabili discrete, e in particolare di:</p>
<ul class="simple">
<li><p>Joint Probability Distributions (o distribuzioni di frequenze/probabilità congiunte)</p></li>
<li><p>Marginal Probability Distributions (o distribuzioni di frequenze/probabilità marginali)</p></li>
<li><p>Conditional Probability Distributions (o distribuzioni di frequenze/probabilità condizionali)</p></li>
</ul>
<p>Vediamo qualche esempio:</p>
<section id="joint-probability-distributions">
<h4><span class="section-number">12.1.1. </span>Joint Probability Distributions<a class="headerlink" href="#joint-probability-distributions" title="Permalink to this heading">#</a></h4>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Pclass</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
    <tr>
      <th>Sex</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>female</th>
      <td>0.105499</td>
      <td>0.085297</td>
      <td>0.161616</td>
    </tr>
    <tr>
      <th>male</th>
      <td>0.136925</td>
      <td>0.121212</td>
      <td>0.389450</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="marginal-probability-distributions">
<h4><span class="section-number">12.1.2. </span>Marginal Probability Distributions<a class="headerlink" href="#marginal-probability-distributions" title="Permalink to this heading">#</a></h4>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Pclass</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>All</th>
    </tr>
    <tr>
      <th>Sex</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>female</th>
      <td>0.105499</td>
      <td>0.085297</td>
      <td>0.161616</td>
      <td>0.352413</td>
    </tr>
    <tr>
      <th>male</th>
      <td>0.136925</td>
      <td>0.121212</td>
      <td>0.389450</td>
      <td>0.647587</td>
    </tr>
    <tr>
      <th>All</th>
      <td>0.242424</td>
      <td>0.206510</td>
      <td>0.551066</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Le marginali sono riportate nell’ultima riga e ultima colonna.</p>
</section>
<section id="conditional-probability-distributions">
<h4><span class="section-number">12.1.3. </span>Conditional Probability Distributions<a class="headerlink" href="#conditional-probability-distributions" title="Permalink to this heading">#</a></h4>
<p>Probabilità condizionate rispetto alla variabile <code class="docutils literal notranslate"><span class="pre">Sex</span></code> (ottenute dividendo i valori della tabella di contingenza per le somme dei valori sulle righe - colonna <code class="docutils literal notranslate"><span class="pre">All</span></code>):</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Pclass</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
    <tr>
      <th>Sex</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>female</th>
      <td>0.299363</td>
      <td>0.242038</td>
      <td>0.458599</td>
    </tr>
    <tr>
      <th>male</th>
      <td>0.211438</td>
      <td>0.187175</td>
      <td>0.601386</td>
    </tr>
    <tr>
      <th>All</th>
      <td>0.242424</td>
      <td>0.206510</td>
      <td>0.551066</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Si noti che nella tabella sopra non sono riportati valori a margine delle righe, in quanto questi sarebbero tutti uguali a 1.</p>
<p>Dalla tabella sopra, posso evincere:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(P(Pclass=1|Sex=female) = 0.290363 = \frac{94}{314}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(P(Pclass=2|Sex=female) = 0.242038 = \frac{76}{314}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(P(Pclass=3|Sex=female) = 0.458599 = \frac{144}{314}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(P(Pclass=1|Sex=male) = 0.211438 = \frac{122}{577}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(P(Pclass=2|Sex=male) = 0.187175 = \frac{108}{577}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(P(Pclass=3|Sex=male) = 0.601386 = \frac{347}{577}\)</span></p></li>
</ul>
<p>Dalla tabella, notiamo che la distribuzione dei passeggeri cambia nelle tre classi. In particolare, tra gli uomini, la terza classe è più frequente che tra le donne.</p>
<p>Possiamo ottenere la prospettiva complementare condizionando rispetto alla classe invece:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Pclass</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>All</th>
    </tr>
    <tr>
      <th>Sex</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>female</th>
      <td>0.435185</td>
      <td>0.413043</td>
      <td>0.293279</td>
      <td>0.352413</td>
    </tr>
    <tr>
      <th>male</th>
      <td>0.564815</td>
      <td>0.586957</td>
      <td>0.706721</td>
      <td>0.647587</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Si noti che nella tabella sopra non sono riportati valori a margine delle colonne, in quanto questi sarebbero tutti uguali a 1.</p>
<p>In questo caso, ogni colonna sarà una distribuzione di probabilità. Ad esempio:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(P(Sex=female|Pclass=1) = 0.435185\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(P(Sex=male|Pclass=1) = 0.564815\)</span></p></li>
</ul>
<p>Notiamo che le proporzione tra uomini e donne cambiano nelle tre classi e in particolare nella terza classe ci sono molti più uomini che donne.</p>
</section>
</section>
<section id="rappresentazioni-grafiche">
<h3><span class="section-number">12.2. </span>Rappresentazioni Grafiche<a class="headerlink" href="#rappresentazioni-grafiche" title="Permalink to this heading">#</a></h3>
<p>Possiamo facilmente ottenere rappresentazioni grafiche delle relazioni tra due variabili mediante grafici a barre, direttamente dalle tabelle di contingenza. Ad esempio, il seguente grafico confronta le frequenze congiunte assolute:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/ac26d800913862e28176b343cc300fd5f9930924d16e9e02d8164436624066c6.png" src="../_images/ac26d800913862e28176b343cc300fd5f9930924d16e9e02d8164436624066c6.png" />
</div>
</div>
<p>Da qui notiamo che molti passeggeri sono uomini e in terza classe. In questi casi, può essere a volte utile uno stacked plot:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/0c55c9596676ee3c1296b3f23b2ef0d97b6ccd7d812d5afed9ea31f895a6d7b8.png" src="../_images/0c55c9596676ee3c1296b3f23b2ef0d97b6ccd7d812d5afed9ea31f895a6d7b8.png" />
</div>
</div>
<p>È spesso utile visualizzare le distribuzioni condizionate. Ad esempio, il grafico che segue ci permette di confrontare le distribuzioni dei passeggeri nelle tre classi, suddividendo in due gruppi sulla base del sesso:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/637ce8addfa61dda9e3bea0bcbfc88d742b2b1f64c7f40452c8e684acdb47ea1.png" src="../_images/637ce8addfa61dda9e3bea0bcbfc88d742b2b1f64c7f40452c8e684acdb47ea1.png" />
</div>
</div>
<p>Anche in questi casi possiamo usare uno stacked plot:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/35516738e5fb7cde47d91db4634a2a60ae820431ebb7a0f185da895c65740c44.png" src="../_images/35516738e5fb7cde47d91db4634a2a60ae820431ebb7a0f185da895c65740c44.png" />
</div>
</div>
<p>Analogamente, possiamo ottenere i grafici delle frequenze condizionate rispetto alle classi:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/d9ad95d7e5a866cc1279aee299505fb0d1b74016f380d366faf595b39e9f624c.png" src="../_images/d9ad95d7e5a866cc1279aee299505fb0d1b74016f380d366faf595b39e9f624c.png" />
<img alt="../_images/e71dd49b01ccab2eab0466335bc44785a12b9b9634d699c691472b88f760aa20.png" src="../_images/e71dd49b01ccab2eab0466335bc44785a12b9b9634d699c691472b88f760aa20.png" />
</div>
</div>
</section>
<section id="misure-di-associazione-tra-due-variabili-discrete">
<h3><span class="section-number">12.3. </span>Misure di Associazione tra due Variabili Discrete<a class="headerlink" href="#misure-di-associazione-tra-due-variabili-discrete" title="Permalink to this heading">#</a></h3>
<p>Vediamo adesso delle misure che ci permettono di stimare se due variabili sono o meno “associate”, ovvero fino a che punto i valori di una variabile influenzano quelli dell’altra. Abbiamo visto che le variabili <code class="docutils literal notranslate"><span class="pre">Sex</span></code> e <code class="docutils literal notranslate"><span class="pre">Pclass</span></code> sembrano avere un qualche grado di associazione. Vediamo adesso un caso di associazione più forte, esplorando la relazione tra <code class="docutils literal notranslate"><span class="pre">Pclass</span></code> e <code class="docutils literal notranslate"><span class="pre">Survived</span></code>.</p>
<p>Consideriamo tre distribuzioni di frequenze relative di <code class="docutils literal notranslate"><span class="pre">Survived</span></code> condizionando rispetto ai valori <code class="docutils literal notranslate"><span class="pre">Pclass</span></code>:</p>
<ul class="simple">
<li><p>f(Survived|Pclass=1)</p></li>
<li><p>f(Survived|Pclass=2)</p></li>
<li><p>f(Survived|Pclass=3)</p></li>
</ul>
<p>La tabella delle frequenze condizionate che segue riassume questi valori</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Survived</th>
      <th>0</th>
      <th>1</th>
    </tr>
    <tr>
      <th>Pclass</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>0.370370</td>
      <td>0.629630</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.527174</td>
      <td>0.472826</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.757637</td>
      <td>0.242363</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Dai numeri vediamo che le distribuzioni sono molto diverse, a seconda del condizionamento operato. Ciò non è soprendente, perché immaginiamo che i passeggeri in prima e seconda classe abbiano avuto un trattamento diverso rispetto a quelli in terza classe.</p>
<p>Visualizziamo le distribuzioni graficamente:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/2ff6a2c575254b2db87f6971f38ba09c207d895c61ab450bd984b39bb88f5918.png" src="../_images/2ff6a2c575254b2db87f6971f38ba09c207d895c61ab450bd984b39bb88f5918.png" />
</div>
</div>
<p>Il grafico mostra chiaramente lo sbilanciamento, per cui deduciamo che <code class="docutils literal notranslate"><span class="pre">Pclass</span></code> e <code class="docutils literal notranslate"><span class="pre">Survived</span></code> sono in effetti <strong>associate</strong> (o <strong>correlate</strong>).</p>
<section id="indipendenza-e-frequenze-attese">
<h4><span class="section-number">12.3.1. </span>Indipendenza e Frequenze Attese<a class="headerlink" href="#indipendenza-e-frequenze-attese" title="Permalink to this heading">#</a></h4>
<p>Prima di procedere con l’illustrare alcune misure di associazione tra variabili, dobbiamo parlare del concetto di <strong>indipendenza</strong>, che è opposto a quello di associazione.</p>
<p>Due variabili si dicono indipendenti se l’osservazione di una variabile non ci permette di fare nessun tipo di predizione sui possibili valori dell’altra variabile.</p>
<p>Immaginiamo due persone scelte a caso che vivono in parti diverse del mondo scelte casualmente. Se osserviamo il modo in cui una di queste due persone si veste, questa osservazione non ci dirà nulla sul modo in cui l’altra potrebbe vestirsi. Le variabili “vestiti della prima persona” e “vestiti della seconda persona” sono indipendenti. La stessa cosa non vale se le persone abitano nella stessa città. In tal caso, se piove, ad esempio, ci aspettiamo che le due persone indossino abiti simili, per cui osservare il modo in cui una delle due persone si veste può dirci qualcosa sul modo in cui si vestirà l’altra.</p>
<p>Consideriamo nuovamente la generica tabella di contingenza:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p>X=<span class="math notranslate nohighlight">\(x_1\)</span></p></th>
<th class="head"><p>X=<span class="math notranslate nohighlight">\(x_2\)</span></p></th>
<th class="head"><p>…</p></th>
<th class="head"><p>X=<span class="math notranslate nohighlight">\(x_l\)</span></p></th>
<th class="head"><p>Total</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Y=<span class="math notranslate nohighlight">\(y_1\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(n_{11}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(n_{12}\)</span></p></td>
<td><p>…</p></td>
<td><p><span class="math notranslate nohighlight">\(n_{1l}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(n_{1+}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>Y=<span class="math notranslate nohighlight">\(y_2\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(n_{21}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(n_{22}\)</span></p></td>
<td><p>…</p></td>
<td><p><span class="math notranslate nohighlight">\(n_{2l}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(n_{2+}\)</span></p></td>
</tr>
<tr class="row-even"><td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
</tr>
<tr class="row-odd"><td><p>Y=<span class="math notranslate nohighlight">\(y_k\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(n_{k1}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(n_{k2}\)</span></p></td>
<td><p>…</p></td>
<td><p><span class="math notranslate nohighlight">\(n_{kl}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(n_{k+}\)</span></p></td>
</tr>
<tr class="row-even"><td><p>Total</p></td>
<td><p><span class="math notranslate nohighlight">\(n_{+1}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(n_{+2}\)</span></p></td>
<td><p>…</p></td>
<td><p><span class="math notranslate nohighlight">\(n_{+l}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(n\)</span></p></td>
</tr>
</tbody>
</table>
<p>Adesso supponiamo di non poter osservare le co-occorrenze, ma di poter osservare solo i valori marginali:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p>X=<span class="math notranslate nohighlight">\(x_1\)</span></p></th>
<th class="head"><p>X=<span class="math notranslate nohighlight">\(x_2\)</span></p></th>
<th class="head"><p>…</p></th>
<th class="head"><p>X=<span class="math notranslate nohighlight">\(x_l\)</span></p></th>
<th class="head"><p>Total</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Y=<span class="math notranslate nohighlight">\(y_1\)</span></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p>…</p></td>
<td><p></p></td>
<td><p><span class="math notranslate nohighlight">\(n_{1+}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>Y=<span class="math notranslate nohighlight">\(y_2\)</span></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p>…</p></td>
<td><p></p></td>
<td><p><span class="math notranslate nohighlight">\(n_{2+}\)</span></p></td>
</tr>
<tr class="row-even"><td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
</tr>
<tr class="row-odd"><td><p>Y=<span class="math notranslate nohighlight">\(y_k\)</span></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p>…</p></td>
<td><p></p></td>
<td><p><span class="math notranslate nohighlight">\(n_{k+}\)</span></p></td>
</tr>
<tr class="row-even"><td><p>Total</p></td>
<td><p><span class="math notranslate nohighlight">\(n_{+1}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(n_{+2}\)</span></p></td>
<td><p>…</p></td>
<td><p><span class="math notranslate nohighlight">\(n_{+l}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(n\)</span></p></td>
</tr>
</tbody>
</table>
<p>Supponiamo adesso di dover “ricostruire” i valori mancanti. Se le due variabili sono indipendenti, allora:</p>
<div class="math notranslate nohighlight">
\[P(X=x_j, Y=y_i) = P(X=x_j) P(Y=y_i)\]</div>
<p>Ricordiamo che:</p>
<div class="math notranslate nohighlight">
\[P(X=x_j) = \frac{n_{+j}}{n}, P(Y=y_i) = \frac{n_{i+}}{n}, P(X=x_j, Y=y_i)=\frac{n_{ij}}{n}\]</div>
<p>Da qui otteniamo che:</p>
<div class="math notranslate nohighlight">
\[\tilde n_{ij} = n \cdot P(X=x_j,Y=y_i) = n \cdot P(X=x_j) \cdot P(Y=y_i) = n \cdot \frac{n_{+j}}{n} \frac{n_{i+}}{n} = \frac{n_{+j}n_{i+}}{n}\]</div>
<p>Da cui:</p>
<div class="math notranslate nohighlight">
\[\tilde n_{ij} = P(X=x_j) n_{i+} = P(Y=y_i) n_{+j}\]</div>
<p>Dove la tilde su <span class="math notranslate nohighlight">\(\tilde n_{ij}\)</span> indica che questo è un valore stimato, non il valore realmente osservato.</p>
<blockquote>
<div><p>Quanto visto sopra suggerisce che le frequenze <span class="math notranslate nohighlight">\(n_{ij}\)</span> seguando la stessa distribuzione delle frequenze marginali in caso di indipendenza tra le variabili.</p>
</div></blockquote>
<section id="esempio">
<h5><span class="section-number">12.3.1.1. </span>Esempio<a class="headerlink" href="#esempio" title="Permalink to this heading">#</a></h5>
<p>Vediamo un esempio sulla nostra tabella di contingenza che mette in relazione <code class="docutils literal notranslate"><span class="pre">Pclass</span></code> e <code class="docutils literal notranslate"><span class="pre">Survived</span></code>:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Survived</th>
      <th>0</th>
      <th>1</th>
      <th>All</th>
    </tr>
    <tr>
      <th>Pclass</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>80</td>
      <td>136</td>
      <td>216</td>
    </tr>
    <tr>
      <th>2</th>
      <td>97</td>
      <td>87</td>
      <td>184</td>
    </tr>
    <tr>
      <th>3</th>
      <td>372</td>
      <td>119</td>
      <td>491</td>
    </tr>
    <tr>
      <th>All</th>
      <td>549</td>
      <td>342</td>
      <td>891</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>La probabilità marginale <span class="math notranslate nohighlight">\(P(Survived)\)</span> è data da:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    0.616162
1    0.383838
Name: Survived, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Queste sono le probabilità <span class="math notranslate nohighlight">\(P(Survived=0)\)</span> e <span class="math notranslate nohighlight">\(P(Survived=1)\)</span>.</p>
<p>Se le due variabili non fossero correlate, ci aspetteremmo di avere delle frequenze assolute proporzionali alle probabilità marginali:</p>
<div class="math notranslate nohighlight">
\[\tilde{n}_{ij} = P(Y=y_j) \cdot n_{i+}\]</div>
<p>Questi valori saranno dati dalla seguente tabella:</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f_ij</span> <span class="o">=</span> <span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Survived&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
<span class="n">n_iplus</span> <span class="o">=</span> <span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Pclass&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

<span class="n">tab</span> <span class="o">=</span> <span class="n">f_ij</span><span class="o">*</span><span class="n">n_iplus</span>
<span class="n">ct</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Pclass&#39;</span><span class="p">],</span> <span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Survived&#39;</span><span class="p">],</span> <span class="n">margins</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
<span class="n">ct</span><span class="o">.</span><span class="n">values</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">,:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">tab</span><span class="p">[</span><span class="o">...</span><span class="p">]</span>
<span class="n">ct</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Survived</th>
      <th>0</th>
      <th>1</th>
      <th>All</th>
    </tr>
    <tr>
      <th>Pclass</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>133.090909</td>
      <td>82.909091</td>
      <td>216.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>113.373737</td>
      <td>70.626263</td>
      <td>184.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>302.535354</td>
      <td>188.464646</td>
      <td>491.0</td>
    </tr>
    <tr>
      <th>All</th>
      <td>549.000000</td>
      <td>342.000000</td>
      <td>891.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Confrontando queste frequenze con le frequenze effettive, ci accorgiamo che esistono delle discrepanze, ragionevolmente dovute al fatto che le variabili non sono in effetti indipendenti.</p>
</section>
</section>
<section id="statistica-mathcal-x-2-di-pearson">
<h4><span class="section-number">12.3.2. </span>Statistica <span class="math notranslate nohighlight">\(\mathcal{X}^2\)</span> di Pearson<a class="headerlink" href="#statistica-mathcal-x-2-di-pearson" title="Permalink to this heading">#</a></h4>
<p>La statistica <span class="math notranslate nohighlight">\(\mathcal{X}^2\)</span> di Pearson misura queste discrepanze con la seguente formula:</p>
<div class="math notranslate nohighlight">
\[\mathcal{X}^2 = \sum_{i=1}^k \sum_{j=1}^l \frac{(n_{ij}-\tilde{n}_{ij})^2}{\tilde{n}_{ij}}\]</div>
<p>La formula sopra calcola le differenze tra le frequenze assolute osservate e attese al quadrato (per eliminare segni negativi) e scala il risultato per le frequenze attese. <strong>Scalare il risultato fa si che piccole discrepanze ottenute su frequenze attese piccole pesino di più di piccole discrepanze ottenute tra frequenze attese grandi.</strong></p>
<p>Si noti che se le frequenze attese sono identiche a quelle osservate, la statistica ottiene un valore pari a zero.</p>
<p>Nell’esempio visto in precedenza, il risultato sarà pari a:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>102.89
</pre></div>
</div>
</div>
</div>
</section>
<section id="statistica-v-di-cramer">
<h4><span class="section-number">12.3.3. </span>Statistica <span class="math notranslate nohighlight">\(V\)</span> di Cramer<a class="headerlink" href="#statistica-v-di-cramer" title="Permalink to this heading">#</a></h4>
<p>La statistica <span class="math notranslate nohighlight">\(\mathcal{X}^2\)</span> di Pearson non è normalizzata, nel senso che il suo valore massimo dipende dalla dimensione del campione. Per ovviare a questo problema, si può usare la statistica V di Cramer, definita come segue:</p>
<div class="math notranslate nohighlight">
\[V = \sqrt{\frac{\mathcal{X}^2}{n(min(k,l)-1)}}\]</div>
<p>Il risultato sarà un valore compreso tra <span class="math notranslate nohighlight">\(0\)</span> e <span class="math notranslate nohighlight">\(1\)</span>.</p>
<p>La statistica V di Cramer sarà pari al seguente valore per l’esempio visto prima:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.34
</pre></div>
</div>
</div>
</div>
<p>Questo valore indica una piccola associazione tra le due variabili, perché il valore è maggiore di <span class="math notranslate nohighlight">\(0\)</span> ma comunque non prossimo a <span class="math notranslate nohighlight">\(1\)</span>.</p>
</section>
<section id="rischio-relativo">
<h4><span class="section-number">12.3.4. </span>Rischio Relativo<a class="headerlink" href="#rischio-relativo" title="Permalink to this heading">#</a></h4>
<p>Il rischio relativo è uno dei metodi di misurazione del grado di correlazione tra due variabili discrete più diffuso in epidemiologia.</p>
<p>Vediamo un esempio (da <a class="reference external" href="https://en.wikipedia.org/wiki/Odds_ratio">qui</a>): supponiamo che in un villaggio di <span class="math notranslate nohighlight">\(1000\)</span> persone sia aumentata l’incidenza di una malattia rara. Investigando, scopriamo che recentemente una parte della popolazione è stata esposta a una radiazione.</p>
<p>I dati relativi a soggetti malati e sani esposti o non esposti al rischio (la radiazione) viene riassunta dalla seguente tabella di contingenza che mette in relazione la variabile “Diseased/Healthy” con quella “Exposed/Non Exposed”:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Exposed</th>
      <th>Non Exposed</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Diseased</th>
      <td>20</td>
      <td>6</td>
    </tr>
    <tr>
      <th>Healthy</th>
      <td>380</td>
      <td>594</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>La tabella indica il numero di persone che hanno contratto una data malattia o meno in relazione al fatto che siano stati esposti a un determinato rischio o meno (es. a un elemento inquinante).</p>
<p>Il rischio di sviluppare la malattia se esposti può essere calcolato con la seguente probabilità:</p>
<div class="math notranslate nohighlight">
\[P(Diseased|Exposed) = \frac{\#\ (Diseased, Exposed)}{\#\ Exposed} = \frac{20}{20+380} = 0.05\]</div>
<p>Vediamo che abbiamo un rischio del <span class="math notranslate nohighlight">\(5\%\)</span> di sviluppare la malattia, se esposti alla radiazione. Ad esempio, tra <span class="math notranslate nohighlight">\(100\)</span> persone esposte al rischio, ci aspettiamo di trovarne <span class="math notranslate nohighlight">\(5\)</span> malate.</p>
<p>Il rischio calcolato sopra, da solo, non ci dice molto sull’associazione tra le variabili “Exposed” e “Non Exposed”. Consideriamo adesso la probabilità di contrarre la malattia se non esposti al rischio:</p>
<div class="math notranslate nohighlight">
\[P(Diseased|Non\ Exposed) = \frac{\#\ (Diseased, Non\ Exposed)}{\#\ Non\ Exposed} = \frac{6}{6+594} = 0.01\]</div>
<p>Questo valore ci dice che abbiamo un rischio di circa l’<span class="math notranslate nohighlight">\(1\%\)</span> di contrarre la malattia se non esposti. In pratica, su <span class="math notranslate nohighlight">\(100\)</span> soggetti non esposti al rischio, <span class="math notranslate nohighlight">\(1\)</span> si ammala.</p>
<p>È utile mettere a confronto questi due valori di rischio. Infatti, sebbene il <span class="math notranslate nohighlight">\(5\%\)</span> di rischio di ammalarsi tra i soggetti esposti non sia in valore assoluto un numero molto alto, va anche detto che la proporzione di soggetti malati non esposti al rischio è molto più bassa (<span class="math notranslate nohighlight">\(1\%\)</span>). Definiamo dunque il rischio relativo come il rapporto tra questi due rischi (o probabilità):</p>
<div class="math notranslate nohighlight">
\[\textit{RR} = \frac{P(Diseased|Exposed)}{P(Diseased|Non\ Exposed)} = \frac{\frac{\#\ (Diseased, Exposed)}{\#\ Exposed}}{\frac{\#\ (Diseased, Non\ Exposed)}{\#\ Non\ Exposed}} = \frac{0.05}{0.1}=5\]</div>
<p>Interpretiamo questo valore così:</p>
<blockquote>
<div><p>La proporzione di soggetti che contraggono la malattia è di <span class="math notranslate nohighlight">\(5\)</span> volte più grande tra coloro che sono stati esposti al rischio, rispetto al gruppo di coloro che non lo sono stati.</p>
</div></blockquote>
<p>Ad esempio, se tra <span class="math notranslate nohighlight">\(100\)</span> persone non esposte al rischio, generalmente <span class="math notranslate nohighlight">\(10\)</span> si ammalano (rischio del <span class="math notranslate nohighlight">\(10\%\)</span>), allora ci aspettiamo che tra <span class="math notranslate nohighlight">\(100\)</span> persone esposte al rischio, ben il <span class="math notranslate nohighlight">\(50\%\)</span> si ammali!</p>
<p>Il rischio relativo non ci dice nulla sul rischio assoluto (la proporzione di persone che si ammala), ma solo su quanto osservare soggetti esposti al rischio, rispetto a osservare soggetti non esposti al rischio possa influenzare la proporzione di soggetti malati.</p>
<p>In genere:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(RR=1\)</span> indica che l’esposizione al rischio è ininfluente nello sviluppo della malattia (le variabili sono indipendenti);</p></li>
<li><p><span class="math notranslate nohighlight">\(RR&gt;1\)</span> indica che l’esposizione al rischio è associata positivamente allo sviluppo della malattia (ci sono più malati tra i soggetti esposti al rischio);</p></li>
<li><p><span class="math notranslate nohighlight">\(RR&lt;1\)</span> indica che l’esposizione al rischio è associata negativamente allo sviluppo della malattia (ci sono meno malati tra i soggetti esposti al rishcio). In questo caso si dice che il rischio “protegge” dalla comparsa della malattia (utile se il “rischio” è in realtà l’assunzione di un farmaco).</p></li>
</ul>
<p><strong>Attenzione al fatto che il rischio relativo misura una correlazione tra variabili, non un rapporto di causa-effetto, quindi non è sempre corretto dire che un in presenza di un rischio relativo maggiore di 1, allora l’esposizione al rischio “causa” la malattia. Esistono però degli strumenti (analisi causale) che ci permettono di verificare in quali casi possiamo dare questa interpretazione. Questi strumenti sono fondamentali per poter appurare se un determinato farmaco causa (o è co-responsabile di) una guarigione o se una determinata abitudine (es. il fumo) causa (o è co-responsabile della) comparsa di una malattia. Vedremo meglio qualche esempio più in là nel corso.</strong></p>
</section>
<section id="odds-ratio">
<h4><span class="section-number">12.3.5. </span>Odds Ratio<a class="headerlink" href="#odds-ratio" title="Permalink to this heading">#</a></h4>
<p>Il rischio relativo non è sempre calcolabile. Infatti, nel caso precedente abbiamo assunto di avere a disposizione tutti i dati sulla popolazione: di tutti i <span class="math notranslate nohighlight">\(1000\)</span> abitanti sapevamo chi era stato esposto al rischio e chi no e chi aveva sviluppato la malattia e chi no. In molti casi, potremmo non avere tutti questi dati. Ad esempio, immaginiamo che l’incidente sia avvenuto <span class="math notranslate nohighlight">\(50\)</span> fa e che ai tempi sia stato intervistato solo un campione casuale del <span class="math notranslate nohighlight">\(50\%\)</span> dei <span class="math notranslate nohighlight">\(1000\)</span> abitanti del villaggio. Immaginiamo di aver ottenere la seguente tabella di contingenza:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Exposed</th>
      <th>Non Exposed</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Diseased</th>
      <td>20</td>
      <td>6</td>
    </tr>
    <tr>
      <th>Healthy</th>
      <td>10</td>
      <td>16</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Si noti che questo caso (quello del campionamento) sarà il più frequente, in quanto spesso non abbiamo accesso a tutta la popolazione, ma solo a un campione.</p>
<p>In questo caso, non possiamo calcolare il rischio relativo in quanto non sono disponibili i numeri reali di persone esposte e non esposte al rischio, che stavano al denominatore delle espressioni del calcolo del rischio. Se applichiamo comunque la formula, otterremo una stima falsata dal nostro campionamento:</p>
<div class="math notranslate nohighlight">
\[\textit{RR} = \frac{f(Diseased|Exposed)}{f(Diseased|Non\ Exposed)} = \frac{\frac{\#\ (Diseased, Exposed)}{\#\ Exposed}}{\frac{\#\ (Diseased, Non\ Exposed)}{\#\ Non\ Exposed}} = \frac{20/(20+10)}{6/(6+16)}=2.45\]</div>
<p>Sebbene non possiamo calcolare il rischio relativo in quanto non conosciamo il numero assoluto di persone malate e esposte, <strong>ci aspettiamo che il nostro campione sia una buona rappresentazione della popolazione</strong>, per cui possiamo ragionare in termini di “odds”.</p>
<p>Gli odds sono un concetto di probabilità molto usato nell’ambito delle scommesse, perché permettono allo scommettitore di calcolare in modo facile la vinciata da incassare. Ad esempio, se la vittoria della squadra <span class="math notranslate nohighlight">\(A\)</span> sulla squadra <span class="math notranslate nohighlight">\(B\)</span> in una partita di calcio è data <span class="math notranslate nohighlight">\(5:1\)</span>, il bookmaker si aspetta che sia <span class="math notranslate nohighlight">\(5\)</span> volte più probabile che vinca la squadra <span class="math notranslate nohighlight">\(A\)</span> rispetto alla <span class="math notranslate nohighlight">\(B\)</span>. Se scometto la cifra di <span class="math notranslate nohighlight">\(2\)</span> euro sulla squadra <span class="math notranslate nohighlight">\(B\)</span> e la squadra <span class="math notranslate nohighlight">\(B\)</span> vince, allora vincerò <span class="math notranslate nohighlight">\(5\times 2 = 10\)</span> euro (ho scomesso su un evento raro). L’odd in questo caso sarebbe definito come:</p>
<div class="math notranslate nohighlight">
\[odd = \frac{5}{1} = 5\]</div>
<p>Alternativamente, posso ragionare in termini di probabilità. Visto lo schema sopra, mi aspetto che, se giocassimo la partita <span class="math notranslate nohighlight">\(100\)</span> volte, allora la probabilità di vittorie per la squadra <span class="math notranslate nohighlight">\(A\)</span> sarebbe pari a <span class="math notranslate nohighlight">\(P(A\ vince)=\frac{5}{5+1}\)</span>, mentre la probabilità di sconfitta sarebbe pari a <span class="math notranslate nohighlight">\(P(A\ perde)=\frac{1}{5+1}\)</span>. L’odd può essere definito in termini di queste probabilità:</p>
<div class="math notranslate nohighlight">
\[odd = \frac{P(A\ vince)}{P(A\ perde)} = \frac{\frac{5}{5+1}}{\frac{1}{5+1}} = 5\]</div>
<p>In generale, l’odd per un evento <span class="math notranslate nohighlight">\(E\)</span> è la probabilità che l’evento accade, fratto la probabilità che l’evento non accada:</p>
<div class="math notranslate nohighlight">
\[odd = \frac{P(E)}{1-P(E)}\]</div>
<p>L’odd è un concetto simile a quello del rischio perché ci dice quanto è più grande la frequenza che un evento si realizzi (A vince) rispetto alla frequenza che l’evento non si realizzi. Applichiamo questo concetto al nostro esempio. Definiamo due odds (così come abbiamo definito due rischi):</p>
<ul class="simple">
<li><p>L’odds di ammalarsi se esposti: <span class="math notranslate nohighlight">\(\frac{P(Diseased|Exposed)}{P(Healthy|Exposed)} = \frac{\frac{20}{20+10}}{\frac{10}{20+10}} = \frac{20}{10} = 2\)</span></p></li>
<li><p>L’odds di ammalarsi se non esposti: <span class="math notranslate nohighlight">\(\frac{P(Diseased|Non\ Exposed)}{P(Healthy|Non\ Exposed)} = \frac{\frac{6}{6+16}}{\frac{16}{6+16}} = \frac{6}{16} 0.375\)</span></p></li>
</ul>
<p>Va notato che nelle formule sopra i conteggi assoluti, ovvero quelli di cui non ci fidiamo dato il campionamento, “si annullano”.</p>
<p>L’odds ratio sarà definito come segue:</p>
<div class="math notranslate nohighlight">
\[odd = \frac{\frac{f(Diseased|Exposed)}{f(Healthy|Exposed)}}{\frac{f(Diseased|Non\ Exposed)}{f(Healthy|Non\ Exposed)}} = \frac{2}{0.375} \approx 5.3\]</div>
<p>Notiamo come l’odds ratio ottenuto sia molto vicino al rischio relativo calolcato in precedenza <span class="math notranslate nohighlight">\(5\)</span>. <strong>In pratica si può dimostrare che, se si assume che la malattia sia rara (rare-disease assumption), l’odds ratio e il rischio relativo convergono a volori simili.</strong> È quindi una pratica abbastanza comune di effettuare questa ipotesi e calcolare l’odds ratio al posto del rischio relativo.</p>
</section>
</section>
<section id="associazioni-tra-variabili-continue">
<h3><span class="section-number">12.4. </span>Associazioni tra Variabili Continue<a class="headerlink" href="#associazioni-tra-variabili-continue" title="Permalink to this heading">#</a></h3>
<p>Quando le variabili sono continue, non è più possibile costruire tabelle di contingenza. In quei casi, si utilizzano altri strumenti, che vedremo in questa sezione.</p>
<p>Considereremo il dataset “diabetes” per questa parte. Il dataset è stato introdotto nel <span class="math notranslate nohighlight">\(1979\)</span> da Reaven e Miller ed esamina la relazione tra misure del sangue e l’insulina in <span class="math notranslate nohighlight">\(145\)</span> adulti:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>relwt</th>
      <th>glufast</th>
      <th>glutest</th>
      <th>instest</th>
      <th>sspg</th>
      <th>group</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.81</td>
      <td>80</td>
      <td>356</td>
      <td>124</td>
      <td>55</td>
      <td>Normal</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.95</td>
      <td>97</td>
      <td>289</td>
      <td>117</td>
      <td>76</td>
      <td>Normal</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.94</td>
      <td>105</td>
      <td>319</td>
      <td>143</td>
      <td>105</td>
      <td>Normal</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.04</td>
      <td>90</td>
      <td>356</td>
      <td>199</td>
      <td>108</td>
      <td>Normal</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.00</td>
      <td>90</td>
      <td>323</td>
      <td>240</td>
      <td>143</td>
      <td>Normal</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>140</th>
      <td>1.05</td>
      <td>353</td>
      <td>1428</td>
      <td>41</td>
      <td>480</td>
      <td>Overt_Diabetic</td>
    </tr>
    <tr>
      <th>141</th>
      <td>0.91</td>
      <td>180</td>
      <td>923</td>
      <td>77</td>
      <td>150</td>
      <td>Overt_Diabetic</td>
    </tr>
    <tr>
      <th>142</th>
      <td>0.90</td>
      <td>213</td>
      <td>1025</td>
      <td>29</td>
      <td>209</td>
      <td>Overt_Diabetic</td>
    </tr>
    <tr>
      <th>143</th>
      <td>1.11</td>
      <td>328</td>
      <td>1246</td>
      <td>124</td>
      <td>442</td>
      <td>Overt_Diabetic</td>
    </tr>
    <tr>
      <th>144</th>
      <td>0.74</td>
      <td>346</td>
      <td>1568</td>
      <td>15</td>
      <td>253</td>
      <td>Overt_Diabetic</td>
    </tr>
  </tbody>
</table>
<p>145 rows × 6 columns</p>
</div></div></div>
</div>
<p>Le <span class="math notranslate nohighlight">\(6\)</span> variabili hanno i seguenti significati:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">relwt</span></code>
relative weight, expressed as the ratio of actual weight to
expected weight, given the person’s height, a numeric vector</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">glufast</span></code>
fasting plasma glucose level, a numeric vector</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">glutest</span></code>
test plasma glucose level, a measure of glucose intolerance, a
numeric vector</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">instest</span></code>
plasma insulin during test, a measure of insulin response to oral
glucose, a numeric vector</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sspg</span></code>
steady state plasma glucose, a measure of insulin resistance, a
numeric vector</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">group</span></code>
diagnostic group, a factor with levels <code class="docutils literal notranslate"><span class="pre">Normal</span></code>
<code class="docutils literal notranslate"><span class="pre">Chemical_Diabetic</span></code> <code class="docutils literal notranslate"><span class="pre">Overt_Diabetic</span></code></p></li>
</ul>
<section id="rappresentazione-grafica-di-due-variabili-continue">
<h4><span class="section-number">12.4.1. </span>Rappresentazione grafica di due variabili continue<a class="headerlink" href="#rappresentazione-grafica-di-due-variabili-continue" title="Permalink to this heading">#</a></h4>
<p>Iniziamo considerando le variabili <code class="docutils literal notranslate"><span class="pre">sspg</span></code> e <code class="docutils literal notranslate"><span class="pre">glutest</span></code>. La prima forma di rappresentazione utile è quella dello scatterplot, che visualizza le osservazioni come dati bidimensionali:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/72c9c65a4539d7164e8ee1c1aab1ac1452411c24ef7706efc9de99971c000370.png" src="../_images/72c9c65a4539d7164e8ee1c1aab1ac1452411c24ef7706efc9de99971c000370.png" />
</div>
</div>
<p>Notiamo che, sembra esserci una relazione tra le due variabili. Infatti, al crescere di <code class="docutils literal notranslate"><span class="pre">sspg</span></code>, i valori di <code class="docutils literal notranslate"><span class="pre">glutest</span></code> tendono a crescere. Sembra esserci una <strong>correlazione</strong> (o <strong>associazione</strong>) positiva. Prendiamo adesso la coppia <code class="docutils literal notranslate"><span class="pre">relwt</span></code> e <code class="docutils literal notranslate"><span class="pre">sspg</span></code>:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/76b65c3d7b8c9959be7f8b08ec0ee768d3a30cf425e5963d37ad1bb93e503dd1.png" src="../_images/76b65c3d7b8c9959be7f8b08ec0ee768d3a30cf425e5963d37ad1bb93e503dd1.png" />
</div>
</div>
<p>Notiamo che in questo caso la relazione appare meno marcata, ma notiamo comunque un trend ascendente di <code class="docutils literal notranslate"><span class="pre">sspg</span></code> al crescere di <code class="docutils literal notranslate"><span class="pre">relwt</span></code>. È spesso utile cercare studiare le correlazioni con una <strong>scattermatrix</strong> che mostra tutti i possibili scatterplot. Nel caso del nostro esempio:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/a79a952db4c21e82aad889a200fa92adaed5af142fbd6d1a23d0f1809a1d2954.png" src="../_images/a79a952db4c21e82aad889a200fa92adaed5af142fbd6d1a23d0f1809a1d2954.png" />
</div>
</div>
<p>Dalla visualizzazione sopra, possiamo dedurre alcune cose:</p>
<ul class="simple">
<li><p>alcune coppie di variabili sono correlate positivamente (ad esempio <code class="docutils literal notranslate"><span class="pre">relwt</span></code>-<code class="docutils literal notranslate"><span class="pre">sspg</span></code>), mentre altre lo sono negativamente (<code class="docutils literal notranslate"><span class="pre">glutest</span></code>-<code class="docutils literal notranslate"><span class="pre">instest</span></code>);</p></li>
<li><p>alcune relazioni sono “lineari” (ad esempio <code class="docutils literal notranslate"><span class="pre">glutest</span></code> e <code class="docutils literal notranslate"><span class="pre">glufast</span></code>), mentre altre tengono a non esserlo (ad esempio <code class="docutils literal notranslate"><span class="pre">glufast</span></code> e <code class="docutils literal notranslate"><span class="pre">sspg</span></code>):</p></li>
<li><p>alcune coppie di variabili (ad esempio <code class="docutils literal notranslate"><span class="pre">sspg</span></code> e <code class="docutils literal notranslate"><span class="pre">relwt</span></code>) non sembrano essere correlate.</p></li>
</ul>
</section>
<section id="covarianza">
<h4><span class="section-number">12.4.2. </span>Covarianza<a class="headerlink" href="#covarianza" title="Permalink to this heading">#</a></h4>
<p>Abbiamo visto che la <strong>varianza</strong> indica quanto un campione univariato sia disperso attorno alla sua media. Possiamo utilizzare un’idea simile per quantificare fino a che punto <strong>due variabili si distribuiscono in modo simile attorno alla loro media</strong>. Ci aspettiamo che, se le variabili sono correlate, allora si distribuiranno in maniera simile.</p>
<p>Il concetto di <strong>varianza</strong> viene generalizzato dal concetto di <strong>covarianza</strong> nel caso di dati bivariati. La covarianza misura quanto le due variabili varino assieme e si misura come segue:</p>
<div class="math notranslate nohighlight">
\[
Cov(X,Y) = \frac{1}{n}\sum_i^n (x^{(i)} - \overline x) (y^{(i)} - \overline y)
\]</div>
<p>dove <span class="math notranslate nohighlight">\(X\)</span> e <span class="math notranslate nohighlight">\(Y\)</span> sono le due variabili di interesse, <span class="math notranslate nohighlight">\(x^{(i)}\)</span> è il valore di <span class="math notranslate nohighlight">\(X\)</span> per l’iesima osservazione, <span class="math notranslate nohighlight">\(y^{(i)}\)</span> è il valore di <span class="math notranslate nohighlight">\(Y\)</span> per l’iesima osservazione e <span class="math notranslate nohighlight">\(\overline x\)</span>, <span class="math notranslate nohighlight">\(\overline y\)</span> sono le medie delle osservazioni per le due variabili <span class="math notranslate nohighlight">\(X\)</span> e <span class="math notranslate nohighlight">\(Y\)</span>.</p>
<p>I principali “attori” nella formula sopra sono i termini:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\((x^{(i)}-\overline x)\)</span>: misura la distanza tra un punto <span class="math notranslate nohighlight">\(x^{(i)}\)</span> e la rispettiva media <span class="math notranslate nohighlight">\(\overline x\)</span>. Se il valore del punto in considerazione è sopra la media, allora questa differenza sarà positiva, altrimenti negativa.</p></li>
<li><p><span class="math notranslate nohighlight">\((y^{(i)}-\overline y)\)</span>: misura la distanza tra un punto <span class="math notranslate nohighlight">\(y^{(i)}\)</span> e la rispettiva media <span class="math notranslate nohighlight">\(\overline y\)</span>. Se il valore del punto in considerazione è sopra la media, allora questa differenza sarà positiva, altrimenti negativa.</p></li>
</ul>
<p>Ogni termine della somma nella formula della covarianza effettua i prodotti tra questi due termini:</p>
<div class="math notranslate nohighlight">
\[(x^{(i)}-\overline x)(y^{(i)}-\overline y)\]</div>
<p>Che saranno:</p>
<ul class="simple">
<li><p><strong>positivi</strong> se gli elementi <span class="math notranslate nohighlight">\(x^{(i)}\)</span> e <span class="math notranslate nohighlight">\(y^{(i)}\)</span> sono “concordi”, ovvero se sono entrambi sopra le rispettive medie o entrambi sotto le rispettive medie;</p></li>
<li><p><strong>negativi</strong> se gli elementi <span class="math notranslate nohighlight">\(x^{(i)}\)</span> e <span class="math notranslate nohighlight">\(y^{(i)}\)</span> sono “discordi”, ovvero se uno dei due è sopra la rispettiva media, mentre l’altro è sotto la rispettiva media;</p></li>
<li><p><strong>nulli o prossimi allo zero</strong> se gli elementi <span class="math notranslate nohighlight">\(x^{(i)}\)</span> e <span class="math notranslate nohighlight">\(y^{(i)}\)</span> sono molto vicini alle rispettive medie.</p></li>
</ul>
<p>Queste quantità hanno una interpretazione geometrica. Consideriamo il seguente plot:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/3da6313b7718ddb85fb100765759924a10a83fa16ef270ceef33839b74365296.png" src="../_images/3da6313b7718ddb85fb100765759924a10a83fa16ef270ceef33839b74365296.png" />
</div>
</div>
<p>Il grafico mostra un campione di punti e le rispettive medie con una linea orizzontale (per Y) e verticale (per X). Le due medie dividono il grafico in quattro quadranti. Per ogni punto, le linee tratteggiate rosse indicano i valori delle grandezze <span class="math notranslate nohighlight">\((x^{(i)}-\overline x)\)</span> e <span class="math notranslate nohighlight">\((y^{(i)}-\overline y)\)</span>. In particolare:</p>
<ul class="simple">
<li><p>I punti nel quadrante in alto a destra avranno entrambe queste grandezze positive. I prodotti <span class="math notranslate nohighlight">\((x^{(i)}-\overline x)(y^{(i)}-\overline y)\)</span> saranno positivi.</p></li>
<li><p>I punti nel quadrante in basso a destra avranno entrambe queste grandezze negative. I prodotti <span class="math notranslate nohighlight">\((x^{(i)}-\overline x)(y^{(i)}-\overline y)\)</span> saranno positivi.</p></li>
<li><p>I punti negli altri due quadranti avranno una delle grandezze positive e l’altra negativa. I prodotti <span class="math notranslate nohighlight">\((x^{(i)}-\overline x)(y^{(i)}-\overline y)\)</span> saranno negativi.</p></li>
</ul>
<p>In pratica:</p>
<ul class="simple">
<li><p>i punti nel primo e terzo quadrante contribuiscono <strong>positivamente</strong> all’indice di correlazione;</p></li>
<li><p>i punti nel secondo e quarto quadrante contribuiscono <strong>negativamente</strong> all’indice di correlazione.</p></li>
<li><p>I punti vicini alla media (l’intersezione tra le due medie) corrisponderanno a grandezze molto piccole e <strong>non contribuiranno</strong> a cambiare il valore della covarianza.</p></li>
</ul>
<p>Intuitivamente, la covarianza assumerà valori molto positivi quando <span class="math notranslate nohighlight">\(X\)</span> e <span class="math notranslate nohighlight">\(Y\)</span> variano in maniera concorde (ovvero, se <span class="math notranslate nohighlight">\(X\)</span> assume valori alti, <span class="math notranslate nohighlight">\(Y\)</span> assume valori alti e se <span class="math notranslate nohighlight">\(X\)</span> assume valori bassi <span class="math notranslate nohighlight">\(Y\)</span> assume valori bassi). In tal caso infatti i segni dei due fattori all’interno della sommatoria saranno concordi e il loro prodotto avrà segno positivo. Se invece <span class="math notranslate nohighlight">\(X\)</span> e <span class="math notranslate nohighlight">\(Y\)</span> variano in maniera discorde, il prodotto avrà segno negativo e la varianza assumerà valori negativi.</p>
<p>Notiamo che la covarianza di una variabile <span class="math notranslate nohighlight">\(X\)</span> con se stessa è uguale alla varianza:</p>
<div class="math notranslate nohighlight">
\[
Cov(X,X) = \frac{1}{n}\sum_i^n (x_i - \overline x) (x_i - \overline x) = s_X
\]</div>
<p>Va notato che:</p>
<ul class="simple">
<li><p>Valori negativi indicano una correlazione negativa (quando una delle due variabili cresce, l’altra diminuisce);</p></li>
<li><p>Valori positivi indicano una correlazione positiva (le due variabili crescono o decrescono insieme);</p></li>
<li><p>Valori nulli (o vicini allo zero) indicano che le due variabili non sono correlate (o lo sono debolmente).</p></li>
</ul>
<p>Va anche notato che i valori della correlazione non sono normalizzati e dipendono dai range delle singole variabili, per cui non è possibile confrontare le covarianze. Ad esempio, la covarianza tra <code class="docutils literal notranslate"><span class="pre">relwt</span></code> e se stessa (dunque la varianza di <code class="docutils literal notranslate"><span class="pre">relwt</span></code>) è prossima allo zero, tuttavia, ciò non vuol dire che <code class="docutils literal notranslate"><span class="pre">relwt</span></code> non sia correlata con se stessa!</p>
<p>In pratica, in presenza di più variabili, si calcolano le covarianze di tutte le coppie possibili di variabili, un po’ come visto nel caso della scatter matrix. Nel nostro caso avremo:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>relwt</th>
      <th>glufast</th>
      <th>glutest</th>
      <th>instest</th>
      <th>sspg</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>relwt</th>
      <td>0.016702</td>
      <td>-0.072815</td>
      <td>0.982426</td>
      <td>3.473373</td>
      <td>5.266255</td>
    </tr>
    <tr>
      <th>glufast</th>
      <td>-0.072815</td>
      <td>4087.097031</td>
      <td>19546.064080</td>
      <td>-3063.463649</td>
      <td>4849.905651</td>
    </tr>
    <tr>
      <th>glutest</th>
      <td>0.982426</td>
      <td>19546.064080</td>
      <td>100457.849808</td>
      <td>-12918.162739</td>
      <td>25908.490182</td>
    </tr>
    <tr>
      <th>instest</th>
      <td>3.473373</td>
      <td>-3063.463649</td>
      <td>-12918.162739</td>
      <td>14625.312548</td>
      <td>101.482519</td>
    </tr>
    <tr>
      <th>sspg</th>
      <td>5.266255</td>
      <td>4849.905651</td>
      <td>25908.490182</td>
      <td>101.482519</td>
      <td>11242.331897</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>La matrice vista sopra viene anche detta “matrice di covarianza” e indicata con la lettere <span class="math notranslate nohighlight">\(\Sigma\)</span>. Date le variabili <span class="math notranslate nohighlight">\(X=(X_i,\ldots,X_k)\)</span>, <span class="math notranslate nohighlight">\(\Sigma\)</span> è una matrice <span class="math notranslate nohighlight">\([k \times k]\)</span> il cui termine generale è:</p>
<div class="math notranslate nohighlight">
\[\Sigma_{ij} = Cov(X_i,X_j)\]</div>
</section>
<section id="indice-di-correlazione-di-pearson">
<h4><span class="section-number">12.4.3. </span>Indice di Correlazione di Pearson<a class="headerlink" href="#indice-di-correlazione-di-pearson" title="Permalink to this heading">#</a></h4>
<p>Il coefficiente di correlazione di Pearson cerca di risolvere i problemi della covarianza fornendo uno score quantitativo normalizzato. Dato un campione bivariato <span class="math notranslate nohighlight">\(\{(x^{(i)},y^{(i)})\}\)</span>, il coefficiente di correlazione di Pearson è definito come la covarianza tra le due variabili, diviso il prodotto delle deviazioni standard:</p>
<div class="math notranslate nohighlight">
\[
\rho(x,y)= \frac{Cov(X,Y)}{s_X s_Y} 
\]</div>
<p>Notiamo che:</p>
<div class="math notranslate nohighlight">
\[
 \rho(x,y) = \frac{Cov(X,Y)}{s_X s_Y}  = \frac{1}{n} \sum \frac{(x_i - \overline x)}{s_X} \frac{(y_i - \overline y)}{s_X} = Cov(z(X),z(Y))
\]</div>
<p>Dove</p>
<div class="math notranslate nohighlight">
\[
z(X) = \frac{X-\overline X}{s_x}
\]</div>
<p>è la funzione di z-scoring.</p>
<p>Possiamo dunque vedere l’indice di correlazione di Pearson come la covarianza delle variabili normalizzate con z-scoring. Si può facilmente vedere che il coefficiente di correlazione di Pearson può essere scritto anche come segue:</p>
<div class="math notranslate nohighlight">
\[
\rho(x,y) = \frac{\sum_{i=1}^n (x^{(i)}-\overline x)(y^{(i)}-\overline y)}{\sqrt{\sum_{i=1}^n (x^{(i)}-\overline x)^2} \sqrt{\sum_{i=1}^n (y^{(i)}-\overline y)^2}}
\]</div>
<p>Dove <span class="math notranslate nohighlight">\(\overline x\)</span> e <span class="math notranslate nohighlight">\(\overline y\)</span> sono rispettivamente le medie dei valori delle due variabili.</p>
<p>Il grafico che segue mostra un plot analogo al precedente dopo aver effettuato lo z-scoring. Si noti come adesso i range di <span class="math notranslate nohighlight">\(x\)</span> e <span class="math notranslate nohighlight">\(y\)</span> sono normalizzati e la media si trova nell’origine.</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/678c1017ce1a57225a15e996d5d0c28533f3ea183469220416da82cfc88a1339.png" src="../_images/678c1017ce1a57225a15e996d5d0c28533f3ea183469220416da82cfc88a1339.png" />
</div>
</div>
<p>L’indice di correlazione di Pearson è un numero compreso tra <span class="math notranslate nohighlight">\(-1\)</span> (massima anticorrelazione) e <span class="math notranslate nohighlight">\(1\)</span> (massima correlazione).</p>
<p>In pratica, si avrà:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\rho(x,-x)=-1\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\rho(x,x) = 1\)</span></p></li>
</ul>
<p>L’indice di correlazione tra le variabili <code class="docutils literal notranslate"><span class="pre">relwt</span></code> e <code class="docutils literal notranslate"><span class="pre">sspg</span></code> sarà pari a:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.38
</pre></div>
</div>
</div>
</div>
<section id="interpretazione-dei-valori-dell-indice-di-correlazione-di-pearson">
<h5><span class="section-number">12.4.3.1. </span>Interpretazione dei valori dell’indice di correlazione di Pearson<a class="headerlink" href="#interpretazione-dei-valori-dell-indice-di-correlazione-di-pearson" title="Permalink to this heading">#</a></h5>
<p>L’indice di correlazione di Pearson è un numero compreso tra <span class="math notranslate nohighlight">\(-1\)</span> e <span class="math notranslate nohighlight">\(1\)</span> che indica se sussiste una correlazione (ovvero, quando i valori della prima variabile crescono, anche i valori della seconda variabile crescono) o un’anticorrelazione (ovvero, quando i valori della prima variabile crescono, i valori della seconda variabile decrescono e viceversa). Valori prossimi a <span class="math notranslate nohighlight">\(-1\)</span> indicano che le variabili sono anticorrelate; valori prossimi a <span class="math notranslate nohighlight">\(1\)</span> indicano che le variabili sono correlate; valori prossimi a <span class="math notranslate nohighlight">\(0\)</span> indicano che le variabili sono decorrelate. In pratica:</p>
<ul class="simple">
<li><p>Il segno dell’indice indica il “verso” della correlazione:</p>
<ul>
<li><p>Positivo: le variabili sono correlate;</p></li>
<li><p>Negativo: le variabili sono anticorrelate;</p></li>
</ul>
</li>
<li><p>Il valore assoluto dell’indice indica quanto la correlazione (o anticorrelazione) sia forte:</p>
<ul>
<li><p>per valori compresi tra <span class="math notranslate nohighlight">\(0\)</span> e <span class="math notranslate nohighlight">\(0.3\)</span> si parla di correlazione (o anticorrelazione) <strong>debole</strong>;</p></li>
<li><p>per valori compresi tra <span class="math notranslate nohighlight">\(0.3\)</span> e <span class="math notranslate nohighlight">\(0.7\)</span> si parla di correlazione (o anticorrelazione) <strong>moderata</strong>;</p></li>
<li><p>per valori compresi tra <span class="math notranslate nohighlight">\(0.7\)</span> e <span class="math notranslate nohighlight">\(1\)</span> si parla di correlazione (o anticorrelazione) <strong>forte</strong>.</p></li>
</ul>
</li>
</ul>
<p>Si noti che l’indice di correlazione di Pearson misura solo le <strong>correlazioni lineari</strong>. Pertanto, tra due variabili potrebbe sussistere una correlazione non lineare anche se l’indice di correlazione ottenuto è basso.</p>
<p>Il seguente grafico mostra gli scatterplot di alcuni campioni bivariati di esempio con diversi gradi di correlazione, insieme ai relativi indici di correlazione di Pearson:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/4690238e89cff14024d89b1d1e67ba9d8bb9789a8ae315345347e6c34a85b1b5.png" src="../_images/4690238e89cff14024d89b1d1e67ba9d8bb9789a8ae315345347e6c34a85b1b5.png" />
</div>
</div>
<p>Osservando i grafici mostrati sopra, possiamo notare che sussistono le seguenti relazioni tra indice e scatterplot:</p>
<ul class="simple">
<li><p>Un indice positivo individua un andamento ascendente (una retta con coefficiente angolare positivo);</p></li>
<li><p>Un indice negativo individua un andamento discendente (una retta con coefficiente angolare negativo);</p></li>
<li><p>Il valore assoluto dell’indice è correlato alla “larghezza” del “corridoio” formato dai dati.</p></li>
</ul>
<p>Si noti che non esiste alcuna relazione tra indice di correlazione di Pearson e pendenza della retta. Possiamo vederlo nel seguente grafico:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/bdf7d00d5b64d5c7d6647ac32468892357f887abd02443eac770472792eef4f5.png" src="../_images/bdf7d00d5b64d5c7d6647ac32468892357f887abd02443eac770472792eef4f5.png" />
</div>
</div>
</section>
</section>
<section id="indice-di-correlazione-di-spearman-per-ranghi">
<h4><span class="section-number">12.4.4. </span>Indice di Correlazione di Spearman per ranghi<a class="headerlink" href="#indice-di-correlazione-di-spearman-per-ranghi" title="Permalink to this heading">#</a></h4>
<p>L’indice di Pearson cattura le relazioni lineari tra le variabili. Esistono tuttavia dei casi in cui la relazione tra due variabili può non essere lineare, ma ha comunque senso cercare di capire se esiste una correlazione.</p>
<p>Immaginiamo di avere una serie di utenti che assegnano dei punteggi a dei prodotti che recensiscono. Ogni utente userà una scala soggettiva diversa e probabilmente non lineare. L’indice di correlazione di Pearson non sarebbe il più adeguato per verificare se i punteggi assegnati da due utenti sono correlati.</p>
<p><strong>L’indice di correlazione di Spearman cerca di risolvere questo problema passando dai punteggi ai ranghi</strong>. Invece di ragionare sui punteggi individuali, l’indice di correlazione di Spearman ordina i prodotti per score e verifica se gli ordinamenti ottenuti sono simili.</p>
<p>Consideriamo il campione <span class="math notranslate nohighlight">\(\{(x^{(i)},y^{(i)})\}_i\)</span>. Siano <span class="math notranslate nohighlight">\(R(x^{(i)})\)</span> e <span class="math notranslate nohighlight">\(R(y^{(i)})\)</span> i ranghi associati ai valori delle due variabili e sia <span class="math notranslate nohighlight">\(d_i=R(x^{(i)})\)</span> - <span class="math notranslate nohighlight">\(R(y^{(i)})\)</span>. Il coefficiente di correlazione di Spearman per ranghi è definito come segue:</p>
<div class="math notranslate nohighlight">
\[ R = 1 - \frac{6\sum_{i=1}^n d_i^2}{n(n^2-1)} \]</div>
<p>I valori del coefficiente di Spearman sono normalizzati tra <span class="math notranslate nohighlight">\(-1\)</span> e <span class="math notranslate nohighlight">\(+1\)</span> e hanno una interpretazione simile al coefficiente di Pearson.</p>
<p>Consideriamo il seguente esempio. Chiediamo a Alice, Bob, Charlie e David di assegnare uno score da <span class="math notranslate nohighlight">\(1\)</span> a <span class="math notranslate nohighlight">\(5\)</span> a quattro gusti di gelato, ottenendo questi risultati:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Participant</th>
      <th>Chocolate</th>
      <th>Vanilla</th>
      <th>Strawberry</th>
      <th>MintChip</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Alice</td>
      <td>5</td>
      <td>4</td>
      <td>3</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Bob</td>
      <td>3</td>
      <td>5</td>
      <td>4</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Charlie</td>
      <td>4</td>
      <td>3</td>
      <td>5</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>David</td>
      <td>2</td>
      <td>3</td>
      <td>2</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Dato che ogni bambino può usare una diversa scala, utilizziamo il coefficiente di Spearman ottenendo i seguenti valori:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Spearman Correlation (Chocolate vs. Vanilla): 0.21
Spearman Correlation (Chocolate vs. Strawberry): 0.40
Spearman Correlation (Chocolate vs. MintChip): -0.77
</pre></div>
</div>
</div>
</div>
<p>Questi valori ci dicono che il gusto di gelati che ha ricevuto score “più simili” al cioccolato è la fragola.</p>
<p>A differenza del coefficiente di Pearson, l’indice di Spearman può catturare relazioni non lineari, come mostrato nell’esempio che segue:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/2083f8f5a738a48ff842e5251bde87d59fd0f25267940f2a100c655722a87529.png" src="../_images/2083f8f5a738a48ff842e5251bde87d59fd0f25267940f2a100c655722a87529.png" />
</div>
</div>
</section>
<section id="indice-di-correlazione-di-kendall-opzionale">
<h4><span class="section-number">12.4.5. </span>Indice di Correlazione di Kendall (Opzionale)<a class="headerlink" href="#indice-di-correlazione-di-kendall-opzionale" title="Permalink to this heading">#</a></h4>
<p>L’indice di correlazione per ranghi di Kendall, detto anche <strong>Kendall’s <span class="math notranslate nohighlight">\(\tau\)</span></strong>, è anch’esso usato per misurare il livello di associazione tra due variabili, considerandone i ranghi.</p>
<p>Consideriamo il campione <span class="math notranslate nohighlight">\(\{(x^{(i)},y^{(i)})\}_i\)</span>. Ogni coppia di osservazioni <span class="math notranslate nohighlight">\((x_i,y_i)\)</span> e <span class="math notranslate nohighlight">\((x_j,y_j)\)</span>, con <span class="math notranslate nohighlight">\(i&lt;j\)</span> si dice:</p>
<ul class="simple">
<li><p><strong>concordante</strong> se: <span class="math notranslate nohighlight">\(x_i&gt;x_j\)</span> e <span class="math notranslate nohighlight">\(y_i&gt;y_j\)</span> o <span class="math notranslate nohighlight">\(x_i&lt;x_j\)</span> e <span class="math notranslate nohighlight">\(y_i&lt;y_j\)</span>;</p></li>
<li><p><strong>discordante</strong> se: <span class="math notranslate nohighlight">\(x_i&lt;x_j\)</span> e <span class="math notranslate nohighlight">\(y_i&gt;y_j\)</span> o <span class="math notranslate nohighlight">\(x_i&gt;x_j\)</span> e <span class="math notranslate nohighlight">\(y_i&lt;y_j\)</span>;</p></li>
</ul>
<p>Il coefficiente <span class="math notranslate nohighlight">\(\tau\)</span> di Kendall è definito come segue:</p>
<div class="math notranslate nohighlight">
\[\tau = \frac{\text{concordant pairs} - \text{discordant pairs}}{\text{pairs}}\]</div>
<p>Il grafico che segue mostra un campione con sei punti. Ciascuna linea mostra una possibile coppia di punti. Le linee verdi mostrano i campioni concordanti, mentre quelle rosse mostrano i campioni discordanti. Il coefficiente di Kendall per questo esempio è dato da:</p>
<div class="math notranslate nohighlight">
\[\tau = \frac{4-2}{6} = \frac{1}{3}\]</div>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/dd3c773c6c1393e349a610a0ede1dae20bfbd81e4fca4ed6a58a8844d1cb874b.png" src="../_images/dd3c773c6c1393e349a610a0ede1dae20bfbd81e4fca4ed6a58a8844d1cb874b.png" />
</div>
</div>
</section>
<section id="matrice-di-correlazione">
<h4><span class="section-number">12.4.6. </span>Matrice di Correlazione<a class="headerlink" href="#matrice-di-correlazione" title="Permalink to this heading">#</a></h4>
<p>Analogamente a quanto visto nel caso degli scatterplot, quando abbiamo più variabili, possiamo calcolare gli indici di correlazione tra tutte le variabili del dataset. Otteniamo in questo modo una “matrice di correlazione”. La matrice di correlazione calcolata mediante il coefficiente di Pearson, nel caso del nostro dataset <code class="docutils literal notranslate"><span class="pre">diabetes</span></code> sarà:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>relwt</th>
      <th>glufast</th>
      <th>glutest</th>
      <th>instest</th>
      <th>sspg</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>relwt</th>
      <td>1.000000</td>
      <td>-0.008813</td>
      <td>0.023984</td>
      <td>0.222238</td>
      <td>0.384320</td>
    </tr>
    <tr>
      <th>glufast</th>
      <td>-0.008813</td>
      <td>1.000000</td>
      <td>0.964628</td>
      <td>-0.396235</td>
      <td>0.715480</td>
    </tr>
    <tr>
      <th>glutest</th>
      <td>0.023984</td>
      <td>0.964628</td>
      <td>1.000000</td>
      <td>-0.337020</td>
      <td>0.770942</td>
    </tr>
    <tr>
      <th>instest</th>
      <td>0.222238</td>
      <td>-0.396235</td>
      <td>-0.337020</td>
      <td>1.000000</td>
      <td>0.007914</td>
    </tr>
    <tr>
      <th>sspg</th>
      <td>0.384320</td>
      <td>0.715480</td>
      <td>0.770942</td>
      <td>0.007914</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Esiste anche una rappresentazione grafica della matrice di correlazione, spesso detta “correlation plot”:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/489b6bd05531e1dbc7782b66e5410b70ccfc9d0a3fa4be0db6a0ca62298f4f23.png" src="../_images/489b6bd05531e1dbc7782b66e5410b70ccfc9d0a3fa4be0db6a0ca62298f4f23.png" />
</div>
</div>
</section>
</section>
<section id="referenze">
<h3><span class="section-number">12.5. </span>Referenze<a class="headerlink" href="#referenze" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Capitolo 3 di: Heumann, Christian, and Michael Schomaker Shalabh. Introduction to statistics and data analysis. Springer International Publishing Switzerland, 2016.</p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Odds_ratio">https://en.wikipedia.org/wiki/Odds_ratio</a></p></li>
</ul>
</section>
</section>
</div>
<div class="toctree-wrapper compound">
<span id="document-laboratories/06_misure_di_frequenze_e_rappresentazioni_grafiche_dei_dati"></span><section class="tex2jax_ignore mathjax_ignore" id="laboratorio-su-misure-di-frequenze-e-rappresentazione-grafica-dei-dati">
<h2><span class="section-number">13. </span>Laboratorio su Misure di Frequenze e Rappresentazione Grafica dei Dati<a class="headerlink" href="#laboratorio-su-misure-di-frequenze-e-rappresentazione-grafica-dei-dati" title="Permalink to this heading">#</a></h2>
<p>In questo Laboratorio, utilizzeremo un semplice dataset di esempio contenente osservazioni relativi a pesi e altezze di diversi soggetti. Il dataset è disponibile al seguente URL: <a class="reference external" href="http://antoninofurnari.it/downloads/height_weight.csv">http://antoninofurnari.it/downloads/height_weight.csv</a>.</p>
<p>Carichiamo il dataset mediante la libreria Pandas e visualizziamo alcune informazioni sul DataFrame:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;http://antoninofurnari.it/downloads/height_weight.csv&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 4231 entries, 0 to 4230
Data columns (total 4 columns):
 #   Column  Non-Null Count  Dtype  
---  ------  --------------  -----  
 0   sex     4231 non-null   object 
 1   BMI     4231 non-null   float64
 2   height  4231 non-null   float64
 3   weight  4231 non-null   float64
dtypes: float64(3), object(1)
memory usage: 132.3+ KB
</pre></div>
</div>
</div>
</div>
<p>Il dataset contiene <span class="math notranslate nohighlight">\(4321\)</span> osservazioni e <span class="math notranslate nohighlight">\(4\)</span> colonne. In particolare, per ogni soggetto sono riportate le seguenti variabili:</p>
<ul class="simple">
<li><p>Il sesso (sex);</p></li>
<li><p>Il body mass index (BMI);</p></li>
<li><p>L’altezza in cm (height);</p></li>
<li><p>Il peso in Kg (weight).
Visualizziamo le prime righe del dataframe:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sex</th>
      <th>BMI</th>
      <th>height</th>
      <th>weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>M</td>
      <td>33.36</td>
      <td>187.96</td>
      <td>117.933920</td>
    </tr>
    <tr>
      <th>1</th>
      <td>M</td>
      <td>26.54</td>
      <td>177.80</td>
      <td>83.914520</td>
    </tr>
    <tr>
      <th>2</th>
      <td>F</td>
      <td>32.13</td>
      <td>154.94</td>
      <td>77.110640</td>
    </tr>
    <tr>
      <th>3</th>
      <td>M</td>
      <td>26.62</td>
      <td>172.72</td>
      <td>79.378600</td>
    </tr>
    <tr>
      <th>4</th>
      <td>F</td>
      <td>27.13</td>
      <td>167.64</td>
      <td>76.203456</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="frequenze-assolute-e-relative">
<h3><span class="section-number">13.1. </span>Frequenze Assolute e Relative<a class="headerlink" href="#frequenze-assolute-e-relative" title="Permalink to this heading">#</a></h3>
<p>Possiamo ottenere i valori univoci in una variabile con la funzione <code class="docutils literal notranslate"><span class="pre">unique()</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;sex&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;M&#39;, &#39;F&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<p>Le frequenze assolute vengono calcolate mediante il metodo <code class="docutils literal notranslate"><span class="pre">value_counts</span></code> di Pandas. Visualizziamo ad esempio, le frequenze assolute dei valori di <code class="docutils literal notranslate"><span class="pre">sex</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sex_counts</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;sex&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="n">sex_counts</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>F    2285
M    1946
Name: sex, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Un buon modo per capire se ha senso calcolare le frequenze assolute per una data variabile, è quello di controllare quanti valori univoci appaiono. Questo si può fare mediante la funzione <code class="docutils literal notranslate"><span class="pre">unique()</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;sex&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2
18
172
</pre></div>
</div>
</div>
</div>
<p>Notiamo che, mentre sex e height contengono pochi valori, weight ne contiene molti. Controlliamo anche le frequenze assolute di weight:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">height_counts</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="n">height_counts</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>162.56    435
167.64    391
170.18    377
172.72    355
165.10    351
175.26    302
160.02    291
177.80    272
182.88    260
157.48    259
180.34    235
154.94    152
185.42    146
152.40    130
187.96    104
190.50     72
149.86     52
193.04     47
Name: height, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Il metodo restituisce una <code class="docutils literal notranslate"><span class="pre">Series</span></code> di <code class="docutils literal notranslate"><span class="pre">Pandas</span></code> che ha come <em>indici</em> i valori unici delle altezze e come <em>valori</em> le frequenze dei valori unici. Gli elementi della serie sono ordinati per valore (e dunque per frequenza). Sappiamo dunque che il primo elemento della serie è il più frequente, mentre l’ultimo è il meno frequente:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Altezza più frequente:&quot;</span><span class="p">,</span><span class="n">height_counts</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Altezza meno frequente:&quot;</span><span class="p">,</span><span class="n">height_counts</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Altezza più frequente: 435
Altezza meno frequente: 47
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p><strong>🙋‍♂️ Domanda 1</strong></p>
<p>Scrivendo:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Altezza più frequente:&quot;</span><span class="p">,</span><span class="n">height_counts</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Altezza meno frequente:&quot;</span><span class="p">,</span><span class="n">height_counts</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<p>otteniamo lo stesso risultato? Perché?</p>
</div></blockquote>
<p>In genere, torna utile riordinare la serie ottenuta per indice, in modo da ottenere una serie di valori crescente con le relative frequenze.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>149.86     52
152.40    130
154.94    152
157.48    259
160.02    291
162.56    435
165.10    351
167.64    391
170.18    377
172.72    355
175.26    302
177.80    272
180.34    235
182.88    260
185.42    146
187.96    104
190.50     72
193.04     47
Name: height, dtype: int64
</pre></div>
</div>
</div>
</div>
<section id="diagramma-a-barre-delle-frequenze-assolute">
<h4><span class="section-number">13.1.1. </span>Diagramma a Barre delle Frequenze Assolute<a class="headerlink" href="#diagramma-a-barre-delle-frequenze-assolute" title="Permalink to this heading">#</a></h4>
<p>Le frequenze dei dati possono essere rappresentate graficamente mediante un grafico a barre utilizzando le funzionalità di plot di <code class="docutils literal notranslate"><span class="pre">Pandas</span></code>. Tali funzionalità si appoggiano a matplotlib, per cui, per avere maggiore controllo su di esse dobbiamo importare <code class="docutils literal notranslate"><span class="pre">pyplot</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/db319056669d16263e9f0daa51151895cbe4b84ed48571a84a130f0bc8e654db.png" src="../_images/db319056669d16263e9f0daa51151895cbe4b84ed48571a84a130f0bc8e654db.png" />
</div>
</div>
<p>dove il parametro <code class="docutils literal notranslate"><span class="pre">figsize=(12,6)</span></code> serve a specificare le dimensioni del plot, mentre <code class="docutils literal notranslate"><span class="pre">plt.grid()</span></code> serve a mostrare una griglia sovrapposta al plot.</p>
<p>Il grafico ottenuto è detto <strong>digramma a barre delle frequenze assolute</strong> e mostra il numero di volte in cui ciascun valore appare nel campione.</p>
<blockquote>
<div><p><strong>🙋‍♂️ Domanda 2</strong></p>
<p>Che cosa ci dice la rappresentazione dei dati sopra? Quali sono i valori più frequenti? Quante persone hanno un’altezza pari a <span class="math notranslate nohighlight">\(167.64\ cm\)</span>?</p>
</div></blockquote>
<p>Si noti che, alternativamente, è possibile plottare un grafico a barre direttamente tramite matplotlib come segue:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">height_counts</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">height_counts</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">height_counts</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">height_counts</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/063a99b14af493b5508e3ad00c87d10cb3d5074b4bcabc0e32d2d8e500e56d92.png" src="../_images/063a99b14af493b5508e3ad00c87d10cb3d5074b4bcabc0e32d2d8e500e56d92.png" />
</div>
</div>
<p>In molti casi sarà possibile utilizzare le funzioni compatte messe a disposizione da Pandas, mentre in altri sarà necessario utilizzare matplotlib esplicitamente.</p>
</section>
<section id="frequenze-relative">
<h4><span class="section-number">13.1.2. </span>Frequenze Relative<a class="headerlink" href="#frequenze-relative" title="Permalink to this heading">#</a></h4>
<p>Possiamo calcolare le frequenze relative dividendo quelle assolute per il numero di elementi contenuti nel dataset:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>149.86    0.012290
152.40    0.030726
154.94    0.035925
157.48    0.061215
160.02    0.068778
162.56    0.102813
165.10    0.082959
167.64    0.092413
170.18    0.089104
172.72    0.083905
175.26    0.071378
177.80    0.064287
180.34    0.055542
182.88    0.061451
185.42    0.034507
187.96    0.024580
190.50    0.017017
193.04    0.011108
Name: height, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>O, alternativamente, specificando <code class="docutils literal notranslate"><span class="pre">normalize=True</span></code> (dividere per la somma degli elementi è un forma di normalizzazione) come parametro per <code class="docutils literal notranslate"><span class="pre">value_counts</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>149.86    0.012290
152.40    0.030726
154.94    0.035925
157.48    0.061215
160.02    0.068778
162.56    0.102813
165.10    0.082959
167.64    0.092413
170.18    0.089104
172.72    0.083905
175.26    0.071378
177.80    0.064287
180.34    0.055542
182.88    0.061451
185.42    0.034507
187.96    0.024580
190.50    0.017017
193.04    0.011108
Name: height, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Come si può vedere, tutti i numeri sono compresi tra zero e uno. Inoltre, la somma dei valori è pari a 1:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:0.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.00
</pre></div>
</div>
</div>
</div>
<section id="diagramma-a-barre-delle-frequenze-relative">
<h5><span class="section-number">13.1.2.1. </span>Diagramma a Barre delle Frequenze Relative<a class="headerlink" href="#diagramma-a-barre-delle-frequenze-relative" title="Permalink to this heading">#</a></h5>
<p>Possiamo ottenere un diagramma a barre delle frequenze relative come segue:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">sort_index</span><span class="p">())</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/fb7fe494f64a6d081b3a2ba06a6f12c7e7a1774559ef37a62230cbbe27c2a9aa.png" src="../_images/fb7fe494f64a6d081b3a2ba06a6f12c7e7a1774559ef37a62230cbbe27c2a9aa.png" />
</div>
</div>
<blockquote>
<div><p><strong>🙋‍♂️ Domanda 3</strong></p>
<p>Cosa hanno in comune (graficamente) il diagramma a barre delle frequenze assolute e il diagramma a barre delle frequenze relative? Che cosa ci dice in più una rappresentazione rispetto all’altra?</p>
</div></blockquote>
<p>I diagrammi a barre delle frequenze relative possono essere utili anche per confrontare diversi campioni di dati. Consideriamo ad esempio le altezze delle donne e degli uomini come due campioni separati nel dataset e calcoliamone le frequenze relative:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pmf_height_m</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;sex&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;M&#39;</span><span class="p">][</span><span class="s1">&#39;height&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>
<span class="n">pmf_height_f</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;sex&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;F&#39;</span><span class="p">][</span><span class="s1">&#39;height&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Mostriamo i due istogrammi mettendoli a confronto. Per poter mostrare i due istogrammi agevolemente nello stesso grafico, utilizzeremo matplotlib:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="c1">#sommiamo e sottraiamo 0.2 agli indici per &quot;spostare&quot; le barre e renderle</span>
<span class="c1">#visibili quando sovrappose. Inoltre impostiamo alpha=0.9 per rendere le barre</span>
<span class="c1">#parzialmente trasparenti</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">pmf_height_m</span><span class="o">.</span><span class="n">index</span><span class="o">+</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">pmf_height_m</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">pmf_height_f</span><span class="o">.</span><span class="n">index</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">pmf_height_f</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">(),</span> <span class="n">rotation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;M&#39;</span><span class="p">,</span><span class="s1">&#39;F&#39;</span><span class="p">])</span> <span class="c1">#mostriamo una legenda</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/f94af1b62863a84c9726a2c97bd169cfeb04b93d092762639f93b1fb1c518492.png" src="../_images/f94af1b62863a84c9726a2c97bd169cfeb04b93d092762639f93b1fb1c518492.png" />
</div>
</div>
<blockquote>
<div><p><strong>🙋‍♂️ Domanda 4</strong></p>
<p>Cosa ci dicono i due plot? Quale delle due classi (‘F’ o ‘M’) contiene i soggetti più bassi? Esistono soggetti di sesso femminile alti? Esistono soggetti di sesso maschile bassi? Quanto sono “probabili”?</p>
</div></blockquote>
</section>
</section>
</section>
<section id="empirical-cumulative-distribution-function-ecdf">
<h3><span class="section-number">13.2. </span>Empirical Cumulative Distribution Function (ECDF)<a class="headerlink" href="#empirical-cumulative-distribution-function-ecdf" title="Permalink to this heading">#</a></h3>
<p>Possiamo calcolare una ECDF mediante la funzione <strong>cumsum</strong>, che, data una serie di valori calcola ad ogni posizione <span class="math notranslate nohighlight">\(i\)</span> la somma dei primi <span class="math notranslate nohighlight">\(i\)</span> valori. Ad esempio:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">])</span>
<span class="n">a</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0     1
1     4
2    10
3    18
4    27
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Dal momento che le frequenze relative sono ordinate, la funzione <strong>cumsum</strong> calcola per ogni indice la somma delle frequenze relative dei valori precedenti. Calcoliamo le <strong>ECDF</strong> dei due campioni e confrontiamoli:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ecdf_weight_m</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;sex&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;M&#39;</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
<span class="n">ecdf_weight_f</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;sex&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;F&#39;</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ecdf_weight_m</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">ecdf_weight_m</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ecdf_weight_f</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">ecdf_weight_f</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;M&#39;</span><span class="p">,</span><span class="s1">&#39;F&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/add401108f55afc165346db5193c0ccdd250338af33e01c123ee443913f9979d.png" src="../_images/add401108f55afc165346db5193c0ccdd250338af33e01c123ee443913f9979d.png" />
</div>
</div>
<blockquote>
<div><p><strong>🙋‍♂️ Domanda 5</strong></p>
<p>Il confronto è adesso più chiaro? Quale dei due campioni contiene i pesi maggiori?</p>
</div></blockquote>
<p>Le ECDF tornano utili per verificare graficamente se due fenomeni hanno distribuzioni simili. Prendiamo ad esempio il dataset “Titanic”, che riporta diversi dati sui passeggeri del Titanic:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">titanic</span> <span class="o">=</span> \
<span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/agconti/kaggle-titanic/master/data/train.csv&#39;</span><span class="p">,</span>
                     <span class="n">index_col</span><span class="o">=</span><span class="s1">&#39;PassengerId&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Mostriamo le informazioni sul dataset:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">titanic</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Int64Index: 891 entries, 1 to 891
Data columns (total 11 columns):
 #   Column    Non-Null Count  Dtype  
---  ------    --------------  -----  
 0   Survived  891 non-null    int64  
 1   Pclass    891 non-null    int64  
 2   Name      891 non-null    object 
 3   Sex       891 non-null    object 
 4   Age       714 non-null    float64
 5   SibSp     891 non-null    int64  
 6   Parch     891 non-null    int64  
 7   Ticket    891 non-null    object 
 8   Fare      891 non-null    float64
 9   Cabin     204 non-null    object 
 10  Embarked  889 non-null    object 
dtypes: float64(2), int64(4), object(5)
memory usage: 83.5+ KB
</pre></div>
</div>
</div>
</div>
<p>Confrontiamo adesso le distribuzioni delle età dei passeggeri di sesso maschile e femminile:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="o">=</span><span class="n">titanic</span><span class="p">[</span><span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Sex&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;male&#39;</span><span class="p">][</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
<span class="n">b</span><span class="o">=</span><span class="n">titanic</span><span class="p">[</span><span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Sex&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;female&#39;</span><span class="p">][</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">a</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">b</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;M&#39;</span><span class="p">,</span><span class="s1">&#39;F&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d76afe7e837cc4da67844df83f70052c8495a537fb1d8e9334fc98a34b5659a5.png" src="../_images/d76afe7e837cc4da67844df83f70052c8495a537fb1d8e9334fc98a34b5659a5.png" />
</div>
</div>
<p>Com’è possibile vedere, in questo caso le due curve hanno delle forme molto simili. Ciò suggerisce che i due fenomeni obbediscono a simili densità di probabilità. Tuttavia è possibile notare che le donne tendono ad essere più giovani degli uomini.</p>
</section>
<section id="istogrammi">
<h3><span class="section-number">13.3. </span>Istogrammi<a class="headerlink" href="#istogrammi" title="Permalink to this heading">#</a></h3>
<p>Possiamo plottare un istogramma con matplotlib come segue:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">_</span><span class="p">,</span><span class="n">edges</span><span class="p">,</span><span class="n">_</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="mf">10.8</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">edges</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/96852a9fb1a05a895ac7f189e8f5d2eff3aef69f753664e4172f0d2366a3561e.png" src="../_images/96852a9fb1a05a895ac7f189e8f5d2eff3aef69f753664e4172f0d2366a3561e.png" />
</div>
</div>
<p>Oltre a graficare l’istogramma, la funzione <strong>plt.hist</strong> restituisce tre valori:</p>
<ul class="simple">
<li><p>un vettore contenente i valori dell’istogramma;</p></li>
<li><p>i “bordi” di ogni bin;</p></li>
<li><p>una lista di handle agli elementi grafici visualizzati.</p></li>
</ul>
<p>Nell’esempio sopra abbiamo utilizzato la notazione <code class="docutils literal notranslate"><span class="pre">_,edges,_=...</span></code> per scartare il primo e l’ultimo valore e ottenere i “bordi” dell’istogramma.</p>
<section id="struges-e-rice">
<h4><span class="section-number">13.3.1. </span>Struges e Rice<a class="headerlink" href="#struges-e-rice" title="Permalink to this heading">#</a></h4>
<p>Vediamo come rappresentare gli istogrammi scegliendo i numeri di bin con Struges e Rice:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">bins_struges</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="mf">3.3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">])))</span>
<span class="n">bins_rice</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Struges (</span><span class="si">{}</span><span class="s1"> bins)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">bins_struges</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins_struges</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Rice (</span><span class="si">{}</span><span class="s1"> bins)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">bins_rice</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins_rice</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/befa4570ca68be6b9e18c54ec9159b2088117211e5a44137ca8b209e3a571956.png" src="../_images/befa4570ca68be6b9e18c54ec9159b2088117211e5a44137ca8b209e3a571956.png" />
</div>
</div>
<p>E’ possibile anche specificare i “bordi” dei bin esplicitamente:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">_</span><span class="p">,</span><span class="n">edges</span><span class="p">,</span><span class="n">_</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="p">[</span><span class="mi">40</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="mi">70</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="mi">90</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">110</span><span class="p">,</span><span class="mi">120</span><span class="p">,</span><span class="mi">130</span><span class="p">],</span> 
                   <span class="n">width</span><span class="o">=</span><span class="mf">9.5</span><span class="p">)</span> <span class="c1">#costruiamo un istogramma con i bin definiti</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">edges</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/9fe7020c5685339704d5ed2e621ba3f51ad3b69311e5c7706cd50b8b3163261f.png" src="../_images/9fe7020c5685339704d5ed2e621ba3f51ad3b69311e5c7706cd50b8b3163261f.png" />
</div>
</div>
<p>L’istogramma mostrato sopra riporta le frequenze assolute per ogni bin e ci permette di rispondere a domande del genere “quanti soggetti hanno un peso compreso tra <span class="math notranslate nohighlight">\(70 Kg\)</span> e <span class="math notranslate nohighlight">\(80 Kg\)</span>”?</p>
<blockquote>
<div><p><strong>🙋‍♂️ Domanda 6</strong></p>
<p>Si costruiscano degli istogrammi per rispondere alle domande</p>
<ul class="simple">
<li><p>quanti soggetti di sesso maschile hanno un peso compreso tra <span class="math notranslate nohighlight">\(70Kg\)</span> e <span class="math notranslate nohighlight">\(80Kg\)</span>?</p></li>
<li><p>quanti soggetti di sesso femminile hanno un peso compreso tra <span class="math notranslate nohighlight">\(60Kg\)</span> e <span class="math notranslate nohighlight">\(65Kg\)</span>?</p></li>
</ul>
</div></blockquote>
</section>
<section id="istogrammi-di-densita">
<h4><span class="section-number">13.3.2. </span>Istogrammi di densità<a class="headerlink" href="#istogrammi-di-densita" title="Permalink to this heading">#</a></h4>
<p>Per ottenere un istogramma di densità, dobbiamo passare il parametro <code class="docutils literal notranslate"><span class="pre">density=True</span></code> alla funzione <code class="docutils literal notranslate"><span class="pre">hist</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">valori</span><span class="p">,</span><span class="n">bordi</span><span class="p">,</span><span class="n">_</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="p">[</span><span class="mi">40</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="mi">70</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="mi">90</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">110</span><span class="p">,</span><span class="mi">120</span><span class="p">,</span><span class="mi">130</span><span class="p">],</span> 
                   <span class="n">width</span><span class="o">=</span><span class="mf">9.5</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">bordi</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/171be5af468ad6176571ac48d5cff228fe48e929aba5779e7e7655898dab1267.png" src="../_images/171be5af468ad6176571ac48d5cff228fe48e929aba5779e7e7655898dab1267.png" />
</div>
</div>
<p>Possiamo verificare che la condizione</p>
<div class="math notranslate nohighlight">
\[
\sum_{i=0}^{n} b_i \cdot w_i = 1
\]</div>
<p>sia effettivamente soddisfatta:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">larghezze</span> <span class="o">=</span> <span class="n">bordi</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">-</span><span class="n">bordi</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">larghezze</span><span class="p">)</span> <span class="c1">#tutti i bin hanno la stessa larghezza</span>
<span class="nb">print</span><span class="p">((</span><span class="n">larghezze</span><span class="o">*</span><span class="n">valori</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span> <span class="c1">#colcoliamo la somma dei prodotti</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[10 10 10 10 10 10 10 10 10]
1.0
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p><strong>🙋‍♂️ Domanda 7</strong></p>
<p>Utilizzare l’istogramma sopra per ottenere la probabilità che un soggetto abbia un peso compreso tra <span class="math notranslate nohighlight">\(40Kg\)</span> e <span class="math notranslate nohighlight">\(50Kg\)</span>.</p>
</div></blockquote>
<p>Gli istogrammi possono essere plottati anche direttamente da <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="n">width</span><span class="o">=</span><span class="mf">9.5</span><span class="p">,</span> 
                         <span class="n">density</span><span class="o">=</span><span class="s1">&#39;True&#39;</span><span class="p">,</span>
                         <span class="n">bins</span><span class="o">=</span><span class="p">[</span><span class="mi">40</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="mi">70</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="mi">90</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">110</span><span class="p">,</span><span class="mi">120</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/61187643bf1eb10f989b0633d28eb44191fdb2a2d164706a1284ba6aedae0da8.png" src="../_images/61187643bf1eb10f989b0633d28eb44191fdb2a2d164706a1284ba6aedae0da8.png" />
</div>
</div>
<p>La funzione prende gli stessi parametri in input della funzione <code class="docutils literal notranslate"><span class="pre">hist</span></code> di matplotlib. Tuttavia, a differenza di essa, non restituisce i valori dei bin e i rispettivi bordi.</p>
</section>
<section id="stima-della-densita">
<h4><span class="section-number">13.3.3. </span>Stima della densità<a class="headerlink" href="#stima-della-densita" title="Permalink to this heading">#</a></h4>
<p>Possiamo stimare e plottare le densità mediante Pandas come segue:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">density</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/8e0cfabda7b0b55e7f8726ca8b37c4f114b746762cfaf09ccb02d798faaeef10.png" src="../_images/8e0cfabda7b0b55e7f8726ca8b37c4f114b746762cfaf09ccb02d798faaeef10.png" />
</div>
</div>
<blockquote>
<div><p><strong>🙋‍♂️ Domanda 8</strong></p>
<p>Si confronti il plot di densità visto sopra con istogrammi ottenuti con diversi numeri di bin. Qual è il vantaggio principale della stima della densità?</p>
</div></blockquote>
</section>
<section id="confrontare-campioni-mediante-istogrammi">
<h4><span class="section-number">13.3.4. </span>Confrontare campioni mediante istogrammi<a class="headerlink" href="#confrontare-campioni-mediante-istogrammi" title="Permalink to this heading">#</a></h4>
<p>Gli istogrammi possono essere utili per comparare campioni. Confrontiamo ad esempio gli istogrammi del campione dei pesi degli uomini e del campione dei pesi delle donne:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;sex&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;F&#39;</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;sex&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;M&#39;</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="s1">&#39;M&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/3bc530579fb3ded776292992f96d9b06f596d48a5eb8f3a84dcd2d95fe42ba3c.png" src="../_images/3bc530579fb3ded776292992f96d9b06f596d48a5eb8f3a84dcd2d95fe42ba3c.png" />
</div>
</div>
<blockquote>
<div><p><strong>🙋‍♂️ Domanda 9</strong></p>
<p>Si metta in relazione il plot dei due istogrammi con il plot delle dure relative ECDF. I due plot sono concordi? Quali dei due plot è più immediato?</p>
</div></blockquote>
<p>È possibile effettuare plot combinati simili direttamente da <code class="docutils literal notranslate"><span class="pre">Pandas</span></code> utilizzando il <code class="docutils literal notranslate"><span class="pre">groupby</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;sex&#39;</span><span class="p">)[</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;sex&#39;</span><span class="p">)[</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">density</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/62b5e7b391d6f0a887c6dafee2358fd5e5f7c5a9996e04832f52e4b2cd5686d3.png" src="../_images/62b5e7b391d6f0a887c6dafee2358fd5e5f7c5a9996e04832f52e4b2cd5686d3.png" />
</div>
</div>
</section>
</section>
<section id="altre-visualizzazioni-dei-dati">
<h3><span class="section-number">13.4. </span>Altre Visualizzazioni dei Dati<a class="headerlink" href="#altre-visualizzazioni-dei-dati" title="Permalink to this heading">#</a></h3>
<p>Abbiamo visto che i grafici a barre possono essere utilizzati per graficare le frequenze assolute e relative dei dati. Vediamo adesso alcune altre visualizzazioni che fanno uso di grafici a barre e grafici a torta per confrontare diverse quantità. Per iniziare a discutere di visualizzazioni, utilizzeremo il dataset Titanic caricato precedentemente.</p>
<p>Mostriamo le prime righe del dataset:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">titanic</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Name</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>Cabin</th>
      <th>Embarked</th>
    </tr>
    <tr>
      <th>PassengerId</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>3</td>
      <td>Braund, Mr. Owen Harris</td>
      <td>male</td>
      <td>22.0</td>
      <td>1</td>
      <td>0</td>
      <td>A/5 21171</td>
      <td>7.2500</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>1</td>
      <td>Cumings, Mrs. John Bradley (Florence Briggs Th...</td>
      <td>female</td>
      <td>38.0</td>
      <td>1</td>
      <td>0</td>
      <td>PC 17599</td>
      <td>71.2833</td>
      <td>C85</td>
      <td>C</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>3</td>
      <td>Heikkinen, Miss. Laina</td>
      <td>female</td>
      <td>26.0</td>
      <td>0</td>
      <td>0</td>
      <td>STON/O2. 3101282</td>
      <td>7.9250</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>1</td>
      <td>Futrelle, Mrs. Jacques Heath (Lily May Peel)</td>
      <td>female</td>
      <td>35.0</td>
      <td>1</td>
      <td>0</td>
      <td>113803</td>
      <td>53.1000</td>
      <td>C123</td>
      <td>S</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0</td>
      <td>3</td>
      <td>Allen, Mr. William Henry</td>
      <td>male</td>
      <td>35.0</td>
      <td>0</td>
      <td>0</td>
      <td>373450</td>
      <td>8.0500</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="barplot">
<h4><span class="section-number">13.4.1. </span>Barplot<a class="headerlink" href="#barplot" title="Permalink to this heading">#</a></h4>
<p>Oltre a mostrare le frequenze dei dati, i barplot possono essere utili per confrontare diverse quantità numeriche. Supponiamo di voler confrontare il numero di donne e uomini a bordo del Titanic. Possiamo calcolare questi numeri mediante un <code class="docutils literal notranslate"><span class="pre">groupby</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">titanic</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Sex&#39;</span><span class="p">)[</span><span class="s1">&#39;Sex&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sex
female    314
male      577
Name: Sex, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Possiamo confrontare queste due quantità visivamente mediante un barplot come segue:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">titanic</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Sex&#39;</span><span class="p">)[</span><span class="s1">&#39;Sex&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Number of Passengers&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/3fe495ba5e2542dd652633e8e23191cd9b64716b2b129c1fcf199418b36dd2aa.png" src="../_images/3fe495ba5e2542dd652633e8e23191cd9b64716b2b129c1fcf199418b36dd2aa.png" />
</div>
</div>
<p>Confrontiamo adesso le età medie dei passeggeri imbarcati nelle varie classi. Costruiamo prima una tabella riassuntiva mediante <code class="docutils literal notranslate"><span class="pre">groupby</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">titanic</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Pclass&#39;</span><span class="p">)[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Pclass
1    38.233441
2    29.877630
3    25.140620
Name: Age, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Possiamo confrontare le quantità ottenute graficamente mediante barplot:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">titanic</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Pclass&#39;</span><span class="p">)[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Age&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/2da36afaff2bc22c3f059fb736a11c02e1d553b0f3312d69885d34bba77aeebc.png" src="../_images/2da36afaff2bc22c3f059fb736a11c02e1d553b0f3312d69885d34bba77aeebc.png" />
</div>
</div>
<p>Calcoliamo il numero di sopravvissuti per classe di imbarco:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Pclass&#39;</span><span class="p">],</span> <span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Survived&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Survived</th>
      <th>0</th>
      <th>1</th>
    </tr>
    <tr>
      <th>Pclass</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>80</td>
      <td>136</td>
    </tr>
    <tr>
      <th>2</th>
      <td>97</td>
      <td>87</td>
    </tr>
    <tr>
      <th>3</th>
      <td>372</td>
      <td>119</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Per ottenere delle percentuali, possiamo normalizzare per righe come segue:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Pclass&#39;</span><span class="p">],</span> <span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Survived&#39;</span><span class="p">],</span> <span class="n">normalize</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Survived</th>
      <th>0</th>
      <th>1</th>
    </tr>
    <tr>
      <th>Pclass</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>0.370370</td>
      <td>0.629630</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.527174</td>
      <td>0.472826</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.757637</td>
      <td>0.242363</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Ogni riga della tabella riporta la percentuale di sopravvissuti (1) e la percentuale di non sopravvissuti (0). Visualizziamo un grafico a barre della tabella:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Pclass&#39;</span><span class="p">],</span> <span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Survived&#39;</span><span class="p">],</span> <span class="n">normalize</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Survived %&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/313e14c030c1f8eb88c9f6c3401d6232cd511dba025b100390344cc3b7d6ef05.png" src="../_images/313e14c030c1f8eb88c9f6c3401d6232cd511dba025b100390344cc3b7d6ef05.png" />
</div>
</div>
<p>Un grafico spesso utile a confrontare grandezze complementari (come nel caso delle percentuali viste sopra) è lo “stacked bar plot”. Per ottenere questo grafico bisogna passare <code class="docutils literal notranslate"><span class="pre">stacked=True</span></code> al metodo <code class="docutils literal notranslate"><span class="pre">bar</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Pclass&#39;</span><span class="p">],</span> <span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Survived&#39;</span><span class="p">],</span> <span class="n">normalize</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">stacked</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;%&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/2fad7d720d6577b5a653d0b2e4c8f4082b908e294573c98b6c48976181534258.png" src="../_images/2fad7d720d6577b5a653d0b2e4c8f4082b908e294573c98b6c48976181534258.png" />
</div>
</div>
<p>Possiamo mettere in relazione anche più variabili. Ad esempio:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">([</span><span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Pclass&#39;</span><span class="p">],</span> <span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Sex&#39;</span><span class="p">]],</span> <span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Survived&#39;</span><span class="p">],</span> <span class="n">normalize</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Survived</th>
      <th>0</th>
      <th>1</th>
    </tr>
    <tr>
      <th>Pclass</th>
      <th>Sex</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">1</th>
      <th>female</th>
      <td>0.031915</td>
      <td>0.968085</td>
    </tr>
    <tr>
      <th>male</th>
      <td>0.631148</td>
      <td>0.368852</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">2</th>
      <th>female</th>
      <td>0.078947</td>
      <td>0.921053</td>
    </tr>
    <tr>
      <th>male</th>
      <td>0.842593</td>
      <td>0.157407</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">3</th>
      <th>female</th>
      <td>0.500000</td>
      <td>0.500000</td>
    </tr>
    <tr>
      <th>male</th>
      <td>0.864553</td>
      <td>0.135447</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Il relativo plot sarà:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">([</span><span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Pclass&#39;</span><span class="p">],</span> <span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Sex&#39;</span><span class="p">]],</span> <span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Survived&#39;</span><span class="p">],</span> <span class="n">normalize</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">stacked</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;%&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d8cec47bded2cd9366cd8e014d42489b2ddb633fafa118b79190f565ed8b5649.png" src="../_images/d8cec47bded2cd9366cd8e014d42489b2ddb633fafa118b79190f565ed8b5649.png" />
</div>
</div>
<blockquote>
<div><p><strong>🙋‍♂️ Domanda 10</strong></p>
<p>Si confrontino mediante un barplot le età medie dei passeggeri per classe di imbarco e sesso.</p>
</div></blockquote>
<p>Così come per i barplot, è possibile confrontare gli istogrammi di diversi campioni di dati. Confrontiamo le distribuzioni delle età distinte per sesso:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">titanic</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Sex&#39;</span><span class="p">)[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="c1">#alpha=0.7 serve a mostrare gli istogrammi come semi-trasparenti</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/28b8eb8f08e98ccaf50eeeba70b74f5d2e2cc79058fbd09db3b24ff0333a35e8.png" src="../_images/28b8eb8f08e98ccaf50eeeba70b74f5d2e2cc79058fbd09db3b24ff0333a35e8.png" />
</div>
</div>
<p>In maniera simile, si possono confrontare densità:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">titanic</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Sex&#39;</span><span class="p">)[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">density</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/918c2d12718990b2b88123e2c4727b4882cd23e69e60cef3dc9fca4703d8ed34.png" src="../_images/918c2d12718990b2b88123e2c4727b4882cd23e69e60cef3dc9fca4703d8ed34.png" />
</div>
</div>
</section>
<section id="grafici-a-torta">
<h4><span class="section-number">13.4.2. </span>Grafici a Torta<a class="headerlink" href="#grafici-a-torta" title="Permalink to this heading">#</a></h4>
<p>I grafici a torta vengono utilizzati per confrontare diverse quantità <strong>senza imporre</strong> un ordinamento a priori. Supponiamo ad esempio di voler confrontare il numero di sopravvissuti in rispetto ai due sessi. Iniziamo ottenendo una tabella che riassume i numeri da confrontare:</p>
<p>Possiamo plottare un grafico a torta come segue:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">titanic</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Sex&#39;</span><span class="p">)[</span><span class="s1">&#39;Survived&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sex
female    233
male      109
Name: Survived, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">titanic</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Sex&#39;</span><span class="p">)[</span><span class="s1">&#39;Survived&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">pie</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Sex&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/0aeecd2ffe7cb044d86a7937f7014eec52a2a4ce4af65c67475af11597f1889a.png" src="../_images/0aeecd2ffe7cb044d86a7937f7014eec52a2a4ce4af65c67475af11597f1889a.png" />
</div>
</div>
<blockquote>
<div><p><strong>🙋‍♂️ Domanda 11</strong></p>
<p>Costruire un grafico a torta che confronti il numero di sopravvissuti nelle varie classi di imbarco.</p>
</div></blockquote>
</section>
</section>
<section id="esercizi">
<h3><span class="section-number">13.5. </span>Esercizi<a class="headerlink" href="#esercizi" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><p>🧑‍💻 Esercizio 1</p>
<p>Considerando il dataset Titanic, si mostrino i diagrammi a barre delle frequenze assolute e relative dei valori della colonna <code class="docutils literal notranslate"><span class="pre">Pclass</span></code>. Scegliendo a caso tra i passeggeri, qual è la probabilità che egli si sia imbarcato in seconda classe?</p>
</div></blockquote>
<blockquote>
<div><p>🧑‍💻 Esercizio 2</p>
<p>Considerando il dataset Titanic, si mostri l’istogramma delle età dei passeggeri imbarcati in prima classe. Si utilizzi un criterio opportuno per scegliere il numero di bin.</p>
</div></blockquote>
<blockquote>
<div><p>🧑‍💻 Esercizio 3</p>
<p>Si modifichi il plot dell’esercizio precedente per costruire un istogramma che permetta di rispondere alla domanda “se scelgo casualmente un passeggero imbarcato in prima classe, qual è la probabilità che la sua età sia compresa tra <span class="math notranslate nohighlight">\(20\)</span> e <span class="math notranslate nohighlight">\(30\)</span> anni?</p>
</div></blockquote>
<blockquote>
<div><p>🧑‍💻 Esercizio 4</p>
<p>Considerando il dataset Titanic, si confrontino le distribuzioni cumulative delle età dei passeggeri imbarcati nelle varie classi. Le distribuzioni sono simili? In quale classe sono imbarcati i soggetti più giovani?</p>
</div></blockquote>
<blockquote>
<div><p>🧑‍💻 Esercizio 5</p>
<p>Considerando il dataset Titanic, si mostrino con uno stacked bar plot le percentuali di passeggeri appartenenti alle tre classi separatamente per i due sessi. Si notano differenze nella ripartizione?</p>
</div></blockquote>
</section>
</section>
<span id="document-laboratories/07_misure_di_tendenza_centrale_dispersione_e_forma"></span><section class="tex2jax_ignore mathjax_ignore" id="laboratorio-su-misure-di-tendenza-centrale-dispersione-e-forma">
<h2><span class="section-number">14. </span>Laboratorio su Misure di Tendenza Centrale, Dispersione e Forma<a class="headerlink" href="#laboratorio-su-misure-di-tendenza-centrale-dispersione-e-forma" title="Permalink to this heading">#</a></h2>
<p>Per esaminare gli strumenti in oggetto, ci avvremo del dataset <strong>Titanic</strong>. Si tratta di un dataset classico, che riporta alcune informazioni, quali sesso, età, classe di imbarco e sopravvivenza di alcuni passaggeri del Titanic. Troviamo una versione del dataset al seguente URL:</p>
<p><a class="reference external" href="https://raw.githubusercontent.com/agconti/kaggle-titanic/master/data/train.csv">https://raw.githubusercontent.com/agconti/kaggle-titanic/master/data/train.csv</a></p>
<p>Carichiamo il dataset mediante la libreria Pandas:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">titanic</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/agconti/kaggle-titanic/master/data/train.csv&#39;</span><span class="p">,</span>
                     <span class="n">index_col</span><span class="o">=</span><span class="s1">&#39;PassengerId&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Visualizziamo alcune informazioni sul dataset:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">titanic</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Int64Index: 891 entries, 1 to 891
Data columns (total 11 columns):
 #   Column    Non-Null Count  Dtype  
---  ------    --------------  -----  
 0   Survived  891 non-null    int64  
 1   Pclass    891 non-null    int64  
 2   Name      891 non-null    object 
 3   Sex       891 non-null    object 
 4   Age       714 non-null    float64
 5   SibSp     891 non-null    int64  
 6   Parch     891 non-null    int64  
 7   Ticket    891 non-null    object 
 8   Fare      891 non-null    float64
 9   Cabin     204 non-null    object 
 10  Embarked  889 non-null    object 
dtypes: float64(2), int64(4), object(5)
memory usage: 83.5+ KB
</pre></div>
</div>
</div>
</div>
<p>Il dataset contiene <span class="math notranslate nohighlight">\(891\)</span> osservazioni e <span class="math notranslate nohighlight">\(11\)</span> colonne. Visualizziamo le prime righe del DataFrame per vedere com’è organizzato:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">titanic</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Name</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>Cabin</th>
      <th>Embarked</th>
    </tr>
    <tr>
      <th>PassengerId</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>3</td>
      <td>Braund, Mr. Owen Harris</td>
      <td>male</td>
      <td>22.0</td>
      <td>1</td>
      <td>0</td>
      <td>A/5 21171</td>
      <td>7.2500</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>1</td>
      <td>Cumings, Mrs. John Bradley (Florence Briggs Th...</td>
      <td>female</td>
      <td>38.0</td>
      <td>1</td>
      <td>0</td>
      <td>PC 17599</td>
      <td>71.2833</td>
      <td>C85</td>
      <td>C</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>3</td>
      <td>Heikkinen, Miss. Laina</td>
      <td>female</td>
      <td>26.0</td>
      <td>0</td>
      <td>0</td>
      <td>STON/O2. 3101282</td>
      <td>7.9250</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>1</td>
      <td>Futrelle, Mrs. Jacques Heath (Lily May Peel)</td>
      <td>female</td>
      <td>35.0</td>
      <td>1</td>
      <td>0</td>
      <td>113803</td>
      <td>53.1000</td>
      <td>C123</td>
      <td>S</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0</td>
      <td>3</td>
      <td>Allen, Mr. William Henry</td>
      <td>male</td>
      <td>35.0</td>
      <td>0</td>
      <td>0</td>
      <td>373450</td>
      <td>8.0500</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="numerosita">
<h3><span class="section-number">14.1. </span>Numerosità<a class="headerlink" href="#numerosita" title="Permalink to this heading">#</a></h3>
<p>La numerosità dei campioni costituiti dalle singole colonne può essere ottenuta mediante il metodo <code class="docutils literal notranslate"><span class="pre">len</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>891
</pre></div>
</div>
</div>
</div>
<p>Il metodo <code class="docutils literal notranslate"><span class="pre">len</span></code> però non considera i dati incompleti (la colonna potrebbe contenere dei <code class="docutils literal notranslate"><span class="pre">NaN</span></code>). Per ottenere un conteggio più corretto possiamo esplicitamente eliminare i <code class="docutils literal notranslate"><span class="pre">NaN</span></code> con <code class="docutils literal notranslate"><span class="pre">dropna</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>714
</pre></div>
</div>
</div>
</div>
<p>Come possiamo notare, il campione è meno numeroso di quello che sembrava. Alternativamente possiamo richiamare <code class="docutils literal notranslate"><span class="pre">info</span></code> sul DataFrame:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">titanic</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Int64Index: 891 entries, 1 to 891
Data columns (total 11 columns):
 #   Column    Non-Null Count  Dtype  
---  ------    --------------  -----  
 0   Survived  891 non-null    int64  
 1   Pclass    891 non-null    int64  
 2   Name      891 non-null    object 
 3   Sex       891 non-null    object 
 4   Age       714 non-null    float64
 5   SibSp     891 non-null    int64  
 6   Parch     891 non-null    int64  
 7   Ticket    891 non-null    object 
 8   Fare      891 non-null    float64
 9   Cabin     204 non-null    object 
 10  Embarked  889 non-null    object 
dtypes: float64(2), int64(4), object(5)
memory usage: 83.5+ KB
</pre></div>
</div>
</div>
</div>
<p>Lo schema sopra mostra il numero di oggetti <code class="docutils literal notranslate"><span class="pre">non-null</span></code> per ogni colonna. Coerentemente con quanto visto prima, abbiamo solo <span class="math notranslate nohighlight">\(714\)</span> elementi di <code class="docutils literal notranslate"><span class="pre">Age</span></code> validi.</p>
<blockquote>
<div><p><strong>🙋‍♂️ Domanda 1</strong></p>
<p>Qual è la numerosità di <code class="docutils literal notranslate"><span class="pre">Cabin</span></code>?</p>
</div></blockquote>
</section>
<section id="indicatori-centrali-media-mediana-e-moda">
<h3><span class="section-number">14.2. </span>Indicatori Centrali: Media, Mediana e Moda<a class="headerlink" href="#indicatori-centrali-media-mediana-e-moda" title="Permalink to this heading">#</a></h3>
<section id="media">
<h4><span class="section-number">14.2.1. </span>Media<a class="headerlink" href="#media" title="Permalink to this heading">#</a></h4>
<p>Possiamo calcolarlo manualmente la media come segue</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>29.69911764705882
</pre></div>
</div>
</div>
</div>
<p>O semplicemente mediante la funzione <code class="docutils literal notranslate"><span class="pre">mean</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>29.69911764705882
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p><strong>🙋‍♂️ Domanda 2</strong></p>
<p>In quali casi la media riassume bene i dati? In quali casi no?</p>
</div></blockquote>
</section>
<section id="mediana">
<h4><span class="section-number">14.2.2. </span>Mediana<a class="headerlink" href="#mediana" title="Permalink to this heading">#</a></h4>
<p>Possiamo calcolare la mediana manualmente come segue:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">a</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">sort_values</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mediana: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">sort_values</span><span class="p">()</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3   -4
1   -2
0    1
2    3
4    7
dtype: int64
Mediana: 1
</pre></div>
</div>
</div>
</div>
<p>o alternativamente mediante il metodo <code class="docutils literal notranslate"><span class="pre">median</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.0
</pre></div>
</div>
</div>
</div>
<p>Calcoliamo ad esempio il valore mediano di <code class="docutils literal notranslate"><span class="pre">Age</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>28.0
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p><strong>🙋‍♂️ Domanda 3</strong></p>
<p>Si confronti la media di <code class="docutils literal notranslate"><span class="pre">Age</span></code> con la sua mediana. I due valori corrispondono? Perché? Quali dei due valori è uguale a uno dei valori appartenente al campione?</p>
</div></blockquote>
</section>
<section id="quantili-percentili-e-quartili">
<h4><span class="section-number">14.2.3. </span>Quantili, Percentili e Quartili<a class="headerlink" href="#quantili-percentili-e-quartili" title="Permalink to this heading">#</a></h4>
<p>In pandas, i quantili si ottengono mediante il metodo <code class="docutils literal notranslate"><span class="pre">quantile</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Quantile di ordine 0 (minimo):&quot;</span><span class="p">,</span> <span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Quantile di ordine 0.5 (mediana):&quot;</span><span class="p">,</span> <span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.5</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Quantile di ordine 1 (massimo):&quot;</span><span class="p">,</span> <span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Quantile di ordine 0.15:&quot;</span><span class="p">,</span> <span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.15</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Quantile di ordine 0 (minimo): 0.42
Quantile di ordine 0.5 (mediana): 28.0
Quantile di ordine 1 (massimo): 80.0
Quantile di ordine 0.15: 17.0
</pre></div>
</div>
</div>
</div>
<p>I percentili si ottengono sempre mediante la funzione <code class="docutils literal notranslate"><span class="pre">quantile</span></code>, dividendo l’ordine per percentile per 100:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Percentile di ordine 50% (mediana):&quot;</span><span class="p">,</span> <span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mi">50</span><span class="o">/</span><span class="mi">100</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Percentile di ordine 30%:&quot;</span><span class="p">,</span> <span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mi">30</span><span class="o">/</span><span class="mi">100</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Percentile di ordine 50% (mediana): 28.0
Percentile di ordine 30%: 22.0
</pre></div>
</div>
</div>
</div>
<p>Analogamente, i quartili si ottengono dividendo l’ordine del quartile per 4:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Quartile di ordine 0 (minimo):&quot;</span><span class="p">,</span> <span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mi">0</span><span class="o">/</span><span class="mi">4</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Quartile di ordine 1:&quot;</span><span class="p">,</span> <span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Quartile di ordine 2 (mediana):&quot;</span><span class="p">,</span> <span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Quartile di ordine 3:&quot;</span><span class="p">,</span> <span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">4</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Quartile di ordine 4 (massimo):&quot;</span><span class="p">,</span> <span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mi">4</span><span class="o">/</span><span class="mi">4</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Quartile di ordine 0 (minimo): 0.42
Quartile di ordine 1: 20.125
Quartile di ordine 2 (mediana): 28.0
Quartile di ordine 3: 38.0
Quartile di ordine 4 (massimo): 80.0
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p><strong>🙋‍♂️ Domanda 4</strong></p>
<p>Anche i quartili, come il minimo e il massimo, permettono di farsi un’idea dell’ordine di grandezza dei dati analizzati, tuttavia, i quartili hanno un vantaggio, quale?</p>
</div></blockquote>
</section>
<section id="moda">
<h4><span class="section-number">14.2.4. </span>Moda<a class="headerlink" href="#moda" title="Permalink to this heading">#</a></h4>
<p>Possiamo calcolare la moda manualmente come segue:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Moda: &quot;</span><span class="p">,</span><span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>24.0    30
22.0    27
18.0    26
19.0    25
28.0    25
Name: Age, dtype: int64
Moda:  24.0
</pre></div>
</div>
</div>
</div>
<p>Alternativamente, possiamo usare la funzione <code class="docutils literal notranslate"><span class="pre">mode</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mode</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    24.0
Name: Age, dtype: float64
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p><strong>🙋‍♂️ Domanda 5</strong></p>
<p>Si confrontino la moda di <code class="docutils literal notranslate"><span class="pre">Age</span></code> con la sua media. I valori corrispondono? Perché?</p>
</div></blockquote>
</section>
</section>
<section id="indicatori-di-dispersione">
<h3><span class="section-number">14.3. </span>Indicatori di dispersione<a class="headerlink" href="#indicatori-di-dispersione" title="Permalink to this heading">#</a></h3>
<section id="minimo-massimo-e-range">
<h4><span class="section-number">14.3.1. </span>Minimo, Massimo e Range<a class="headerlink" href="#minimo-massimo-e-range" title="Permalink to this heading">#</a></h4>
<p>Massimo, minimo e range vengono calcolati semplicemente come segue:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Minimo:&quot;</span><span class="p">,</span> <span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Massimo:&quot;</span><span class="p">,</span> <span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Range:&quot;</span><span class="p">,</span> <span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Minimo: 0.42
Massimo: 80.0
Range: 79.58
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p><strong>🙋‍♂️ Domanda 6</strong></p>
<p>Il range è un indicatore di dispersione robusto alla presenza di “outliers”?</p>
</div></blockquote>
</section>
<section id="distanza-interquartile">
<h4><span class="section-number">14.3.2. </span>Distanza interquartile<a class="headerlink" href="#distanza-interquartile" title="Permalink to this heading">#</a></h4>
<p>Possiamo calcolare la distanza interquartile come segue:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">q11</span><span class="p">,</span><span class="n">q13</span> <span class="o">=</span> <span class="n">titanic</span><span class="p">[</span><span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Sex&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;male&#39;</span><span class="p">][</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">([</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="o">/</span><span class="mi">4</span><span class="p">])</span>
<span class="n">q21</span><span class="p">,</span><span class="n">q23</span> <span class="o">=</span> <span class="n">titanic</span><span class="p">[</span><span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Sex&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;female&#39;</span><span class="p">][</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">([</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="o">/</span><span class="mi">4</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Lo scarto interquartile di sample 1 è:&quot;</span><span class="p">,</span><span class="n">q13</span><span class="o">-</span><span class="n">q11</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Lo scarto interquartile di sample 2 è:&quot;</span><span class="p">,</span><span class="n">q23</span><span class="o">-</span><span class="n">q21</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Lo scarto interquartile di sample 1 è: 18.0
Lo scarto interquartile di sample 2 è: 19.0
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p><strong>🙋‍♂️ Domanda 7</strong></p>
<p>La distanza interquartile è sempre una misura di dispersione robusta? Cosa succede nel caso di distribuzioni fortemente asimmetriche?</p>
</div></blockquote>
</section>
<section id="varianza-e-deviazione-standard">
<h4><span class="section-number">14.3.3. </span>Varianza e Deviazione Standard<a class="headerlink" href="#varianza-e-deviazione-standard" title="Permalink to this heading">#</a></h4>
<p>La varianza può essere calcolata richiamando il metodo <code class="docutils literal notranslate"><span class="pre">var</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">titanic</span><span class="p">[</span><span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Sex&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;male&#39;</span><span class="p">][</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">var</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">titanic</span><span class="p">[</span><span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Sex&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;female&#39;</span><span class="p">][</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">var</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>215.44957942429036
199.0962330533453
</pre></div>
</div>
</div>
</div>
<p>La <strong>deviazione standard</strong> si calcola mediante il metodo <code class="docutils literal notranslate"><span class="pre">std</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Deviazione standard del campione:&quot;</span><span class="p">,</span><span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">(),</span><span class="s2">&quot;anni&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Deviazione standard del campione: 14.526497332334044 anni
</pre></div>
</div>
</div>
</div>
<p>La deviazione standard ci dice qualcosa anche sulla “forma” della distribuzione. Confrontiamo ad esempio le deviazioni standard delle età dei passeggeri appartenenti alle tre classi di imbarco:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">titanic</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Pclass&#39;</span><span class="p">)[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Pclass
1    14.802856
2    14.001077
3    12.495398
Name: Age, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Confrontiamo adesso le densità stimate dai tre campioni:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="n">titanic</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Pclass&#39;</span><span class="p">)[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">density</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/3127b5ecb288eba512d670ea969b8c4eabfb9e0d36ad57988cbb81267b12f59b.png" src="../_images/3127b5ecb288eba512d670ea969b8c4eabfb9e0d36ad57988cbb81267b12f59b.png" />
</div>
</div>
<blockquote>
<div><p><strong>🙋‍♂️ Domanda 8</strong></p>
<p>Esiste una relazione tra le deviazioni standard dei campioni e le relative densità? Quale?</p>
</div></blockquote>
<section id="normalizzazione-tra-0-e-1">
<h5><span class="section-number">14.3.3.1. </span>Normalizzazione tra 0 e 1<a class="headerlink" href="#normalizzazione-tra-0-e-1" title="Permalink to this heading">#</a></h5>
<p>Secondo la normalizzazione tra 0 e 1, i dati vengono riscalati come segue:</p>
<div class="math notranslate nohighlight">
\[
x_{norm} = (x-x_{min})/(x_{max}-x_{min})
\]</div>
<p>Possiamo effettuare questa trasformazione in Pandas come segue:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">age_norm_01</span> <span class="o">=</span> <span class="p">(</span><span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">())</span><span class="o">/</span><span class="p">(</span><span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">-</span><span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<p>Verifichiamo che gli estremi del nuovo campione siano 0 e 1:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">age_norm_01</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">age_norm_01</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0 1.0
</pre></div>
</div>
</div>
</div>
</section>
<section id="normalizzazione-tra-1-e-1">
<h5><span class="section-number">14.3.3.2. </span>Normalizzazione tra -1 e 1<a class="headerlink" href="#normalizzazione-tra-1-e-1" title="Permalink to this heading">#</a></h5>
<p>I dati vengono riscalati come segue:</p>
<div class="math notranslate nohighlight">
\[
x_{norm} = (x_{max}+x_{min}-2\cdot x)/(x_{max}-x_{min})
\]</div>
<p>Possiamo effettuare questa trasformazione in Pandas come segue:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">age_norm_11</span> <span class="o">=</span> <span class="p">(</span><span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">+</span><span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">-</span><span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<p>Verifichiamo che gli estremi del nuovo campione siano -1 e 1:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">age_norm_11</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">age_norm_11</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-1.0 1.0
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="standardizzazione-z-scoring">
<h4><span class="section-number">14.3.4. </span>Standardizzazione (z-scoring)<a class="headerlink" href="#standardizzazione-z-scoring" title="Permalink to this heading">#</a></h4>
<p>Possiamo effettuare questa normalizzazione usando la funzione <code class="docutils literal notranslate"><span class="pre">zscore</span></code> di <code class="docutils literal notranslate"><span class="pre">scipy</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">zscore</span>
<span class="n">zscore</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([-1.41421356, -0.70710678,  0.        ,  0.70710678,  1.41421356])
</pre></div>
</div>
</div>
</div>
<p>Applichiamo questa normalizzazione alle età dei passeggeri del Titanic:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">age_z</span><span class="o">=</span><span class="n">zscore</span><span class="p">(</span><span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">density</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<span class="n">age_z</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">density</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/94d6f9801933af40ea58e994ae8e4868959480742ea326ad146ff0c511d56c11.png" src="../_images/94d6f9801933af40ea58e994ae8e4868959480742ea326ad146ff0c511d56c11.png" />
</div>
</div>
</section>
<section id="indicatori-di-forma">
<h4><span class="section-number">14.3.5. </span>Indicatori di Forma<a class="headerlink" href="#indicatori-di-forma" title="Permalink to this heading">#</a></h4>
<section id="asimmetria-skewness">
<h5><span class="section-number">14.3.5.1. </span>Asimmetria (skewness)<a class="headerlink" href="#asimmetria-skewness" title="Permalink to this heading">#</a></h5>
<p>Posso calcolare il valore di skewness mediante il metodo di Pandas <code class="docutils literal notranslate"><span class="pre">skew</span></code>. Vediamo un paio di esempi sul dataset di pesi e altezze:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">titanic</span><span class="o">.</span><span class="n">skew</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/var/folders/cs/p62_d78d49n3ddj0xlfh1h7r0000gn/T/ipykernel_31494/1596635564.py:1: FutureWarning: Dropping of nuisance columns in DataFrame reductions (with &#39;numeric_only=None&#39;) is deprecated; in a future version this will raise TypeError.  Select only valid columns before calling the reduction.
  titanic.skew()
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Survived    0.478523
Pclass     -0.630548
Age         0.389108
SibSp       3.695352
Parch       2.749117
Fare        4.787317
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Confrontiamo i risultati con le stime di densità:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">titanic</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">density</span><span class="p">(</span><span class="n">subplots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[&lt;AxesSubplot:ylabel=&#39;Density&#39;&gt;, &lt;AxesSubplot:ylabel=&#39;Density&#39;&gt;,
        &lt;AxesSubplot:ylabel=&#39;Density&#39;&gt;],
       [&lt;AxesSubplot:ylabel=&#39;Density&#39;&gt;, &lt;AxesSubplot:ylabel=&#39;Density&#39;&gt;,
        &lt;AxesSubplot:ylabel=&#39;Density&#39;&gt;]], dtype=object)
</pre></div>
</div>
<img alt="../_images/db7ca8b3af75435e6a0559d58c00faaf677aadc08d3b10203140f7c00457ab50.png" src="../_images/db7ca8b3af75435e6a0559d58c00faaf677aadc08d3b10203140f7c00457ab50.png" />
</div>
</div>
<p>I valori di skewness di pesi e altezze sarnno:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">hw</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;http://antoninofurnari.it/downloads/height_weight.csv&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Skweness pesi: </span><span class="si">{</span><span class="n">hw</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">skew</span><span class="p">()</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Skweness altezza: </span><span class="si">{</span><span class="n">hw</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">skew</span><span class="p">()</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Skweness pesi: 0.57
Skweness altezza: 0.19
</pre></div>
</div>
</div>
</div>
<p>Confrontando con le densità:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hw</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">density</span><span class="p">(</span><span class="n">subplots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[&lt;AxesSubplot:ylabel=&#39;Density&#39;&gt;, &lt;AxesSubplot:ylabel=&#39;Density&#39;&gt;,
        &lt;AxesSubplot:ylabel=&#39;Density&#39;&gt;],
       [&lt;AxesSubplot:ylabel=&#39;Density&#39;&gt;, &lt;AxesSubplot:ylabel=&#39;Density&#39;&gt;,
        &lt;AxesSubplot:ylabel=&#39;Density&#39;&gt;]], dtype=object)
</pre></div>
</div>
<img alt="../_images/0b8c6e1db2d6c3e5aa90f25f408109f1ef065faf6116962d108297f4741ed227.png" src="../_images/0b8c6e1db2d6c3e5aa90f25f408109f1ef065faf6116962d108297f4741ed227.png" />
</div>
</div>
</section>
<section id="curtosi-kurtosis">
<h5><span class="section-number">14.3.5.2. </span>Curtosi (kurtosis)<a class="headerlink" href="#curtosi-kurtosis" title="Permalink to this heading">#</a></h5>
<p>Analogamente, possiamo calcolare la curtosi con il metodo <code class="docutils literal notranslate"><span class="pre">Kurtosis</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">titanic</span><span class="o">.</span><span class="n">kurtosis</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/var/folders/cs/p62_d78d49n3ddj0xlfh1h7r0000gn/T/ipykernel_31494/3071249296.py:1: FutureWarning: Dropping of nuisance columns in DataFrame reductions (with &#39;numeric_only=None&#39;) is deprecated; in a future version this will raise TypeError.  Select only valid columns before calling the reduction.
  titanic.kurtosis()
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Survived    -1.775005
Pclass      -1.280015
Age          0.178274
SibSp       17.880420
Parch        9.778125
Fare        33.398141
dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hw</span><span class="o">.</span><span class="n">kurtosis</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/var/folders/cs/p62_d78d49n3ddj0xlfh1h7r0000gn/T/ipykernel_31494/4227707798.py:1: FutureWarning: Dropping of nuisance columns in DataFrame reductions (with &#39;numeric_only=None&#39;) is deprecated; in a future version this will raise TypeError.  Select only valid columns before calling the reduction.
  hw.kurtosis()
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>BMI       0.917179
height   -0.687287
weight   -0.056386
dtype: float64
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="boxplot">
<h3><span class="section-number">14.4. </span>Boxplot<a class="headerlink" href="#boxplot" title="Permalink to this heading">#</a></h3>
<p>Possiamo visualizzare un boxplot direttamente mediante <code class="docutils literal notranslate"><span class="pre">Pandas</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">box</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/24ce3a60a19260af41dbbe519a20cc5bb83884b3725b8559e329f5efc6b6d1b5.png" src="../_images/24ce3a60a19260af41dbbe519a20cc5bb83884b3725b8559e329f5efc6b6d1b5.png" />
</div>
</div>
<p>Alternativamente, possiamo mostrare un boxplot mediante matplotlib:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">())</span><span class="c1">#inseriamo dropna per eliminare i NaN</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/720afb629c1a6f2676144757c776184c11d125f9d75c8df2002e982dfd1556d6.png" src="../_images/720afb629c1a6f2676144757c776184c11d125f9d75c8df2002e982dfd1556d6.png" />
</div>
</div>
<section id="boxplot-multipli">
<h4><span class="section-number">14.4.1. </span>Boxplot Multipli<a class="headerlink" href="#boxplot-multipli" title="Permalink to this heading">#</a></h4>
<p>Mediante <code class="docutils literal notranslate"><span class="pre">Pandas</span></code> è possibile mostrare i boxplot di tutte le variabili numeriche di un DataFrame come segue:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">titanic</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">box</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/de2f3779e3ca0a5415af5d0b1fd7b13d8512c8c761774699af78989be464eade.png" src="../_images/de2f3779e3ca0a5415af5d0b1fd7b13d8512c8c761774699af78989be464eade.png" />
</div>
</div>
<p>Se vogliamo restringere l’analisi ad alcune variabili, possiamo selezionare solo le variabili interessate come segue:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">titanic</span><span class="p">[[</span><span class="s1">&#39;Age&#39;</span><span class="p">,</span><span class="s1">&#39;Fare&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">box</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/f07d23bc4d5aeb42aebc700af486860efab477ee35bd57f9e8646bfc77b431b5.png" src="../_images/f07d23bc4d5aeb42aebc700af486860efab477ee35bd57f9e8646bfc77b431b5.png" />
</div>
</div>
<p>E’ inoltre possibile confrontare i boxplot di diversi campioni. Supponiamo di voler confrontare le età di uomini e donne:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">titanic</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;Sex&#39;</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">],</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/39dad22ba90a44b0126bbad7ea284ea3867bd8f6c21a0a1181d6678cde1bc88f.png" src="../_images/39dad22ba90a44b0126bbad7ea284ea3867bd8f6c21a0a1181d6678cde1bc88f.png" />
</div>
</div>
<p>Nel caso di variabili multiple:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">titanic</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;Sex&#39;</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">,</span><span class="s1">&#39;Fare&#39;</span><span class="p">],</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/cf3e189ccf3f2adeb0cb2920596f95655da5ba8d86c5c39d951dbdd2ac00b871.png" src="../_images/cf3e189ccf3f2adeb0cb2920596f95655da5ba8d86c5c39d951dbdd2ac00b871.png" />
</div>
</div>
<p>Possiamo anche combinare i boxplot con un <code class="docutils literal notranslate"><span class="pre">groupby</span></code>. Confrontiamo ad esempio le tariffe pagate da e donne appartenenti alle tre classi di imbarco:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">titanic</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Pclass&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;Sex&#39;</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Fare&#39;</span><span class="p">],</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">layout</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/0f8d2c7e5e7c25f0ffacd637664b7a6aed807c7bbd8756334f2bb6af12c1bb39.png" src="../_images/0f8d2c7e5e7c25f0ffacd637664b7a6aed807c7bbd8756334f2bb6af12c1bb39.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">titanic</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Pclass&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;Sex&#39;</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">],</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">layout</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ade8de75dd250f657860417399df43f016f9c2434f36ad5e583829eb2f5f88d5.png" src="../_images/ade8de75dd250f657860417399df43f016f9c2434f36ad5e583829eb2f5f88d5.png" />
</div>
</div>
<blockquote>
<div><p><strong>🙋‍♂️ Domanda 9</strong></p>
<p>Si confrontino le età di donne e uomini nelle varie classi di imbarco. In quale classe esistano differenze notevoli tra le età di uomini e donne?</p>
</div></blockquote>
</section>
</section>
<section id="esercizi">
<h3><span class="section-number">14.5. </span>Esercizi<a class="headerlink" href="#esercizi" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><p>🧑‍💻 Esercizio 1</p>
<p>Considerando il dataset Titanic, si calcolino per ogni variabile la numerosità, la media, la deviazione standard, il minimo, il massimo, il valore mediano, il primo e il terzo quartile. Dopo aver calcolato i valori richiesti individualmente, si utilizzi il metodo <code class="docutils literal notranslate"><span class="pre">describe</span></code> per ottenere tali valori. Qual è la variabile più dispersa?</p>
</div></blockquote>
<blockquote>
<div><p>🧑‍💻 Esercizio 2</p>
<p>Considerando il dataset Titanic, per ognuna delle tre classi, si calcolino medie e varianze delle età dei passeggeri. In quale classe le età sono meno disperse? Quale classe contiene i soggetti più giovani? Si completi l’analisi con dei grafici a barre.</p>
</div></blockquote>
</section>
</section>
<span id="document-laboratories/08_associazione_variabili"></span><section class="tex2jax_ignore mathjax_ignore" id="associazione-tra-variabili">
<h2><span class="section-number">15. </span>Associazione tra Variabili<a class="headerlink" href="#associazione-tra-variabili" title="Permalink to this heading">#</a></h2>
<p>Utilizzeremo come esempio nuovamente il dataset Titanic:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">titanic</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/agconti/kaggle-titanic/master/data/train.csv&#39;</span><span class="p">,</span>
                     <span class="n">index_col</span><span class="o">=</span><span class="s1">&#39;PassengerId&#39;</span><span class="p">)</span>
<span class="n">titanic</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Name</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>Cabin</th>
      <th>Embarked</th>
    </tr>
    <tr>
      <th>PassengerId</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>3</td>
      <td>Braund, Mr. Owen Harris</td>
      <td>male</td>
      <td>22.0</td>
      <td>1</td>
      <td>0</td>
      <td>A/5 21171</td>
      <td>7.2500</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>1</td>
      <td>Cumings, Mrs. John Bradley (Florence Briggs Th...</td>
      <td>female</td>
      <td>38.0</td>
      <td>1</td>
      <td>0</td>
      <td>PC 17599</td>
      <td>71.2833</td>
      <td>C85</td>
      <td>C</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>3</td>
      <td>Heikkinen, Miss. Laina</td>
      <td>female</td>
      <td>26.0</td>
      <td>0</td>
      <td>0</td>
      <td>STON/O2. 3101282</td>
      <td>7.9250</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>1</td>
      <td>Futrelle, Mrs. Jacques Heath (Lily May Peel)</td>
      <td>female</td>
      <td>35.0</td>
      <td>1</td>
      <td>0</td>
      <td>113803</td>
      <td>53.1000</td>
      <td>C123</td>
      <td>S</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0</td>
      <td>3</td>
      <td>Allen, Mr. William Henry</td>
      <td>male</td>
      <td>35.0</td>
      <td>0</td>
      <td>0</td>
      <td>373450</td>
      <td>8.0500</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Dato il dataset sopra, potremmo chiederci se delle variabili influenzano i valori di altre. Ad esempio, trovarsi in prima, seconda o terza classe (variabile <code class="docutils literal notranslate"><span class="pre">Pclass</span></code>) influenza in qualche modo la probabilità di sopravvivere (variabile <code class="docutils literal notranslate"><span class="pre">Survived</span></code>)?, o ancora, l’età (variabile <code class="docutils literal notranslate"><span class="pre">Age</span></code>) o il prezzo pagato (<code class="docutils literal notranslate"><span class="pre">Fare</span></code>) influenza in qualche modo la probabilità di salvarsi (<code class="docutils literal notranslate"><span class="pre">Survived</span></code>)?</p>
<p>In questa lezione, vedremo diversi modi per riassumere le distribuzioni di due variabili e verificare eventuali associazioni (o correlazioni) tra le variabili.</p>
<section id="riassumere-la-distribuzione-di-due-variabili-discrete">
<h3><span class="section-number">15.1. </span>Riassumere la Distribuzione di due Variabili Discrete<a class="headerlink" href="#riassumere-la-distribuzione-di-due-variabili-discrete" title="Permalink to this heading">#</a></h3>
<p>Se entrambe le variabili che stiamo studiando sono discrete, possiamo enumerare tutte le possibili combinazioni di valori e riassumerle in una tabella di contingenza che indica i valori di una variabile sulle righe e quelli dell’altra variabile sulle colonne. Ogni cella indicherà il numero di volte in cui osserviamo una data coppia di valori.</p>
<section id="tabelle-di-contingenza">
<h4><span class="section-number">15.1.1. </span>Tabelle di Contingenza<a class="headerlink" href="#tabelle-di-contingenza" title="Permalink to this heading">#</a></h4>
<p>Costruiamo la tabella di contingenza per le variabili <code class="docutils literal notranslate"><span class="pre">Sex</span></code> e <code class="docutils literal notranslate"><span class="pre">Pclass</span></code>. Per farlo utilizzeremo la funzione <code class="docutils literal notranslate"><span class="pre">crosstab</span></code> di Pandas:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Sex&#39;</span><span class="p">],</span> <span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Pclass&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Pclass</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
    <tr>
      <th>Sex</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>female</th>
      <td>94</td>
      <td>76</td>
      <td>144</td>
    </tr>
    <tr>
      <th>male</th>
      <td>122</td>
      <td>108</td>
      <td>347</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>La tabella sopra indica ad esempio che <span class="math notranslate nohighlight">\(94\)</span> passeggeri in classe <span class="math notranslate nohighlight">\(1\)</span> erano di sesso femminile. Specificando <code class="docutils literal notranslate"><span class="pre">margins=True</span></code> possiamo ottenere le somme per righe e colonne, che indicheranno le frequenze assolute di ciascuna variabile:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Sex&#39;</span><span class="p">],</span> <span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Pclass&#39;</span><span class="p">],</span><span class="n">margins</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Pclass</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>All</th>
    </tr>
    <tr>
      <th>Sex</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>female</th>
      <td>94</td>
      <td>76</td>
      <td>144</td>
      <td>314</td>
    </tr>
    <tr>
      <th>male</th>
      <td>122</td>
      <td>108</td>
      <td>347</td>
      <td>577</td>
    </tr>
    <tr>
      <th>All</th>
      <td>216</td>
      <td>184</td>
      <td>491</td>
      <td>891</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="distribuzioni-di-frequenze-relative-congiunte">
<h4><span class="section-number">15.1.2. </span>Distribuzioni di Frequenze Relative Congiunte<a class="headerlink" href="#distribuzioni-di-frequenze-relative-congiunte" title="Permalink to this heading">#</a></h4>
<p>Possiamo ottenere la tabella delle frequenze relative congiunte passando <code class="docutils literal notranslate"><span class="pre">normalize=True</span></code> alla funzione crosstab:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Sex&#39;</span><span class="p">],</span> <span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Pclass&#39;</span><span class="p">],</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Pclass</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
    <tr>
      <th>Sex</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>female</th>
      <td>0.105499</td>
      <td>0.085297</td>
      <td>0.161616</td>
    </tr>
    <tr>
      <th>male</th>
      <td>0.136925</td>
      <td>0.121212</td>
      <td>0.389450</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="distribuzioni-di-frequenze-relative-marginali">
<h4><span class="section-number">15.1.3. </span>Distribuzioni di Frequenze Relative Marginali<a class="headerlink" href="#distribuzioni-di-frequenze-relative-marginali" title="Permalink to this heading">#</a></h4>
<p>Otteniamo i marginali passando <code class="docutils literal notranslate"><span class="pre">margins=True</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Sex&#39;</span><span class="p">],</span> <span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Pclass&#39;</span><span class="p">],</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">margins</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Pclass</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>All</th>
    </tr>
    <tr>
      <th>Sex</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>female</th>
      <td>0.105499</td>
      <td>0.085297</td>
      <td>0.161616</td>
      <td>0.352413</td>
    </tr>
    <tr>
      <th>male</th>
      <td>0.136925</td>
      <td>0.121212</td>
      <td>0.389450</td>
      <td>0.647587</td>
    </tr>
    <tr>
      <th>All</th>
      <td>0.242424</td>
      <td>0.206510</td>
      <td>0.551066</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Va notato che le frequenze relative marginali ottenute, sono identiche alle frequenze relative dei campioni univariati:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Sex&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>male      0.647587
female    0.352413
Name: Sex, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Che sono esattamente i valori nell’ultima colonna della tabella precedente. Analogamente:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Pclass&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3    0.551066
1    0.242424
2    0.206510
Name: Pclass, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Che sono i valori nell’ultima riga della tabella precedente.</p>
</section>
<section id="distribuzioni-di-frequenze-relative-condizionali">
<h4><span class="section-number">15.1.4. </span>Distribuzioni di Frequenze Relative Condizionali<a class="headerlink" href="#distribuzioni-di-frequenze-relative-condizionali" title="Permalink to this heading">#</a></h4>
<p>È possibile ottenere le frequenze condizionate relative normalizzando per la riga opportuna. Se voglio condizionare rispetto alla variabile X, normalizzerò per righe:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#normalize=0 indica di condizionare rispetto alla prima variabile</span>
<span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Sex&#39;</span><span class="p">],</span> <span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Pclass&#39;</span><span class="p">],</span> <span class="n">normalize</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Pclass</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
    <tr>
      <th>Sex</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>female</th>
      <td>0.299363</td>
      <td>0.242038</td>
      <td>0.458599</td>
    </tr>
    <tr>
      <th>male</th>
      <td>0.211438</td>
      <td>0.187175</td>
      <td>0.601386</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Dalla tabella sopra, ad esempio, posso evincere:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(f(Pclass=1|Sex=female) = 0.290363\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(f(Pclass=2|Sex=female) = 0.242038\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(f(Pclass=3|Sex=female) = 0.458599\)</span></p></li>
</ul>
<p>Queste sono le frequenze delle donne nelle tre classi. Analogamente, la seconda riga rappresenta le frequenze condizionate rispetto a <code class="docutils literal notranslate"><span class="pre">Sex=male</span></code>. Dalla tabella, notiamo che la distribuzione dei passeggeri cambia nelle tre classi. In particolare, tra gli uomini, la terza classe è più frequente che tra le donne.</p>
<p>Possiamo ottenere la prospettiva complementare condizionando su classe invece:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#normalize=1 indica di condizionare rispetto alla prima variabile</span>
<span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Sex&#39;</span><span class="p">],</span> <span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Pclass&#39;</span><span class="p">],</span> <span class="n">normalize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Pclass</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
    <tr>
      <th>Sex</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>female</th>
      <td>0.435185</td>
      <td>0.413043</td>
      <td>0.293279</td>
    </tr>
    <tr>
      <th>male</th>
      <td>0.564815</td>
      <td>0.586957</td>
      <td>0.706721</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>In questo caso, ogni colonna sarà una distribuzione di probabilità. Ad esempio:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(P(Sex=female|Pclass=1) = 0.435185\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(P(Sex=male|Pclass=1) = 0.564815\)</span></p></li>
</ul>
<p>Notiamo che le proporzione tra uomini e donne cambiano nelle tre classi e in particolare nella terza classe ci sono molti più uomini che donne.</p>
</section>
<section id="rappresentazioni-grafiche">
<h4><span class="section-number">15.1.5. </span>Rappresentazioni Grafiche<a class="headerlink" href="#rappresentazioni-grafiche" title="Permalink to this heading">#</a></h4>
<p>Possiamo facilmente ottenere rappresentazioni grafiche delle relazioni tra due variabili mediante grafici a barre, direttamente dalle tabelle di contingenza.</p>
<p>Possiamo confrontare le frequenze assolute di passeggeri e sessi nelle tre classi come segue:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Sex&#39;</span><span class="p">],</span> <span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Pclass&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:xlabel=&#39;Sex&#39;&gt;
</pre></div>
</div>
<img alt="../_images/ac26d800913862e28176b343cc300fd5f9930924d16e9e02d8164436624066c6.png" src="../_images/ac26d800913862e28176b343cc300fd5f9930924d16e9e02d8164436624066c6.png" />
</div>
</div>
<p>Da qui notiamo che molti passeggeri sono uomini e in terza classe. In questi casi, può essere a volte utile uno stacked plot:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Sex&#39;</span><span class="p">],</span> <span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Pclass&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">stacked</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:xlabel=&#39;Sex&#39;&gt;
</pre></div>
</div>
<img alt="../_images/0c55c9596676ee3c1296b3f23b2ef0d97b6ccd7d812d5afed9ea31f895a6d7b8.png" src="../_images/0c55c9596676ee3c1296b3f23b2ef0d97b6ccd7d812d5afed9ea31f895a6d7b8.png" />
</div>
</div>
<p>È spesso utile visualizzare le distribuzioni condizionate. Ad esempio, il grafico che segue ci permette di confrontare le distribuzioni di passeggeri nelle tre classi, suddividendo in due gruppi sulla base del sesso:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Sex&#39;</span><span class="p">],</span> <span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Pclass&#39;</span><span class="p">],</span> <span class="n">normalize</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:xlabel=&#39;Sex&#39;&gt;
</pre></div>
</div>
<img alt="../_images/637ce8addfa61dda9e3bea0bcbfc88d742b2b1f64c7f40452c8e684acdb47ea1.png" src="../_images/637ce8addfa61dda9e3bea0bcbfc88d742b2b1f64c7f40452c8e684acdb47ea1.png" />
</div>
</div>
<p>Possiamo ottenere il grafico delle frequenze condizionate rispetto alle classi per una vista complementare. In questo caso, per avere un grafico significativo, dobbiamo trasporre la tabella di contingenza con un <code class="docutils literal notranslate"><span class="pre">.T</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#normalize=1 indica di condizionare rispetto alla prima variabile</span>
<span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Sex&#39;</span><span class="p">],</span> <span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Pclass&#39;</span><span class="p">],</span> <span class="n">normalize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:xlabel=&#39;Pclass&#39;&gt;
</pre></div>
</div>
<img alt="../_images/d9ad95d7e5a866cc1279aee299505fb0d1b74016f380d366faf595b39e9f624c.png" src="../_images/d9ad95d7e5a866cc1279aee299505fb0d1b74016f380d366faf595b39e9f624c.png" />
</div>
</div>
</section>
<section id="misure-di-associazione-tra-due-variabili-discrete">
<h4><span class="section-number">15.1.6. </span>Misure di Associazione tra due Variabili Discrete<a class="headerlink" href="#misure-di-associazione-tra-due-variabili-discrete" title="Permalink to this heading">#</a></h4>
<section id="statistica-mathcal-x-2-di-pearson">
<h5><span class="section-number">15.1.6.1. </span>Statistica <span class="math notranslate nohighlight">\(\mathcal{X}^2\)</span> di Pearson<a class="headerlink" href="#statistica-mathcal-x-2-di-pearson" title="Permalink to this heading">#</a></h5>
<p>Possiamo calcolare la statistica <span class="math notranslate nohighlight">\(\mathcal{X}^2\)</span> di Pearson come segue:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">chi2_contingency</span>
<span class="n">contingency</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Pclass&#39;</span><span class="p">],</span> <span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Survived&#39;</span><span class="p">])</span>
<span class="n">chi2_contingency</span><span class="p">(</span><span class="n">contingency</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chi2ContingencyResult(statistic=102.88898875696056, pvalue=4.549251711298793e-23, dof=2, expected_freq=array([[133.09090909,  82.90909091],
       [113.37373737,  70.62626263],
       [302.53535354, 188.46464646]]))
</pre></div>
</div>
</div>
</div>
<p>La funzione <code class="docutils literal notranslate"><span class="pre">chi2_contingency</span></code> restituisce:</p>
<ul class="simple">
<li><p>Il valore della statistica;</p></li>
<li><p>il p-value (lo vedremo meglio in seguito);</p></li>
<li><p>i gradi di libertà della distirbuzione <span class="math notranslate nohighlight">\(\chi^2\)</span> (vedremo meglio anche questo in seguito);</p></li>
<li><p>Le occorrenze attese in caso di indipendenza.</p></li>
</ul>
<p>Possiamo confrontare queste occorrenze con quelle reali:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">contingency</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Survived</th>
      <th>0</th>
      <th>1</th>
    </tr>
    <tr>
      <th>Pclass</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>80</td>
      <td>136</td>
    </tr>
    <tr>
      <th>2</th>
      <td>97</td>
      <td>87</td>
    </tr>
    <tr>
      <th>3</th>
      <td>372</td>
      <td>119</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="statistica-v-di-cramer">
<h5><span class="section-number">15.1.6.2. </span>Statistica <span class="math notranslate nohighlight">\(V\)</span> di Cramer<a class="headerlink" href="#statistica-v-di-cramer" title="Permalink to this heading">#</a></h5>
<p>È possibile calcolare la statistica V di Cramer come segue:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats.contingency</span> <span class="kn">import</span> <span class="n">association</span>

<span class="n">association</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Pclass&#39;</span><span class="p">],</span> <span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Survived&#39;</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.33981738800531175
</pre></div>
</div>
</div>
</div>
</section>
<section id="rischio-relativo-e-odds-ratio">
<h5><span class="section-number">15.1.6.3. </span>Rischio Relativo e Odds Ratio<a class="headerlink" href="#rischio-relativo-e-odds-ratio" title="Permalink to this heading">#</a></h5>
<p>Consideriamo questa matrice di contingenza:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">contingency</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;Exposed&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">380</span><span class="p">],</span>
    <span class="s2">&quot;Non Exposed&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span><span class="mi">594</span><span class="p">]</span>
<span class="p">},</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Diseased&quot;</span><span class="p">,</span> <span class="s2">&quot;Healthy&quot;</span><span class="p">])</span>
<span class="n">contingency</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Exposed</th>
      <th>Non Exposed</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Diseased</th>
      <td>20</td>
      <td>6</td>
    </tr>
    <tr>
      <th>Healthy</th>
      <td>380</td>
      <td>594</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Possiamo calcolare il rischio relativo come segue:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats.contingency</span> <span class="kn">import</span> <span class="n">relative_risk</span>
<span class="n">relative_risk</span><span class="p">(</span><span class="n">contingency</span><span class="p">[</span><span class="s1">&#39;Exposed&#39;</span><span class="p">][</span><span class="s1">&#39;Diseased&#39;</span><span class="p">],</span><span class="n">contingency</span><span class="p">[</span><span class="s1">&#39;Exposed&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span><span class="n">contingency</span><span class="p">[</span><span class="s1">&#39;Non Exposed&#39;</span><span class="p">][</span><span class="s1">&#39;Diseased&#39;</span><span class="p">],</span> <span class="n">contingency</span><span class="p">[</span><span class="s1">&#39;Non Exposed&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>RelativeRiskResult(relative_risk=5.0, exposed_cases=20, exposed_total=400, control_cases=6, control_total=600)
</pre></div>
</div>
</div>
</div>
<p>La funzione richiede che vengano passati i vari valori necessari piuttoto che la matrice di contingenza per evitare ambiguità.</p>
<p>L’odds ratio si calcola così:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats.contingency</span> <span class="kn">import</span> <span class="n">odds_ratio</span>
<span class="n">odds_ratio</span><span class="p">(</span><span class="n">contingency</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>OddsRatioResult(statistic=5.202179487843056)
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="associazioni-tra-variabili-continue">
<h3><span class="section-number">15.2. </span>Associazioni tra Variabili Continue<a class="headerlink" href="#associazioni-tra-variabili-continue" title="Permalink to this heading">#</a></h3>
<p>Per studiare le associazioni tra variabili continue, considereremo il dataset delle iris di fisher come dataset di esempio. Carichiamo il dataset mediante la libreria <code class="docutils literal notranslate"><span class="pre">seaborn</span></code> e visualizziamone informazioni e prime righe:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">iris</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="s1">&#39;iris&#39;</span><span class="p">)</span>
<span class="n">iris</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
<span class="n">iris</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 150 entries, 0 to 149
Data columns (total 5 columns):
 #   Column        Non-Null Count  Dtype  
---  ------        --------------  -----  
 0   sepal_length  150 non-null    float64
 1   sepal_width   150 non-null    float64
 2   petal_length  150 non-null    float64
 3   petal_width   150 non-null    float64
 4   species       150 non-null    object 
dtypes: float64(4), object(1)
memory usage: 6.0+ KB
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sepal_length</th>
      <th>sepal_width</th>
      <th>petal_length</th>
      <th>petal_width</th>
      <th>species</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5.1</td>
      <td>3.5</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4.9</td>
      <td>3.0</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4.7</td>
      <td>3.2</td>
      <td>1.3</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4.6</td>
      <td>3.1</td>
      <td>1.5</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5.0</td>
      <td>3.6</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Il dataset contiene <span class="math notranslate nohighlight">\(150\)</span> osservazioni riportanti le misure di 4 grandezze (lunghezza e larghezza di sepalo e petalo) per <span class="math notranslate nohighlight">\(150\)</span> esemplari di iris appartenenti a tre specie diverse: Iris setosa, Iris virginica e Iris versicolor.</p>
<p>Tutte le variabili sono numeriche, eccetto <code class="docutils literal notranslate"><span class="pre">species</span></code> che è categorica. Visualizziamone i valori univoci:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iris</span><span class="p">[</span><span class="s1">&#39;species&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;setosa&#39;, &#39;versicolor&#39;, &#39;virginica&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<p>Esploriamo i dati calcolando i principali indicatori statistici mediante <code class="docutils literal notranslate"><span class="pre">describe</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iris</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sepal_length</th>
      <th>sepal_width</th>
      <th>petal_length</th>
      <th>petal_width</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>150.000000</td>
      <td>150.000000</td>
      <td>150.000000</td>
      <td>150.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>5.843333</td>
      <td>3.057333</td>
      <td>3.758000</td>
      <td>1.199333</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.828066</td>
      <td>0.435866</td>
      <td>1.765298</td>
      <td>0.762238</td>
    </tr>
    <tr>
      <th>min</th>
      <td>4.300000</td>
      <td>2.000000</td>
      <td>1.000000</td>
      <td>0.100000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>5.100000</td>
      <td>2.800000</td>
      <td>1.600000</td>
      <td>0.300000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>5.800000</td>
      <td>3.000000</td>
      <td>4.350000</td>
      <td>1.300000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>6.400000</td>
      <td>3.300000</td>
      <td>5.100000</td>
      <td>1.800000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>7.900000</td>
      <td>4.400000</td>
      <td>6.900000</td>
      <td>2.500000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<blockquote>
<div><p><strong>🙋‍♂️ Domanda 1</strong></p>
<p>La variabile <code class="docutils literal notranslate"><span class="pre">species</span></code> non è stata inclusa nel sommario. Perché?</p>
</div></blockquote>
<p>Confrontiamo le diverse variabili mediante boxplot:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="n">iris</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">box</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/a9889b3ca87b0828a39742ef9d9639169a3855d9e75338e5f277de0a9ae5d88d.png" src="../_images/a9889b3ca87b0828a39742ef9d9639169a3855d9e75338e5f277de0a9ae5d88d.png" />
</div>
</div>
</section>
<section id="scatter-plot">
<h3><span class="section-number">15.3. </span>Scatter Plot<a class="headerlink" href="#scatter-plot" title="Permalink to this heading">#</a></h3>
<p>Possiamo mostrare uno scatterplot in seaborn come segue:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">iris</span><span class="p">[</span><span class="s1">&#39;sepal_width&#39;</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">iris</span><span class="p">[</span><span class="s1">&#39;sepal_length&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/76283409610d088f833d785d672fd880db3964fec998251986d1ad5dea94bf98.png" src="../_images/76283409610d088f833d785d672fd880db3964fec998251986d1ad5dea94bf98.png" />
</div>
</div>
<p>In alternativa, possiamo usare Pandas:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iris</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;sepal_width&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;sepal_length&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/eefd76215abcdfab8a1e4fa0dda175fa6ef36435ededb01b7a4c13222117310e.png" src="../_images/eefd76215abcdfab8a1e4fa0dda175fa6ef36435ededb01b7a4c13222117310e.png" />
</div>
</div>
<p>Con seabord, possiamo facilmente colorare i punti in maniera diversa a seconda dell’appartenenza alle diverse classi di iris utilizzando il parametro <code class="docutils literal notranslate"><span class="pre">hue</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">iris</span><span class="p">[</span><span class="s1">&#39;sepal_width&#39;</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">iris</span><span class="p">[</span><span class="s1">&#39;sepal_length&#39;</span><span class="p">],</span> <span class="n">hue</span><span class="o">=</span><span class="n">iris</span><span class="p">[</span><span class="s1">&#39;species&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/b1f04a4cb77c09ccbb02040538a4a0b50507329e6b03838e5472edba3eb7be9e.png" src="../_images/b1f04a4cb77c09ccbb02040538a4a0b50507329e6b03838e5472edba3eb7be9e.png" />
</div>
</div>
<blockquote>
<div><p><strong>🙋‍♂️ Domanda 2</strong></p>
<p>Cosa apprendiamo dal plot? La coppia di variabili considerata costituisce un fattore discriminante per l’appartenenza alle diverse classi?</p>
</div></blockquote>
<p>Lo scatterplot può essere effettuato con diverse coppie di variabili. Consideriamo la coppia (<code class="docutils literal notranslate"><span class="pre">sepal_length</span></code>, <code class="docutils literal notranslate"><span class="pre">petal_length</span></code>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">iris</span><span class="p">[</span><span class="s1">&#39;petal_length&#39;</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">iris</span><span class="p">[</span><span class="s1">&#39;sepal_length&#39;</span><span class="p">],</span> <span class="n">hue</span><span class="o">=</span><span class="n">iris</span><span class="p">[</span><span class="s1">&#39;species&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/9fc9f23122bb34f43a1f571a4f1dfab61d8b34ef9b897dbf4bda4262dde38422.png" src="../_images/9fc9f23122bb34f43a1f571a4f1dfab61d8b34ef9b897dbf4bda4262dde38422.png" />
</div>
</div>
<blockquote>
<div><p><strong>🙋‍♂️ Domanda 3</strong></p>
<p>Si confronti l’ultimo scatterplot visualizzato con lo scatterplot visto in precedenza. La nuova coppia di variabili costituisce un fattore discriminante per l’appartenenza alle diverse classi?</p>
</div></blockquote>
<p>Come possiamo notare dai due plot, ogni coppia di variabili ci permette di vedere “una parte” delle possibili interazioni tra le diverse variabili. Per avere un quadro più completo, in pratica si visualizzano gli scatter plot di tutte le coppie possibili. Questo plot prende il nome di scatter matrix. Possiamo ottenere una scatter matrix con <code class="docutils literal notranslate"><span class="pre">seaborn</span></code> come segue:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">iris</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/901e78ad102068b03f80a563fe0f8c17634fd9c0168a9b4074dd16e985619c13.png" src="../_images/901e78ad102068b03f80a563fe0f8c17634fd9c0168a9b4074dd16e985619c13.png" />
</div>
</div>
<blockquote>
<div><p><strong>🙋‍♂️ Domanda 4</strong></p>
<p>Perché sulla diagonale principale vengono mostrati degli istogrammi al posto di scatter plot? Si mostrino gli scatterplot corrispondenti alle coppie di variabili sulla diagonale principale.</p>
</div></blockquote>
<p>Possiamo evidenziare i punti per classe specificando una variabile sulla base della quale colorare i punti:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">iris</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;species&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d46123de31e58dfeb8edb21141cb1f953c65d24573a69c0853fcc211c8f60834.png" src="../_images/d46123de31e58dfeb8edb21141cb1f953c65d24573a69c0853fcc211c8f60834.png" />
</div>
</div>
<blockquote>
<div><p><strong>🙋‍♂️ Domanda 5</strong></p>
<p>Esiste una coppia di variabili che individua uno spazio nel quale le osservazioni appartenenti alle diverse classi sono maggiormente distinte? Esiste una unica variabile che presenta distribuzioni particolarmente diverse a seconda dell’appartenenza alle tre classi?</p>
</div></blockquote>
</section>
<section id="medie-e-covarianze">
<h3><span class="section-number">15.4. </span>Medie e Covarianze<a class="headerlink" href="#medie-e-covarianze" title="Permalink to this heading">#</a></h3>
<p>Nel caso <strong>multivariato</strong>, la <strong>media</strong> viene calcolata in maniera del tutto analoga al caso <strong>univariato</strong> come <strong>media di vettori</strong>. Possiamo banalmente calcolare la media dei nostri dati multivariati mediante il metodo <code class="docutils literal notranslate"><span class="pre">mean</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">iris</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sepal_length    5.843333
sepal_width     3.057333
petal_length    3.758000
petal_width     1.199333
dtype: float64
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/var/folders/cs/p62_d78d49n3ddj0xlfh1h7r0000gn/T/ipykernel_34355/769219605.py:1: FutureWarning: Dropping of nuisance columns in DataFrame reductions (with &#39;numeric_only=None&#39;) is deprecated; in a future version this will raise TypeError.  Select only valid columns before calling the reduction.
  print(iris.mean())
</pre></div>
</div>
</div>
</div>
<p>Il risultato sarà un vettore (una serie di Pandas) che individua un punto nello spazio a quattro dimensioni che rappresenta la media delle osservazioni. Vediamo un semplice esempio a due dimensioni, considerando solo alcune variabili:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iris2d</span> <span class="o">=</span> <span class="n">iris</span><span class="p">[[</span><span class="s1">&#39;sepal_length&#39;</span><span class="p">,</span><span class="s1">&#39;sepal_width&#39;</span><span class="p">]]</span>
<span class="n">mean_point</span> <span class="o">=</span> <span class="n">iris2d</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">iris2d</span><span class="p">[</span><span class="s1">&#39;sepal_length&#39;</span><span class="p">],</span><span class="n">iris2d</span><span class="p">[</span><span class="s1">&#39;sepal_width&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">mean_point</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">mean_point</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;rx&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/c8fd81e79a35c43ddf6f4d9dfdfe8fd585c12db3d320d359c126a7c1757aff19.png" src="../_images/c8fd81e79a35c43ddf6f4d9dfdfe8fd585c12db3d320d359c126a7c1757aff19.png" />
</div>
</div>
<p>La croce rossa rappresenta il punto medio del dataset bidimensionale considerato.</p>
<p>Posso ottenre la matrice di covarianza mediante il metodo <code class="docutils literal notranslate"><span class="pre">cov</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iris</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;species&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">cov</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sepal_length</th>
      <th>sepal_width</th>
      <th>petal_length</th>
      <th>petal_width</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>sepal_length</th>
      <td>0.685694</td>
      <td>-0.042434</td>
      <td>1.274315</td>
      <td>0.516271</td>
    </tr>
    <tr>
      <th>sepal_width</th>
      <td>-0.042434</td>
      <td>0.189979</td>
      <td>-0.329656</td>
      <td>-0.121639</td>
    </tr>
    <tr>
      <th>petal_length</th>
      <td>1.274315</td>
      <td>-0.329656</td>
      <td>3.116278</td>
      <td>1.295609</td>
    </tr>
    <tr>
      <th>petal_width</th>
      <td>0.516271</td>
      <td>-0.121639</td>
      <td>1.295609</td>
      <td>0.581006</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<blockquote>
<div><p><strong>🙋‍♂️ Domanda 6</strong></p>
<p>A cosa serve il codice <code class="docutils literal notranslate"><span class="pre">drop(&quot;species&quot;,</span> <span class="pre">axis=1)</span></code> inserito sopra?</p>
<p>Che cosa rappresentano i valori sulla diagonale principale?</p>
</div></blockquote>
<blockquote>
<div><p><strong>🙋‍♂️ Domanda 7</strong></p>
<p>Ci sono coppie di variabili che presentano covarianze fortemente positive? Si confrontino i valori della matrice di covarianza con i relativi plot dello scatterplot. I due indicatori ci dicono la stessa cosa?</p>
</div></blockquote>
</section>
<section id="indici-di-correlazione">
<h3><span class="section-number">15.5. </span>Indici di Correlazione<a class="headerlink" href="#indici-di-correlazione" title="Permalink to this heading">#</a></h3>
<p>Posso calcolare la matrice di correlazione con l’indice di correlazione di Pearson mediante il metodo <code class="docutils literal notranslate"><span class="pre">corr</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iris</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sepal_length</th>
      <th>sepal_width</th>
      <th>petal_length</th>
      <th>petal_width</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>sepal_length</th>
      <td>1.000000</td>
      <td>-0.117570</td>
      <td>0.871754</td>
      <td>0.817941</td>
    </tr>
    <tr>
      <th>sepal_width</th>
      <td>-0.117570</td>
      <td>1.000000</td>
      <td>-0.428440</td>
      <td>-0.366126</td>
    </tr>
    <tr>
      <th>petal_length</th>
      <td>0.871754</td>
      <td>-0.428440</td>
      <td>1.000000</td>
      <td>0.962865</td>
    </tr>
    <tr>
      <th>petal_width</th>
      <td>0.817941</td>
      <td>-0.366126</td>
      <td>0.962865</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<blockquote>
<div><p><strong>🙋‍♂️ Domanda 8</strong></p>
<p>Ci sono coppie di variabili che presentano correlazioni fortemente positive? Si confrontino i valori della matrice di covarianza con i relativi plot dello scatterplot. I due indicatori ci dicono la stessa cosa?</p>
</div></blockquote>
<p>È possibile specificare l’utilizzo di un indice di correlazione diverso passando un parametro al metodo <code class="docutils literal notranslate"><span class="pre">corr</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iris</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;spearman&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sepal_length</th>
      <th>sepal_width</th>
      <th>petal_length</th>
      <th>petal_width</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>sepal_length</th>
      <td>1.000000</td>
      <td>-0.166778</td>
      <td>0.881898</td>
      <td>0.834289</td>
    </tr>
    <tr>
      <th>sepal_width</th>
      <td>-0.166778</td>
      <td>1.000000</td>
      <td>-0.309635</td>
      <td>-0.289032</td>
    </tr>
    <tr>
      <th>petal_length</th>
      <td>0.881898</td>
      <td>-0.309635</td>
      <td>1.000000</td>
      <td>0.937667</td>
    </tr>
    <tr>
      <th>petal_width</th>
      <td>0.834289</td>
      <td>-0.289032</td>
      <td>0.937667</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iris</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;kendall&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sepal_length</th>
      <th>sepal_width</th>
      <th>petal_length</th>
      <th>petal_width</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>sepal_length</th>
      <td>1.000000</td>
      <td>-0.076997</td>
      <td>0.718516</td>
      <td>0.655309</td>
    </tr>
    <tr>
      <th>sepal_width</th>
      <td>-0.076997</td>
      <td>1.000000</td>
      <td>-0.185994</td>
      <td>-0.157126</td>
    </tr>
    <tr>
      <th>petal_length</th>
      <td>0.718516</td>
      <td>-0.185994</td>
      <td>1.000000</td>
      <td>0.806891</td>
    </tr>
    <tr>
      <th>petal_width</th>
      <td>0.655309</td>
      <td>-0.157126</td>
      <td>0.806891</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="correlation-plot">
<h4><span class="section-number">15.5.1. </span>Correlation Plot<a class="headerlink" href="#correlation-plot" title="Permalink to this heading">#</a></h4>
<p>Possiamo facilmente ottenere un correlation plot in <code class="docutils literal notranslate"><span class="pre">Seaborn</span></code> come segue:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">iris</span><span class="o">.</span><span class="n">corr</span><span class="p">(),</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1">#annot=True serve a stampare i valori di correlazione</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ef6e8b7b902c2f487d21e77a075f1d932234db5a000a2c0326828a259f9b6d14.png" src="../_images/ef6e8b7b902c2f487d21e77a075f1d932234db5a000a2c0326828a259f9b6d14.png" />
</div>
</div>
</section>
</section>
<section id="esercizi">
<h3><span class="section-number">15.6. </span>Esercizi<a class="headerlink" href="#esercizi" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><p>🧑‍💻 Esercizio 1</p>
<p>Considerando il dataset Titanic, si calcolino per ogni variabile la numerosità, la media, la deviazione standard, il minimo, il massimo, il valore mediano, il primo e il terzo quartile. Dopo aver calcolato i valori richiesti individualmente, si utilizzi il metodo <code class="docutils literal notranslate"><span class="pre">describe</span></code> per ottenere tali valori. Qual è la variabile più dispersa?</p>
</div></blockquote>
<blockquote>
<div><p>🧑‍💻 Esercizio 2</p>
<p>Considerando il dataset Titanic, per ognuna delle tre classi, si calcolino medie e varianze delle età dei passeggeri. In quale classe le età sono meno disperse? Quale classe contiene i soggetti più giovani? Si completi l’analisi con dei grafici a barre.</p>
</div></blockquote>
<blockquote>
<div><p>🧑‍💻 Esercizio 3</p>
<p>Si aggiunga al dataset Titanic una nuova colonna “Old” che assume valore pari a 1 per le osservazioni che presentano età superiore al valore medio e 0 altrimenti. Si calcoli dunque una crosstab che calcoli il numero di soggetti “anziani” (soggetti per i quali old è pari a 1) rispetto alle variabili Pclass e Sex. Si mostri un barplot a partire dalla tabella. In quale classe gli uomini tendono ad essere molto più anziani delle donne?</p>
</div></blockquote>
<blockquote>
<div><p>🧑‍💻 Esercizio 4</p>
<p>Si carichi il dataset mpg mediante la libreria seaborn (usare l’istruzione <code class="docutils literal notranslate"><span class="pre">t=sns.load_dataset('mpg')</span></code>). Si visualizzi la scatter matrix differenziando i colori dei punti a seconda dei valori della variabile <code class="docutils literal notranslate"><span class="pre">origin</span></code>. Chi produce le macchine più pesanti? Esistono coppie di variabili che costituiscono un fattore decisivo per distinguere una delle origini dalle altre?</p>
</div></blockquote>
<blockquote>
<div><p>🧑‍💻 Esercizio 5</p>
<p>Considerando il dataset <code class="docutils literal notranslate"><span class="pre">mpg</span></code>, si scelga un gruppo di variabili rispetto alle quali ottenere un diagramma a coordinate parallele. Che cosa possiamo inferire dal diagramma?</p>
</div></blockquote>
</section>
</section>
</div>
<div class="toctree-wrapper compound">
<span id="document-lectures/10_statistical_inference"></span><section class="tex2jax_ignore mathjax_ignore" id="statistical-inference">
<h2><span class="section-number">16. </span>Statistical Inference<a class="headerlink" href="#statistical-inference" title="Permalink to this heading">#</a></h2>
<p>So far, we have seen methods for describing a sample of data (descriptive statistics) and we have reasoned on abstract concepts using basic probability theory concepts. In practice, we are often interested in the properties of a <strong>population</strong>, rather than a sample or some abstract quantities. Examples are:</p>
<ul class="simple">
<li><p>What are the percentage of votes each candidate will get at an election?</p></li>
<li><p>What is the proportion of defective goods in a manufacturing process?</p></li>
<li><p>Is there a relationship between smoking and developing a given disease in the world population?</p></li>
</ul>
<p>One approach to answer these questions would be to collect the whole population, but this is often unfeasible (e.g., interviewing <strong>all voters</strong>) and sometimes impossible.</p>
<p>The statistician’s approach is instead to <strong>sample</strong> a subset of the whole population and try to <strong>infer some of the properties of the population from the sample</strong>. This part of statistics is called <strong>statistical inference</strong>. Analyzing data using such techniques is often called an <strong>inferential analysis</strong>. In this part of the course, we will review different statistical tools for inferential analysis and show some concrete examples, without giving a formal definition of such tools, which is left to other courses.</p>
<section id="sampling">
<h3><span class="section-number">16.1. </span>Sampling<a class="headerlink" href="#sampling" title="Permalink to this heading">#</a></h3>
<p>The first step towards an inferential analysis is the <strong>sampling process</strong>. When we acquire a pre-made dataset, sampling is already done, while when we collect data, we are actually sampling from the population. In both cases, it is important to reason on the properties of the sample we will work on.</p>
<section id="simple-random-sample">
<h4><span class="section-number">16.1.1. </span>Simple random sample<a class="headerlink" href="#simple-random-sample" title="Permalink to this heading">#</a></h4>
<p>The easiest way to sample from a population is <strong>randomly</strong>. A simple random sample makes two assumptions:</p>
<ul class="simple">
<li><p><strong>Unbiasedness</strong>: each element of the population has the same probability of being selected;</p></li>
<li><p><strong>Independence</strong>: selecting one of the elements of the population does not affect the selection of the other elements in any way.</p></li>
</ul>
<p>This approach guarantees that, if we collect a large number of elements, the obtained sample will be a good representative of the population. For instance, if in the population of interest we have <span class="math notranslate nohighlight">\(10\%\)</span> of people over <span class="math notranslate nohighlight">\(70\)</span>, we expect this proportion to be roughly represented in the sample as well.</p>
<p>An example of bad sampling:</p>
<blockquote>
<div><p>We want to ask the inhabitants of a city whether they are satisfied with the quality of life in that city. To sample a large quantity of subjects, we go to the main square and ask passengers to reply to a few questions. If a ground of friends stops we interview all of them to maximize the number of examples we can obtain.</p>
</div></blockquote>
<p>The sampling design outlined above has two important issues:</p>
<ul class="simple">
<li><p><strong>Unbiasedness</strong>: the selection process is biased (<strong>selection bias</strong>). We selected a single location in the city (the main square) and hence we are <strong>oversampling</strong> people who tend to spend time there (e.g., because they work in the city center), versus people who do not spend much time there (e.g., because they work in the periphery).</p></li>
<li><p><strong>Independence</strong>: when we interview groups of people, in fact, we are breaking the independence assumption, Indeed, selecting one of the people is not independent of selecting others (the members of the same group).</p></li>
</ul>
<p>Another example of flawed sampling:</p>
<blockquote>
<div><p>We want to check how many people believe a given conspiracy theory. To do so, I send a message to all my contacts (<span class="math notranslate nohighlight">\(500\)</span>). About <span class="math notranslate nohighlight">\(200\)</span> of them reply to my message and <span class="math notranslate nohighlight">\(180\)</span> of them say they do believe that theory. <span class="math notranslate nohighlight">\(80\%\)</span> of people actually believe it!</p>
</div></blockquote>
<p>Also here there are important issues:</p>
<ul class="simple">
<li><p><strong>Selection bias</strong>: I am not randomly sampling. Instead, I am choosing among my contacts.</p></li>
<li><p><strong>Response bias</strong>: Only <span class="math notranslate nohighlight">\(200\)</span> people replied. Chances are that only people who are very motivated will reply. Maybe most of the believers did, while the others just ignored my message.</p></li>
</ul>
<p>Another example:</p>
<blockquote>
<div><p>We interview people on their voting preferences by dialing random phone numbers.</p>
</div></blockquote>
<p>While this may seem sound, we will not end up with a simple random sample because we will not select people without a phone number and we will oversample people with more than one numbers (e.g., work and home).</p>
</section>
</section>
<section id="sample-size-and-standard-error">
<h3><span class="section-number">16.2. </span>Sample Size and Standard Error<a class="headerlink" href="#sample-size-and-standard-error" title="Permalink to this heading">#</a></h3>
<p>While the <strong>way we sample</strong> is fundamental, also its size is very important. Intuitively speaking, a survey on a small number of people is probably not very accurate. Indeed, we expect that, <strong>if the sample is small, it is easier to obtain a biased representation of the population by chance</strong>. In general, the larger the sample, the better, but is there a way to estimate what a good size would be for my sample?</p>
<p>Let’s consider this example:</p>
<blockquote>
<div><p>A factory produces chips. Among all chips produced, about <span class="math notranslate nohighlight">\(p\%\)</span> will be defective (i.e., a chip has probability <span class="math notranslate nohighlight">\(p\)</span> to be defective). We want to estimate this probability. To do it directly, we should test each chip. The defect rate <span class="math notranslate nohighlight">\(p\)</span> will be given by the fraction of defective chips: <span class="math notranslate nohighlight">\(p=\frac{x}{N}\)</span>, where <span class="math notranslate nohighlight">\(x\)</span> is the number of defective chips and <span class="math notranslate nohighlight">\(N\)</span> is the total number of chips. However, testing all chips would slow down production, so this is not feasible. Instead, we choose to test a random sample of all chips and estimate the defect rate from this sample: <span class="math notranslate nohighlight">\(\hat p = \frac{x}{n}\)</span>, where <span class="math notranslate nohighlight">\(n\)</span> is the sample size. Now the question is: given that my sample has size <span class="math notranslate nohighlight">\(n\)</span>, what is the error that I will likely make estimating <span class="math notranslate nohighlight">\(p\)</span> with <span class="math notranslate nohighlight">\(\hat p\)</span>?</p>
</div></blockquote>
<p>To answer this question, we need to introduce the concept of <strong>sampling distribution</strong>. What we expect is that, if we draw many random samples in the same way, we will end up with different estimates of <span class="math notranslate nohighlight">\(\hat p\)</span>. If these estimates are similar to each other, then the error will probably be small, but if these estimates will be significantly different, then my error is large.</p>
<p>For example, consider the following <span class="math notranslate nohighlight">\(10\)</span> samplings with size <span class="math notranslate nohighlight">\(50\)</span>:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Sample Size (n = 50)</p></th>
<th class="head"><p>Defective Chips (x)</p></th>
<th class="head"><p>Estimated Defect Rate (<span class="math notranslate nohighlight">\(\hat{p} = \frac{x}{n}\)</span>)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>50</p></td>
<td><p>0</p></td>
<td><p>0.000</p></td>
</tr>
<tr class="row-odd"><td><p>50</p></td>
<td><p>1</p></td>
<td><p>0.020</p></td>
</tr>
<tr class="row-even"><td><p>50</p></td>
<td><p>2</p></td>
<td><p>0.040</p></td>
</tr>
<tr class="row-odd"><td><p>50</p></td>
<td><p>4</p></td>
<td><p>0.080</p></td>
</tr>
<tr class="row-even"><td><p>50</p></td>
<td><p>3</p></td>
<td><p>0.060</p></td>
</tr>
<tr class="row-odd"><td><p>50</p></td>
<td><p>5</p></td>
<td><p>0.100</p></td>
</tr>
<tr class="row-even"><td><p>50</p></td>
<td><p>3</p></td>
<td><p>0.060</p></td>
</tr>
<tr class="row-odd"><td><p>50</p></td>
<td><p>2</p></td>
<td><p>0.040</p></td>
</tr>
<tr class="row-even"><td><p>50</p></td>
<td><p>1</p></td>
<td><p>0.020</p></td>
</tr>
<tr class="row-odd"><td><p>50</p></td>
<td><p>4</p></td>
<td><p>0.080</p></td>
</tr>
</tbody>
</table>
<p>If we repeat the experiment for a larger number of times (e.g., <span class="math notranslate nohighlight">\(1000\)</span>), we could imagine the distribution of <span class="math notranslate nohighlight">\(x\)</span> (number of defective chips) to follow a similar trend:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/5063273c8fe855a9ab31473e1c978c7688b4cebba12166b0c6a6b170fdff2b22.png" src="../_images/5063273c8fe855a9ab31473e1c978c7688b4cebba12166b0c6a6b170fdff2b22.png" />
</div>
</div>
<p>We can see a peak at about <span class="math notranslate nohighlight">\(2\)</span>, but there is some variability in the measurements. The variability is given by the fact that <span class="math notranslate nohighlight">\(50\)</span> is a small sample size. The plot below shows examples of what we would observe for different sample sizes:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/272d47a6b1ac33b6eab16ccb9db9fec0813a4e2b287ea07c8321592e534318f2.png" src="../_images/272d47a6b1ac33b6eab16ccb9db9fec0813a4e2b287ea07c8321592e534318f2.png" />
</div>
</div>
<p>As we can see, the mean is always around <span class="math notranslate nohighlight">\(0.05\)</span>, but the standard deviation decreases as the sample size increases. This suggests that <strong>the error in the estimation of the real defect rate decreases with large samples</strong>.</p>
<p>In practice, we can see the act of <strong>taking a random sample of size <span class="math notranslate nohighlight">\(50\)</span> ad a random experiment</strong> and introduce a random variable <span class="math notranslate nohighlight">\(X\)</span> depending on the sampling process. In particular we will define:</p>
<div class="math notranslate nohighlight">
\[X = \text{number of defective chips in the sample}\]</div>
<p>Also the estimated defect rate will be a random variable:</p>
<div class="math notranslate nohighlight">
\[\hat P = \frac{X}{n} \]</div>
<p>As can be noted, <span class="math notranslate nohighlight">\(X\)</span> can be modeled with a <strong>Binomial distribution</strong> (the probability of having <span class="math notranslate nohighlight">\(k\)</span> successes in a sequence of <span class="math notranslate nohighlight">\(n\)</span> independent experiments with probability <span class="math notranslate nohighlight">\(p\)</span>). Recall we have:</p>
<div class="math notranslate nohighlight">
\[E[X] = np\]</div>
<div class="math notranslate nohighlight">
\[Var[X] = np(1-p)\]</div>
<p>In turn we have:</p>
<div class="math notranslate nohighlight">
\[E[\hat P] = E[\frac{X}{n}]=p\]</div>
<div class="math notranslate nohighlight">
\[Var[\hat P] = Var\left[\frac{X}{n}\right] = \frac{p(1-p)}{n}\]</div>
<div class="math notranslate nohighlight">
\[Std[\hat P] = \frac{\sqrt{p(1-p)}}{\sqrt{n}}\]</div>
<p>If can be shown (but we will not see it formally) that for large values of <span class="math notranslate nohighlight">\(n\)</span>, <span class="math notranslate nohighlight">\(\hat P\)</span> will be approximately normal.</p>
<p>Note that the <span class="math notranslate nohighlight">\(Std[\hat P]\)</span> depends in fact on the true probability <span class="math notranslate nohighlight">\(p\)</span>, which is in general not available. So, in its place, it is common to consider the <strong>standard error</strong> of <span class="math notranslate nohighlight">\(\hat P\)</span>:</p>
<div class="math notranslate nohighlight">
\[SE(\hat p) = \frac{\sqrt{\hat p(1-\hat p)}}{\sqrt{n}}\]</div>
<p>Note that, since the sampling distribution of <span class="math notranslate nohighlight">\(\hat P\)</span> is approximately normal, a low standard deviation means that we are more accurately estimating the true mean <span class="math notranslate nohighlight">\(p\)</span>, hence we have a <strong>lower error</strong>.</p>
<p>We can see that, as we draw samples, the estimated probabilites <span class="math notranslate nohighlight">\(\hat p\)</span> will distribute around the mean value <span class="math notranslate nohighlight">\(p\)</span> with a standard deviation which is <strong>proportional</strong> to:</p>
<div class="math notranslate nohighlight">
\[\frac{1}{\sqrt{n}}\]</div>
<p>Very informally, we will say that:</p>
<div class="math notranslate nohighlight">
\[SE(\hat p) \propto \frac{1}{\sqrt{n}}\]</div>
<p><strong>This result is very important: if we want to reduce the error in the estimation of a property of the population, we need to increase the sample size.</strong></p>
<p>In our example above, if we set:</p>
<div class="math notranslate nohighlight">
\[n=50, p=0.05\]</div>
<p>we will have a standard error equal to:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.03
</pre></div>
</div>
</div>
</div>
<p>If we set <span class="math notranslate nohighlight">\(n=1000\)</span>, we obtain a standard error of about:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.01
</pre></div>
</div>
</div>
</div>
</section>
<section id="confidence-intervals">
<h3><span class="section-number">16.3. </span>Confidence Intervals<a class="headerlink" href="#confidence-intervals" title="Permalink to this heading">#</a></h3>
<p>We have seen that, if we try to estimate the true defect rate <span class="math notranslate nohighlight">\(p\)</span> from a sample of size <span class="math notranslate nohighlight">\(n\)</span>, then the estimated rate <span class="math notranslate nohighlight">\(\hat p\)</span> will be characterized by a standard error of:</p>
<div class="math notranslate nohighlight">
\[SE(\hat p) = \frac{\sqrt{\hat p(1-\hat p)}}{\sqrt{n}}\]</div>
<p>If we fix <span class="math notranslate nohighlight">\(p\)</span> (this is the value we want to estimate, we don’t have much control on it), then small values of <span class="math notranslate nohighlight">\(n\)</span> will lead to large errors, while large values of <span class="math notranslate nohighlight">\(n\)</span> will lead to small errors. In particular, a sample <strong><span class="math notranslate nohighlight">\(4\)</span> times bigger will reduce the error by <span class="math notranslate nohighlight">\(\frac{1}{2}\)</span></strong>.</p>
<p>So what should we do to obtain a small error? We should certainly take a large sample. However, sampling is generally costly, so it is not always possible to take large samples. Moreover, how large should a sample be to obtain a small enough error?</p>
<p>Let’s suppose <strong>we accept a maximum defect rate of <span class="math notranslate nohighlight">\(5\%\)</span></strong>, meaning that, if the defect rate is larger than <span class="math notranslate nohighlight">\(5\%\)</span>, then it is not convenient anymore to keep the current pipeline. We take a sample of <span class="math notranslate nohighlight">\(500\)</span> chips and find that <span class="math notranslate nohighlight">\(20\)</span> are defective. We compute a defect rate of:</p>
<div class="math notranslate nohighlight">
\[\hat p = \frac{20}{500} = 0.04\]</div>
<p>which is below <span class="math notranslate nohighlight">\(0.05\)</span>.</p>
<p>Are we happy? We actually know that this is <strong>one of the values that we may have obtained considering a sample of <span class="math notranslate nohighlight">\(500\)</span> chips from the population</strong>. We also know that these numbers follow a Gaussian distribution of mean <span class="math notranslate nohighlight">\(p\)</span> and standard deviation</p>
<div class="math notranslate nohighlight">
\[\sigma(\hat p) = \frac{\sqrt{p(1-p)}}{\sqrt{n}}\]</div>
<p>Recall that about <span class="math notranslate nohighlight">\(68.3\%\)</span> of the density of the Gaussian distribution will be within <span class="math notranslate nohighlight">\(p-\sigma(\hat p)\)</span> and <span class="math notranslate nohighlight">\(p+\sigma(\hat p)\)</span>, so we can write:</p>
<div class="math notranslate nohighlight">
\[P\left(p-\sigma(\hat p)\leq \hat p \leq p+\sigma(\hat p)\right) = 0.683\]</div>
<p>Which means that, if we perform several independent samplings, with sample size <span class="math notranslate nohighlight">\(n\)</span>, the probability of obtaining a defect rate <span class="math notranslate nohighlight">\(\hat p\)</span> in the range <span class="math notranslate nohighlight">\([p-\sigma(\hat p), p+\sigma(\hat p)]\)</span> is <span class="math notranslate nohighlight">\(68.3\%\)</span>.</p>
<p>It is easy to show that:</p>
<div class="math notranslate nohighlight">
\[\hat p \in [p-\sigma(\hat p), p+\sigma(\hat p)] \Leftrightarrow p \in [\hat p-\sigma(\hat p), \hat p+\sigma(\hat p)]\]</div>
<p>This is graphically shown in the plot below. The blue segment is the one of bounds <span class="math notranslate nohighlight">\([p-\sigma(\hat p), p+\sigma(\hat p)]\)</span>. Note that, all times a point <span class="math notranslate nohighlight">\(\hat p\)</span> happens to be in the blue segment centered around <span class="math notranslate nohighlight">\(p\)</span>, then <span class="math notranslate nohighlight">\(p\)</span> is in the segment centered around <span class="math notranslate nohighlight">\(\hat p\)</span>.</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/16b3a7bc4de69f70e1c0ed0f324bf9ac59c85609cad1df9bb3c7c4b289435447.png" src="../_images/16b3a7bc4de69f70e1c0ed0f324bf9ac59c85609cad1df9bb3c7c4b289435447.png" />
</div>
</div>
<p>This allows us to write:</p>
<div class="math notranslate nohighlight">
\[P\left(\hat p-\sigma(\hat p)\leq p \leq \hat p+\sigma(\hat p)\right) = 0.683\]</div>
<p>which has a powerful interpretation:</p>
<blockquote>
<div><p>If we draw many independent samples of size <span class="math notranslate nohighlight">\(n\)</span> and compute <span class="math notranslate nohighlight">\(\hat p\)</span> from the samples, the true mean <span class="math notranslate nohighlight">\(p\)</span> will lie in the interval <span class="math notranslate nohighlight">\([\hat p-\sigma(\hat p), \hat p+\sigma(\hat p)]\)</span> <span class="math notranslate nohighlight">\(68.3\%\)</span> of the times</p>
</div></blockquote>
<p>Alternatively</p>
<blockquote>
<div><p>We can say with a confidence of <span class="math notranslate nohighlight">\(68.3\%\)</span> that the true mean will be in the <span class="math notranslate nohighlight">\([\hat p-\sigma(\hat p), \hat p+\sigma(\hat p)]\)</span> interval</p>
</div></blockquote>
<p>In this context, <span class="math notranslate nohighlight">\([\hat p-\sigma(\hat p), \hat p+\sigma(\hat p)]\)</span> is called a <strong>confidence interval</strong>.</p>
<p>We still have to compute actual numbers for our confidence interval, but we don’t have the standard deviation <span class="math notranslate nohighlight">\(\sigma(\hat p)\)</span>. In practice, we replace it with the standard error and obtain the confidence interval:</p>
<div class="math notranslate nohighlight">
\[[\hat p-SE(\hat p), \hat p+SE(\hat p)]\]</div>
<p>In our case:</p>
<div class="math notranslate nohighlight">
\[\hat p = \frac{20}{500} = 0.04\]</div>
<div class="math notranslate nohighlight">
\[SE(\hat p) = \frac{\sqrt{\hat p(1-\hat p)}}{\sqrt{n}} = \frac{\sqrt{\hat p(1-\hat p)}}{\sqrt{n}} = \frac{\sqrt{\hat 0.4(1-0.4)}}{\sqrt{500}} = 0.009\]</div>
<p>Hence our confidence interval will be:</p>
<div class="math notranslate nohighlight">
\[[0.04-0.009, 0.04+0.009] = [0.031,0.049]\]</div>
<p>We can say with <span class="math notranslate nohighlight">\(68\%\)</span> confidence that <span class="math notranslate nohighlight">\(\hat p\)</span> will be between <span class="math notranslate nohighlight">\(3.1\%\)</span> and <span class="math notranslate nohighlight">\(4.9\%\)</span>. This looks like good news, the maximum defect rate is still under <span class="math notranslate nohighlight">\(5\%\)</span>!</p>
<p>However, a <span class="math notranslate nohighlight">\(68\%\)</span> confidence seems to be rather low - still, in <span class="math notranslate nohighlight">\(32\%\)</span> of the cases, the true defect rate could be outside the confidence interval. What can we do to increase confidence? Well, we know that about <span class="math notranslate nohighlight">\(95.5\%\)</span> of the density of the Gaussian distribution is between <span class="math notranslate nohighlight">\(-2\sigma\)</span> and <span class="math notranslate nohighlight">\(2\sigma\)</span>. We can update our confidence interval as:</p>
<div class="math notranslate nohighlight">
\[[\hat p-2SE(\hat p), \hat p+2SE(\hat p)] = [0.022, 0.058]\]</div>
<p>Now we can say with <span class="math notranslate nohighlight">\(95.5\%\)</span> confidence that the true defect rate will be in the <span class="math notranslate nohighlight">\([0.022, 0.058]\)</span>. What happened? To increase our confidence, we obtained a larger range. Of course, we could say that the true defect rate is comprised between <span class="math notranslate nohighlight">\([0,1]\)</span> with <span class="math notranslate nohighlight">\(100\%\)</span> probability!</p>
<p>Our “new” confidence interval does not support our hypothesis that the defect rate is under <span class="math notranslate nohighlight">\(0.05\)</span>, but at the same time, it’s a very large interval…it does not refute the hypothesis either. <strong>How can we narrow this interval?</strong> We know that, if we had a larger <span class="math notranslate nohighlight">\(n\)</span>, our standard error would be smaller. We hence increase our sample and check another set of <span class="math notranslate nohighlight">\(1500\)</span> boards. We get <span class="math notranslate nohighlight">\(82\)</span> defective boards over the <span class="math notranslate nohighlight">\(2000\)</span> we tested, with an estimated defect rate:</p>
<div class="math notranslate nohighlight">
\[\hat p = \frac{82}{1000} = 0.41\]</div>
<p>The standard error is:</p>
<div class="math notranslate nohighlight">
\[SE(\hat p) = \frac{\sqrt{\hat p(1-\hat p)}}{\sqrt{n}} = \frac{\sqrt{\hat p(1-\hat p)}}{\sqrt{n}} = \frac{\sqrt{\hat 0.41(1-0.41)}}{\sqrt{2000}} = 0.004\]</div>
<p>The updated confidence interval with <span class="math notranslate nohighlight">\(95.5\%\)</span> confidence will be:</p>
<div class="math notranslate nohighlight">
\[[\hat p-2SE(\hat p), \hat p+2SE(\hat p)] = [0.033, 0.049]\]</div>
<p>We now have a reasonably narrow confidence interval at a <span class="math notranslate nohighlight">\(95.5\%\)</span> confidence level. Moreover, our “maximum” true defect rate will be lower than <span class="math notranslate nohighlight">\(0.49\)</span>, so we are happy about the result.</p>
<p>What if we wanted to be sure at exactly <span class="math notranslate nohighlight">\(99\%\)</span>? Well in that case we can use the inverse of the CDF (which is called a PPF) and compute the right multiplier <span class="math notranslate nohighlight">\(\alpha\)</span> in order to compute the confidence interval:</p>
<div class="math notranslate nohighlight">
\[[\hat p-\alpha SE(\hat p), \hat p+\alpha SE(\hat p)]\]</div>
<p>We will not see it into details, but for <span class="math notranslate nohighlight">\(99\%\)</span> we will get:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>alpha = 2.5758
Confidence interval: [0.030, 0.052]
</pre></div>
</div>
</div>
</div>
<p>We’re not very happy about this result, the true defect rate could be larger than <span class="math notranslate nohighlight">\(5\%\)</span>. What can we do? Again, we could collect a larger sample to narrow down the confidence interval.</p>
</section>
<section id="bias-and-variance-of-estimators">
<h3><span class="section-number">16.4. </span>Bias and Variance of Estimators<a class="headerlink" href="#bias-and-variance-of-estimators" title="Permalink to this heading">#</a></h3>
<p>In the example above, we have seen that we can use the formula</p>
<div class="math notranslate nohighlight">
\[\hat p = \frac{x}{n}\]</div>
<p>as a way to estimate the true value of <span class="math notranslate nohighlight">\(p\)</span>. We will call the formula above an <strong>estimator</strong>, while its result <span class="math notranslate nohighlight">\(\hat p\)</span>, an <strong>estimate</strong>.</p>
<p>Let again consider the random variable arising from multiple random samples:</p>
<div class="math notranslate nohighlight">
\[\hat P = \frac{X}{n}\]</div>
<p>We expect that this estimator will give different results depending on sampling, leading to a distribution of values. In practice, it is important to measure two important aspects of an estimator, namely, its <strong>bias</strong> and its <strong>variance</strong>.</p>
<section id="bias-of-an-estimator">
<h4><span class="section-number">16.4.1. </span>Bias of an Estimator<a class="headerlink" href="#bias-of-an-estimator" title="Permalink to this heading">#</a></h4>
<p>Let <span class="math notranslate nohighlight">\(X\)</span> be a random variable (e.g., the heights of all people in the world) and let <span class="math notranslate nohighlight">\(x=(x_1,x_2,\ldots,x_n)\)</span> be a realization of <span class="math notranslate nohighlight">\(X\)</span> (a sample from the population). Let <span class="math notranslate nohighlight">\(T(X)\)</span> be an estimator of the true value <span class="math notranslate nohighlight">\(\phi\)</span> depending on the variable <span class="math notranslate nohighlight">\(X\)</span>. For instance, <span class="math notranslate nohighlight">\(\phi\)</span> could be the mean value of all heights. <span class="math notranslate nohighlight">\(T(X)\)</span> is then an estimator of the mean and <span class="math notranslate nohighlight">\(\hat \phi = T(x)\)</span> is the estimate we obtain considering the sample <span class="math notranslate nohighlight">\(x\)</span>, for instance:</p>
<div class="math notranslate nohighlight">
\[T(x) = \frac{\sum_{i=1}^n x_i}{n}\]</div>
<p>Note that <strong><span class="math notranslate nohighlight">\(T(x)\)</span> is a random variable</strong>, while <span class="math notranslate nohighlight">\(T(x)\)</span> is the value we obtain when we consider the realization <span class="math notranslate nohighlight">\(x\)</span>.</p>
<p>We will define the <strong>bias</strong> of the estimator as:</p>
<div class="math notranslate nohighlight">
\[Bias_\theta (T(X)) = E_\theta[T(X)] - \phi\]</div>
<p>That is to say, the <strong>difference between the expected value of the estimate (under different samplings) minus the true value of the quantity we are trying to estimate</strong>.</p>
<p>We will say that an estimator <span class="math notranslate nohighlight">\(T(X)\)</span> is an unbiased estimator of <span class="math notranslate nohighlight">\(\phi\)</span> if:</p>
<div class="math notranslate nohighlight">
\[E_\theta[T(X)] = \phi\]</div>
<p>or equivalently:</p>
<div class="math notranslate nohighlight">
\[Bias_{\phi}(T(X)) = 0\]</div>
<p>The bias indicates if the estimator <strong>systematically underestimate or overestimate the property of the population we are interested in</strong>. A bias equal to zero means that, <strong>on average</strong> our estimates will be close to true value. This means that, if we could perform sampling many times and take the average of the estimates, we would get a value close to the true one.</p>
<section id="unbiased-estimators-for-sample-mean-and-variance">
<h5><span class="section-number">16.4.1.1. </span>Unbiased Estimators for Sample Mean and Variance<a class="headerlink" href="#unbiased-estimators-for-sample-mean-and-variance" title="Permalink to this heading">#</a></h5>
<p>Let us consider a univariate sample <span class="math notranslate nohighlight">\(\{X^{(i)}\}_{i=1}^n\)</span>. The mean estimator:</p>
<div class="math notranslate nohighlight">
\[
\overline x = \frac{1}{n} \sum_{i=0}^{n} x^{(i)};
\]</div>
<p>is unbiased. This means that <strong>if we draw a large number of random samples, we compute their mean and then we compute the mean of their mean, this last value will converge to the population mean as the sample size <span class="math notranslate nohighlight">\(n\)</span> gets larger</strong>.</p>
<p>The estimator for the variance:</p>
<div class="math notranslate nohighlight">
\[
s_n^2=\frac{1}{n}\sum_{i=0}^{n}(x^{(i)}-\overline x)^2
\]</div>
<p>is known to be <strong>biased</strong>. In practice, it can be shown that this estimator systematically underestimates the variance. In particular:</p>
<div class="math notranslate nohighlight">
\[
\mathbf{E}[s_n^2]=\frac{n-1}{n}\sigma^2
\]</div>
<p>where <span class="math notranslate nohighlight">\(\sigma^2\)</span> is the variance of the population. An unbiased estimator for the variance is given by:</p>
<div class="math notranslate nohighlight">
\[
s_{n-1}^2=\frac{1}{n-1}\sum_{i=0}^{n}(x^{(i)}-\overline x)^2
\]</div>
<p>Note that this approaches to <span class="math notranslate nohighlight">\(s_{n}^2\)</span> as <span class="math notranslate nohighlight">\(n \to \infty\)</span>. In practice:</p>
<ul class="simple">
<li><p>When <span class="math notranslate nohighlight">\(n\)</span> is small, it does make sense to use the unbiased estimator <span class="math notranslate nohighlight">\(s_{n-1}^2\)</span> if we want to estimate the variance of the population;</p></li>
<li><p>When <span class="math notranslate nohighlight">\(n\)</span> is very large, the two estimates will be similar (often equivalent).</p></li>
</ul>
</section>
</section>
<section id="variance-of-an-estimator">
<h4><span class="section-number">16.4.2. </span>Variance of an Estimator<a class="headerlink" href="#variance-of-an-estimator" title="Permalink to this heading">#</a></h4>
<p>The variance of <span class="math notranslate nohighlight">\(T(X)\)</span> is defined as:</p>
<div class="math notranslate nohighlight">
\[Var_\phi(T(X)) = E[(T(X)-E(T(X)))^2]\]</div>
<p>That is, the variance of the random variable T(X). The variance measures another characteristic of the estimator, telling us <strong>how disperse the different estimates will be</strong>. A low variance indicates that, if we perform sampling multiple times and take different estimates, we <strong>end up with similar values</strong>. A high variance indicates that different samplings will lead to drastically different estimates.</p>
</section>
<section id="bias-variance-tradeoff">
<h4><span class="section-number">16.4.3. </span>Bias-Variance Tradeoff<a class="headerlink" href="#bias-variance-tradeoff" title="Permalink to this heading">#</a></h4>
<p>Ideally, we would like our estimates to have <strong>low variance and low bias</strong>. Indeed, in this case we would be sure that each estimate will be close to the true value. Indeed, since we have <strong>low variance</strong> estimates will be close to each other, while, since we have <strong>low bias</strong> the average (and hence all estimates) will be close to the true value.</p>
<p>In practice, we can distinguish four cases, described in the plot below. In the plot, the true value is the center of the circle, while each point is a different estimate. The circle represents a range of values which we may define as <strong>acceptable estimates</strong>. Alternatively, we can see the circe as a target and each estimate as a dart we are throwing at the target.</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/02c559276766f7a717f8cb62072d5383c7d2707f34c41363214b17416c680e2f.png" src="../_images/02c559276766f7a717f8cb62072d5383c7d2707f34c41363214b17416c680e2f.png" />
</div>
</div>
<p>The four cases are:</p>
<ul class="simple">
<li><p>Low bias, low variance: all estimates will be close to the true value;</p></li>
<li><p>Low bias, high variance: in average, estimates will be close to the true value, but different estimates may greatly differ;</p></li>
<li><p>High bias, low variance: while different estimates will be similar, they all are very far away from the true value;</p></li>
<li><p>High bias, high variance: we don’t have many guarantees - estimates will all be different, but also far from the real value, even in average.</p></li>
</ul>
<p>It’s clear that having low bias and low variance is desirable, but, as we will see, this is not always easy to achieve. In practice, we’ll see that in many cases it there is a trade-off between bias and variance, meaning that <strong>we can tweak our estimator to find a balance between these two properties</strong>.</p>
</section>
</section>
<section id="sampling-distribution-of-the-mean">
<h3><span class="section-number">16.5. </span>Sampling Distribution of the Mean<a class="headerlink" href="#sampling-distribution-of-the-mean" title="Permalink to this heading">#</a></h3>
<p>Let us now consider another example. Besides producing non-defective chips, our facility also manufactures specific electronic components which need to have a given diameter. The process requires high precision, so we need the diameters of these components all equal to the same value of <span class="math notranslate nohighlight">\(0.1nm\)</span> with very small deviations allowed.</p>
<p>We sample <span class="math notranslate nohighlight">\(n=1000\)</span> of such components and measure their diameters <span class="math notranslate nohighlight">\(x_1,\ldots,x_n\)</span>. We then compute the mean, obtaining:</p>
<div class="math notranslate nohighlight">
\[\overline x = \frac{x_1+x_2+\ldots+x_n}{n} = 0.1001nm\]</div>
<p>This value is close to <span class="math notranslate nohighlight">\(1.1nm\)</span>, so we could conclude that the quality of the production process is good enough. However, we can imagine how, if we drew another sample, we could obtain a slightly different result. The questions are <strong>“how close that result would be to the one we obtained”</strong> and <strong>“how close this result is to the population mean”</strong>.</p>
<p>Similarly to what we observed in the case of the defect rate, we can see the diameter of a single component as a random variable <span class="math notranslate nohighlight">\(X_i\)</span>. We will have:</p>
<div class="math notranslate nohighlight">
\[E[X_i] = \mu\]</div>
<div class="math notranslate nohighlight">
\[Std[X_i] = \sigma\]</div>
<p>Where <span class="math notranslate nohighlight">\(\mu\)</span> and <span class="math notranslate nohighlight">\(\sigma\)</span> are the population mean and standard deviation. The average of the diameters of the components in our sample will be in turn a new random variable:</p>
<div class="math notranslate nohighlight">
\[\overline X = \frac{X_1+X_2+\ldots+X_n}{n}\]</div>
<p>We will have:</p>
<div class="math notranslate nohighlight">
\[E[\overline X] = \mu\]</div>
<div class="math notranslate nohighlight">
\[Std[\overline X] = \frac{\sigma}{\sqrt{n}}\]</div>
<p>Again, the standard deviation is proportional to <span class="math notranslate nohighlight">\(\frac{1}{\sqrt{n}}\)</span>.</p>
<p>While in the previous case, the shape of each <span class="math notranslate nohighlight">\(X_i\)</span> variable was binomial (and hence similar to Gaussian), in this case, we cannot make any assumption on the shape of <span class="math notranslate nohighlight">\(X_i\)</span>. However, the <strong>central limit theorem</strong> guarantees that, when <span class="math notranslate nohighlight">\(n\)</span> is large, <span class="math notranslate nohighlight">\(\overline X\)</span> will indeed <strong>follow a Gaussian distribution</strong>.</p>
<p>This result allow us to characterize the distribution of the means, which is useful to understand if our production is high quality enough.</p>
<p>However, we still have two problems:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\overline X\)</span> is Gaussian only for large values of <span class="math notranslate nohighlight">\(n\)</span>;</p></li>
<li><p>We need the true standard deviation <span class="math notranslate nohighlight">\(\sigma\)</span>.</p></li>
</ul>
<p>To overcome these problems, we will replace the true standard deviation <span class="math notranslate nohighlight">\(\sigma\)</span> with the <strong>next best thing</strong>, the standard deviation of the sample:</p>
<div class="math notranslate nohighlight">
\[s_{n-1} = \frac{1}{n-1}\sum_{i=1}^n (x_i - \overline x)^2\]</div>
<p>We still know that <strong>the distribution will be Gaussian only for large values of n</strong>. In practice, it turns out that <span class="math notranslate nohighlight">\(\overline X\)</span> follows a similar distribution for an arbitrary <span class="math notranslate nohighlight">\(n\)</span>, the t-Student distribution.</p>
<p>More specifically, we will say that the standardized variable:</p>
<div class="math notranslate nohighlight">
\[t_{n-1} = \frac{\overline X - \mu}{s_{n-1}/\sqrt{n}}\]</div>
<p>follows a t-Student distribution with <span class="math notranslate nohighlight">\(n-1\)</span> degrees of freedom. <strong>This standardized form will be useful when we’ll talk about hypothesis tests</strong>. The t-Student distribution looks like a Gaussian, but it is more uncertain than a Gaussian for small values of <span class="math notranslate nohighlight">\(n\)</span>, as shown in the following:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/74fb663fb4122c820977d8e96ac4aabd65caee8593a96357435edc6178bedaf8.png" src="../_images/74fb663fb4122c820977d8e96ac4aabd65caee8593a96357435edc6178bedaf8.png" />
</div>
</div>
<p>As <span class="math notranslate nohighlight">\(n\)</span> gets larger, the t-Distribution approximates a Gaussian distribution.</p>
<p>We can now characterize how the means will distribute. In particular, <strong>for large values of <span class="math notranslate nohighlight">\(n\)</span>, sample means will distribute according to a Gaussian distribution with standard deviation equal to the sample standard deviation</strong>.</p>
<section id="confidence-intervals-for-the-mean">
<h4><span class="section-number">16.5.1. </span>Confidence Intervals for the Mean<a class="headerlink" href="#confidence-intervals-for-the-mean" title="Permalink to this heading">#</a></h4>
<p>Now that we know that sample means follow a t-Student distribution, we can use this result to compute confidence intervals for the mean. Let’s consider again our example in which we wanted to assess the average diameter of our components. Suppose we measured:</p>
<div class="math notranslate nohighlight">
\[\overline x = 0.1001nm\]</div>
<div class="math notranslate nohighlight">
\[s_{n-1} = 0.01nm\]</div>
<p>with a sample of <span class="math notranslate nohighlight">\(n=1000\)</span> measurements.</p>
<p>We know that the random variable <span class="math notranslate nohighlight">\(\overline X\)</span> will distribute according to a t-Student distribution with <span class="math notranslate nohighlight">\(n-1\)</span> degrees of freedom:</p>
<div class="math notranslate nohighlight">
\[\frac{\overline X-\mu}{s/\sqrt{n}}\]</div>
<p>Using the inverse of the CDF function (we will not see the details), we find out that <span class="math notranslate nohighlight">\(95\%\)</span> of the density is included between <span class="math notranslate nohighlight">\(-1.96\sigma\)</span> and <span class="math notranslate nohighlight">\(1.96\sigma\)</span>. We hence write:</p>
<div class="math notranslate nohighlight">
\[0.95 = P(\overline X -1.96 SE(\overline X) \leq \mu \leq \overline X + 1.96 SE(\overline X))\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[SE (\overline X) = \frac{s_{n-1}}{\sqrt{n}} = \frac{0.01}{\sqrt{1000}} = 0.0003\]</div>
<p>From which, we get the following confidence interval for a <span class="math notranslate nohighlight">\(95\%\)</span> confidence:</p>
<div class="math notranslate nohighlight">
\[[0.1001 - 1.96 \cdot 0.0003, 0.1001 + 1.96 \cdot 0.0003 ] = [0.0995, 0.1006]\]</div>
<p>Since the deviations are small, we can say that our estimation of the mean is accurate.</p>
</section>
<section id="computing-confidence-intervals-in-practice">
<h4><span class="section-number">16.5.2. </span>Computing Confidence Intervals in Practice<a class="headerlink" href="#computing-confidence-intervals-in-practice" title="Permalink to this heading">#</a></h4>
<p>We have seen how to compute confidence interval “by hand” in the case of the estimation of proportions (defect rate).In practice, depending on the quantities for which we want to estimate confidence bounds, we will need to use different distributions. For instance, when estimating means, we will have to use the t-Student distribution with <span class="math notranslate nohighlight">\(n-1\)</span> degrees of freedom. We will not see all methods in detail, but the main libraries implement all confidence bounds estimation procedure for us.</p>
<p>The main estimation procedures are related to:</p>
<ul class="simple">
<li><p>Estimation of confidence bounds for means;</p></li>
<li><p>Estimation of confidence bounds for variances;</p></li>
<li><p>Estimation of confidence bounds for proportions.</p></li>
</ul>
<p>We will see how to compute these practically in the laboratory sessions.</p>
</section>
</section>
<section id="hypothesis-testing">
<h3><span class="section-number">16.6. </span>Hypothesis Testing<a class="headerlink" href="#hypothesis-testing" title="Permalink to this heading">#</a></h3>
<p>Confidence bounds provide a set of plausible values for a given statistic of a population estimated from a sample (e.g., the mean, proportions, etc.). A hypothesis test instead attempts to refute a specific claim about the statistic. Examples of hypotheses to be refuted are:</p>
<ul class="simple">
<li><p>The population mean is equal to <span class="math notranslate nohighlight">\(0.1\)</span>;</p></li>
<li><p>The means of two populations (e.g., two different production processes) are equal;</p></li>
<li><p>Proportions of males and females are equally distributed in a given population (e.g., the employees of a company).</p></li>
</ul>
<p>If the hypothesis is rejected, we conclude that it is not true. Otherwise, we cannot really prove that it is false, so it makes sense to act as it is were true.</p>
<section id="hypothesis-testing-for-means">
<h4><span class="section-number">16.6.1. </span>Hypothesis Testing for Means<a class="headerlink" href="#hypothesis-testing-for-means" title="Permalink to this heading">#</a></h4>
<p>We get back to our example of estimating the average diameter of manufactured components. We set our machines to produce components of a diameter of exactly <span class="math notranslate nohighlight">\(0.1nm\)</span> and find an empirical average of <span class="math notranslate nohighlight">\(0.1001nm\)</span> with a standard deviation of <span class="math notranslate nohighlight">\(0.003\)</span>. We imagine the difference is due to small errors in measurement, calculation, or manufacturing, so we are keen to conclude that <strong>the population mean is indeed <span class="math notranslate nohighlight">\(\mu = 0.1nm\)</span></strong>.</p>
<p>Our boss objects that this may not be the case, and the population mean is not <span class="math notranslate nohighlight">\(0.1nm\)</span>. He formulates a test to confute the following hypothesis, that he calls the <strong>null hypothesis</strong>:</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(H_0\)</span>: the mean of the population is equal to <span class="math notranslate nohighlight">\(\mu_0=0.1nm\)</span></p>
</div></blockquote>
<p>He also defines an <strong>alternative hypothesis</strong>, that he is trying to prove:</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(H_a\)</span>: the mean of the population is different from <span class="math notranslate nohighlight">\(\mu\)</span></p>
</div></blockquote>
<p>Before proceeding, you ask your boss if he is going to accept any margin of error. He answers that he can tolerate a <span class="math notranslate nohighlight">\(5\%\)</span> margin of error, i.e., he can tolerate to wrongly reject the null hypothesis and accept the alternative hypothesis only <span class="math notranslate nohighlight">\(5\%\)</span> of the times. We will call this value the <strong>significance level</strong>.</p>
<p>We hence ask ourselves <strong>“how much does the computed mean <span class="math notranslate nohighlight">\(\overline x=0.1001nm\)</span> deviates from the assumed one <span class="math notranslate nohighlight">\(\mu_0=0.1nm\)</span>”</strong>? that is to say <strong>“how large is the difference <span class="math notranslate nohighlight">\(|\overline x - \mu|\)</span>”</strong>?</p>
<p>More specifically, we ask ourselves, <strong>“what is the probability of observing a difference larger than <span class="math notranslate nohighlight">\(|\overline x - \mu|\)</span> if we repeat sampling many times”</strong>? We know that the answer to this question depends on the distribution of the sample means. Since we know that the means follow a t-Student distribution, then also <span class="math notranslate nohighlight">\(\overline x - \mu\)</span> will follow a t-Student distribution. We z-score such difference and compute the test statistic:</p>
<div class="math notranslate nohighlight">
\[t = \frac{\overline x - \mu_0}{s_{n-1}/\sqrt{n}} = 1.054\]</div>
<ul class="simple">
<li><p>If we perform sampling and obtain a deviation larger than <span class="math notranslate nohighlight">\(|\overline x - \mu|\)</span>, then we will observe a statistic <span class="math notranslate nohighlight">\(z\)</span> larger than <span class="math notranslate nohighlight">\(t\)</span>.</p></li>
<li><p>If we perform sampling and obtain a deviation smaller than <span class="math notranslate nohighlight">\(-|\overline x - \mu|\)</span>, then we will observe a statistic <span class="math notranslate nohighlight">\(z\)</span> smaller than <span class="math notranslate nohighlight">\(-t\)</span>.</p></li>
</ul>
<p>The probability of obtaining such extreme results is given by:</p>
<div class="math notranslate nohighlight">
\[P(|z|&gt;|t|)\]</div>
<p>We call this probability <span class="math notranslate nohighlight">\(p-value\)</span>.</p>
<p>The p-value is the area under the shaded curve in the plot below:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/90657d60c5ba2a302dc1c9e2a56be57a3be405d912dfc02548c1bfd921aa9983.png" src="../_images/90657d60c5ba2a302dc1c9e2a56be57a3be405d912dfc02548c1bfd921aa9983.png" />
</div>
</div>
<p>Since the t-Student distribution is symmetrical, we can easily compute this value as:</p>
<div class="math notranslate nohighlight">
\[2(1-CDF_t(t))\]</div>
<p>In our case, we obtain:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.29
</pre></div>
</div>
</div>
</div>
<p>This is a large number! How to interpret it?</p>
<blockquote>
<div><p>If the true mean is <span class="math notranslate nohighlight">\(\mu=0.1\)</span> and we repeat sampling many times (<span class="math notranslate nohighlight">\(n=1000\)</span>), then <span class="math notranslate nohighlight">\(30\%\)</span> of the times we obtain a deviation more extreme than the observed one.</p>
</div></blockquote>
<p>We now compare this number to the significance level of <span class="math notranslate nohighlight">\(5\%\)</span>. If we reject the null hypothesis, we risk to make a mistake <span class="math notranslate nohighlight">\(30\%\)</span> of times, which is above the threshold of <span class="math notranslate nohighlight">\(5\%\)</span>. Hence, <strong>we cannot reject the null hypothesis</strong> under the circumstances.</p>
<p>Does this mean that the two means are the same? We don’t know, the test does not tell us what to do in this case! But we may try to collect more measurements hoping to reduce uncertainty.</p>
<p>Our boss wants to prove us wrong, so they collect a total of <span class="math notranslate nohighlight">\(n=5000\)</span> examples and obtains:</p>
<div class="math notranslate nohighlight">
\[\overline x = 0.10009\]</div>
<div class="math notranslate nohighlight">
\[s_{n-1} = 0.0031\]</div>
<p>The mean has decreased a little and the standard deviation has increased marginally. These numbers seem to agree with our previous results. We recompute the statistic and obtain:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.05
</pre></div>
</div>
</div>
</div>
<p>We hence compute our p-value:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.04
</pre></div>
</div>
</div>
</div>
<p>This p-value is now below the threshold of <span class="math notranslate nohighlight">\(5\%\)</span>. We can now reject the null hypothesis and conclude that the population mean is different from <span class="math notranslate nohighlight">\(0.1\)</span>. The boss was right, there’s something wrong with the process!</p>
<section id="one-tailed-tests">
<h5><span class="section-number">16.6.1.1. </span>One-tailed Tests<a class="headerlink" href="#one-tailed-tests" title="Permalink to this heading">#</a></h5>
<p>The tests seen above is a “two-tailed test” in which we summed the areas in the two tails of the distribution. Depending on the form of the alternative hypothesis, in particular:</p>
<ul class="simple">
<li><p>If the alternative hypothesis has the form <span class="math notranslate nohighlight">\(\mu \neq \mu_0\)</span>, then we want to check when the deviation from the assumed mean is larger than the observed one: <span class="math notranslate nohighlight">\(P(|x| &gt; |z|)\)</span>;</p></li>
<li><p>If the alternative hypothesis has the form <span class="math notranslate nohighlight">\(\mu &gt; \mu_0\)</span>, then we want to check when the deviation from the assumed mean is positive and larger than the observed one: <span class="math notranslate nohighlight">\(P(x &gt; z)\)</span>;</p></li>
<li><p>If the alternative hypothesis has the form <span class="math notranslate nohighlight">\(\mu &lt; \mu_0\)</span>, then we want to check when the deviation from the assumed mean is negative and smaller than the observed one: <span class="math notranslate nohighlight">\(P(x &lt; z)\)</span>.</p></li>
</ul>
<p>This will affect the computation of the p-value as shown in the following figure:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/085aa457f93f883c92c67f6cc56bf0c6eecca94168c6db6d1a3cbb71781397b2.png" src="../_images/085aa457f93f883c92c67f6cc56bf0c6eecca94168c6db6d1a3cbb71781397b2.png" />
</div>
</div>
</section>
</section>
<section id="hypotheses-tests-in-general">
<h4><span class="section-number">16.6.2. </span>Hypotheses Tests in General<a class="headerlink" href="#hypotheses-tests-in-general" title="Permalink to this heading">#</a></h4>
<p>A hypothesis test generally includes:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(H_0\)</span>: the <strong>null hypothesis</strong>, e.g., the means of two populations are equal;</p></li>
<li><p><span class="math notranslate nohighlight">\(H_a\)</span>: the <strong>alternative hypothesis</strong>, e.g., the means of two populations are not equal (this determines if the test is one- or two-tailed);</p></li>
<li><p>a <strong>test statistics</strong> which quantifies how likely it is to reject the null hypothesis. The test statistics follows a specific distribution which depends on the type of statistical tests we are performing. E.g., it can follow a t-Student distribution;</p></li>
<li><p>a <strong>significance level</strong> <span class="math notranslate nohighlight">\(\alpha\)</span> which defines the sensitivity of the test. A common value is <span class="math notranslate nohighlight">\(\alpha=0.05\)</span>, which means that we can wrongly reject the null hypothesis <span class="math notranslate nohighlight">\(5\%\)</span> of the times when it is in fact true. It represents the degree of error that we are willing to accept when performing hypothesis testing. Common values are <span class="math notranslate nohighlight">\(0.1\)</span>, <span class="math notranslate nohighlight">\(0.05\)</span>, <span class="math notranslate nohighlight">\(0.01\)</span>;</p></li>
<li><p>the <strong>p-value</strong>: this quantifies the probability of sampling a test statistics at least as extreme as the one observed under the null hypothesis. In practice, the p-value measures the probability that the null hypothesis is true but we are observing test statistic leading to rejection nevertheless.</p></li>
</ul>
<p>The null hypothesis is rejected if the <strong>p-value is larger than the chosen significance level <span class="math notranslate nohighlight">\(\alpha\)</span></strong>. We will not see in details all the possible hypothesis tests, but all of them follow a similar scheme.</p>
</section>
<section id="other-important-tests">
<h4><span class="section-number">16.6.3. </span>Other Important Tests<a class="headerlink" href="#other-important-tests" title="Permalink to this heading">#</a></h4>
<p>In this section, we briefly see the main statistical tests which can be used in practice, besides the one for means. We will not see how they are formulated, but we will see how to interpret them. We will see a few other tests when we’ll talk about linear regression.</p>
<section id="one-sample-t-test">
<h5><span class="section-number">16.6.3.1. </span>One Sample T-Test<a class="headerlink" href="#one-sample-t-test" title="Permalink to this heading">#</a></h5>
<p>This is the test for sample means we have previously seen. It is used to <strong>determine whether the mean of a single sample is significantly different from a known or hypothesized value.</strong></p>
</section>
<section id="two-sample-t-test">
<h5><span class="section-number">16.6.3.2. </span>Two Sample T-Test<a class="headerlink" href="#two-sample-t-test" title="Permalink to this heading">#</a></h5>
<p>A two-sample t-test is used to determine if there is a significant difference between the means of two independent samples. It’s often used when you want to compare the means of two different populations or treatments. The test assesses whether the difference between the sample means is statistically significant or if it could have occurred due to random chance. Also in this case, the test statistic will follow a t-Student distribution.</p>
<p>Let’s consider the height-weight dataset:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sex</th>
      <th>BMI</th>
      <th>height</th>
      <th>weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>M</td>
      <td>33.36</td>
      <td>74</td>
      <td>53.484771</td>
    </tr>
    <tr>
      <th>1</th>
      <td>M</td>
      <td>26.54</td>
      <td>70</td>
      <td>38.056472</td>
    </tr>
    <tr>
      <th>2</th>
      <td>F</td>
      <td>32.13</td>
      <td>61</td>
      <td>34.970812</td>
    </tr>
    <tr>
      <th>3</th>
      <td>M</td>
      <td>26.62</td>
      <td>68</td>
      <td>35.999365</td>
    </tr>
    <tr>
      <th>4</th>
      <td>F</td>
      <td>27.13</td>
      <td>66</td>
      <td>34.559390</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>4226</th>
      <td>F</td>
      <td>17.12</td>
      <td>69</td>
      <td>23.862436</td>
    </tr>
    <tr>
      <th>4227</th>
      <td>M</td>
      <td>27.47</td>
      <td>69</td>
      <td>38.262182</td>
    </tr>
    <tr>
      <th>4228</th>
      <td>F</td>
      <td>29.16</td>
      <td>64</td>
      <td>34.970812</td>
    </tr>
    <tr>
      <th>4229</th>
      <td>F</td>
      <td>23.68</td>
      <td>64</td>
      <td>28.388071</td>
    </tr>
    <tr>
      <th>4230</th>
      <td>F</td>
      <td>20.12</td>
      <td>61</td>
      <td>22.628172</td>
    </tr>
  </tbody>
</table>
<p>4231 rows × 4 columns</p>
</div></div></div>
</div>
<p>If we compute the average <code class="docutils literal notranslate"><span class="pre">BMI</span></code> for males and females we obtain:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sex
F    26.929287
M    27.684959
Name: BMI, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>We see a small difference. Is this due to chance or is it significant? If we run a two-sample t-test, we obtain the following results:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Test statistic: 4.64
Significance level: 0.05
P-value: 0.00
Conclusion: there is a significant difference between the two means.
</pre></div>
</div>
</div>
</div>
</section>
<section id="chi-square-test-for-independence">
<h5><span class="section-number">16.6.3.3. </span>Chi-Square Test for Independence<a class="headerlink" href="#chi-square-test-for-independence" title="Permalink to this heading">#</a></h5>
<p>The Chi-Square Test for Independence is a statistical test used to determine whether there is an association or independence between two or more categorical variables. This test is particularly useful when we want to assess whether changes in one categorical variable are related to changes in another categorical variable. The typical scenario is to set up a contingency table to compare the observed frequencies (counts) of the joint categories of the two variables to the expected frequencies that would occur under the assumption of independence.</p>
<p>The null hypothesis for the Chi-Square Test for Independence is that <strong>there is no association between the two categorical variables</strong> (they are independent), while the alternative hypothesis suggests that there is an association (they are dependent).</p>
<p>The test statistics follows a Chi-square distribution (we won’t see the details) in this case.</p>
<p>Let’s consider the Titanic dataset:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Name</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>Cabin</th>
      <th>Embarked</th>
    </tr>
    <tr>
      <th>PassengerId</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>3</td>
      <td>Braund, Mr. Owen Harris</td>
      <td>male</td>
      <td>22.0</td>
      <td>1</td>
      <td>0</td>
      <td>A/5 21171</td>
      <td>7.2500</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>1</td>
      <td>Cumings, Mrs. John Bradley (Florence Briggs Th...</td>
      <td>female</td>
      <td>38.0</td>
      <td>1</td>
      <td>0</td>
      <td>PC 17599</td>
      <td>71.2833</td>
      <td>C85</td>
      <td>C</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>3</td>
      <td>Heikkinen, Miss. Laina</td>
      <td>female</td>
      <td>26.0</td>
      <td>0</td>
      <td>0</td>
      <td>STON/O2. 3101282</td>
      <td>7.9250</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>1</td>
      <td>Futrelle, Mrs. Jacques Heath (Lily May Peel)</td>
      <td>female</td>
      <td>35.0</td>
      <td>1</td>
      <td>0</td>
      <td>113803</td>
      <td>53.1000</td>
      <td>C123</td>
      <td>S</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0</td>
      <td>3</td>
      <td>Allen, Mr. William Henry</td>
      <td>male</td>
      <td>35.0</td>
      <td>0</td>
      <td>0</td>
      <td>373450</td>
      <td>8.0500</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>887</th>
      <td>0</td>
      <td>2</td>
      <td>Montvila, Rev. Juozas</td>
      <td>male</td>
      <td>27.0</td>
      <td>0</td>
      <td>0</td>
      <td>211536</td>
      <td>13.0000</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>888</th>
      <td>1</td>
      <td>1</td>
      <td>Graham, Miss. Margaret Edith</td>
      <td>female</td>
      <td>19.0</td>
      <td>0</td>
      <td>0</td>
      <td>112053</td>
      <td>30.0000</td>
      <td>B42</td>
      <td>S</td>
    </tr>
    <tr>
      <th>889</th>
      <td>0</td>
      <td>3</td>
      <td>Johnston, Miss. Catherine Helen "Carrie"</td>
      <td>female</td>
      <td>NaN</td>
      <td>1</td>
      <td>2</td>
      <td>W./C. 6607</td>
      <td>23.4500</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>890</th>
      <td>1</td>
      <td>1</td>
      <td>Behr, Mr. Karl Howell</td>
      <td>male</td>
      <td>26.0</td>
      <td>0</td>
      <td>0</td>
      <td>111369</td>
      <td>30.0000</td>
      <td>C148</td>
      <td>C</td>
    </tr>
    <tr>
      <th>891</th>
      <td>0</td>
      <td>3</td>
      <td>Dooley, Mr. Patrick</td>
      <td>male</td>
      <td>32.0</td>
      <td>0</td>
      <td>0</td>
      <td>370376</td>
      <td>7.7500</td>
      <td>NaN</td>
      <td>Q</td>
    </tr>
  </tbody>
</table>
<p>891 rows × 11 columns</p>
</div></div></div>
</div>
<p>Let’s consider the following contingency table:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Survived</th>
      <th>0</th>
      <th>1</th>
    </tr>
    <tr>
      <th>Pclass</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>80</td>
      <td>136</td>
    </tr>
    <tr>
      <th>2</th>
      <td>97</td>
      <td>87</td>
    </tr>
    <tr>
      <th>3</th>
      <td>372</td>
      <td>119</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We can visualize the distributions of Survived in the three classes for more clarity:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/71f2c9392ada95d68ea04f4e68b5087b9000ad0dc2b408d76c92f2a4dfef612f.png" src="../_images/71f2c9392ada95d68ea04f4e68b5087b9000ad0dc2b408d76c92f2a4dfef612f.png" />
</div>
</div>
<p>We expect some form of correlation between the two variables. Indeed, the chi-square statistics and Cramer V statistics are:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chi-square statistic: 102.89
Cramer V statistic: 0.34
</pre></div>
</div>
</div>
</div>
<p>We have numbers different from zero, but <strong>is this due to chance or is it statistically significant</strong>? If we run a chi-square contingency test:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chi-Square Statistic: 102.88898875696056
p-value: 4.549251711298793e-23

There is a significant association between &#39;Pclass&#39; and &#39;survived&#39;.
</pre></div>
</div>
</div>
</div>
</section>
<section id="chi-square-goodness-of-fit-test">
<h5><span class="section-number">16.6.3.4. </span>Chi-Square Goodness-of-Fit Test<a class="headerlink" href="#chi-square-goodness-of-fit-test" title="Permalink to this heading">#</a></h5>
<p>The Chi-Square Goodness of Fit test is a statistical test used to determine whether observed categorical data (frequencies) fit a specified distribution or expected frequencies. This test is often used to assess whether the observed data deviates significantly from a hypothesized distribution. The typical scenario is to compare observed frequencies with expected frequencies based on a theoretical model or prior knowledge.</p>
<p>The null hypothesis for the Chi-Square Goodness of Fit test is that <strong>there is no significant difference between the observed and expected frequencies</strong>, meaning the observed data fits the specified distribution. The alternative hypothesis suggests that there is a significant difference.</p>
<p>The test statistics follows a Chi-square distribution in this case.</p>
<p>Let us consider the Titanic dataset again. We know that the distribution of <code class="docutils literal notranslate"><span class="pre">Sex</span></code> among passengers is biased:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/50df7af5ea698983406532a20440cf98eb0a4663fa30902355d2b0e095a330e9.png" src="../_images/50df7af5ea698983406532a20440cf98eb0a4663fa30902355d2b0e095a330e9.png" />
</div>
</div>
<p>We now consider the distribution of <code class="docutils literal notranslate"><span class="pre">Sex</span></code> among passengers less than <span class="math notranslate nohighlight">\(18\)</span> years old:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/88bdfbf63a201fd6efcfd0f15004652f39282a265ad23fdbe225619bb8f7d373.png" src="../_images/88bdfbf63a201fd6efcfd0f15004652f39282a265ad23fdbe225619bb8f7d373.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>male      58
female    55
Name: Sex, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>This looks less biased, but there are still minor differences between the counts. Are these due to chance? If <code class="docutils literal notranslate"><span class="pre">Sex</span></code> was distributed uniformly (as we hypothesize), we would have the following frequencies:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[56.5, 56.5]
</pre></div>
</div>
</div>
</div>
<p>We can run a Goodness-of-fit test to check if the observed frequencies match the expected ones:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Observed Frequencies:
[58 55]

Expected Frequencies:
[56.5, 56.5]

Chi-Square Statistic: 0.07964601769911504
p-value: 0.7777776907897473

The observed data fits the expected distribution.
</pre></div>
</div>
</div>
</div>
<p>Given the large p-value, we could not reject the null hypothesis that there are significant differences between expected and observed frequencies.</p>
</section>
<section id="pearson-spearman-correlation-test">
<h5><span class="section-number">16.6.3.5. </span>Pearson/Spearman Correlation Test<a class="headerlink" href="#pearson-spearman-correlation-test" title="Permalink to this heading">#</a></h5>
<p>We have seen how to compute Pearson/Spearman correlation coefficient. However, what can we say when we get small values? Are those supposed to be zero, but we got something different from zero due to sampling, or are they significantly different from zero?</p>
<p>The statistical tests associated with the correlation coefficients are used to determine whether the observed correlation between two variables is statistically significant or if it might have occurred due to random chance. This test assesses whether the correlation in the sample data is likely to reflect a true correlation in the population.</p>
<p>The null hypothesis is that <strong>there is no statistically significant correlation between the two variables in the population</strong>. In other words, the true correlation coefficient in the population is zero.</p>
<p>Let us consider the Titanic dataset. We find the following correlation between the <code class="docutils literal notranslate"><span class="pre">Age</span></code> and <code class="docutils literal notranslate"><span class="pre">Fare</span></code> variables:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Correlation between age and fare: 0.10
</pre></div>
</div>
<img alt="../_images/9af90fc2a2513ed1854ac8bb175a1dcbe0f4c650ea2add3ab0d284378bcd4bef.png" src="../_images/9af90fc2a2513ed1854ac8bb175a1dcbe0f4c650ea2add3ab0d284378bcd4bef.png" />
</div>
</div>
<p>Is this small positive correlation “true” or due to chance? Let us run a statistical test:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Pearson correlation coefficient (r): 0.09606669176903891
P-value: 0.010216277504447006
Reject the null hypothesis. There is a significant correlation between age and fare.
</pre></div>
</div>
</div>
</div>
<p>The p-value is small enough to reject the null hypothesis: the correlation is small but statistically significant.</p>
<p>Similar tests exist for Spearman coefficient:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Spearman correlation coefficient (r): 0.1350512177342878
P-value: 0.00029580903243060916
Reject the null hypothesis. There is a significant correlation between age and fare.
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="assessing-whether-a-sample-is-normally-distributed">
<h3><span class="section-number">16.7. </span>Assessing whether a Sample is Normally Distributed<a class="headerlink" href="#assessing-whether-a-sample-is-normally-distributed" title="Permalink to this heading">#</a></h3>
<p>While the Normal distribution is pervasive, in some cases, it is useful to assess whether a given sample follows a normal distribution before assuming this is true. Let us consider the dataset of heights and weights and plot the distribution of weights:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/32938500bd6e457de5d30d3efccc69e7c19c18d88b57fa0f3922c0a907d86f86.png" src="../_images/32938500bd6e457de5d30d3efccc69e7c19c18d88b57fa0f3922c0a907d86f86.png" />
</div>
</div>
<p>Does the distribution look Gaussian? Let us compute Skewness and Kurtosis:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Skewness of weight: 0.57
Kurtosis of weight: -0.06
</pre></div>
</div>
</div>
</div>
<p>We not that:</p>
<ul class="simple">
<li><p>We have a positive Skewness: this indicates that the distribution is skewed towards the right side (the right tail is longer) as compared to a Normal distribution;</p></li>
<li><p>We have a Kurtosis slightly lower than zero: the distribution is slightly “flatter” than a Normal distribution.</p></li>
</ul>
<p>While Skewness and Kurtosis can help characterize deviations from normality, there are tests which can be used.</p>
<section id="quantile-quantile-plots-q-q-plots">
<h4><span class="section-number">16.7.1. </span>Quantile-Quantile Plots (Q-Q Plots)<a class="headerlink" href="#quantile-quantile-plots-q-q-plots" title="Permalink to this heading">#</a></h4>
<p>One common way to do so is using the Quantile-Quantile plots. The basic idea is to <strong>compare the quantiles of the empirical data distribution with the theoretical quantiles of the reference distribution</strong>. To avoid scale issues, <strong>the empirical data is first transformed into z-scores</strong>. If the sample follows the theoretical distribution, the quantiles will match. By plotting the empirical quantiles against the theoretical ones, we should obtain a set of points that lie on the line <span class="math notranslate nohighlight">\(y=x\)</span>. In the following graph, we show the q-q plot for the weight sample in our weight-height dataset:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/357005ac389bb116ce498fa3a86c69c6bc8002fbef4da6b2129756bbbefa6a67.png" src="../_images/357005ac389bb116ce498fa3a86c69c6bc8002fbef4da6b2129756bbbefa6a67.png" />
</div>
</div>
<p>The plot relates the “theoretical” quantiles with those of the sample. The fact that the points on the plot do not lie on the diagonal indicates that there is a discrepancy between the empirical data distribution and the Gaussian distribution.</p>
<p>Analyzing a Q-Q Plot can be complex. In practice, <strong>there are some guidelines to understand how a sample deviates from a theoretical distribution</strong>. Referring to the Gaussian distribution, we will see how to interpret from a Q-Q plot if a sample follows a distribution that is:</p>
<ul class="simple">
<li><p>Right-skewed</p></li>
<li><p>Left-skewed</p></li>
<li><p>Symmetric with long tails</p></li>
<li><p>Symmetric with short tails</p></li>
</ul>
<p>The following figure compares the q-q plots of different distributions:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/4793b4ba94e81dffb92e1eb40b7121591aa9790fdd6845322eb4cbcb4bf9cfa0.png" src="../_images/4793b4ba94e81dffb92e1eb40b7121591aa9790fdd6845322eb4cbcb4bf9cfa0.png" />
</div>
</div>
<p>Every time we observe a Q-Q Plot, we can relate these features to characteristics of the distribution. Clearly, these characteristics can also combine to create more complex Q-Q Plots, as seen in the case of weights. Now, we have the tools to analyze the Q-Q Plot of weights:</p>
<ul class="simple">
<li><p>The deviation for quantiles less than -1 suggests a left-skew (see Q-Q Plot for “Left-Skewed”).</p></li>
<li><p>The deviation for quantiles greater than 2 indicates that there are more high values than expected in a Gaussian distribution, so the right tail is a bit “longer” than it should be.</p></li>
<li><p>Points below the diagonal around the quantile <span class="math notranslate nohighlight">\(0\)</span> indicate that the peak of the distribution is lower than it should be in the case of a Gaussian distribution.</p></li>
</ul>
<p>We will see how we can conduct a statistical test to check if a sample is Gaussian in the next lessons.</p>
</section>
<section id="shapiro-wilk-normality-test">
<h4><span class="section-number">16.7.2. </span>Shapiro-Wilk Normality Test<a class="headerlink" href="#shapiro-wilk-normality-test" title="Permalink to this heading">#</a></h4>
<p>The Shapiro-Wilk test is a statistical test used to assess whether a sample follows a Gaussian (normal) distribution. It is used with small samples (<span class="math notranslate nohighlight">\(n\leq 2000\)</span>) It works by comparing the observed data to what you would expect if the data were drawn from a truly Gaussian distribution.</p>
<p>We will not see the formal details of this test, but we can use it in our analyses. Here is the result on the <code class="docutils literal notranslate"><span class="pre">weight</span></code> sample in our height-weight dataset:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Test statistic: 0.97
P-value: 0.00
Sample does not look Gaussian (reject H0)
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="d-agostino-s-k-squared-test">
<h2><span class="section-number">17. </span>D’Agostino’s K-squared test<a class="headerlink" href="#d-agostino-s-k-squared-test" title="Permalink to this heading">#</a></h2>
<p>When samples are large (<span class="math notranslate nohighlight">\(n \geq 50\)</span>), the D’Agostino’s K-squared test is more used. It is based on Skewness and Kurtosis. Here is the result for our example:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Test statistic: 201.64
P-value: 0.00
Sample does not look Gaussian (reject H0)
</pre></div>
</div>
</div>
</div>
<section id="references">
<h3><span class="section-number">17.1. </span>References<a class="headerlink" href="#references" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Chapters 6-8 of [1];</p></li>
<li><p>Parts of chapter 9 of [2].</p></li>
</ul>
<p>[1] Gonick, L., &amp; Smith, W. (1993). The cartoon guide to statistics. HarperCollins Publishers, Inc.</p>
<p>[2] Heumann, Christian, and Michael Schomaker Shalabh. Introduction to statistics and data analysis. Springer International Publishing Switzerland, 2016.</p>
</section>
</section>
</div>
<div class="toctree-wrapper compound">
<span id="document-lectures/11_linear_regression"></span><section class="tex2jax_ignore mathjax_ignore" id="linear-regression">
<h2><span class="section-number">18. </span>Linear Regression<a class="headerlink" href="#linear-regression" title="Permalink to this heading">#</a></h2>
<p>Linear regression is a fundamental and widely used statistical technique in data analysis and machine learning. It is a powerful tool for <strong>modeling and understanding the relationships between variables</strong>. At its core, linear regression aims to establish a linear relationship between a <strong>dependent variable</strong> (the one you want to predict) and <strong>one or more independent variables</strong> (the ones used for prediction). This technique allows us to make predictions, infer associations, and gain insights into how changes in independent variables influence the target variable. Linear regression is both intuitive and versatile, making it a valuable tool for tasks ranging from simple trend analysis to more complex predictive modeling and hypothesis testing.</p>
<p>In this context, we will explore the concepts and applications of linear regression, its different types, and how to implement it using Python.</p>
<section id="the-auto-mpg-dataset">
<h3><span class="section-number">18.1. </span>The Auto MPG Dataset<a class="headerlink" href="#the-auto-mpg-dataset" title="Permalink to this heading">#</a></h3>
<p>We will consider the <a class="reference external" href="https://archive.ics.uci.edu/dataset/9/auto+mpg">Auto MPG</a> dataset, which contains <span class="math notranslate nohighlight">\(398\)</span> measurements of <span class="math notranslate nohighlight">\(8\)</span> different properties of different cars:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>displacement</th>
      <th>cylinders</th>
      <th>horsepower</th>
      <th>weight</th>
      <th>acceleration</th>
      <th>model_year</th>
      <th>origin</th>
      <th>mpg</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>307.0</td>
      <td>8</td>
      <td>130.0</td>
      <td>3504</td>
      <td>12.0</td>
      <td>70</td>
      <td>1</td>
      <td>18.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>350.0</td>
      <td>8</td>
      <td>165.0</td>
      <td>3693</td>
      <td>11.5</td>
      <td>70</td>
      <td>1</td>
      <td>15.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>318.0</td>
      <td>8</td>
      <td>150.0</td>
      <td>3436</td>
      <td>11.0</td>
      <td>70</td>
      <td>1</td>
      <td>18.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>304.0</td>
      <td>8</td>
      <td>150.0</td>
      <td>3433</td>
      <td>12.0</td>
      <td>70</td>
      <td>1</td>
      <td>16.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>302.0</td>
      <td>8</td>
      <td>140.0</td>
      <td>3449</td>
      <td>10.5</td>
      <td>70</td>
      <td>1</td>
      <td>17.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>393</th>
      <td>140.0</td>
      <td>4</td>
      <td>86.0</td>
      <td>2790</td>
      <td>15.6</td>
      <td>82</td>
      <td>1</td>
      <td>27.0</td>
    </tr>
    <tr>
      <th>394</th>
      <td>97.0</td>
      <td>4</td>
      <td>52.0</td>
      <td>2130</td>
      <td>24.6</td>
      <td>82</td>
      <td>2</td>
      <td>44.0</td>
    </tr>
    <tr>
      <th>395</th>
      <td>135.0</td>
      <td>4</td>
      <td>84.0</td>
      <td>2295</td>
      <td>11.6</td>
      <td>82</td>
      <td>1</td>
      <td>32.0</td>
    </tr>
    <tr>
      <th>396</th>
      <td>120.0</td>
      <td>4</td>
      <td>79.0</td>
      <td>2625</td>
      <td>18.6</td>
      <td>82</td>
      <td>1</td>
      <td>28.0</td>
    </tr>
    <tr>
      <th>397</th>
      <td>119.0</td>
      <td>4</td>
      <td>82.0</td>
      <td>2720</td>
      <td>19.4</td>
      <td>82</td>
      <td>1</td>
      <td>31.0</td>
    </tr>
  </tbody>
</table>
<p>398 rows × 8 columns</p>
</div></div></div>
</div>
<p>Here is a description of the different variables:</p>
<ul class="simple">
<li><p><strong>Displacement</strong>: The engine’s displacement (in cubic inches), which indicates the engine’s size and power.</p></li>
<li><p><strong>Cylinders</strong>: The number of cylinders in the engine of the car. This is a categorical variable.</p></li>
<li><p><strong>Horsepower</strong>: The engine’s horsepower, a measure of the engine’s performance.</p></li>
<li><p><strong>Weight</strong>: The weight of the car in pounds.</p></li>
<li><p><strong>Acceleration</strong>: The car’s acceleration (in seconds) from 0 to 60 miles per hour.</p></li>
<li><p><strong>Model Year</strong>: The year the car was manufactured. This is often converted into a categorical variable representing the car’s age.</p></li>
<li><p><strong>Origin</strong>: The car’s country of origin or manufacturing.
Car Name: The name or identifier of the car model.</p></li>
<li><p><strong>MPG (Miles per Gallon)</strong>: The fuel efficiency of the car in miles per gallon. It is the variable to be predicted in regression analysis.</p></li>
</ul>
<p>We will start by exploring the relationship between the variables <code class="docutils literal notranslate"><span class="pre">horsepower</span></code> and <code class="docutils literal notranslate"><span class="pre">MPG</span></code>. Let’s visualize the related scatterplot:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/1fb0c4e965f84bea87a10dff24242ac884f289a50476243e5c973efb3ba80747.png" src="../_images/1fb0c4e965f84bea87a10dff24242ac884f289a50476243e5c973efb3ba80747.png" />
</div>
</div>
</section>
<section id="regression-models">
<h3><span class="section-number">18.2. </span>Regression Models<a class="headerlink" href="#regression-models" title="Permalink to this heading">#</a></h3>
<p>Regression models, in general, aim to <strong>study the relationship between two variables</strong>, <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span>, by defining a mathematical model <span class="math notranslate nohighlight">\(f\)</span> such that:</p>
<div class="math notranslate nohighlight">
\[Y=f(X) + \epsilon\]</div>
<p>Here:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(f\)</span> is a deterministic function which can be used to <strong>predict the values of <span class="math notranslate nohighlight">\(Y\)</span> from the values of <span class="math notranslate nohighlight">\(X\)</span></strong>;</p></li>
<li><p><span class="math notranslate nohighlight">\(\epsilon\)</span> is an <strong>error term</strong>, i.e., a variable capturing everything that is not captured by the deterministic function <span class="math notranslate nohighlight">\(f\)</span>. It can be due to different reasons, the main of which are:</p>
<ul>
<li><p><span class="math notranslate nohighlight">\(f\)</span> is not an accurate deterministic function of the process. Since we don’t know the “true” function <span class="math notranslate nohighlight">\(f\)</span> and we are only estimating it, we may obtain a suboptimal <span class="math notranslate nohighlight">\(f\)</span> for which <span class="math notranslate nohighlight">\(Y \neq f(X)\)</span>. The error term captures the differences between our predictions and the true values.</p></li>
<li><p><span class="math notranslate nohighlight">\(Y\)</span> cannot only be predicted from <span class="math notranslate nohighlight">\(X\)</span>, but some other variable is needed to correctly predict <span class="math notranslate nohighlight">\(Y\)</span> from <span class="math notranslate nohighlight">\(X\)</span>. For instance, <span class="math notranslate nohighlight">\(X\)</span> could be “years of education” and <span class="math notranslate nohighlight">\(Y\)</span> can be “income”. While may expect that “income” is not completely predicted from “years of education”. This can happen also because we don’t always have observations for all relevant variables.</p></li>
<li><p>the problem has inherent stochasticity which cannot be entirely modeled within the deterministic function <span class="math notranslate nohighlight">\(f\)</span>. For instance, consider the problem of predicting the rate of wins in poker based on the expertise of the player. The expertise surely allows to predict the rate of wins, but wins partially depend also on random factors, such as how the deck was shuffled.</p></li>
</ul>
</li>
</ul>
<p>Note that, often, we model <span class="math notranslate nohighlight">\(f\)</span> in a way that we have its <strong>analytical form</strong>. This is very powerful. If we have the analytical form of the function <span class="math notranslate nohighlight">\(f\)</span> which <strong>explains</strong> how <span class="math notranslate nohighlight">\(Y\)</span> is influenced from <span class="math notranslate nohighlight">\(X\)</span> (<strong>can be predicted from <span class="math notranslate nohighlight">\(X\)</span></strong>), then we can really understand deeply the connection between the two variables!</p>
<p>The function <span class="math notranslate nohighlight">\(f\)</span> can take different forms. The most common one is the <strong>linear form</strong> that we will see in the next section. While the linear form is very simple (and hence we can anticipate it will be a limited model in many cases), it has the great advantage to be <strong>easy to interpret</strong>.</p>
</section>
<section id="simple-linear-regression">
<h3><span class="section-number">18.3. </span>Simple Linear Regression<a class="headerlink" href="#simple-linear-regression" title="Permalink to this heading">#</a></h3>
<p>Simple linear regression aims to model the <strong>linear relationship</strong> between two variables <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span>. In our example dataset, we will consider <span class="math notranslate nohighlight">\(X=\text{horsepower}\)</span> and <span class="math notranslate nohighlight">\(Y=\text{mpg}\)</span>.</p>
<p>Since we are trying to model a linear relationship, we can imagine <strong>a line passing through the data</strong>. The simple linear regression model is defined as:</p>
<div class="math notranslate nohighlight">
\[Y \approx \beta_0 + \beta_1X\]</div>
<p>In our example:</p>
<div class="math notranslate nohighlight">
\[\text{mpg} \approx \beta_0 + \beta_1 \text{horsepower}\]</div>
<p>It is often common to introduce a <strong>“noise” variable</strong> which captures the randomness due to which the expression above is approximated and write:</p>
<div class="math notranslate nohighlight">
\[Y = \beta_0 + \beta_1X + \epsilon\]</div>
<p>As we will see later, we expect <span class="math notranslate nohighlight">\(\epsilon\)</span> to be <strong>small and randomly distributed</strong>.</p>
<p>Given the model above, we will call:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(X\)</span>, the <strong>dependent variable</strong> or <strong>regressor</strong>;</p></li>
<li><p><span class="math notranslate nohighlight">\(Y\)</span>, the <strong>independent variable</strong> or <strong>regressed variable</strong>.</p></li>
</ul>
<p>The values <span class="math notranslate nohighlight">\(\beta_0\)</span> and <span class="math notranslate nohighlight">\(\beta_1\)</span> are called <strong>coefficients</strong> or <strong>parameters</strong> of the model.</p>
<p>The mathematical model above has a geometrical interpretation. Indeed, specific values of <span class="math notranslate nohighlight">\(\beta_0\)</span> and <span class="math notranslate nohighlight">\(\beta_1\)</span> identify a given line in the 2D plane, as shown in the plot below:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/2a666893895881e826c843f1cc97b4d2e6292b30af6f5084f9d4aeb041ec1fb6.png" src="../_images/2a666893895881e826c843f1cc97b4d2e6292b30af6f5084f9d4aeb041ec1fb6.png" />
</div>
</div>
<p>We hence aim to estimate two appropriate values <span class="math notranslate nohighlight">\(\hat \beta_0\)</span> and <span class="math notranslate nohighlight">\(\hat \beta_1\)</span> from data in a way that they provide a model which represents well our data. In the case of our example, we expect the geometrical model to have this aspect:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/528afcac8e04ed0389165862a00453351b8a1980d8f1adb134e6947820a6de46.png" src="../_images/528afcac8e04ed0389165862a00453351b8a1980d8f1adb134e6947820a6de46.png" />
</div>
</div>
<p>This line will also be called the <strong>regression line</strong>.</p>
<section id="estimating-the-coefficients-ordinary-least-squares-ols">
<h4><span class="section-number">18.3.1. </span>Estimating the Coefficients - Ordinary Least Squares (OLS)<a class="headerlink" href="#estimating-the-coefficients-ordinary-least-squares-ols" title="Permalink to this heading">#</a></h4>
<p>To estimate the coefficients of our optimal model, we should first define what is a good model. We will say that <strong>a good model is one that predicts well the <span class="math notranslate nohighlight">\(Y\)</span> variable from the <span class="math notranslate nohighlight">\(X\)</span> one</strong>. We already know from the example above that, since the relationship is not perfectly linear, the model will make some mistakes.</p>
<p>Let <span class="math notranslate nohighlight">\(\{(x_i,y_i)\}\)</span> be our set of observations. Let</p>
<div class="math notranslate nohighlight">
\[\hat y_i = \hat \beta_0 + \hat \beta_1 x_i\]</div>
<p>be the prediction of the model for the observation <span class="math notranslate nohighlight">\(x_i\)</span>. For each data point <span class="math notranslate nohighlight">\((x_i,y_i)\)</span>, we will define the deviation of the prediction from the <span class="math notranslate nohighlight">\(y_i\)</span> value as follows:</p>
<div class="math notranslate nohighlight">
\[e_i = y_i - \hat y_i\]</div>
<p>These numbers will be positive or negative based on whether we underestimate or overestimate the <span class="math notranslate nohighlight">\(y_i\)</span> values. As a global error indicator for the model, given the data, we will define the <strong>residual sum of squares (RSS)</strong> as:</p>
<div class="math notranslate nohighlight">
\[RSS = e_1^2 + e_2^2 + \ldots + e_n^2 \]</div>
<p>or equivalently:</p>
<div class="math notranslate nohighlight">
\[RSS = (y_1 - \hat \beta_0 - \hat \beta_1 x_1)^2 + (y_2 - \hat \beta_0 - \hat \beta_1 x_2)^2 + \ldots + (y_n - \hat \beta_0 - \hat \beta_1 x_n)^2\]</div>
<p>This number will be the sum of the square values of the dashed segments in the plot below:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/f46d194f5a10e9b2e959291a111eb37f0c9614f92203318a61c27a0b269ed329.png" src="../_images/f46d194f5a10e9b2e959291a111eb37f0c9614f92203318a61c27a0b269ed329.png" />
</div>
</div>
<p>Intuitively, if we minimize these numbers, we will find the line which <strong>best fits the data</strong>.</p>
<p>We can obtain estimates for <span class="math notranslate nohighlight">\(\hat \beta_0\)</span> and <span class="math notranslate nohighlight">\(\hat \beta_1\)</span> by minimizing the RSS using an approach called <strong>ordinary least squares</strong>.</p>
<p>We can write the RSS as a function of the parameters to estimate:</p>
<div class="math notranslate nohighlight">
\[RSS(\beta_0, \beta_1) = \sum_{i=1}^n(y_i - \beta_0 -  \beta_1 x_i)^2 \]</div>
<p>This is also called a <strong>cost function</strong> or <strong>loss function</strong>.</p>
<p>We aim to find:</p>
<div class="math notranslate nohighlight">
\[(\hat \beta_0, \hat \beta_1) = \arg \min_{\beta_0, \beta_1} RSS(\beta_0, \beta_1)\]</div>
<p>The minimum can be found setting:</p>
<div class="math notranslate nohighlight">
\[\frac{\partial RSS(\beta_0, \beta_1)}{\partial \beta_0} = 0\]</div>
<div class="math notranslate nohighlight">
\[\frac{\partial RSS(\beta_0, \beta_1)}{\partial \beta_1} = 0\]</div>
<p>Doing the math, it can be shown that:</p>
<div class="math notranslate nohighlight">
\[\hat \beta_1 = \frac{\sum_{i=1}^n(x_i - \overline x)(y_i - \overline y)}{\sum_{i=1}^n(x_i - \overline x)}\]</div>
<div class="math notranslate nohighlight">
\[\hat \beta_0 = \overline y - \hat \beta_1 \overline x\]</div>
</section>
<section id="interpretation-of-the-coefficients-of-linear-regression">
<h4><span class="section-number">18.3.2. </span>Interpretation of the Coefficients of Linear Regression<a class="headerlink" href="#interpretation-of-the-coefficients-of-linear-regression" title="Permalink to this heading">#</a></h4>
<p>Using the formulas above, we find the following values for the example above:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>beta_0: 39.94
beta_1: -0.16
</pre></div>
</div>
</div>
</div>
<p>These parameters identify the following line:</p>
<div class="math notranslate nohighlight">
\[y = 39.94 - 0.15 x\]</div>
<p>The plot below shows the line on the data:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/2eadbea9271f07cbcd11ded62deaf40105d594525ded3a7b279610e5c4adcb15.png" src="../_images/2eadbea9271f07cbcd11ded62deaf40105d594525ded3a7b279610e5c4adcb15.png" />
</div>
</div>
<p>Apart from the geometric interpretation, the coefficients of a linear regressor have an important <strong>statistical interpretation</strong>. In particular:</p>
<p><strong>The intercept <span class="math notranslate nohighlight">\(\beta_0\)</span> is the value of <span class="math notranslate nohighlight">\(y\)</span> that we get when the input value <span class="math notranslate nohighlight">\(x\)</span> is equal to zero <span class="math notranslate nohighlight">\(x=0\)</span> (i.e., <span class="math notranslate nohighlight">\(f(0)\)</span>)</strong>. This value <strong>may not always make sense</strong>. For instance, in the example above, we have: <span class="math notranslate nohighlight">\(\beta_0 = 39.94\)</span>, which means that, <strong>when the horsepower is <span class="math notranslate nohighlight">\(0\)</span>, then the consumption in mpg is equal to <span class="math notranslate nohighlight">\(39.94\)</span></strong>.</p>
<p><strong>The coefficient <span class="math notranslate nohighlight">\(\beta_1\)</span> indicates the steepness of the curve</strong>. If <span class="math notranslate nohighlight">\(\beta_1\)</span> is large, then the curve is steep. This indicates that a small change in <span class="math notranslate nohighlight">\(x\)</span> is associates to a large change in <span class="math notranslate nohighlight">\(y\)</span>. In general, we can see that:</p>
<div class="math notranslate nohighlight">
\[f(x+1)-f(x)=\beta_0+\beta_1 (x+1)-\beta_0-\beta_1 x=\beta_1 (x+1-x)=\beta_1\]</div>
<p>which reveals that <strong>when we observe an increment of one unit of x, we observe an increment of <span class="math notranslate nohighlight">\(\beta_1\)</span> units in y</strong>. In our example, <span class="math notranslate nohighlight">\(\beta_1=-0.15\)</span>, hence we can say that, for cars with one additional unit of horsepower, we observe an drop in mps <span class="math notranslate nohighlight">\(-0.15\)</span> units.</p>
</section>
<section id="accuracy-of-the-coefficient-estimates">
<h4><span class="section-number">18.3.3. </span>Accuracy of the Coefficient Estimates<a class="headerlink" href="#accuracy-of-the-coefficient-estimates" title="Permalink to this heading">#</a></h4>
<p>Recall that we are trying to model the relationship between two random variables <span class="math notranslate nohighlight">\(X\)</span> as <span class="math notranslate nohighlight">\(Y\)</span> with a simple linear model:</p>
<div class="math notranslate nohighlight">
\[Y = \beta_0 + \beta_1X+\epsilon\]</div>
<p>This means that, once we find appropriate values of <span class="math notranslate nohighlight">\(\beta_0\)</span> and <span class="math notranslate nohighlight">\(\beta_1\)</span>, we expect these to summarize the <strong>linear relationship in the population</strong> or the <strong>population regression line</strong>. Also, recall that these values are obtained using two formulas which are based on realizations of <span class="math notranslate nohighlight">\(X\)</span> of <span class="math notranslate nohighlight">\(Y\)</span> and can be hence seen as <strong>estimators</strong>:</p>
<div class="math notranslate nohighlight">
\[\hat \beta_1 = \frac{\sum_{i=1}^n(x_i - \overline x)(y_i - \overline y)}{\sum_{i=1}^n(x_i - \overline x)^2}\]</div>
<div class="math notranslate nohighlight">
\[\hat \beta_0 = \overline y - \hat \beta_1 \overline x\]</div>
<p>We now recall that, being estimates, they provide values related to a given <strong>realization of the random variables</strong>.</p>
<p>Let us consider an ideal population for which:</p>
<div class="math notranslate nohighlight">
\[Y=2x+1\]</div>
<p>Ideally, given a sample from the population, we expect to obtain <span class="math notranslate nohighlight">\(\hat \beta_0 \approx 1\)</span> and <span class="math notranslate nohighlight">\(\hat \beta_1 \approx 2\)</span>. In practice, different samples may lead to different estimates and hence different regression lines, as shown in the plot below:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/c4fd62442231f408f86ccbad547786768adda153ce75381ddf95623eb21c5f08.png" src="../_images/c4fd62442231f408f86ccbad547786768adda153ce75381ddf95623eb21c5f08.png" />
</div>
</div>
<p>Each of the first three subplots shows a different sample drawn from the population, with its corresponding estimated regression line, along with the true population regression line. The last subplot compares the different estimated lines with the population regression line and the average regression line (in red). Coefficient estimates are shown in the subplot titles.</p>
<p>As can be noted, each estimate can be inaccurate, while the average regression line is very close to the population regression line. This is due to the fact that our estimators for the parameters of the regression coefficients <strong>have non-zero variance</strong>. In practice, in can be shown that these estimators are <strong>unbiased</strong> (hence the average regression line is close to the population line).</p>
<section id="standard-errors-of-the-regression-coefficients">
<h5><span class="section-number">18.3.3.1. </span>Standard Errors of the Regression Coefficients<a class="headerlink" href="#standard-errors-of-the-regression-coefficients" title="Permalink to this heading">#</a></h5>
<p>A natural question is hence <strong>“how do we assess how good our estimates of the regression coefficients are”</strong>. We resort here to <strong>statistical inference</strong>. It can be shown that the squared standard errors associated to the coefficient estimates are:</p>
<div class="math notranslate nohighlight">
\[SE(\hat \beta_0)^2 = \sigma^2 \left[\frac{1}{n} + \frac{\overline x^2}{\sum_{i=1}^{n}(x_i-\overline x)^2}\right], SE(\hat \beta_1)^2 = \frac{\sigma^2}{\sum_{i=1}^{n}(x_i-\overline x)^2}\]</div>
<p>Where:</p>
<div class="math notranslate nohighlight">
\[\sigma^2 = Var(\epsilon)\]</div>
<p>Note that <span class="math notranslate nohighlight">\(\sigma^2\)</span> is generally unknown, but it can be estimated as the <strong>residual standard error</strong>:</p>
<div class="math notranslate nohighlight">
\[RSE = \sqrt{\frac{RSS}{n-2}}\]</div>
<p>In the formulas above, we see that:</p>
<ul class="simple">
<li><p>The standard errors are proportional to <span class="math notranslate nohighlight">\(\sigma^2\)</span>. This is expected, as we will have more uncertainty when the variance of the error term is high, hence when the points are more <strong>scattered around the population regression line</strong>.</p></li>
<li><p>The standard errors depend inversely on <span class="math notranslate nohighlight">\(n\sigma_x^2 = \sum_{i=1}^n(x_i-\overline x)\)</span> (the variance of <span class="math notranslate nohighlight">\(x\)</span> multiplied by the sample size). This means that we will have more uncertainty in the estimates if <span class="math notranslate nohighlight">\(x\)</span> concentrate in a narrow range.</p></li>
</ul>
</section>
<section id="confidence-intervals-of-the-regression-coefficients">
<h5><span class="section-number">18.3.3.2. </span>Confidence Intervals of the Regression Coefficients<a class="headerlink" href="#confidence-intervals-of-the-regression-coefficients" title="Permalink to this heading">#</a></h5>
<p>As we have seen, standard errors allow to compute confidence intervals. We will not see it into details, but it turns out that the true values will be in the following intervals with a <span class="math notranslate nohighlight">\(95\%\)</span> confidence:</p>
<div class="math notranslate nohighlight">
\[[\hat \beta_0 - 1.96 \cdot SE(\hat \beta_0), \hat \beta_0 + 1.96 \cdot SE(\hat \beta_0)]\]</div>
<div class="math notranslate nohighlight">
\[[\hat \beta_1 - 1.96 \cdot SE(\hat \beta_1), \hat \beta_1 + 1.96 \cdot SE(\hat \beta_1)]\]</div>
<p>In practice, it is common to compute confidence intervals with a <span class="math notranslate nohighlight">\(95\%\)</span> confidence. In the case of our model:</p>
<div class="math notranslate nohighlight">
\[horsepower \approx = \beta_0 + mpg \cdot beta_1\]</div>
<p>We will have:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p>COEFFICIENT</p></th>
<th class="head"><p>STD ERROR</p></th>
<th class="head"><p>CONFIDENCE INTERVAL</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\beta_0\)</span></p></td>
<td><p>39.94</p></td>
<td><p>0.717</p></td>
<td><p><span class="math notranslate nohighlight">\([38.53, 41.35]\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\beta_1\)</span></p></td>
<td><p>-0.1578</p></td>
<td><p>0.006</p></td>
<td><p><span class="math notranslate nohighlight">\([-0.17, -0.15]\)</span></p></td>
</tr>
</tbody>
</table>
<p>From the table above, we can say that:</p>
<ul class="simple">
<li><p>The value of <code class="docutils literal notranslate"><span class="pre">mpg</span></code> for <code class="docutils literal notranslate"><span class="pre">horsepower=0</span></code> lies somewhere between <span class="math notranslate nohighlight">\(38.53\)</span> and <span class="math notranslate nohighlight">\(41.35\)</span>;</p></li>
<li><p>An increase of <code class="docutils literal notranslate"><span class="pre">horsepower</span></code> by one unit is associated to an decrease of <code class="docutils literal notranslate"><span class="pre">mpg</span></code> between <span class="math notranslate nohighlight">\(-0.17\)</span> and <span class="math notranslate nohighlight">\(.015\)</span>.</p></li>
</ul>
<p>It is also common to see plots like the following one:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/99a1dc89c41e1e1f1fe741d100d9b713250994651e2042407614d2a881468af8.png" src="../_images/99a1dc89c41e1e1f1fe741d100d9b713250994651e2042407614d2a881468af8.png" />
</div>
</div>
<p>In the plot above, the shading around the line illustrates the variability induced by the confidence intervals estimated for the coefficients.</p>
</section>
<section id="statistical-tests-for-the-significance-of-coefficients">
<h5><span class="section-number">18.3.3.3. </span>Statistical Tests for the Significance of Coefficients<a class="headerlink" href="#statistical-tests-for-the-significance-of-coefficients" title="Permalink to this heading">#</a></h5>
<p>Standard errors are also used to perform <strong>hypothesis tests</strong> on the coefficients. In practice, it is common to perform a statistical test to assess whether the coefficient <span class="math notranslate nohighlight">\(\beta_1\)</span> is significantly different from zero. It is interesting to check this because, if <span class="math notranslate nohighlight">\(\beta_1\)</span> was equal to zero, then there would not be any correlation between the variables (and hence the linear regressor would not be useful). Indeed, if <span class="math notranslate nohighlight">\(\beta-1=0\)</span>:</p>
<div class="math notranslate nohighlight">
\[Y=\beta_0 + \epsilon\]</div>
<p>Hence <span class="math notranslate nohighlight">\(Y\)</span> cannot be predicted from <span class="math notranslate nohighlight">\(X\)</span> and the two variables are not associated.</p>
<p>The <strong>null hypothesis</strong> of the test is as follows:</p>
<div class="math notranslate nohighlight">
\[H_0: \text{There is no association between } X \text{ and } Y \Leftrightarrow \beta_1=0\]</div>
<p>While the <strong>alternative hypothesis</strong> is formulated as follows:</p>
<div class="math notranslate nohighlight">
\[H_1: \text{There is some association between } X \text{ and } Y \Leftrightarrow \beta_1 \neq 0\]</div>
<p>To conduct the test, the following t-statistic is computed from the estimate of <span class="math notranslate nohighlight">\(\beta_1\)</span> and the standard error:</p>
<div class="math notranslate nohighlight">
\[t=\frac{\hat \beta_1 - 0}{SE(\hat \beta_1)}\]</div>
<p>Where the <span class="math notranslate nohighlight">\(-0\)</span> term indicates that we are subtracting the value assumed by the null hypothesis (<span class="math notranslate nohighlight">\(\beta_1=0\)</span>). The statistic will follow a t-Student distribution with <span class="math notranslate nohighlight">\(n-2\)</span> degrees of freedom (<span class="math notranslate nohighlight">\(n\)</span> being the number of data points). If <span class="math notranslate nohighlight">\(n&gt;30\)</span> the distribution is approximately Gaussian. Using this statistic, a <strong><span class="math notranslate nohighlight">\(p-value\)</span></strong> indicating the <strong>probability of observing a t statistic more extreme than this one if there is no associated between the two variables</strong> is computed. Chosen a significance level <span class="math notranslate nohighlight">\(\alpha\)</span> (often <span class="math notranslate nohighlight">\(\alpha=0.05\)</span>), we will reject the null hypothesis if <span class="math notranslate nohighlight">\(p&lt;\alpha\)</span>.</p>
<p>A similar test is conducted to check that <span class="math notranslate nohighlight">\(\beta_0\)</span> is significantly different from zero.</p>
<p>Let’s see the updated table from the same example:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p>COEFFICIENT</p></th>
<th class="head"><p>STD ERROR</p></th>
<th class="head"><p>t</p></th>
<th class="head"><p>P&gt;|t|</p></th>
<th class="head"><p>CONFIDENCE INTERVAL</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\beta_0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(39.94\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0.717\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(55.66\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\([38.53, 41.35]\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\beta_1\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(-0.1578\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0.006\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(-24.49\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\([-0.17, -0.15]\)</span></p></td>
</tr>
</tbody>
</table>
<p>From the table above, we can conclude that both <span class="math notranslate nohighlight">\(\beta_0\)</span> and <span class="math notranslate nohighlight">\(\beta_1\)</span> are significantly different than <span class="math notranslate nohighlight">\(0\)</span> (p-value is equal to zero). This can also be noted by the fact that the confidence intervals do not contain the zero number.</p>
</section>
</section>
<section id="accuracy-of-the-model">
<h4><span class="section-number">18.3.4. </span>Accuracy of the Model<a class="headerlink" href="#accuracy-of-the-model" title="Permalink to this heading">#</a></h4>
<p>The tests performed above will tell us if there is a relationship between the variables, but they will not tell us <strong>how well does the model fit the data</strong>. For instance, if the relationship between <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span> is not linear, we would expect the model not to fit the data very well. In practice, we can use different measures of accuracy of the model.</p>
<section id="residual-standard-error">
<h5><span class="section-number">18.3.4.1. </span>Residual Standard Error<a class="headerlink" href="#residual-standard-error" title="Permalink to this heading">#</a></h5>
<p>One way to measure how well the model fits the data is to check the variance of the residuals <span class="math notranslate nohighlight">\(\epsilon\)</span>. Recall that our model is:</p>
<div class="math notranslate nohighlight">
\[Y=\beta_0 + \beta_1 X + \epsilon\]</div>
<p>If the model fits the data well, then the values of <span class="math notranslate nohighlight">\(\epsilon\)</span> will be close to zero and their variance will be small. We have already seen that the <strong>Residual Sum of Squares (RSS)</strong> is defined as:</p>
<div class="math notranslate nohighlight">
\[RSE = \sqrt{\frac{RSS}{n-2}} = \sqrt{\frac{1}{n-2}\sum_{i=1}^n (y_i-\hat y_i)^2}\]</div>
<p>The residual standard error is a measure of the <strong>lack of fit</strong>. Large values will indicate that the model is not a good fit. For instance, in our example we have:</p>
<div class="math notranslate nohighlight">
\[RSE = 4.91\]</div>
<p>This value has to be interpreted depending on the scale of the <span class="math notranslate nohighlight">\(Y\)</span> variable. The average value of <span class="math notranslate nohighlight">\(Y\)</span> is:</p>
<div class="math notranslate nohighlight">
\[\overline{mpg} = 23.52\]</div>
<p>So the percentage error will be <span class="math notranslate nohighlight">\(4.91/23.52 \approx 20\%\)</span>.</p>
</section>
<section id="r-2-statistic">
<h5><span class="section-number">18.3.4.2. </span><span class="math notranslate nohighlight">\(R^2\)</span> Statistic<a class="headerlink" href="#r-2-statistic" title="Permalink to this heading">#</a></h5>
<p>The RSE value is an absolute measure, which is measured in the units of <span class="math notranslate nohighlight">\(Y\)</span>. Indeed, to interpret it, we had to check the range of the <span class="math notranslate nohighlight">\(Y\)</span> values. An alternative way to check if the model is fitting the data well, would be to compare the performance of our model with the performance of a <strong>baseline model</strong> which assumes no association between the <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span> variables. This model would be:</p>
<div class="math notranslate nohighlight">
\[Y = k\]</div>
<p>This model has a single parameter <span class="math notranslate nohighlight">\(k\)</span>. The <strong>Residual Sum of Squares</strong> of this model would be:</p>
<div class="math notranslate nohighlight">
\[RSS(k)=\sum_{i=1}^n{(k-y_i)^2}\]</div>
<p>To find the optimal value <span class="math notranslate nohighlight">\(k\)</span>, we can compute the derivative of the RSS and set it to zero:</p>
<div class="math notranslate nohighlight">
\[\frac{\partial RSS(k)}{\partial k}=2\sum_{i=1}^n{(k-y_i)} = 2(nk - \sum_{i=1}^n y_i) = 2(nk - n\overline y_i)\]</div>
<div class="math notranslate nohighlight">
\[2n(k - \overline y_i) = 0 \Leftrightarrow k=\overline y_i\]</div>
<p>Hence, the optimal estimator, <strong>when there is not relationship between <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span> is the average value of <span class="math notranslate nohighlight">\(Y\)</span></strong>. We will call its RSS value the <strong>total sum of squares</strong>:</p>
<div class="math notranslate nohighlight">
\[TSS = \sum_{i=1}^n(y_i-\overline y)^2\]</div>
<p>We can compare the RSS value obtained by our model to the TSS, which is the error of the baseline method:</p>
<div class="math notranslate nohighlight">
\[\frac{RSS}{TSS}\]</div>
<p>This number will be <strong>comprised between 0 and 1</strong>, and in particular:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\frac{RSS}{TSS}=0\)</span> when <span class="math notranslate nohighlight">\(RSS=0\)</span>, i.e., we have a perfect model;</p></li>
<li><p><span class="math notranslate nohighlight">\(\frac{RSS}{TSS}=1\)</span> when <span class="math notranslate nohighlight">\(RSS=TSS\)</span>, i.e., we are not doing any better than the baseline model (so our model is poor).</p></li>
</ul>
<p>Note that the RSS measures <strong>the variability in <span class="math notranslate nohighlight">\(Y\)</span> left unexplained after regression</strong> (the one that the model could not capture), while the TSS measures <strong>the total variability in <span class="math notranslate nohighlight">\(Y\)</span></strong>. The fraction hence explains the <strong>proportion of variability which the model could not explain</strong>.</p>
<p>We define the <span class="math notranslate nohighlight">\(R^2\)</span> statistic as:</p>
<div class="math notranslate nohighlight">
\[R^2 = 1 - \frac{RSS}{TSS}\]</div>
<p>Inverting by the <span class="math notranslate nohighlight">\(1-\)</span> subtraction, this number measures the <strong>proportion of variability in <span class="math notranslate nohighlight">\(Y\)</span> that can be explained using <span class="math notranslate nohighlight">\(X\)</span></strong></p>
<p>The plot below shows examples of linear regression fits with different <span class="math notranslate nohighlight">\(R^2\)</span> values.</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/3d62b26713ecd8bf2fc4bb00fdd1e4f749a313553f209878086fc881d42a9656.png" src="../_images/3d62b26713ecd8bf2fc4bb00fdd1e4f749a313553f209878086fc881d42a9656.png" />
</div>
</div>
<p>The interpretation of the <span class="math notranslate nohighlight">\(R^2\)</span> is related to the one of the Pearson’s <span class="math notranslate nohighlight">\(\rho\)</span> correlation coefficient. Indeed, both scores are independent of the slope of the regression line, but quantify how liner the relationship between <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span> is. In practice, it can be shown that:</p>
<div class="math notranslate nohighlight">
\[R^2 = \rho^2\]</div>
<p>The <span class="math notranslate nohighlight">\(R^2\)</span> value in our example of regressing <code class="docutils literal notranslate"><span class="pre">mpg</span></code> from <code class="docutils literal notranslate"><span class="pre">horsepower</span></code> is:</p>
<div class="math notranslate nohighlight">
\[R^2 = 0.61\]</div>
<p>Which indicates that <span class="math notranslate nohighlight">\(61\%\)</span> of the variance of the <span class="math notranslate nohighlight">\(Y\)</span> variable is explained by the model.</p>
</section>
</section>
</section>
<section id="multiple-linear-regression">
<h3><span class="section-number">18.4. </span>Multiple Linear Regression<a class="headerlink" href="#multiple-linear-regression" title="Permalink to this heading">#</a></h3>
<p>In the example above, we have seen that about <span class="math notranslate nohighlight">\(61\%\)</span> of the variance in <span class="math notranslate nohighlight">\(Y\)</span> was explained by the model. One may wonder why about <span class="math notranslate nohighlight">\(39\%\)</span> of the variance could not be explained. Some common reasons may be:</p>
<ul class="simple">
<li><p>There is stochasticity in the data which prevents us to learn an accurate function to predict <span class="math notranslate nohighlight">\(Y\)</span> from <span class="math notranslate nohighlight">\(X\)</span>;</p></li>
<li><p>The relationship between <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span> is far from linear, so we cannot predict <span class="math notranslate nohighlight">\(Y\)</span> accurately;</p></li>
<li><p>The prediction of <span class="math notranslate nohighlight">\(Y\)</span> also depends on other variables.</p></li>
</ul>
<p>While in general the unexplained variance is due to a combination of the aforementioned factors, the third one is often very common and relatively easy to fix. In our case, we are trying to predict <code class="docutils literal notranslate"><span class="pre">mpg</span></code> from <code class="docutils literal notranslate"><span class="pre">horsepower</span></code>. However, we can easily imagine how other variables may contribute to the estimation of <code class="docutils literal notranslate"><span class="pre">mpg</span></code>. For instance, two cars with the same <code class="docutils literal notranslate"><span class="pre">horsepower</span></code> but different <code class="docutils literal notranslate"><span class="pre">weight</span></code> may have different values of <code class="docutils literal notranslate"><span class="pre">mpg</span></code>. We can hence try to find a model with <strong>also uses <code class="docutils literal notranslate"><span class="pre">weight</span></code> to predict <code class="docutils literal notranslate"><span class="pre">mpg</span></code></strong>. This is simply done by adding an additional coefficient for the new variable:</p>
<div class="math notranslate nohighlight">
\[mpg = \beta_0 + \beta_1 horsepower + \beta_2 weight\]</div>
<p>The obtained model is called <strong>multiple linear regression</strong>. If we fit this model (we will see how to estimate coefficients in this case), we obtain the following <span class="math notranslate nohighlight">\(R^2\)</span> value:</p>
<div class="math notranslate nohighlight">
\[R^2=0.71\]</div>
<p>An increment of <span class="math notranslate nohighlight">\(+0.1\)</span>!</p>
<p>In general, we can include as many variables as we think is relevant to add and define the following model:</p>
<div class="math notranslate nohighlight">
\[Y = \beta_0 + \beta_1 X_1 + \ldots + \beta_n X_n\]</div>
<p>For instance, the following model:</p>
<div class="math notranslate nohighlight">
\[mpg = \beta_0 + \beta_1 horsepower + \beta_2 weight + \beta_3 model\_year\]</div>
<p>Has an <span class="math notranslate nohighlight">\(R^2\)</span> value of:</p>
<div class="math notranslate nohighlight">
\[R^2=0.808\]</div>
<section id="geometrical-interpretation">
<h4><span class="section-number">18.4.1. </span>Geometrical Interpretation<a class="headerlink" href="#geometrical-interpretation" title="Permalink to this heading">#</a></h4>
<p>The multiple regression model based on two variable has a geometrical interpretation. Indeed, the equation:</p>
<div class="math notranslate nohighlight">
\[Z = \beta_0 + \beta_1 X + \beta_2 Y\]</div>
<p>identifies a plane in the 3D space. We can visualize the plane identified by the <span class="math notranslate nohighlight">\(mpg = \beta_0 + \beta_1 horsepower + \beta_2 weight\)</span> model as follows:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/a9a15334cb0d1ea09bbf96f4ab8ac2ec1d66efe826bd3ec4736af6d7eb2e9f86.png" src="../_images/a9a15334cb0d1ea09bbf96f4ab8ac2ec1d66efe826bd3ec4736af6d7eb2e9f86.png" />
</div>
</div>
<p>The dashed lines indicate the residuals. The best fit of the model minimizes again the sum of squared residuals. This model makes predictions selecting the <span class="math notranslate nohighlight">\(Z\)</span> value which intersect the plane for given values of <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span>.</p>
<p>In general, when we consider <span class="math notranslate nohighlight">\(n\)</span> variables, the linear regressor will be <strong>a (n-1)-dimensional hyperplane in the n-dimensional space</strong>.</p>
</section>
<section id="statistical-interpretation">
<h4><span class="section-number">18.4.2. </span>Statistical Interpretation<a class="headerlink" href="#statistical-interpretation" title="Permalink to this heading">#</a></h4>
<p>The statistical interpretation of a multiple linear regression model is very similar to the interpretation of a simple linear regression model. Given the general model:</p>
<div class="math notranslate nohighlight">
\[y=\beta_0 + \beta_1 x_1 + \ldots + \beta_i x_i + \ldots + \beta_n x_n\]</div>
<p>we can interpret the coefficients as follows:</p>
<ul class="simple">
<li><p>The value of <span class="math notranslate nohighlight">\(\beta_0\)</span> indicates the value of <span class="math notranslate nohighlight">\(y\)</span> when all independent variables are set to zero;</p></li>
<li><p>The value of <span class="math notranslate nohighlight">\(\beta_i\)</span> indicates the increment of <span class="math notranslate nohighlight">\(y\)</span> that we expect to see when <span class="math notranslate nohighlight">\(x_i\)</span> increments by one unit, <strong>provided that all other values <span class="math notranslate nohighlight">\(x_j | j\neq i\)</span> are constant</strong>.</p></li>
</ul>
<p>In the considered example:</p>
<div class="math notranslate nohighlight">
\[mpg = \beta_0 + \beta_1 horsepower + \beta_2 weight\]</div>
<p>we obtain the following estimates for the coefficients:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p><span class="math notranslate nohighlight">\(\hat \beta_0\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(\hat \beta_1\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(\hat \beta_2\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(45.64\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(-0.05\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(-0.01\)</span></p></td>
</tr>
</tbody>
</table>
<p>We can interpret these estimates as follows:</p>
<ul class="simple">
<li><p>Cars with zero <code class="docutils literal notranslate"><span class="pre">horsepower</span></code> and zero <code class="docutils literal notranslate"><span class="pre">weight</span></code> will have an <code class="docutils literal notranslate"><span class="pre">mpg</span></code> of <span class="math notranslate nohighlight">\(45.64\)</span> (<span class="math notranslate nohighlight">\(\approx 19.4 Km/l\)</span>).</p></li>
<li><p>An increment of one unit of <code class="docutils literal notranslate"><span class="pre">horsepower</span></code> is associated to a decrement of <code class="docutils literal notranslate"><span class="pre">mpg</span></code> of <span class="math notranslate nohighlight">\(-0.05\)</span> units, provided that <code class="docutils literal notranslate"><span class="pre">weight</span></code> is constant. This makes sense: cars with more <code class="docutils literal notranslate"><span class="pre">horsepower</span></code> will probably consume more fuel.</p></li>
<li><p>An increment of one unit of <code class="docutils literal notranslate"><span class="pre">weight</span></code> is associated to a decrement of <code class="docutils literal notranslate"><span class="pre">mpg</span></code> of <code class="docutils literal notranslate"><span class="pre">-0.01</span></code> units, provided that <code class="docutils literal notranslate"><span class="pre">horsepower</span></code> is constant. This makes sense: heavier cars will consume more fuel.</p></li>
</ul>
<p>Let’s compare the estimates above with the estimates of our previous model:</p>
<div class="math notranslate nohighlight">
\[mpg = \beta_0 + \beta_1 horsepower\]</div>
<p>In that case, we obtained:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p><span class="math notranslate nohighlight">\(\hat \beta_0\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(\hat \beta_1\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(39.94\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(-0.16\)</span></p></td>
</tr>
</tbody>
</table>
<p>We can note that the coefficients are different. This happens because, when we add more variables, <strong>the model explains variance in a different way</strong>. If we think more about it, this is coherent with the interpretation of the coefficients. Indeed:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(39.94\)</span> is the expected value of <code class="docutils literal notranslate"><span class="pre">mpg</span></code> when <code class="docutils literal notranslate"><span class="pre">horsepower=0</span></code>, but all other variables have unknown values. <span class="math notranslate nohighlight">\(45.64\)</span> is the expected value of <code class="docutils literal notranslate"><span class="pre">mpg</span></code> when <code class="docutils literal notranslate"><span class="pre">horsepower=0</span></code> and <code class="docutils literal notranslate"><span class="pre">weight=0</span></code>. This is different, as in the second case we are (virtually) looking at a subset of data for which both horsepower and weight are zero, while in the first case, we are only looking at data for which <code class="docutils literal notranslate"><span class="pre">horsepower=0</span></code>, but <code class="docutils literal notranslate"><span class="pre">weight</span></code> can be any value. In some sense, we can see <span class="math notranslate nohighlight">\(39.94\)</span> as an average value for different values of <code class="docutils literal notranslate"><span class="pre">weight</span></code> (and all other unobserved variables).</p></li>
<li><p><span class="math notranslate nohighlight">\(-0.16\)</span> is the expected increment of <code class="docutils literal notranslate"><span class="pre">mpg</span></code> when we observe an increment of one unit of <code class="docutils literal notranslate"><span class="pre">horsepower</span></code> and we don’t know anything about the values of the other variables. <span class="math notranslate nohighlight">\(-0.05\)</span> is the expected increment of <code class="docutils literal notranslate"><span class="pre">mpg</span></code> when <code class="docutils literal notranslate"><span class="pre">horsepower</span></code> and <code class="docutils literal notranslate"><span class="pre">weight</span></code> are held constant, so, again, we are (virtually) looking at a different subset of the data in which the relationship between <code class="docutils literal notranslate"><span class="pre">mpg</span></code> and <code class="docutils literal notranslate"><span class="pre">horsepower</span></code> may be a bit different.</p></li>
</ul>
<p>Note that, also in the case of multiple regression, we can estimate confidence intervals and perform statistical tests. In our example, we will get this table:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p>COEFFICIENT</p></th>
<th class="head"><p>STD ERROR</p></th>
<th class="head"><p>t</p></th>
<th class="head"><p>P&gt;|t|</p></th>
<th class="head"><p>CONFIDENCE INTERVAL</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\beta_0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(45.64\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0.793\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(57.54\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\([44.08, 47.20]\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\beta_1\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(-0.05\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0.011\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(-4.26\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\([-0.07, -0.03]\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\beta_2\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(-0.01\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0.001\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(-11.53\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\([-0.007, -0.005]\)</span></p></td>
</tr>
</tbody>
</table>
</section>
<section id="estimating-the-regression-coefficients">
<h4><span class="section-number">18.4.3. </span>Estimating the Regression Coefficients<a class="headerlink" href="#estimating-the-regression-coefficients" title="Permalink to this heading">#</a></h4>
<p>Given the general model:</p>
<div class="math notranslate nohighlight">
\[y=\beta_0 + \beta_1 x_1 + \ldots + \beta_i x_i + \ldots + \beta_n x_n\]</div>
<p>We can define our <strong>cost function</strong> again as the residual sum of squares:</p>
<div class="math notranslate nohighlight">
\[RSS(\beta_0,\ldots,\beta_n) = \sum_{i=1}^n (y_i - \beta_0+\beta_1x_i + \ldots + \beta_n x_n)^2\]</div>
<p>The values <span class="math notranslate nohighlight">\(\hat \beta_0,\ldots,\hat \beta_n\)</span> values that minimize the loss function above are the <strong>multiple least square coefficient estimates</strong>.</p>
<p>To find these optimal values, it is convenient to use matrix notation. Given <span class="math notranslate nohighlight">\(m\)</span> observations, we will have <span class="math notranslate nohighlight">\(m\)</span> equations:</p>
<div class="math notranslate nohighlight">
\[y^{(1)} = \beta_0 + \beta_1 x_1^{(1)} + \ldots + \beta_n x_n^{(1)} + e^{(1)}\]</div>
<div class="math notranslate nohighlight">
\[y^{(2)} = \beta_0 + \beta_1 x_1^{(2)} + \ldots + \beta_n x_n^{(2)} + e^{(2)}\]</div>
<div class="math notranslate nohighlight">
\[\ldots\]</div>
<div class="math notranslate nohighlight">
\[y^{(m)} = \beta_0 + \beta_1 x_1^{(m)} + \ldots + \beta_n x_n^{(m)} + e^{(m)}\]</div>
<p>We can write the <span class="math notranslate nohighlight">\(m\)</span> equations in matrix form as follows:</p>
<div class="math notranslate nohighlight">
\[\mathbf{y} = \mathbf{X} \mathbf{\beta} + \mathbf{e}\]</div>
<p>where:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{y} = \begin{bmatrix}
y^{(1)} \\
y^{(2)} \\
\vdots \\
y^{(m)}
\end{bmatrix},
\mathbf{X}=
\begin{bmatrix}
1 &amp; x_1^{(1)} &amp; x_2^{(1)} &amp; \ldots &amp; x_n^{(1)} \\
1 &amp; x_1^{(2)} &amp; x_2^{(2)} &amp; \ldots &amp;  x_n^{(2)} \\
\vdots &amp; \vdots &amp; \vdots \\
1 &amp; x_1^{(m)} &amp; x_2^{(m)} &amp; \ldots &amp;  x_n^{(m)} \\
\end{bmatrix},
\mathbf{\beta} = \begin{bmatrix}
\beta_{0} \\
\beta_{1} \\
\vdots \\
\beta_{n}
\end{bmatrix},
\mathbf{e} = \begin{bmatrix}
e^{(1)} \\
e^{(2)} \\
\vdots \\
e^{(m)}
\end{bmatrix}
\end{split}\]</div>
<p>The matrix <span class="math notranslate nohighlight">\(\mathbf{X}\)</span> is called the <strong>design matrix</strong>.</p>
<p>In the notation above, we want to minimize:</p>
<div class="math notranslate nohighlight">
\[RSS(\mathbf{\beta}) = \sum_{i=1}^m (e^{(i)})^2 = \mathbf{e}^T \mathbf{e}\]</div>
<p>It can be shown that, by the <strong>least squares method</strong>, the RSS is minimized by the estimate:</p>
<div class="math notranslate nohighlight">
\[\mathbf{\hat \beta} = (\mathbf{X}^T\mathbf{X})^{-1}\mathbf{X}^T\mathbf{y}\]</div>
</section>
<section id="the-f-test">
<h4><span class="section-number">18.4.4. </span>The F-Test<a class="headerlink" href="#the-f-test" title="Permalink to this heading">#</a></h4>
<p>When fitting a multiple linear regressor, it is common to perform a statistical test to check whether at least one of the regression coefficients is significantly different from zero (in the population). This test is called an <span class="math notranslate nohighlight">\(F-test\)</span>. We define the <strong>null and alternative hypotheses</strong> as follows:</p>
<div class="math notranslate nohighlight">
\[H_0: \beta_1=\beta_2=\ldots=\beta_n=0\]</div>
<div class="math notranslate nohighlight">
\[H_a: \exists j\ s.t.\ \beta_j \neq 0\]</div>
<p>The null hypothesis (the one we want to reject with this test) is that all coefficients are zero in the population. If this is true, than the multiple regressor is not reliable and we should discard it. The alternative hypothesis is that at least one of the coefficients is different from zero.</p>
<p>The test is performed by computing the following F-statistic:</p>
<div class="math notranslate nohighlight">
\[F=\frac{(TSS-RSS)/n}{RSS(m-n-1)}\]</div>
<p>Where recall that <span class="math notranslate nohighlight">\(n\)</span> is the number of variables and <span class="math notranslate nohighlight">\(m\)</span> is the number of observations.</p>
<p>In practice, the F-statistic will be:</p>
<ul class="simple">
<li><p>Close to <span class="math notranslate nohighlight">\(1\)</span> if there is no relationship between the response and the predictors (<span class="math notranslate nohighlight">\(H_0\)</span> is true);</p></li>
<li><p>Greater than <span class="math notranslate nohighlight">\(1\)</span> if <span class="math notranslate nohighlight">\(H_a\)</span> is true.</p></li>
</ul>
<p>The test is carried out as usual, finding a p-value which indicates the probability to observe a statistic larger than the observed one if all regression coefficients are zero in the population.</p>
<p>In our example of regressing <code class="docutils literal notranslate"><span class="pre">mpg</span></code> from <code class="docutils literal notranslate"><span class="pre">horsepower</span></code> and <code class="docutils literal notranslate"><span class="pre">weight</span></code>, we will find:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p><span class="math notranslate nohighlight">\(R^2\)</span></p></th>
<th class="head"><p>F-statistic</p></th>
<th class="head"><p>Prob(F-statistic)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0.706</p></td>
<td><p>467.9</p></td>
<td><p>3.06e-104</p></td>
</tr>
</tbody>
</table>
<p>This indicates that the regressor is statistically relevant. The <span class="math notranslate nohighlight">\(F-statistic\)</span> is much larger than <span class="math notranslate nohighlight">\(1\)</span> and the p-value (Prob(F-statistic)) is very small (under the significance level <span class="math notranslate nohighlight">\(\alpha = 0.05\)</span>).</p>
</section>
<section id="variable-selection">
<h4><span class="section-number">18.4.5. </span>Variable Selection<a class="headerlink" href="#variable-selection" title="Permalink to this heading">#</a></h4>
<p>Let’s now try to fit a multiple linear regressor on our dataset by including all variables. Our dependent variable will be <code class="docutils literal notranslate"><span class="pre">mpg</span></code>, while the set of dependent variables will be:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;displacement&#39; &#39;cylinders&#39; &#39;horsepower&#39; &#39;weight&#39; &#39;acceleration&#39;
 &#39;model_year&#39; &#39;origin&#39;]
</pre></div>
</div>
</div>
</div>
<p>We obtain the following measures of fit:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p><span class="math notranslate nohighlight">\(R^2\)</span></p></th>
<th class="head"><p>F-statistic</p></th>
<th class="head"><p>Prob(F-statistic)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0.821</p></td>
<td><p>252.4</p></td>
<td><p>2.04e-139</p></td>
</tr>
</tbody>
</table>
<p>The regressor has a good <span class="math notranslate nohighlight">\(R^2\)</span> and the p-value of the F-test is very small. We can conclude that there is some relationship between the independent variables and the dependent one.</p>
<p>The estimates of the regression coefficients will be:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<tr>
        <td></td>          <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th>    <td>  -17.2184</td> <td>    4.644</td> <td>   -3.707</td> <td> 0.000</td> <td>  -26.350</td> <td>   -8.087</td>
</tr>
<tr>
  <th>horsepower</th>   <td>   -0.0170</td> <td>    0.014</td> <td>   -1.230</td> <td> 0.220</td> <td>   -0.044</td> <td>    0.010</td>
</tr>
<tr>
  <th>weight</th>       <td>   -0.0065</td> <td>    0.001</td> <td>   -9.929</td> <td> 0.000</td> <td>   -0.008</td> <td>   -0.005</td>
</tr>
<tr>
  <th>displacement</th> <td>    0.0199</td> <td>    0.008</td> <td>    2.647</td> <td> 0.008</td> <td>    0.005</td> <td>    0.035</td>
</tr>
<tr>
  <th>cylinders</th>    <td>   -0.4934</td> <td>    0.323</td> <td>   -1.526</td> <td> 0.128</td> <td>   -1.129</td> <td>    0.142</td>
</tr>
<tr>
  <th>acceleration</th> <td>    0.0806</td> <td>    0.099</td> <td>    0.815</td> <td> 0.415</td> <td>   -0.114</td> <td>    0.275</td>
</tr>
<tr>
  <th>model_year</th>   <td>    0.7508</td> <td>    0.051</td> <td>   14.729</td> <td> 0.000</td> <td>    0.651</td> <td>    0.851</td>
</tr>
<tr>
  <th>origin</th>       <td>    1.4261</td> <td>    0.278</td> <td>    5.127</td> <td> 0.000</td> <td>    0.879</td> <td>    1.973</td>
</tr>
</table></div></div>
</div>
<p>From the table, we can see that not all predictors have a p-value below the significance level <span class="math notranslate nohighlight">\(\alpha=0.05\)</span>. In particular:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">horsepower</span></code> has a large p-value of <span class="math notranslate nohighlight">\(0.22\)</span>;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cylinders</span></code> has a large p-value of <span class="math notranslate nohighlight">\(0.128\)</span>;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">acceleration</span></code> has a large p-value of <span class="math notranslate nohighlight">\(0.415\)</span>.</p></li>
</ul>
<p>This means that, within the current regressor, there is no meaningful relationship between these variables and <code class="docutils literal notranslate"><span class="pre">mpg</span></code>. A legitimate question is</p>
<blockquote>
<div><p>How is it possible that <code class="docutils literal notranslate"><span class="pre">horsepower</span></code> is not associated to <code class="docutils literal notranslate"><span class="pre">mpg</span></code> in this regressor if it was associated to it before?!</p>
</div></blockquote>
<p>However, we should recall that, when we consider a different set of variables, the interpretation of the coefficients changes. So, even if in the previous models, <code class="docutils literal notranslate"><span class="pre">horsepower</span></code> was correlated to <code class="docutils literal notranslate"><span class="pre">mpg</span></code>, now it is not correlated anymore. We can imagine that the relationship between these variables is now explained by the other variables which we have introduced.</p>
<p>Even if the model is statistically significant, it does make sense to get rid of the variables with poor relationships with <code class="docutils literal notranslate"><span class="pre">mpg</span></code>. After all, if we remove a variable, the estimates of the other coefficients may change.</p>
<p>A common way to remove these variables is by <strong>backward selection</strong> or <strong>backward elimination</strong>. This consists in iteratively removing the variable with the largest p-value. We remove one variable at a time and re-compute the results, iterating until all variables have a small p-value.</p>
<p>let’s start by removing <code class="docutils literal notranslate"><span class="pre">acceleration</span></code>. This is the result:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<tr>
        <td></td>          <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th>    <td>  -15.5635</td> <td>    4.175</td> <td>   -3.728</td> <td> 0.000</td> <td>  -23.773</td> <td>   -7.354</td>
</tr>
<tr>
  <th>horsepower</th>   <td>   -0.0239</td> <td>    0.011</td> <td>   -2.205</td> <td> 0.028</td> <td>   -0.045</td> <td>   -0.003</td>
</tr>
<tr>
  <th>weight</th>       <td>   -0.0062</td> <td>    0.001</td> <td>  -10.883</td> <td> 0.000</td> <td>   -0.007</td> <td>   -0.005</td>
</tr>
<tr>
  <th>displacement</th> <td>    0.0193</td> <td>    0.007</td> <td>    2.579</td> <td> 0.010</td> <td>    0.005</td> <td>    0.034</td>
</tr>
<tr>
  <th>cylinders</th>    <td>   -0.5067</td> <td>    0.323</td> <td>   -1.570</td> <td> 0.117</td> <td>   -1.141</td> <td>    0.128</td>
</tr>
<tr>
  <th>model_year</th>   <td>    0.7475</td> <td>    0.051</td> <td>   14.717</td> <td> 0.000</td> <td>    0.648</td> <td>    0.847</td>
</tr>
<tr>
  <th>origin</th>       <td>    1.4282</td> <td>    0.278</td> <td>    5.138</td> <td> 0.000</td> <td>    0.882</td> <td>    1.975</td>
</tr>
</table></div></div>
</div>
<p>Note that the coefficients have changed. We now remove <code class="docutils literal notranslate"><span class="pre">cylinders</span></code>, which has the largest p-value of <span class="math notranslate nohighlight">\(0.117\)</span>:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<tr>
        <td></td>          <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th>    <td>  -16.6939</td> <td>    4.120</td> <td>   -4.051</td> <td> 0.000</td> <td>  -24.795</td> <td>   -8.592</td>
</tr>
<tr>
  <th>horsepower</th>   <td>   -0.0219</td> <td>    0.011</td> <td>   -2.033</td> <td> 0.043</td> <td>   -0.043</td> <td>   -0.001</td>
</tr>
<tr>
  <th>weight</th>       <td>   -0.0063</td> <td>    0.001</td> <td>  -11.124</td> <td> 0.000</td> <td>   -0.007</td> <td>   -0.005</td>
</tr>
<tr>
  <th>displacement</th> <td>    0.0114</td> <td>    0.006</td> <td>    2.054</td> <td> 0.041</td> <td>    0.000</td> <td>    0.022</td>
</tr>
<tr>
  <th>model_year</th>   <td>    0.7484</td> <td>    0.051</td> <td>   14.707</td> <td> 0.000</td> <td>    0.648</td> <td>    0.848</td>
</tr>
<tr>
  <th>origin</th>       <td>    1.3853</td> <td>    0.277</td> <td>    4.998</td> <td> 0.000</td> <td>    0.840</td> <td>    1.930</td>
</tr>
</table></div></div>
</div>
<p>All variables now have an acceptable p-value (<span class="math notranslate nohighlight">\(\alpha=0.05\)</span>). We are done. Note that, by removing the two variables, <code class="docutils literal notranslate"><span class="pre">horsepower</span></code> now has an acceptable p-value. This indicates that one of the removed variables was redundant with respect to <code class="docutils literal notranslate"><span class="pre">horsepower</span></code>.</p>
</section>
<section id="adjusted-r-2">
<h4><span class="section-number">18.4.6. </span>Adjusted <span class="math notranslate nohighlight">\(R^2\)</span><a class="headerlink" href="#adjusted-r-2" title="Permalink to this heading">#</a></h4>
<p>While in the case of simple regression we saw that <span class="math notranslate nohighlight">\(R^2=\rho(x,y)^2\)</span> (where <span class="math notranslate nohighlight">\(\rho\)</span> is the correlation coefficient), in the case of multiple regression, it turns out that:</p>
<div class="math notranslate nohighlight">
\[R^2 = \rho(Y, \hat Y)^2\]</div>
<p>In general, having more variables in the linear regressor will reduce the error term and improve the covariance between <span class="math notranslate nohighlight">\(Y\)</span> and <span class="math notranslate nohighlight">\(\hat Y\)</span>, hence increasing the <span class="math notranslate nohighlight">\(R^2\)</span>. However, in general having a small increase in <span class="math notranslate nohighlight">\(R^2\)</span> when we add a new variable may not be good. Indeed, we could prefer a simpler model with a slightly smaller <span class="math notranslate nohighlight">\(R^2\)</span> value.</p>
<p>To express this, we can compute the adjusted <span class="math notranslate nohighlight">\(R^2\)</span> as follows:</p>
<div class="math notranslate nohighlight">
\[\overline R^2 = 1- \frac{m-1}{m-n-1} R^2\]</div>
<p>Where <span class="math notranslate nohighlight">\(m\)</span> is the number of data points and <span class="math notranslate nohighlight">\(n\)</span> is the number of independent variables. The <span class="math notranslate nohighlight">\(\overline R^2\)</span> re-balances the <span class="math notranslate nohighlight">\(R^2\)</span> accounting for the introduction of additional variables.</p>
<p>For instance the last model we fit has an <span class="math notranslate nohighlight">\(R^2=0.820\)</span> and <span class="math notranslate nohighlight">\(\overline R^2=0.818\)</span>. We will see more in details how to use the <span class="math notranslate nohighlight">\(\overline R^2\)</span> in the laboratory.</p>
</section>
</section>
<section id="qualitative-predictors">
<h3><span class="section-number">18.5. </span>Qualitative Predictors<a class="headerlink" href="#qualitative-predictors" title="Permalink to this heading">#</a></h3>
<p>So far, we have studied relationships between continuous variables. In practice, linear regression allows to also study relationship between <strong>continuous dependent variables</strong> and <strong>qualitative independent variables</strong>. We will consider another dataset similar to the <strong>Auto MPG</strong> dataset:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mpg</th>
      <th>horsepower</th>
      <th>fuelsystem</th>
      <th>fueltype</th>
      <th>length</th>
      <th>cylinders</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>21</td>
      <td>111.0</td>
      <td>mpfi</td>
      <td>gas</td>
      <td>168.8</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>21</td>
      <td>111.0</td>
      <td>mpfi</td>
      <td>gas</td>
      <td>168.8</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>19</td>
      <td>154.0</td>
      <td>mpfi</td>
      <td>gas</td>
      <td>171.2</td>
      <td>6</td>
    </tr>
    <tr>
      <th>3</th>
      <td>24</td>
      <td>102.0</td>
      <td>mpfi</td>
      <td>gas</td>
      <td>176.6</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>18</td>
      <td>115.0</td>
      <td>mpfi</td>
      <td>gas</td>
      <td>176.6</td>
      <td>5</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>200</th>
      <td>23</td>
      <td>114.0</td>
      <td>mpfi</td>
      <td>gas</td>
      <td>188.8</td>
      <td>4</td>
    </tr>
    <tr>
      <th>201</th>
      <td>19</td>
      <td>160.0</td>
      <td>mpfi</td>
      <td>gas</td>
      <td>188.8</td>
      <td>4</td>
    </tr>
    <tr>
      <th>202</th>
      <td>18</td>
      <td>134.0</td>
      <td>mpfi</td>
      <td>gas</td>
      <td>188.8</td>
      <td>6</td>
    </tr>
    <tr>
      <th>203</th>
      <td>26</td>
      <td>106.0</td>
      <td>idi</td>
      <td>diesel</td>
      <td>188.8</td>
      <td>6</td>
    </tr>
    <tr>
      <th>204</th>
      <td>19</td>
      <td>114.0</td>
      <td>mpfi</td>
      <td>gas</td>
      <td>188.8</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
<p>205 rows × 6 columns</p>
</div></div></div>
</div>
<p>In this case, besides having numerical variables, we also have qualitative ones such as <code class="docutils literal notranslate"><span class="pre">fuelsystem</span></code> and <code class="docutils literal notranslate"><span class="pre">fueltype</span></code>. Let’s see what are their unique values:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Fuel System: [&#39;mpfi&#39; &#39;2bbl&#39; &#39;mfi&#39; &#39;1bbl&#39; &#39;spfi&#39; &#39;4bbl&#39; &#39;idi&#39; &#39;spdi&#39;]
Fuel Type: [&#39;gas&#39; &#39;diesel&#39;]
</pre></div>
</div>
</div>
</div>
<p>We will not see the meaning of all the values of <code class="docutils literal notranslate"><span class="pre">fuelsystem</span></code>, while the values of <code class="docutils literal notranslate"><span class="pre">fueltype</span></code> are self-explanatory.</p>
<section id="predictors-with-only-two-levels">
<h4><span class="section-number">18.5.1. </span>Predictors with Only Two Levels<a class="headerlink" href="#predictors-with-only-two-levels" title="Permalink to this heading">#</a></h4>
<p>We will first see the case in which qualitative predictors only have two levels. To handle these as independent variables, we can define a new <strong>dummy variable</strong> which will encode <span class="math notranslate nohighlight">\(1\)</span> as one of the two levels and <span class="math notranslate nohighlight">\(0\)</span> as the other one. For instance, we can introduce a <code class="docutils literal notranslate"><span class="pre">fueltype[T.gas]</span></code> variable defined as follows:</p>
<div class="math notranslate nohighlight">
\[\begin{split}fueltype[T.gas] = \begin{cases} 1 &amp; \text{if } fueltype=gas \\ 0 &amp; \text{otherwise}\end{cases}\end{split}\]</div>
<p>If we fit the model:</p>
<div class="math notranslate nohighlight">
\[mpg = \beta_0 + \beta_1 horsepower + \beta_1 fueltype[T.gas]\]</div>
<p>We obtain an <span class="math notranslate nohighlight">\(R^2=0.661\)</span> with <span class="math notranslate nohighlight">\(Prob(F-statistic) \approx 0\)</span> and the following estimates for the regression parameters:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<tr>
         <td></td>            <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th>       <td>   41.2379</td> <td>    1.039</td> <td>   39.705</td> <td> 0.000</td> <td>   39.190</td> <td>   43.286</td>
</tr>
<tr>
  <th>fueltype[T.gas]</th> <td>   -2.7658</td> <td>    0.918</td> <td>   -3.013</td> <td> 0.003</td> <td>   -4.576</td> <td>   -0.956</td>
</tr>
<tr>
  <th>horsepower</th>      <td>   -0.1295</td> <td>    0.007</td> <td>  -18.758</td> <td> 0.000</td> <td>   -0.143</td> <td>   -0.116</td>
</tr>
</table></div></div>
</div>
<p>How do we interpret this result?</p>
<ul class="simple">
<li><p>The value of <code class="docutils literal notranslate"><span class="pre">mpg</span></code> when <code class="docutils literal notranslate"><span class="pre">horsepower=0</span></code> <code class="docutils literal notranslate"><span class="pre">fueltype=diesel</span></code> (i.e., <code class="docutils literal notranslate"><span class="pre">fueltype[T.gas]=0</span></code>) is <span class="math notranslate nohighlight">\(41.2379\)</span>;</p></li>
<li><p>An increase of one unit of <code class="docutils literal notranslate"><span class="pre">horsepower</span></code> is associated to a decrease of <span class="math notranslate nohighlight">\(0.1295\)</span> units of <code class="docutils literal notranslate"><span class="pre">mpg</span></code> provided that <code class="docutils literal notranslate"><span class="pre">fueltype=diesel</span></code>;</p></li>
<li><p>For gas vehicles we expect to see a decrease of <code class="docutils literal notranslate"><span class="pre">mpg</span></code> equal to <span class="math notranslate nohighlight">\(2.7658\)</span> with respect to diesel vehicles.</p></li>
</ul>
</section>
<section id="predictors-with-more-than-two-levels">
<h4><span class="section-number">18.5.2. </span>Predictors with More than Two Levels<a class="headerlink" href="#predictors-with-more-than-two-levels" title="Permalink to this heading">#</a></h4>
<p>When predictors have <span class="math notranslate nohighlight">\(n\)</span> levels, we need to introduce <strong>multiple dummy variables</strong>. Specifically, we need to introduce <span class="math notranslate nohighlight">\(n-1\)</span> binary variables. For instance, if the levels of the variable <code class="docutils literal notranslate"><span class="pre">income</span></code> are <code class="docutils literal notranslate"><span class="pre">low</span></code>, <code class="docutils literal notranslate"><span class="pre">medium</span></code> and <code class="docutils literal notranslate"><span class="pre">high</span></code>, we could introduce two variables <code class="docutils literal notranslate"><span class="pre">income[T.low]</span></code> and <code class="docutils literal notranslate"><span class="pre">income[T.medium]</span></code>. These are sufficient to express all possible values of <code class="docutils literal notranslate"><span class="pre">income</span></code> as shown in the table below:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p><code class="docutils literal notranslate"><span class="pre">income</span></code></p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">income[T.low]</span></code></p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">income[T.medium]</span></code></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">low</span></code></p></td>
<td><p>1</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">medium</span></code></p></td>
<td><p>0</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">high</span></code></p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
</tbody>
</table>
<p>Note that we could have introduced a new variable <code class="docutils literal notranslate"><span class="pre">income[T.high]</span></code> but this would have been redundant and so <strong>correlated to the other two variables</strong>, which is something we know we have to avoid in linear regression.</p>
<p>If we fit the model which predicts <code class="docutils literal notranslate"><span class="pre">mpg</span></code> from <code class="docutils literal notranslate"><span class="pre">horsepower</span></code> and <code class="docutils literal notranslate"><span class="pre">fuelsystem</span></code> we obtain <span class="math notranslate nohighlight">\(R^2=0.734\)</span>, <span class="math notranslate nohighlight">\(Prob(F-statistic) \approx 0\)</span> and the following estimates for the regression coefficients:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<tr>
           <td></td>             <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th>          <td>   38.8638</td> <td>    1.234</td> <td>   31.504</td> <td> 0.000</td> <td>   36.431</td> <td>   41.297</td>
</tr>
<tr>
  <th>fuelsystem[T.2bbl]</th> <td>   -1.6374</td> <td>    1.127</td> <td>   -1.453</td> <td> 0.148</td> <td>   -3.860</td> <td>    0.585</td>
</tr>
<tr>
  <th>fuelsystem[T.4bbl]</th> <td>  -12.0875</td> <td>    2.263</td> <td>   -5.341</td> <td> 0.000</td> <td>  -16.551</td> <td>   -7.624</td>
</tr>
<tr>
  <th>fuelsystem[T.idi]</th>  <td>   -0.3894</td> <td>    1.300</td> <td>   -0.299</td> <td> 0.765</td> <td>   -2.954</td> <td>    2.175</td>
</tr>
<tr>
  <th>fuelsystem[T.mfi]</th>  <td>   -5.8285</td> <td>    3.661</td> <td>   -1.592</td> <td> 0.113</td> <td>  -13.049</td> <td>    1.392</td>
</tr>
<tr>
  <th>fuelsystem[T.mpfi]</th> <td>   -5.4942</td> <td>    1.202</td> <td>   -4.570</td> <td> 0.000</td> <td>   -7.865</td> <td>   -3.123</td>
</tr>
<tr>
  <th>fuelsystem[T.spdi]</th> <td>   -5.2446</td> <td>    1.612</td> <td>   -3.254</td> <td> 0.001</td> <td>   -8.423</td> <td>   -2.066</td>
</tr>
<tr>
  <th>fuelsystem[T.spfi]</th> <td>   -6.1522</td> <td>    3.615</td> <td>   -1.702</td> <td> 0.090</td> <td>  -13.282</td> <td>    0.978</td>
</tr>
<tr>
  <th>horsepower</th>         <td>   -0.0968</td> <td>    0.009</td> <td>  -11.248</td> <td> 0.000</td> <td>   -0.114</td> <td>   -0.080</td>
</tr>
</table></div></div>
</div>
<p>As we can see, we have added different correlation coefficients in order to deal with the different levels. Not all predictors have a low p-value, so we can remove those with backward elimination. We will see some more examples in the laboratory.</p>
</section>
</section>
<section id="extensions-of-the-linear-model">
<h3><span class="section-number">18.6. </span>Extensions of the Linear Model<a class="headerlink" href="#extensions-of-the-linear-model" title="Permalink to this heading">#</a></h3>
<p>The linear model makes the very restrictive assumption that the the nature of the relationship between the variables is linear. However, in many cases, it is common to find relationships which deviate from this assumption. In the following sections, we will see some simple ways to deviate from these assumption within a linear regression model.</p>
<section id="interaction-terms">
<h4><span class="section-number">18.6.1. </span>Interaction Terms<a class="headerlink" href="#interaction-terms" title="Permalink to this heading">#</a></h4>
<p>A linear regression model assumes that <strong>the effect of the different independent variables to the prediction of the dependent variable is additive</strong>:</p>
<div class="math notranslate nohighlight">
\[y = \beta_0 + \beta_1 x_1 + \ldots + \beta_n x_n + \epsilon\]</div>
<p>In some cases, however, it makes sense to assume the presence of <strong>interaction terms</strong>, i.e., terms in the model which account for the interactions between some variables. For instance:</p>
<div class="math notranslate nohighlight">
\[y = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + \beta_3 x_1x_2\]</div>
<p>As a concrete example, consider the problem of regressing <code class="docutils literal notranslate"><span class="pre">mpg</span></code> from <code class="docutils literal notranslate"><span class="pre">horsepower</span></code> and <code class="docutils literal notranslate"><span class="pre">weight</span></code>. A simple model of the kind:</p>
<div class="math notranslate nohighlight">
\[mpg = \beta_0 + \beta_1 horsepower + \beta_1 weight\]</div>
<p>assumes that the <span class="math notranslate nohighlight">\(\beta_1\)</span>, the increment that we observe in <code class="docutils literal notranslate"><span class="pre">mpg</span></code> when <code class="docutils literal notranslate"><span class="pre">horsepower</span></code> increments by one unit is <strong>constant even when other variables change their values</strong>. However, we can imagine how, for light vehicles <code class="docutils literal notranslate"><span class="pre">horsepower</span></code> affects <code class="docutils literal notranslate"><span class="pre">mpg</span></code> in a way, while for heavy vehicles <code class="docutils literal notranslate"><span class="pre">horsepower</span></code> affects <code class="docutils literal notranslate"><span class="pre">mpg</span></code> in a different way. For example, we expect light vehicles with big <code class="docutils literal notranslate"><span class="pre">horsepower</span></code> to be more efficient than heavy vehicles with small <code class="docutils literal notranslate"><span class="pre">horsepower</span></code>. To account for this, we could consider the following model instead:</p>
<div class="math notranslate nohighlight">
\[mpg = \beta_0 + \beta_1 horsepower + \beta_2 weight + \beta_3 horsepower \times weight\]</div>
<p>Note that the model above is nonlinear in <span class="math notranslate nohighlight">\(horsepower\)</span> and <span class="math notranslate nohighlight">\(weight\)</span>, but it is still linear if we introduce a variable <span class="math notranslate nohighlight">\(hw = horsepower \times weight\)</span>. We can easily do this by adding a new column to our design matrix computed as the product of the two variables. Then we can fit the model using the same exact estimators seen before.</p>
<p>This new regressor obtained <span class="math notranslate nohighlight">\(R^2=0.748\)</span>, which is larger as compared to <span class="math notranslate nohighlight">\(R^2=0.706\)</span> obtained for the <span class="math notranslate nohighlight">\(mpg = \beta_0 + \beta_1 horsepower + \beta_2 weight\)</span> regressor. Both regressor have a large F-statistic and an associated p-value close to zero. The new regressor explains more variance than the previous one.</p>
<p>The estimated coefficients are:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<tr>
          <td></td>             <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th>         <td>   63.5579</td> <td>    2.343</td> <td>   27.127</td> <td> 0.000</td> <td>   58.951</td> <td>   68.164</td>
</tr>
<tr>
  <th>horsepower</th>        <td>   -0.2508</td> <td>    0.027</td> <td>   -9.195</td> <td> 0.000</td> <td>   -0.304</td> <td>   -0.197</td>
</tr>
<tr>
  <th>weight</th>            <td>   -0.0108</td> <td>    0.001</td> <td>  -13.921</td> <td> 0.000</td> <td>   -0.012</td> <td>   -0.009</td>
</tr>
<tr>
  <th>horsepower:weight</th> <td> 5.355e-05</td> <td> 6.65e-06</td> <td>    8.054</td> <td> 0.000</td> <td> 4.05e-05</td> <td> 6.66e-05</td>
</tr>
</table></div></div>
</div>
<p>Let’s compare these with the ones obtained for the <span class="math notranslate nohighlight">\(mpg = \beta_0 + \beta_1 horsepower + \beta_2 weight\)</span> regressor:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<tr>
       <td></td>         <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th>  <td>   45.6402</td> <td>    0.793</td> <td>   57.540</td> <td> 0.000</td> <td>   44.081</td> <td>   47.200</td>
</tr>
<tr>
  <th>horsepower</th> <td>   -0.0473</td> <td>    0.011</td> <td>   -4.267</td> <td> 0.000</td> <td>   -0.069</td> <td>   -0.026</td>
</tr>
<tr>
  <th>weight</th>     <td>   -0.0058</td> <td>    0.001</td> <td>  -11.535</td> <td> 0.000</td> <td>   -0.007</td> <td>   -0.005</td>
</tr>
</table></div></div>
</div>
<p>We can note that:</p>
<ul class="simple">
<li><p>The p-value of the product <span class="math notranslate nohighlight">\(horsepower \times weight\)</span> is almost zero. This is a strong evidence that the true relationship is not merely additive, but an interaction between the two variables actually happens.</p></li>
<li><p>The coefficients of <code class="docutils literal notranslate"><span class="pre">horsepower</span></code> and <code class="docutils literal notranslate"><span class="pre">weight</span></code> have changed. This makes sense, also their interpretation has changed. For instance, in the new regressor an increase of one unit of <code class="docutils literal notranslate"><span class="pre">horsepower</span></code> is associated to an decrease of <span class="math notranslate nohighlight">\(0.2508\)</span> units of <code class="docutils literal notranslate"><span class="pre">mpg</span></code> if <strong>the product between <code class="docutils literal notranslate"><span class="pre">horsepower</span></code> and <code class="docutils literal notranslate"><span class="pre">weight</span></code> does not change</strong>, i.e., if the way the two quantities interact does not change.</p></li>
</ul>
<p>How should we interpret the coefficient <span class="math notranslate nohighlight">\(\beta_3\)</span>? Let’s rewrite our model:</p>
<div class="math notranslate nohighlight">
\[mpg = \beta_0 + \beta_1 horsepower + \beta_2 weight + \beta_3 horsepower \times weight\]</div>
<p>as follows:</p>
<div class="math notranslate nohighlight">
\[mpg = \beta_0 + horsepower (\beta_1 + \beta_3 weight) + \beta_2 weight \]</div>
<p>Hence we can see <span class="math notranslate nohighlight">\(\beta_3\)</span> as the increase in the coefficient of <code class="docutils literal notranslate"><span class="pre">horsepower</span></code> when <code class="docutils literal notranslate"><span class="pre">weight</span></code> increases by one unit. In the example above <span class="math notranslate nohighlight">\(\beta_3\)</span> is very small, this is due to the fact that weight is measured in pounds, so increasing the weight by one pound has a very small effect. It easy to see that, <strong>an increase in <code class="docutils literal notranslate"><span class="pre">weight</span></code> by <span class="math notranslate nohighlight">\(1000\)</span> pounds increases the coefficient of <span class="math notranslate nohighlight">\(horsepower\)</span> by <span class="math notranslate nohighlight">\(1000 \beta_3 \approx = 0.05\)</span></strong>. This is a relevant increase, considering that the coefficient of <span class="math notranslate nohighlight">\(horsepower\)</span> is <span class="math notranslate nohighlight">\(-0.2508\)</span>. Hence, when we see an increase in <code class="docutils literal notranslate"><span class="pre">weight</span></code> of <span class="math notranslate nohighlight">\(1000\)</span> units, the coefficient of <code class="docutils literal notranslate"><span class="pre">horsepower</span></code> will be larger, meaning that <strong>in heavier cars, large <code class="docutils literal notranslate"><span class="pre">horsepower</span></code> will let <code class="docutils literal notranslate"><span class="pre">mpg</span></code> decrease more gently</strong>.</p>
<p>Let us consider the computed coefficients again:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<tr>
          <td></td>             <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th>         <td>   63.5579</td> <td>    2.343</td> <td>   27.127</td> <td> 0.000</td> <td>   58.951</td> <td>   68.164</td>
</tr>
<tr>
  <th>horsepower</th>        <td>   -0.2508</td> <td>    0.027</td> <td>   -9.195</td> <td> 0.000</td> <td>   -0.304</td> <td>   -0.197</td>
</tr>
<tr>
  <th>weight</th>            <td>   -0.0108</td> <td>    0.001</td> <td>  -13.921</td> <td> 0.000</td> <td>   -0.012</td> <td>   -0.009</td>
</tr>
<tr>
  <th>horsepower:weight</th> <td> 5.355e-05</td> <td> 6.65e-06</td> <td>    8.054</td> <td> 0.000</td> <td> 4.05e-05</td> <td> 6.66e-05</td>
</tr>
</table></div></div>
</div>
<p>We can interpret the results as follows:</p>
<ul class="simple">
<li><p><strong>Intercept</strong>: the value of <code class="docutils literal notranslate"><span class="pre">mpg</span></code> is <span class="math notranslate nohighlight">\(63.5579\)</span> when <code class="docutils literal notranslate"><span class="pre">horsepower=0</span></code> and <code class="docutils literal notranslate"><span class="pre">weight=0</span></code> (also their product will be zero);</p></li>
<li><p><strong>horsepower</strong>: an increase of one unit corresponds to a decrement of <span class="math notranslate nohighlight">\(-0.2508\)</span> in <code class="docutils literal notranslate"><span class="pre">mpg</span></code> provided that <code class="docutils literal notranslate"><span class="pre">weight</span></code> is held constant and the way <code class="docutils literal notranslate"><span class="pre">weight</span></code> influences <code class="docutils literal notranslate"><span class="pre">horsepower</span></code> does not change. Note that, if we change the value of <code class="docutils literal notranslate"><span class="pre">horsepower</span></code> and keep <code class="docutils literal notranslate"><span class="pre">weight</span></code> constant, the interaction term will change. Here we assume that, even if the ratio change, we assume that the way <code class="docutils literal notranslate"><span class="pre">weight</span></code> affects <code class="docutils literal notranslate"><span class="pre">horsepower</span></code> does not change.</p></li>
<li><p><strong>weight</strong>: an increase of one unit corresponds to a decrement of <span class="math notranslate nohighlight">\(-0.0108\)</span> in <code class="docutils literal notranslate"><span class="pre">mpg</span></code> provided that <code class="docutils literal notranslate"><span class="pre">horsepower</span></code> is held constant and the way <code class="docutils literal notranslate"><span class="pre">horsepower</span></code> affects <code class="docutils literal notranslate"><span class="pre">weight</span></code> does not change.</p></li>
<li><p><strong>horsepower:weight</strong>: an increase in one unit of <code class="docutils literal notranslate"><span class="pre">weight</span></code> increases the coefficient regulating the effect of <code class="docutils literal notranslate"><span class="pre">horsepower</span></code> on <code class="docutils literal notranslate"><span class="pre">mpg</span></code> by <span class="math notranslate nohighlight">\(5.05e-5\)</span>.</p></li>
</ul>
</section>
<section id="non-linear-relationships-quadratic-and-polynomial-regression">
<h4><span class="section-number">18.6.2. </span>Non-linear Relationships: Quadratic and Polynomial Regression<a class="headerlink" href="#non-linear-relationships-quadratic-and-polynomial-regression" title="Permalink to this heading">#</a></h4>
<p>In many cases, the relationship between two variables is not linear. Let’s visualize the scatterplot between <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span>:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/00f2868fa38957995abd2a520a22ea2428ba3dceb185f71054c3de10fb434315.png" src="../_images/00f2868fa38957995abd2a520a22ea2428ba3dceb185f71054c3de10fb434315.png" />
</div>
</div>
<p>This relationship does not look linear. It looks instead as a quadratic, which would be fit by the following model:</p>
<div class="math notranslate nohighlight">
\[mpg = \beta_0 + \beta_1 horsepower + \beta_2 horsepower^2\]</div>
<p>Again, the model above is nonlinear in <code class="docutils literal notranslate"><span class="pre">horsepower</span></code>, but we can still fit it with a linear regressor if we add a new variable <span class="math notranslate nohighlight">\(z=horsepower\)</span>.</p>
<p>The fit model will obtain <span class="math notranslate nohighlight">\(R^2=0.688\)</span>, larger than <span class="math notranslate nohighlight">\(R^2=608\)</span> obtained by the base model (<span class="math notranslate nohighlight">\(mpg = \beta_0 + \beta_1 horsepower\)</span>). Both have a large F-statistic.</p>
<p>The estimated coefficients are:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<tr>
           <td></td>             <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th>          <td>   56.9001</td> <td>    1.800</td> <td>   31.604</td> <td> 0.000</td> <td>   53.360</td> <td>   60.440</td>
</tr>
<tr>
  <th>horsepower</th>         <td>   -0.4662</td> <td>    0.031</td> <td>  -14.978</td> <td> 0.000</td> <td>   -0.527</td> <td>   -0.405</td>
</tr>
<tr>
  <th>I(horsepower ** 2)</th> <td>    0.0012</td> <td>    0.000</td> <td>   10.080</td> <td> 0.000</td> <td>    0.001</td> <td>    0.001</td>
</tr>
</table></div></div>
</div>
<p>The coefficients now describe the quadratic:</p>
<div class="math notranslate nohighlight">
\[y = 58.9001 - 0.4662 x + 0.0012 x^2\]</div>
<p>If we plot it on the data, we obtain the following:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/e738b8873300d9c7544d5c714998aa9325b362d565b7e27ed58babb98791b19b.png" src="../_images/e738b8873300d9c7544d5c714998aa9325b362d565b7e27ed58babb98791b19b.png" />
</div>
</div>
<p>In general, we can fit a polynomial model to the data, choosing a suitable degree <span class="math notranslate nohighlight">\(d\)</span>. For instance, for <span class="math notranslate nohighlight">\(d=4\)</span> we have:</p>
<div class="math notranslate nohighlight">
\[mpg = \beta_0 + \beta_1 horsepower + \beta_2 horsepower^2 + \beta_3 horsepower^3 + \beta_4 horsepower^4\]</div>
<p>which identifies the following fit:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/c633f07afcf8225e73d306c1a82a5cc2ba213db2ffbce86f01d0fb2426676b44.png" src="../_images/c633f07afcf8225e73d306c1a82a5cc2ba213db2ffbce86f01d0fb2426676b44.png" />
</div>
</div>
<p>This approach is known as <strong>polynomial regression</strong> and allows to turn the linear regression into a nonlinear model. Note that, when we have more variables, polynomial regression also includes interaction terms. For instance, the linear model:</p>
<div class="math notranslate nohighlight">
\[y = \beta_0 + \beta_1x + \beta_2y\]</div>
<p>becomes the following polynomial model of degree <span class="math notranslate nohighlight">\(2\)</span>:</p>
<div class="math notranslate nohighlight">
\[y = \beta_0 + \beta_1x + \beta_2y + \beta_3x^2 + \beta_4y^2 + \beta_5 xy\]</div>
<p>As usual, we only have to add new variables for the squared and interaction term and solve the problem as a linear regression one. This is easily handled by libraries. Note that, as the number of variables increases, the number of terms to add for a given degree also increases.</p>
</section>
</section>
<section id="residual-plots-and-residual-q-q-plots">
<h3><span class="section-number">18.7. </span>Residual Plots and Residual Q-Q Plots<a class="headerlink" href="#residual-plots-and-residual-q-q-plots" title="Permalink to this heading">#</a></h3>
<p>Residual plots are a way to diagnose if the linear model we are fitting on the data actually describes the relationship between the variables. For instance, if the relationship is not linear, and we try to force a linear model, the model will not be accurate.</p>
<p>If the relation is accurate, we expect the residuals of the model (i.e., the <span class="math notranslate nohighlight">\(e_i=\hat y_i - y_i\)</span> terms) to be random and approximately Gaussian.</p>
<p><strong>To check if the residuals are random, it is common to show a residual plot</strong>, which plots the residuals on the <span class="math notranslate nohighlight">\(y\)</span> axis and the true <span class="math notranslate nohighlight">\(y\)</span> values on the y axis. We expect to observe a cloud of points centered around the zero  with no specific patters.</p>
<p><strong>To check if the residuals are Gaussian, we can show Q-Q plots</strong></p>
<p>The graph below compares residual plots and Q-Q Plots of the residuals of different regression models:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/f65885ac9e0db799bbbcb7812e268cc6347ca6459af19c90e5a0ecaebb21ed58.png" src="../_images/f65885ac9e0db799bbbcb7812e268cc6347ca6459af19c90e5a0ecaebb21ed58.png" />
</div>
</div>
<p>From the plot, we can see that some models have residuals less correlated with the predicted variable and quantiles closer to the normal distribution. This happens when the model explains better the variance of the predicted variable. In particular, we can note that the quadratic model (second row) and the one with the interaction term (last row) are a much better fit than the purely linear models (other two rows).</p>
</section>
<section id="collinearity-and-regularization-techniques">
<h3><span class="section-number">18.8. </span>Collinearity and Regularization Techniques<a class="headerlink" href="#collinearity-and-regularization-techniques" title="Permalink to this heading">#</a></h3>
<p>When fitting a multiple linear regressor, we should bear in mind that having two very correlated variables can lead to a poor model. For instance, in the case of perfectly correlated variables, two rows of the <span class="math notranslate nohighlight">\(\mathbf{X}\)</span> matrix will be linearly dependent (one can be computed as a linear function of the other), hence the determinant of <span class="math notranslate nohighlight">\(\mathbf{X}^T\mathbf{X}\)</span> will be zero, the matrix cannot be inverted, and the coefficients cannot be estimated.</p>
<p>Even if two variables are nearly collinear (strongly correlated), the <span class="math notranslate nohighlight">\(\mathbf{X}^T\mathbf{X}\)</span> matrix will be ill conditioned and the parameters will be estimated with high numerical imprecision.</p>
<p>In general, when there is collinearity between two variables (or even <strong>multicollinearity</strong>, involving more than two variables), <strong>the results of the multiple linear regressor cannot be trusted</strong>. In such cases, we can try to remove the correlated variables (we can identify correlated variables with the correlation matrix), apply regularization techniques (discussed later) or perform Principal Component Analysis (PCA), which aims to provide a set of decorrelated features from <span class="math notranslate nohighlight">\(\mathbf{X}\)</span>. The PCA method will be presented later.</p>
<section id="ridge-regression">
<h4><span class="section-number">18.8.1. </span>Ridge Regression<a class="headerlink" href="#ridge-regression" title="Permalink to this heading">#</a></h4>
<p>One way to remove collinearity is to <strong>remove those variables which are highly correlated with other variables</strong>. This will effectively remove collinearity and solve the instability issues of linear regression. However, when there is a large number of predictors, this approach may not be very convenient. Also, it is not always clear which predictors to remove and which ones to keep, especially in the case of <strong>multicollinearity</strong> (sets of more than two variables which are highly correlated).</p>
<p>A “<strong>soft approach</strong>” would be to feed all variables to the model and <strong>encourage it to set some of the coefficients to zero</strong>. If we could do this, the model would <strong>effectively select which variables to exclude from the model</strong>, hence releasing us from making a hard decision.</p>
<p>This can be done by changing our cost function, the RSS. Recall that the RSS of linear regression (Ordinary Least Squares) can be written as:</p>
<div class="math notranslate nohighlight">
\[RSS = \sum_{i=1}^m (y_i - \beta_0 - \sum_{j=1}^n \beta_j x_{ij})^2\]</div>
<p>where <span class="math notranslate nohighlight">\(x_{ij}\)</span> is the value of the <span class="math notranslate nohighlight">\(x_j\)</span> variable in the <span class="math notranslate nohighlight">\(i^{th}\)</span> observation.</p>
<p>We can write the cost function as follows:</p>
<div class="math notranslate nohighlight">
\[\sum_{i=1}^m (y_i - \beta_0 - \sum_{j=1}^n \beta_j x_{ij})^2 + \lambda \sum_{j=1}^n \beta_j^2 = RSS + \lambda \sum_{j=1}^n \beta_j^2\]</div>
<p>In practice, we are adding the following term:</p>
<p><span class="math notranslate nohighlight">\(\sum_{j=1}^n \beta_j^2\)</span></p>
<p>weighted by a parameter <span class="math notranslate nohighlight">\(\lambda\)</span>. The term above <strong>penalizes solutions with large values for the coefficients <span class="math notranslate nohighlight">\(\beta_j\)</span>, hence encouraging the model to put some of the variables to zero, or close to zero</strong>. This term is called “regularization term” and a linear regressor fit by minimizing this new cost function is called a <strong>ridge regressor</strong>.</p>
<p>The cost function has a parameter <span class="math notranslate nohighlight">\(\lambda\)</span> which must be set as a constant. These kinds of parameters which we need to specify manually and are not computed from the data, are called <strong>hyperparameters</strong>. In practice, <span class="math notranslate nohighlight">\(\lambda\)</span> controls <strong>how much we want to regularize the linear regressor</strong>. The higher the value of <span class="math notranslate nohighlight">\(\lambda\)</span>, the stronger the regularization will be, hence encouraging the model to select small values of <span class="math notranslate nohighlight">\(\beta_j\)</span> or set some of them to zero.</p>
<p>To avoid <span class="math notranslate nohighlight">\(\lambda\)</span> having different effects depending on the unit measures of the given variables, it is common to <strong>z-score all variables before computing a ridge regressor</strong>.</p>
<p>This is shown in the following plot, which shows the values of the parameters <span class="math notranslate nohighlight">\(\beta_j\)</span> when a ridge regression model is fit with different values of <span class="math notranslate nohighlight">\(\lambda\)</span>:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/fd3880ceafc33f42cf09494bcb5ed81c6e71e85916ac64e3be39f6dea62356e3.png" src="../_images/fd3880ceafc33f42cf09494bcb5ed81c6e71e85916ac64e3be39f6dea62356e3.png" />
</div>
</div>
<p>As can be seen, the coefficient values are gradually shrunk towards zero as the value of <span class="math notranslate nohighlight">\(\lambda\)</span> increases. Interestingly, the model <strong>“decides”</strong> which coefficients to shrink. For instance, for low values of <span class="math notranslate nohighlight">\(\lambda\)</span>, <code class="docutils literal notranslate"><span class="pre">weight</span></code> is shrunk, while <code class="docutils literal notranslate"><span class="pre">acceleration</span></code> is first shrunk, then allowed to be larger than zero. This is due to the fact that, the regularization term acts as a sort of “soft constraint” encouraging the model to find smaller weights, while still finding a good solution.</p>
<p>It can be shown (but we will not see it formally), that ridge regression <strong>reduces the variance of coefficient estimates</strong>. At the same time, <strong>the bias is increased</strong>. So, finding a good value of <span class="math notranslate nohighlight">\(\lambda\)</span> allows to <strong>control the bias-variance trade-off</strong>.</p>
<section id="interpretation-of-the-ridge-regression-coefficients">
<h5><span class="section-number">18.8.1.1. </span>Interpretation of the ridge regression coefficients<a class="headerlink" href="#interpretation-of-the-ridge-regression-coefficients" title="Permalink to this heading">#</a></h5>
<p>Let us compare the parameters obtained through a ridge regressor with those obtained with a linear regressor (OLS):</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ridge_params</th>
      <th>ols_params</th>
    </tr>
    <tr>
      <th>variables</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>displacement</th>
      <td>-0.998445</td>
      <td>2.079303</td>
    </tr>
    <tr>
      <th>cylinders</th>
      <td>-0.969852</td>
      <td>-0.840519</td>
    </tr>
    <tr>
      <th>horsepower</th>
      <td>-1.027231</td>
      <td>-0.651636</td>
    </tr>
    <tr>
      <th>weight</th>
      <td>-1.401530</td>
      <td>-5.492050</td>
    </tr>
    <tr>
      <th>acceleration</th>
      <td>0.199621</td>
      <td>0.222014</td>
    </tr>
    <tr>
      <th>model_year</th>
      <td>1.375600</td>
      <td>2.762119</td>
    </tr>
    <tr>
      <th>origin</th>
      <td>0.830411</td>
      <td>1.147316</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>As we can see, the ridge parameters has a smaller scale. This is due to the regularization term. As a result, the parameters <strong>cannot be interpreted statistically as the ones of a linear regressor</strong>. Instead, we can interpret them as denoting the relative importance of the variable to the prediction.</p>
</section>
</section>
<section id="lasso-regression">
<h4><span class="section-number">18.8.2. </span>Lasso Regression<a class="headerlink" href="#lasso-regression" title="Permalink to this heading">#</a></h4>
<p>The ridge regressor will in general set coefficients exactly to zero only for very large values of <span class="math notranslate nohighlight">\(\lambda\)</span>. An alternative model which has been shown to set coefficients more likely to zero is the <strong>lasso regressor</strong>. The main difference with ridge regression is in the regularization term. The new cost function of a lasso regressor is as follows:</p>
<div class="math notranslate nohighlight">
\[\sum_{i=1}^m (y_i - \beta_0 - \sum_{j=1}^n \beta_j x_{ij})^2 + \lambda \sum_{j=1}^n |\beta_j| = RSS + \lambda \sum_{j=1}^n |\beta_j|\]</div>
<p>We basically replaced the norm of the coefficients with the absolute values (this is called an L1 norm), which has the effect to encourage the model to set values to zero.</p>
<p>The figure below shows how the coefficient estimates change for different values of <span class="math notranslate nohighlight">\(\lambda\)</span>:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/1de2a52c820bc6c4b1de5bd7c81ccce61b4e45a2ff1d88ceff546b121bee77db.png" src="../_images/1de2a52c820bc6c4b1de5bd7c81ccce61b4e45a2ff1d88ceff546b121bee77db.png" />
</div>
</div>
<p>As can be seen, the model now makes “hard choices” on whether a value should be set to zero or not, thus performing variable selection.</p>
</section>
</section>
<section id="references">
<h3><span class="section-number">18.9. </span>References<a class="headerlink" href="#references" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Chapter 3 of [1]</p></li>
<li><p>Parts of chapter 11 of [2]</p></li>
</ul>
<p>[1] Heumann, Christian, and Michael Schomaker Shalabh. Introduction to statistics and data analysis. Springer International Publishing Switzerland, 2016.</p>
<p>[2] James, Gareth Gareth Michael. An introduction to statistical learning: with applications in Python, 2023.<a class="reference external" href="https://www.statlearning.com">https://www.statlearning.com</a></p>
</section>
</section>
</div>
<div class="toctree-wrapper compound">
<span id="document-lectures/12_logistic_regression"></span><section class="tex2jax_ignore mathjax_ignore" id="logistic-regression">
<h2><span class="section-number">19. </span>Logistic Regression<a class="headerlink" href="#logistic-regression" title="Permalink to this heading">#</a></h2>
<p>Linear regression allows to model relationships between <strong>continuos independent and dependent variables</strong> and <strong>between qualitative independent variables and continuous variables</strong>. However, it does not allow to model relationships between continuous or qualitative independent variables and <strong>qualitative dependent variables</strong>.</p>
<section id="example-data">
<h3><span class="section-number">19.1. </span>Example Data<a class="headerlink" href="#example-data" title="Permalink to this heading">#</a></h3>
<p>Establishing such relationships is useful in different contexts. For instance, let us consider the <a class="reference external" href="https://archive.ics.uci.edu/dataset/17/breast+cancer+wisconsin+diagnostic">Breast Cancer Wisconsin</a> dataset:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>radius1</th>
      <th>texture1</th>
      <th>perimeter1</th>
      <th>area1</th>
      <th>smoothness1</th>
      <th>compactness1</th>
      <th>concavity1</th>
      <th>concave_points1</th>
      <th>symmetry1</th>
      <th>fractal_dimension1</th>
      <th>...</th>
      <th>texture3</th>
      <th>perimeter3</th>
      <th>area3</th>
      <th>smoothness3</th>
      <th>compactness3</th>
      <th>concavity3</th>
      <th>concave_points3</th>
      <th>symmetry3</th>
      <th>fractal_dimension3</th>
      <th>Diagnosis</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>17.99</td>
      <td>10.38</td>
      <td>122.80</td>
      <td>1001.0</td>
      <td>0.11840</td>
      <td>0.27760</td>
      <td>0.30010</td>
      <td>0.14710</td>
      <td>0.2419</td>
      <td>0.07871</td>
      <td>...</td>
      <td>17.33</td>
      <td>184.60</td>
      <td>2019.0</td>
      <td>0.16220</td>
      <td>0.66560</td>
      <td>0.7119</td>
      <td>0.2654</td>
      <td>0.4601</td>
      <td>0.11890</td>
      <td>M</td>
    </tr>
    <tr>
      <th>1</th>
      <td>20.57</td>
      <td>17.77</td>
      <td>132.90</td>
      <td>1326.0</td>
      <td>0.08474</td>
      <td>0.07864</td>
      <td>0.08690</td>
      <td>0.07017</td>
      <td>0.1812</td>
      <td>0.05667</td>
      <td>...</td>
      <td>23.41</td>
      <td>158.80</td>
      <td>1956.0</td>
      <td>0.12380</td>
      <td>0.18660</td>
      <td>0.2416</td>
      <td>0.1860</td>
      <td>0.2750</td>
      <td>0.08902</td>
      <td>M</td>
    </tr>
    <tr>
      <th>2</th>
      <td>19.69</td>
      <td>21.25</td>
      <td>130.00</td>
      <td>1203.0</td>
      <td>0.10960</td>
      <td>0.15990</td>
      <td>0.19740</td>
      <td>0.12790</td>
      <td>0.2069</td>
      <td>0.05999</td>
      <td>...</td>
      <td>25.53</td>
      <td>152.50</td>
      <td>1709.0</td>
      <td>0.14440</td>
      <td>0.42450</td>
      <td>0.4504</td>
      <td>0.2430</td>
      <td>0.3613</td>
      <td>0.08758</td>
      <td>M</td>
    </tr>
    <tr>
      <th>3</th>
      <td>11.42</td>
      <td>20.38</td>
      <td>77.58</td>
      <td>386.1</td>
      <td>0.14250</td>
      <td>0.28390</td>
      <td>0.24140</td>
      <td>0.10520</td>
      <td>0.2597</td>
      <td>0.09744</td>
      <td>...</td>
      <td>26.50</td>
      <td>98.87</td>
      <td>567.7</td>
      <td>0.20980</td>
      <td>0.86630</td>
      <td>0.6869</td>
      <td>0.2575</td>
      <td>0.6638</td>
      <td>0.17300</td>
      <td>M</td>
    </tr>
    <tr>
      <th>4</th>
      <td>20.29</td>
      <td>14.34</td>
      <td>135.10</td>
      <td>1297.0</td>
      <td>0.10030</td>
      <td>0.13280</td>
      <td>0.19800</td>
      <td>0.10430</td>
      <td>0.1809</td>
      <td>0.05883</td>
      <td>...</td>
      <td>16.67</td>
      <td>152.20</td>
      <td>1575.0</td>
      <td>0.13740</td>
      <td>0.20500</td>
      <td>0.4000</td>
      <td>0.1625</td>
      <td>0.2364</td>
      <td>0.07678</td>
      <td>M</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>564</th>
      <td>21.56</td>
      <td>22.39</td>
      <td>142.00</td>
      <td>1479.0</td>
      <td>0.11100</td>
      <td>0.11590</td>
      <td>0.24390</td>
      <td>0.13890</td>
      <td>0.1726</td>
      <td>0.05623</td>
      <td>...</td>
      <td>26.40</td>
      <td>166.10</td>
      <td>2027.0</td>
      <td>0.14100</td>
      <td>0.21130</td>
      <td>0.4107</td>
      <td>0.2216</td>
      <td>0.2060</td>
      <td>0.07115</td>
      <td>M</td>
    </tr>
    <tr>
      <th>565</th>
      <td>20.13</td>
      <td>28.25</td>
      <td>131.20</td>
      <td>1261.0</td>
      <td>0.09780</td>
      <td>0.10340</td>
      <td>0.14400</td>
      <td>0.09791</td>
      <td>0.1752</td>
      <td>0.05533</td>
      <td>...</td>
      <td>38.25</td>
      <td>155.00</td>
      <td>1731.0</td>
      <td>0.11660</td>
      <td>0.19220</td>
      <td>0.3215</td>
      <td>0.1628</td>
      <td>0.2572</td>
      <td>0.06637</td>
      <td>M</td>
    </tr>
    <tr>
      <th>566</th>
      <td>16.60</td>
      <td>28.08</td>
      <td>108.30</td>
      <td>858.1</td>
      <td>0.08455</td>
      <td>0.10230</td>
      <td>0.09251</td>
      <td>0.05302</td>
      <td>0.1590</td>
      <td>0.05648</td>
      <td>...</td>
      <td>34.12</td>
      <td>126.70</td>
      <td>1124.0</td>
      <td>0.11390</td>
      <td>0.30940</td>
      <td>0.3403</td>
      <td>0.1418</td>
      <td>0.2218</td>
      <td>0.07820</td>
      <td>M</td>
    </tr>
    <tr>
      <th>567</th>
      <td>20.60</td>
      <td>29.33</td>
      <td>140.10</td>
      <td>1265.0</td>
      <td>0.11780</td>
      <td>0.27700</td>
      <td>0.35140</td>
      <td>0.15200</td>
      <td>0.2397</td>
      <td>0.07016</td>
      <td>...</td>
      <td>39.42</td>
      <td>184.60</td>
      <td>1821.0</td>
      <td>0.16500</td>
      <td>0.86810</td>
      <td>0.9387</td>
      <td>0.2650</td>
      <td>0.4087</td>
      <td>0.12400</td>
      <td>M</td>
    </tr>
    <tr>
      <th>568</th>
      <td>7.76</td>
      <td>24.54</td>
      <td>47.92</td>
      <td>181.0</td>
      <td>0.05263</td>
      <td>0.04362</td>
      <td>0.00000</td>
      <td>0.00000</td>
      <td>0.1587</td>
      <td>0.05884</td>
      <td>...</td>
      <td>30.37</td>
      <td>59.16</td>
      <td>268.6</td>
      <td>0.08996</td>
      <td>0.06444</td>
      <td>0.0000</td>
      <td>0.0000</td>
      <td>0.2871</td>
      <td>0.07039</td>
      <td>B</td>
    </tr>
  </tbody>
</table>
<p>569 rows × 31 columns</p>
</div></div></div>
</div>
<p>The dataset contains several measurements of given quantities measured from digitized image of a fine needle aspirate (FNA) of a breast mass, together with a categorical variable <code class="docutils literal notranslate"><span class="pre">Diagnosis</span></code> with two levels: <code class="docutils literal notranslate"><span class="pre">M</span></code> (malignant) and <code class="docutils literal notranslate"><span class="pre">B</span></code> (benign).</p>
<p>In this case, it would be good to be able to study whether a relationship exists between some of the considered independent variables and the dependent variable.</p>
<p>We will consider the <code class="docutils literal notranslate"><span class="pre">radius1</span></code> variable for the moment. Let us plot this variable with respect to <code class="docutils literal notranslate"><span class="pre">Diagnosis</span></code>:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/01c33ebded8bb30ea7bb8492a0c9edac9908961157669eb728f33788ce57ff28.png" src="../_images/01c33ebded8bb30ea7bb8492a0c9edac9908961157669eb728f33788ce57ff28.png" />
</div>
</div>
<p>From the plot above, we can note that there is some form of relationship between the two variables. Indeed:</p>
<ul class="simple">
<li><p>For low values of <code class="docutils literal notranslate"><span class="pre">radius1</span></code>, we tend to have more benign cases;</p></li>
<li><p>For large values of <code class="docutils literal notranslate"><span class="pre">radius1</span></code>, we tend to have more malignant cases.</p></li>
</ul>
</section>
<section id="limits-of-linear-regression">
<h3><span class="section-number">19.2. </span>Limits of Linear Regression<a class="headerlink" href="#limits-of-linear-regression" title="Permalink to this heading">#</a></h3>
<p>Of course, we would like to quantify this relationship in a more formal way.
<strong>As in the case of a linear regressor, we want to define a model which can predict the independent variable <span class="math notranslate nohighlight">\(y\)</span> from the dependent variables <span class="math notranslate nohighlight">\(x_i\)</span>. If such model gives good predictions, than we can trust its interpretation as a means of studying the relationship between the variables.</strong></p>
<p>We can think of converting <code class="docutils literal notranslate"><span class="pre">B</span> <span class="pre">=&gt;</span> <span class="pre">1</span></code> and <code class="docutils literal notranslate"><span class="pre">M</span> <span class="pre">=&gt;</span> <span class="pre">0</span></code>, and then compute a linear regressor:</p>
<div class="math notranslate nohighlight">
\[Diagnosis = \beta_0 + \beta_1 radius1\]</div>
<p>This would be the result:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/ee318307dbc7f52c1a2c2a7f5c8daee9f19f1d06e6b2ed625dfcccff403e0df5.png" src="../_images/ee318307dbc7f52c1a2c2a7f5c8daee9f19f1d06e6b2ed625dfcccff403e0df5.png" />
</div>
</div>
<p>We can immediately see that this function does not model the relationship between the two variables very well. While we obtain a statistically relevant regressor with <span class="math notranslate nohighlight">\(R^2=0.533\)</span> and statistically relevant coefficients, the residual plot will look like this:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/cb22e8950a18ed9d77288bf5aaf8f32f3fa2d4ebee49d85905d6c1576a8ec27e.png" src="../_images/cb22e8950a18ed9d77288bf5aaf8f32f3fa2d4ebee49d85905d6c1576a8ec27e.png" />
</div>
</div>
<p>The correlation between the residuals and the independent variable is a strong indication that the true relationship between the two variables is not correcly modeled. After all, from a purely predictive point of view, we are using a linear regressor which takes the form:</p>
<div class="math notranslate nohighlight">
\[f:\mathbb{R} \to \mathbb{R}\]</div>
<p>while the values <code class="docutils literal notranslate"><span class="pre">Diagnosis</span></code> variable belong to the set <span class="math notranslate nohighlight">\(\{0,1\}\)</span> and we would need instead a function with the following form:</p>
<div class="math notranslate nohighlight">
\[f:\mathbb{R} \to \{0,1\}\]</div>
<p>However, the linear regressor cannot directly predict <strong>discrete values</strong>.</p>
<p><strong>In practice, while with a linear regressor we wanted to predict continuous values, now we want to assign observations <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> to discrete bins (in this case only two possible ones). As we will better study later in the course, this problem is known as classification.</strong></p>
</section>
<section id="from-binary-values-to-probabilities">
<h3><span class="section-number">19.3. </span>From Binary Values to Probabilities<a class="headerlink" href="#from-binary-values-to-probabilities" title="Permalink to this heading">#</a></h3>
<p>If we want to model some form of continuous value, we could think to transition from <span class="math notranslate nohighlight">\(\{0,1\}\)</span> to <span class="math notranslate nohighlight">\([0,1]\)</span> using probabilities, which is a way to turn discretized values to “soft” values indicating our belief in the fact that <code class="docutils literal notranslate"><span class="pre">Diagnosis</span></code> will take either a <span class="math notranslate nohighlight">\(0\)</span> or <span class="math notranslate nohighlight">\(1\)</span> value. We could hence think to model the following probability, rather than modeling <code class="docutils literal notranslate"><span class="pre">Diagnosis</span></code> directly:</p>
<div class="math notranslate nohighlight">
\[P(Diagnosis=1| radius1)\]</div>
<p>However, even in this case, a model of the form:</p>
<div class="math notranslate nohighlight">
\[P(Diagnosis=1|radius1) = \beta_0 + \beta_1 radius1\]</div>
<p>Would not be appropriate. Indeed, while <span class="math notranslate nohighlight">\(P(Diagnosis=1| radius1)\)</span> needs to be in the <span class="math notranslate nohighlight">\([0,1]\)</span> range, the linear combination <span class="math notranslate nohighlight">\(\beta_0 + \beta_1 radius1\)</span> will naturally output values <strong>smaller than <span class="math notranslate nohighlight">\(0\)</span></strong> and <strong>larger than <span class="math notranslate nohighlight">\(1\)</span></strong>. How should we interpret such values?</p>
<p>Intuitively, we would expect to <span class="math notranslate nohighlight">\(P(Diagnosis=1| radius1)\)</span> to assume values in the <span class="math notranslate nohighlight">\([0,1]\)</span> range for intermediate values (say <code class="docutils literal notranslate"><span class="pre">radius</span></code> <span class="math notranslate nohighlight">\(\in [10,20]\)</span>), while for extremely low values of (say <code class="docutils literal notranslate"><span class="pre">radius</span></code> <span class="math notranslate nohighlight">\(&lt;10\)</span>) the probability <strong>should saturate to <span class="math notranslate nohighlight">\(0\)</span></strong> and for extremely large values (say <code class="docutils literal notranslate"><span class="pre">radius</span></code> <span class="math notranslate nohighlight">\(&gt;20\)</span>) the probability should saturate to 1.</p>
<p>when <code class="docutils literal notranslate"><span class="pre">radius1</span></code> takes large values (say larger than <span class="math notranslate nohighlight">\(20\)</span>), we expect <strong>probability to saturate to <span class="math notranslate nohighlight">\(1\)</span></strong>.</p>
<p>In practice, we would expect a result similar to the following:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/65b1ad849523ee9c99475d6bbe79b679a33735a93fea247a052e153198cc37bc.png" src="../_images/65b1ad849523ee9c99475d6bbe79b679a33735a93fea247a052e153198cc37bc.png" />
</div>
</div>
<p>As can be noted, the function above is not linear, and hence it cannot be fit with a linear regressor. However, we have seen that a linear regressor can be tweaked to also represent nonlinear functions.</p>
</section>
<section id="the-logistic-function">
<h3><span class="section-number">19.4. </span>The Logistic Function<a class="headerlink" href="#the-logistic-function" title="Permalink to this heading">#</a></h3>
<p>Similarly to polynomial regression, we need to find a <strong>transformation of the formulation of the linear regressor to transform its output into a nonlinear function of the independent variables</strong>. Of course, we do not want <em>any</em> transformation, but one that has the previously highlighted properties. While different functions have similar characteristics, in practice the <strong>logistic function has some nice properties that, as we will se in a moment, allow to easily interpret the resulting model in a probabilistic way</strong>. The logistic function is defined as:</p>
<div class="math notranslate nohighlight">
\[f(x) = \frac{1}{1+e^{-x}}\]</div>
<p>and has the following shape:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/cc727668f29fecd8a6d4ca465dbb298a07d5ce320a48c8aa16ca077b3e7b70c4.png" src="../_images/cc727668f29fecd8a6d4ca465dbb298a07d5ce320a48c8aa16ca077b3e7b70c4.png" />
</div>
</div>
<p>As we can see, the function has the properties we need:</p>
<ul class="simple">
<li><p>Its values are comprised between <span class="math notranslate nohighlight">\(0\)</span> and <span class="math notranslate nohighlight">\(1\)</span>;</p></li>
<li><p>It saturates to <span class="math notranslate nohighlight">\(0\)</span> and <span class="math notranslate nohighlight">\(1\)</span> for extreme values of <span class="math notranslate nohighlight">\(x\)</span>.</p></li>
</ul>
</section>
<section id="the-logistic-regression-model">
<h3><span class="section-number">19.5. </span>The Logistic Regression Model<a class="headerlink" href="#the-logistic-regression-model" title="Permalink to this heading">#</a></h3>
<p>In practice, we define our model, <strong>the logistic regressor model</strong> as follows (<strong>simple logistic regression</strong>):</p>
<div class="math notranslate nohighlight">
\[P(Diagnosis=1|X) = f(\beta_0 + \beta_1 X) = \frac{1}{1+e^{-(\beta_0 + \beta_1 X)}}\]</div>
<p>Or, more in general (<strong>multiple logistic regression</strong>):</p>
<div class="math notranslate nohighlight">
\[P(y=1|\mathbf{x}) = \frac{1}{1+e^{-(\beta_0 + \beta_1 x_1 + \ldots + \beta_n x_n)}}\]</div>
<p>It is easy to see that:</p>
<div class="math notranslate nohighlight">
\[p=\frac{1}{1+e^{-x}} \Rightarrow p+pe^{-x} = 1 \Rightarrow pe^{-x} = 1-p \Rightarrow e^{-x} = \frac{1-p}{p} \Rightarrow e^{x} = \frac{p}{1-p}\]</div>
<p>Hence:</p>
<div class="math notranslate nohighlight">
\[e^{\beta_0+\beta_1x_1 + \ldots + \beta_nx_n} = \frac{P(y=1|\mathbf{x})}{1-P(y=1|\mathbf{x})}\]</div>
<p>We note that the term on the right is the odd of <span class="math notranslate nohighlight">\(P(y=1|\mathbf{x})\)</span>. We recall that the odd of <span class="math notranslate nohighlight">\(P(y=1|\mathbf{x})\)</span> is the number of times we believe the example will be positive (observed <span class="math notranslate nohighlight">\(\mathbf{x}\)</span>) over the number of times we believe the example will be negative. For instance, if we believe that the example will be positive <span class="math notranslate nohighlight">\(3\)</span> times out of <span class="math notranslate nohighlight">\(10\)</span>, then the odd will be <span class="math notranslate nohighlight">\(\frac{3}{7}\)</span>.</p>
<p>By taking the logarithm of both terms, we obtain:</p>
<div class="math notranslate nohighlight">
\[\log \left(\frac{P(y=1|\mathbf{x})}{1-P(y=1|\mathbf{x})}\right) = \beta_0 + \beta_1 x_1 + \ldots + \beta_n x_n\]</div>
<p>The expression:</p>
<div class="math notranslate nohighlight">
\[\log \left(\frac{P(y=1|\mathbf{x})}{1-P(y=1|\mathbf{x})}\right)\]</div>
<p>Is the logarithm of the odd (log odd), and it is called <strong>logit</strong>, hence the <strong>logistic regression</strong> is sometimes called <strong>logit regression</strong>.</p>
<p>The expression above shows how a logistic regressor can be seen as <strong>a linear regressor (the expression on the right side of the equation) on the logit (the log odd)</strong>. This paves the way to useful interpretations of the model, as shown in the next section.</p>
</section>
<section id="statistical-interpretation-of-the-coefficients-of-a-linear-regressor">
<h3><span class="section-number">19.6. </span>Statistical Interpretation of the Coefficients of a Linear Regressor<a class="headerlink" href="#statistical-interpretation-of-the-coefficients-of-a-linear-regressor" title="Permalink to this heading">#</a></h3>
<p>Let’s now see how to interpret the coefficients of a logistic regressor. Remember that the regression model (in the case of simple logistic regression) is as follows:</p>
<div class="math notranslate nohighlight">
\[
\log(\frac{p}{1-p})=\beta_0 + \beta_1 x
\]</div>
<p>Applying what we know about linear regressors, we can write:</p>
<div class="math notranslate nohighlight">
\[x=0 \Rightarrow \ln(\frac{p}{1-p})=\beta_0\]</div>
<p>To have a clearer picture, we can exponentiate both sides of the equation and write:</p>
<div class="math notranslate nohighlight">
\[x=0 \Rightarrow \frac{p}{1-p}=e^{\beta_0}\]</div>
<p>Remember that <span class="math notranslate nohighlight">\(\frac{p}{1-p}\)</span> is the odds that the dependent variable is equal to 1 when observing <span class="math notranslate nohighlight">\(x\)</span> and, as such, it has a clear interpretation. For example, if the odds of an event are <span class="math notranslate nohighlight">\(\frac{3}{1}\)</span>, then it is <span class="math notranslate nohighlight">\(3\)</span> times more likely to occur than not to occur. So, <strong>for <span class="math notranslate nohighlight">\(x=0\)</span>, it is <span class="math notranslate nohighlight">\(e^{\beta_0}\)</span> times more likely that the dependent variable is equal to 1, rather than being equal to 0</strong>.</p>
<p>It can be seen that:</p>
<div class="math notranslate nohighlight">
\[p=\frac{odds}{1+odds}\]</div>
<p>Hence, the probability of the event being true when all variables are zero is given by:</p>
<div class="math notranslate nohighlight">
\[p(y=1|x) = \frac{e^\beta_0}{1+e^\beta_0}\]</div>
<p>How can we interpret the <strong>coefficient values</strong>?</p>
<p>We know that:</p>
<div class="math notranslate nohighlight">
\[odds(p|x) = \frac{P(y=1|x)}{1-P(y=1|x)}\]</div>
<p>We can write:</p>
<div class="math notranslate nohighlight">
\[
\log odds(p|x) = \beta_0 + \beta_1 x
\]</div>
<p>Hence:</p>
<div class="math notranslate nohighlight">
\[\log odds(p|x+1) - \log odds(p|x) = \beta_0 + \beta_1 (x+1) - \beta_0 - \beta_1 x = \beta_1 (x+1) - \beta_1 x = \beta_1\]</div>
<p>Exponentiating both sides, we get:</p>
<div class="math notranslate nohighlight">
\[e^{\log odds(p|x+1) - \log odds(p|x)} = e^{\beta_1} \Rightarrow \frac{e^{\log odds(p|x+1)}}{e^{\log odds(p|x)}} = e^{\beta_1} \Rightarrow \frac{odds(p|x+1)}{odds(p|x)} = e^{\beta_1} \Rightarrow odds(p|x+1) = e^{\beta_1}odds(p|x)\]</div>
<p>We can thus say that <strong>increasing the variable <span class="math notranslate nohighlight">\(x\)</span> by one unit corresponds to a multiplicative increase in odds by <span class="math notranslate nohighlight">\(e^{\beta_1}\)</span></strong>.</p>
<p>This analysis can be easily extended to the case of a multiple logistic regressor. Hence in general, given the model:</p>
<div class="math notranslate nohighlight">
\[P(y=1|\mathbf{x}) = \beta_0 + \beta_1 x_1 + \ldots + \beta_n x_n\]</div>
<p>We can say that:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(e^\beta_0\)</span> is the odd of <span class="math notranslate nohighlight">\(y\)</span> being equal to <span class="math notranslate nohighlight">\(1\)</span> rather than <span class="math notranslate nohighlight">\(0\)</span> when <span class="math notranslate nohighlight">\(x_i=0 \forall i\)</span>;</p></li>
<li><p>An increment of one unit in the independent variable <span class="math notranslate nohighlight">\(x_i\)</span> corresponds to a multiplicative increment of <span class="math notranslate nohighlight">\(e^\beta_i\)</span> in the odds of <span class="math notranslate nohighlight">\(y=1\)</span>. So if <span class="math notranslate nohighlight">\(e^\beta_i=0.05\)</span>, then <span class="math notranslate nohighlight">\(y=1\)</span> is <span class="math notranslate nohighlight">\(5\%\)</span> more likely for a one-unit increment of <span class="math notranslate nohighlight">\(x\)</span>.</p></li>
</ul>
</section>
<section id="geometrical-interpretation-of-the-coefficients-of-a-logistic-regressor">
<h3><span class="section-number">19.7. </span>Geometrical Interpretation of the Coefficients of a Logistic Regressor<a class="headerlink" href="#geometrical-interpretation-of-the-coefficients-of-a-logistic-regressor" title="Permalink to this heading">#</a></h3>
<p>Similar to linear regression, also the coefficients of logistic
regression have a geometrical interpretation. We will see that, while
linear regression finds a «curve» that fits the data, logistic
regression finds a hyperplane that separates the data.</p>
<p>Let us consider a simple example with bi-dimensional data
<span class="math notranslate nohighlight">\(\mathbf{x} \in \mathfrak{R}^{2}\)</span> as the one shown in the following:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/d3f5c09f0f264dc55c163080d421b6a2e28653b2c3e463f302984e021cdbe2e3.png" src="../_images/d3f5c09f0f264dc55c163080d421b6a2e28653b2c3e463f302984e021cdbe2e3.png" />
</div>
</div>
<p>Let us assume that we fit a logistic regressor model to this data</p>
<div class="math notranslate nohighlight">
\[P\left( y=1 | \mathbf{x} \right) = \frac{1}{1 + e^{- {(\beta}_{0} + \beta_{1}x_{1} + \beta_{2}x_{2})}}\]</div>
<p>and find the following values for the parameters:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left\{ \begin{matrix}
\beta_{0} = - 3.47 \\
\beta_{1} = 1.17 \\
\beta_{2} = 1.43 \\
\end{matrix} \right.\ \end{split}\]</div>
<p>We know that these parameters allow to find a probability value according to the formula above.
We can use these values to <strong>classify the observations</strong> <span class="math notranslate nohighlight">\(\mathbf{x}\)</span>. In practice, a reasonable criterion to classify observations would be:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\hat y = \begin{cases}1 &amp; \text{if } P(y=1|\mathbf{x}) \geq 0.5\\0 &amp; \text{otherwise}\end{cases}\end{split}\]</div>
<p>This makes sense as we are assigning the observations to the group for which the posterior probability <span class="math notranslate nohighlight">\(P(y|\mathbf{x})\)</span> is higher.</p>
<p>To understand how the data is classified, we can look at those points in
which the classifier is uncertain, which is often called <strong>the decision boundary</strong>, i.e.,
those points in which <span class="math notranslate nohighlight">\(P\left( y=1 | \mathbf{x} \right) = 0.5\)</span>.</p>
<p>We note that:</p>
<div class="math notranslate nohighlight">
\[P\left(y=1 | \mathbf{x} \right) = 0.5 \Leftrightarrow e^{- (\beta_{0} + \beta_{1}x_{1} + \beta_{2}x_{2})} = 1 \Leftrightarrow 0 = \beta_{0} + \beta_{1}x_{1} + \beta_{2}x_{2}\]</div>
<p>This last equation is the equation of a line (in the form
<span class="math notranslate nohighlight">\(ax + by + c = 0\)</span>). We can see it in explicit form:</p>
<div class="math notranslate nohighlight">
\[x_{2} = - \frac{\beta_{1}}{\beta_{2}}x_{1} - \frac{\beta_{0}}{\beta_{2}}\]</div>
<p>So, we have found a line which has a</p>
<ul class="simple">
<li><p>Angular coefficient equal to <span class="math notranslate nohighlight">\(- \frac{\beta_{1}}{\beta_{2}}\)</span>;</p></li>
<li><p>Intercept equal to <span class="math notranslate nohighlight">\(- \frac{\beta_{0}}{\beta_{2}}\)</span>;</p></li>
</ul>
<p>If we plot this line, we obtain the <strong>decision boundary</strong> which
separates the elements from the two classes:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/c0c82e00d05df69a65ebe76581a0935b0c7c8bdbfdbb4a78dc43c85e69233dc8.png" src="../_images/c0c82e00d05df69a65ebe76581a0935b0c7c8bdbfdbb4a78dc43c85e69233dc8.png" />
</div>
</div>
<p>As can be seen, the decision boundary found by a logistic regressor is a
line. This is because <strong>a logistic regressor is a linear classifier</strong>,
despite the logistic function is not linear!</p>
</section>
<section id="estimation-of-the-parameters-of-a-logistic-regressor">
<h3><span class="section-number">19.8. </span>Estimation of the Parameters of a Logistic Regressor<a class="headerlink" href="#estimation-of-the-parameters-of-a-logistic-regressor" title="Permalink to this heading">#</a></h3>
<p>To fit the model and find suitable values for the <span class="math notranslate nohighlight">\(\mathbf{\beta_i}\)</span>
parameters, we will define a <strong>cost function</strong>, similarly to what we have
done in the case of linear regression.</p>
<p>Even if we can see the logistic
regression problem as the linear regression problem of fitting the
<span class="math notranslate nohighlight">\(logit(p) = \mathbf{\beta}^{T}\mathbf{x}\)</span> function, differently from
linear regression, <strong>we should note that we do not have the ground truth probabilities p</strong>.
Indeed, our observations only provide input examples
<span class="math notranslate nohighlight">\(\mathbf{x}^{(i)}\)</span> and the corresponding labels <span class="math notranslate nohighlight">\(y^{(i)}\)</span>.</p>
<p>Starting from the definition:</p>
<div class="math notranslate nohighlight">
\[P\left( y = 1 \middle| \mathbf{x}; \mathbf{\beta} \right) = f_{\mathbf{\beta}}\left( \mathbf{x} \right) = \frac{1}{1 + e^{- \mathbf{\beta}^{T}\mathbf{x}}} = \sigma(\mathbf{\beta}^{T}\mathbf{x})\]</div>
<p>We can write:</p>
<div class="math notranslate nohighlight">
\[P\left( y = 1 \middle| \mathbf{x};\mathbf{\beta} \right) = f_{\mathbf{\beta}}(\mathbf{x})\]</div>
<div class="math notranslate nohighlight">
\[P\left( y = 0 \middle| \mathbf{x};\mathbf{\beta} \right) = 1 - f_{\mathbf{\beta}}(\mathbf{x})\]</div>
<p>Since <span class="math notranslate nohighlight">\(y\)</span> can only take values <span class="math notranslate nohighlight">\(0\)</span> and <span class="math notranslate nohighlight">\(1\)</span>, this can also be written as follows in a more compact form:</p>
<div class="math notranslate nohighlight">
\[P\left( y \middle| \mathbf{x};\mathbf{\beta} \right) = \left( f_{\mathbf{\beta}}\left( \mathbf{x} \right) \right)^{y}\left( 1 - f_{\mathbf{\beta}}\left( \mathbf{x} \right) \right)^{1 - y}\]</div>
<p>Indeed, when <span class="math notranslate nohighlight">\(y = 1\)</span>, the second factor is equal to <span class="math notranslate nohighlight">\(1\)</span> and the
expression reduces to
<span class="math notranslate nohighlight">\(P\left( y = 1 \middle| \mathbf{x};\mathbf{\beta} \right) = f_{\mathbf{\beta}}(\mathbf{x})\)</span>.
Similarly, if <span class="math notranslate nohighlight">\(y = 0\)</span>, the first factor is equal to <span class="math notranslate nohighlight">\(1\)</span> and the
expression reduces to <span class="math notranslate nohighlight">\(1 - f_{\mathbf{\beta}}(x)\)</span>.</p>
<p>We can estimate the parameters by maximum likelihood, i.e., choosing the
values of the parameters which maximize the probability of the data
under the model identified by the parameters <span class="math notranslate nohighlight">\(\mathbf{\beta}\)</span>:</p>
<div class="math notranslate nohighlight">
\[L\left( \mathbf{\beta} \right) = P(Y|X;\mathbf{\beta})\]</div>
<p>If we assume that the training examples are all independent, the
likelihood can be expressed as:</p>
<div class="math notranslate nohighlight">
\[L\left( \mathbf{\beta} \right) = \prod_{i = 1}^{N}{P(y^{(i)}|\mathbf{x}^{(i)};\mathbf{\beta})} = \prod_{i = 1}^{N}{f_{\mathbf{\beta}}\left( \mathbf{x}^{(i)} \right)^{y^{(i)}}\left( 1 - f_{\mathbf{\beta}}\left( \mathbf{x}^{(i)} \right) \right)^{{1 - y}^{(i)}}}\]</div>
<p>Maximizing this expression is equivalent to minimizing the negative
logarithm of <span class="math notranslate nohighlight">\(L(\mathbf{\beta})\)</span> (negative log-likelihood - nll):</p>
<div class="math notranslate nohighlight">
\[nll\left( \mathbf{\beta} \right) = - \log{L\left( \mathbf{\beta} \right)} = - \sum_{i = 1}^{N}{\log\left\lbrack f_{\mathbf{\beta}}\left( \mathbf{x}^{(i)} \right)^{y^{(i)}}\left( 1 - f_{\mathbf{\beta}}\left( \mathbf{x}^{(i)} \right) \right)^{{1 - y}^{(i)}} \right\rbrack} =\]</div>
<div class="math notranslate nohighlight">
\[= - \sum_{i = 1}^{N}{\lbrack y^{(i)}\log{f_{\mathbf{\beta}}\left( \mathbf{x}^{(i)} \right)}} + \left( 1 - y^{(i)} \right)\log{(1 - f_{\mathbf{\beta}}\left( \mathbf{x}^{(i)} \right)})\rbrack\]</div>
<p>Hence, we will define our cost function as:</p>
<div class="math notranslate nohighlight">
\[J\left( \mathbf{\beta} \right) = - \sum_{i = 1}^{N}{\lbrack y^{(i)}\log{f_{\mathbf{\beta}}\left( \mathbf{x}^{(i)} \right)}} + \left( 1 - y^{(i)} \right)\log{(1 - f_{\mathbf{\beta}}\left( \mathbf{x}^{(i)} \right)})\rbrack\]</div>
<p>This can be rewritten more explicitly in terms of the <span class="math notranslate nohighlight">\(\mathbf{\beta}\)</span>
parameters as follows:</p>
<div class="math notranslate nohighlight">
\[J\left( \mathbf{\beta} \right) = - \sum_{i = 1}^{N}{\lbrack y^{(i)}\log{\sigma\left( {\mathbf{\beta}^{T}\mathbf{x}}^{(i)} \right)}} + \left( 1 - y^{(i)} \right)\log{(1 - \sigma\left( \mathbf{\beta}^{T}\mathbf{x}^{(i)} \right)})\rbrack\]</div>
<p>Similarly to linear regression, we now have a cost function to minimize in order to find the values of the <span class="math notranslate nohighlight">\(\beta_i\)</span> parameters. Unfortunately, in this case, <span class="math notranslate nohighlight">\(J(\mathbf{\beta})\)</span> assumes a nonlinear form <strong>which prevents us to use the least square principles</strong> and <strong>there is no closed form solution for the parameter estimation</strong>. In these cases, parameters can be estimated using some form of <strong>iterative solver</strong>, which begins with an initial guess for the parameters and iteratively refine them to find the final solution. Luckily, the logistic regression cost function <strong>is convex, and hence only a single solution is admitted, independently from the initial guess</strong>.</p>
<p>Different iterative solvers can be used in practice. The most commonly used is the <strong>gradient descent algorithm</strong>, which requires the cost function to be differentiable. We will not see this algorithm in details, but an introduction to it and its application to the estimation of the parameters of a logistic regressor are given in the following (hidden) section.</p>
<div class="toggle docutils container">
<p class="rubric">Estimating the Parameters of a Logistic Regressor through Gradient Descent</p>
<p>Given the cost function <span class="math notranslate nohighlight">\(J(\mathcal{\beta})\)</span> above, we want to find suitable values <span class="math notranslate nohighlight">\(\mathbf{\beta}\)</span> by
solving the following optimization problem:</p>
<div class="math notranslate nohighlight">
\[\mathbf{\beta} = \arg_{\mathbf{\beta}}\min{J(\mathbf{\beta})}\]</div>
<p>As we already discussed, since <span class="math notranslate nohighlight">\(J\)</span> is nonlinear, we cannot find a closed form solution for the estimation of the parameters.</p>
<p>Alternatively, we could <strong>compute</strong>
<span class="math notranslate nohighlight">\(\mathbf{J}\left( \mathbf{\beta} \right)\)</span> <strong>for all possible values
of</strong> <span class="math notranslate nohighlight">\(\mathbf{\beta}\)</span> <strong>and choose the values of</strong> <span class="math notranslate nohighlight">\(\mathbf{\beta}\)</span>
<strong>which minimizes the cost</strong>. However, this option is unfeasible in
practice as <span class="math notranslate nohighlight">\(\beta\)</span> may assume an infinite number of values. Hence, we
need a way to <strong>find the values of</strong> <span class="math notranslate nohighlight">\(\mathbf{\beta}\)</span> <strong>which
minimize</strong> <span class="math notranslate nohighlight">\(\mathbf{J(}\mathbf{\beta}\mathbf{)}\)</span> <strong>without computing</strong>
<span class="math notranslate nohighlight">\(\mathbf{J(}\mathbf{\beta}\mathbf{)}\)</span> <strong>for all possible values of</strong>
<span class="math notranslate nohighlight">\(\mathbf{\beta}\)</span><strong>.</strong></p>
<p>In these cases, we can use <strong>gradient descent</strong>, a numerical optimization strategy
which allows to <strong>minimize differentiable functions</strong> with respect
to their parameters.</p>
<p>We will introduce the gradient descent algorithm considering initially
the problem of minimizing a function of a single variable <span class="math notranslate nohighlight">\(J(\theta)\)</span>.
We will then extend to the case of multiple variables.</p>
<p><strong>The gradient descent algorithm is based on the observation that, if a
function</strong> <span class="math notranslate nohighlight">\(J(\theta)\)</span> <em>is defined and differentiable in a neighborhood
of a point</em> <span class="math notranslate nohighlight">\(\theta^{(0)}\)</span><em>, then</em> <span class="math notranslate nohighlight">\(J(\theta)\)</span> <em>decreases fastest if one
goes from</em> <span class="math notranslate nohighlight">\(\theta^{(0)}\)</span> <em>towards the direction of the negative
derivative of</em> <span class="math notranslate nohighlight">\(J\)</span> <em>computed in</em> <span class="math notranslate nohighlight">\(\theta^{(0)}\)</span><em>.</em> Consider the function
<span class="math notranslate nohighlight">\(J(\theta)\)</span> shown in the plot below:</p>
<p>In these cases, we can use <strong>gradient descent</strong>, a numerical optimization strategy
which allows to <strong>minimize differentiable functions</strong> with respect
to their parameters.</p>
<p>We will introduce the gradient descent algorithm considering initially
the problem of minimizing a function of a single variable <span class="math notranslate nohighlight">\(J(\theta)\)</span>.
We will then extend to the case of multiple variables.</p>
<p><strong>The gradient descent algorithm is based on the observation that, if a
function</strong> <span class="math notranslate nohighlight">\(J(\theta)\)</span> <em>is defined and differentiable in a neighborhood
of a point</em> <span class="math notranslate nohighlight">\(\theta^{(0)}\)</span><em>, then</em> <span class="math notranslate nohighlight">\(J(\theta)\)</span> <em>decreases fastest if one
goes from</em> <span class="math notranslate nohighlight">\(\theta^{(0)}\)</span> <em>towards the direction of the negative
derivative of</em> <span class="math notranslate nohighlight">\(J\)</span> <em>computed in</em> <span class="math notranslate nohighlight">\(\theta^{(0)}\)</span><em>.</em> Consider the function
<span class="math notranslate nohighlight">\(J(\theta)\)</span> shown in the plot below:</p>
<p><img alt="" src="../_images/gd1.png" /></p>
<p>Let us assume that we are at the initial point <span class="math notranslate nohighlight">\(\theta^{(0)}\)</span>. From the
plot, we can see that we should move to the right part of the x axis in
order to reach the minimum of the function.</p>
<p><img alt="" src="../_images/gd2.png" /></p>
<p>The first derivative of the function in that point <span class="math notranslate nohighlight">\(J'(\beta^{(0)})\)</span>
will be equal to the angular coefficient of the tangent to the curve in
the point <span class="math notranslate nohighlight">\((\theta^{(0)},J\left( \theta^{(0)} \right))\)</span>. Since the curve
is decreasing in a neighborhood of <span class="math notranslate nohighlight">\(\beta^{(0)}\)</span>, the tangent line will
also be decreasing. Therefore, its angular coefficient
<span class="math notranslate nohighlight">\(J'(\theta^{(0)})\)</span> will be negative. If we want to move to the right, we
should follow in the <em>inverse direction</em> of the derivative of the curve
in that point.</p>
<p>The gradient descent is an iterative algorithm; hence we are not trying
to reach the minimum of the function in one step. Instead, we would like
to move to another point <span class="math notranslate nohighlight">\(\theta^{(1)}\)</span> such that
<span class="math notranslate nohighlight">\(J\left( \theta^{(1)} \right) &lt; J(\theta^{(0)})\)</span>. If we can do this for
every point, we can reach the minimum in a number of steps.</p>
<p>At each step, we will move proportionally to the value of the
derivative. This is based on the observation that larger absolute values
of the derivative indicate steeper curves. If we choose a multiplier
factor <span class="math notranslate nohighlight">\(\gamma\)</span>, we will move to the point:</p>
<div class="math notranslate nohighlight">
\[\theta^{(1)} = \theta^{(0)} - \gamma J'(\theta^{(0)})\]</div>
<p>For instance, if we choose <span class="math notranslate nohighlight">\(\gamma = 0.02\)</span>, we will move to point
<span class="math notranslate nohighlight">\(\theta^{(1)} = 0.4 + 0.02 \cdot 1.8 = 0.436\)</span>. The procedure works
iteratively until the derivative is so small that no movement is
possible, as shown in the following figure:</p>
<p><img alt="" src="../_images/gd3.png" /></p>
<p>In the next step, we compute the derivative of the function in the
current point <span class="math notranslate nohighlight">\(J\left( \beta^{(1)} \right) = - 0.8\)</span> and move to point
<span class="math notranslate nohighlight">\(\beta^{(2)} = \beta_{1} - \gamma J'(\beta^{(1)})\)</span>.</p>
<p><img alt="" src="../_images/gd4.png" /></p>
<p>Next, we compute the derivative of the function in the current point
<span class="math notranslate nohighlight">\(f\left( \theta^{(2)} \right) = - 0.4\)</span> and move to point
<span class="math notranslate nohighlight">\(\theta^{(3)} = \theta^{(2)} - \gamma J'(\theta^{(2)})\)</span>:</p>
<p><img alt="" src="../_images/gd5.png" /></p>
<p>We then compute the derivative of the current point
<span class="math notranslate nohighlight">\(J\left( \theta^{(3)} \right) \approx 0\)</span>:</p>
<p><img alt="" src="../_images/gd6.png" /></p>
<p>This derivative is so small that we cannot advance further. We are in a
local minimum. The optimization terminates here. We have found the value
<span class="math notranslate nohighlight">\(\theta^{(3)} = \arg_{\theta}\min{J(\theta)}\)</span>.</p>
<p>In practice, the algorithm is terminated following a <strong>given termination
criterion</strong>. Two common criteria are:</p>
<ul class="simple">
<li><p>A maximum number of iterations is reached.</p></li>
<li><p>The value <span class="math notranslate nohighlight">\(\gamma J'(\theta)\)</span> is below a given threshold.</p></li>
</ul>
<p class="rubric">Global vs Local Minima</p>
<p>It is important to note that gradient descent can be applied only if the
cost function is <strong>differentiable with respect to its parameters</strong>.
Moreover, the algorithm is guaranteed to converge to the global minimum
<strong>only if the cost function is convex</strong>. In the general case of
non-convex loss function, the algorithm may converge to a <strong>local
minimum</strong>, which may represent a <strong>suboptimal solution</strong>. Nevertheless,
when the number of parameters is very large, gradient descent <strong>usually
finds a good enough solution</strong>, even if it only converges to a local
minimum.</p>
<p class="rubric">One Variable</p>
<p>The gradient descent algorithm can be written in the following form in
the case of one variable:</p>
<ol class="arabic simple">
<li><p>Choose an initial random point <span class="math notranslate nohighlight">\(\beta\)</span>;</p></li>
<li><p>Compute the first derivative of the function <span class="math notranslate nohighlight">\(J'\)</span> in the current
point <span class="math notranslate nohighlight">\(\theta\)</span>: <span class="math notranslate nohighlight">\(J'(\theta)\)</span>;</p></li>
<li><p>Update the position of the current point using the formula
<span class="math notranslate nohighlight">\(\theta = \theta - \gamma J'(\theta)\)</span>;</p></li>
<li><p>Repeat 2-3 until some termination criteria are met.</p></li>
</ol>
<p class="rubric">Multiple Variables</p>
<p>The gradient descent algorithm generalizes to the case in which the
function <span class="math notranslate nohighlight">\(J\)</span> to optimize depends on multiple variables
<span class="math notranslate nohighlight">\(J(\theta_{1},\theta_{2},\ldots,\theta_{n})\)</span>.</p>
<p>For instance, let’s consider a function of two variables
<span class="math notranslate nohighlight">\(J(\theta_{1},\theta_{2})\)</span>. We can plot such function as a 3D plot
(left) or as a contour plot (right). In both cases, our goal is to reach
the point with the minimum value (the ‘center’ of the two plots). Given
a point <span class="math notranslate nohighlight">\(\mathbf{\theta} = (\theta_{1},\theta_{2})\)</span>, the direction of
steepest descent is the <strong>gradient</strong> of the function in the point.</p>
<p><img alt="" src="../_images/gd7.png" /></p>
<p>The gradient is a multi-variable generalization of the derivative. The
gradient of a function of <span class="math notranslate nohighlight">\(n\)</span> variable computed in a point
<span class="math notranslate nohighlight">\(\mathbf{\theta}\)</span> is a vector whose <span class="math notranslate nohighlight">\(i^{th}\)</span> variable is given by the
partial derivative of the function with respect to the <span class="math notranslate nohighlight">\(i^{th}\)</span>
variable:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\nabla J\left( \mathbf{\theta} \right) = \begin{pmatrix}
J_{\theta_{1}}(\mathbf{\theta}) \\
J_{\theta_{2}}(\mathbf{\theta}) \\
\begin{matrix}
\ldots \\
J_{\theta_{n}}(\mathbf{\theta}) \\
\end{matrix} \\
\end{pmatrix}\end{split}\]</div>
<p>In the case of two variables, the gradient will be a 2D vector (the
gradient) indicating the direction to follow. Since in general we want
to optimize multi-variable functions, the algorithm is called ‘gradient
descent’.</p>
<p>The following figure shows an example of an optimization procedure to
reach the center of the curve from a given starting point:</p>
<p><img alt="" src="../_images/gd8.png" /></p>
<p>The pseudocode of the procedure, in the case of the multiple variables
is as follows:</p>
<ol class="arabic simple">
<li><p>Initialize
<span class="math notranslate nohighlight">\(\mathbf{\theta} = (\theta_{1},\theta_{2},\ldots,\theta_{n})\)</span>
randomly.</p></li>
<li><p>For each variable <span class="math notranslate nohighlight">\(x_{i}\)</span>:</p></li>
<li><p>Compute the partial derivative at the point:</p></li>
<li><p><span class="math notranslate nohighlight">\(\frac{\partial}{\partial\theta_{i}}J\left( \mathbf{\theta} \right)\)</span></p></li>
<li><p>Update the current variable using the formula:</p></li>
</ol>
<div class="math notranslate nohighlight">
\[\theta_{i} = \theta_{i} - \gamma\frac{\partial}{\partial\theta_{i}}J(\mathbf{\theta})\]</div>
<ol class="arabic simple" start="6">
<li><p>Repeat 2-3 until the termination criteria are met.</p></li>
</ol>
<p class="rubric">Logistic Regression and Gradient Descent</p>
<p>It can be shown that, in the case of the logistic regressor, the update rule will be:</p>
<div class="math notranslate nohighlight">
\[\beta_{j}\mathbf{=}\beta_{j}\mathbf{-}\gamma\sum_{i = 1\ }^{N}{x_{j}^{(i)}\left( \sigma\left( \mathbf{\beta}^{T}\mathbf{x}^{(i)} \right) - y^{(i)} \right)}\]</div>
<p>For the most curious, the details are in the following section.</p>
<p class="rubric">Derivation of the Update Rule</p>
<p>Let us first consider the derivative of the logistic function:</p>
<div class="math notranslate nohighlight">
\[\sigma(x) = \frac{1}{1 + e^{- x}}\]</div>
<p>This will be:</p>
<p><span class="math notranslate nohighlight">\(\sigma^{'}(x) = - \frac{1}{\left( 1 + e^{- x} \right)^{2}}D\left\lbrack e^{- x} \right\rbrack = \frac{e^{- x}}{\left( 1 + e^{- x} \right)^{2}}\)</span>
[Applying the rule
<span class="math notranslate nohighlight">\(D\left\lbrack \frac{1}{f(x)} \right\rbrack = - \frac{D\left\lbrack f(x) \right\rbrack}{f(x)^{2}}\)</span>]</p>
<p><span class="math notranslate nohighlight">\(\sigma^{'}(x) = \frac{1 + e^{- x} - 1}{\left( 1 + e^{- x} \right)^{2}}\)</span>
[Summing and subtracting <span class="math notranslate nohighlight">\(1\)</span> to the numerator]</p>
<p><span class="math notranslate nohighlight">\(\sigma^{'}(x) = \frac{1 + e^{- x}}{\left( 1 + e^{- x} \right)^{2}} - \frac{1}{\left( 1 + e^{- x} \right)^{2}}\)</span>
[Splitting the numerator in two terms]</p>
<p><span class="math notranslate nohighlight">\(\sigma^{'}(x) = \frac{1}{1 + e^{- x}}\left( 1 - \frac{1}{1 + e^{- x}} \right)\)</span>
[making the <span class="math notranslate nohighlight">\(\frac{1}{1 + e^{- x}}\)</span> factor explicit]</p>
<p><span class="math notranslate nohighlight">\(\sigma^{'}(x) = \sigma(x)\left( 1 - \sigma(x) \right)\)</span> [replacing the
formula <span class="math notranslate nohighlight">\(\sigma(x) = \frac{1}{1 + e^{- x}}\)</span>]</p>
<p class="rubric">Partial Derivatives of the Cost Function</p>
<p>We now need to obtain the partial derivatives of the cost function with
respect to the j-th parameter:</p>
<div class="math notranslate nohighlight">
\[\frac{\partial J\left( \mathbf{\beta} \right)}{\partial\beta_{j}}\]</div>
<p>Remember that the cost function is defined as:</p>
<div class="math notranslate nohighlight">
\[J\left( \mathbf{\beta} \right) = - \sum_{i = 1}^{N}{y^{(i)}\log{\sigma\left( {\mathbf{\beta}^{T}\mathbf{x}}^{(i)} \right)}} + \left( 1 - y^{(i)} \right)\log{(1 - \sigma\left( \mathbf{\beta}^{T}\mathbf{x}^{(i)} \right)})\]</div>
<p>Let us first compute the derivative of the first term of the addition:</p>
<p><span class="math notranslate nohighlight">\(\frac{\partial}{\partial\beta_{j}}y^{(i)}\log{\sigma\left( {\mathbf{\beta}^{T}\mathbf{x}}^{(i)} \right)}\)</span>
[Initial expression]</p>
<p><span class="math notranslate nohighlight">\(= y^{(i)}\frac{1}{\sigma\left( {\mathbf{\beta}^{T}\mathbf{x}}^{(i)} \right)}\frac{\partial}{\beta_{j}}\left\lbrack \sigma\left( {\mathbf{\beta}^{T}\mathbf{x}}^{(i)} \right) \right\rbrack\)</span>
[Applying
<span class="math notranslate nohighlight">\(D\left\lbrack \log\left( f(x) \right) \right\rbrack = \frac{1}{f(x)}f'(x)\)</span>]</p>
<p><span class="math notranslate nohighlight">\(= y^{(i)}\frac{1}{\sigma\left( {\mathbf{\beta}^{T}\mathbf{x}}^{(i)} \right)}\sigma\left( {\mathbf{\beta}^{T}\mathbf{x}}^{(i)} \right)\left( 1 - \sigma\left( {\mathbf{\beta}^{T}\mathbf{x}}^{(i)} \right) \right)\frac{\partial}{\beta_{j}}\left\lbrack {\mathbf{\beta}^{T}\mathbf{x}}^{(i)} \right\rbrack\)</span>
[Applying
<span class="math notranslate nohighlight">\(\sigma^{'}\left( f(x) \right) = \sigma\left( f(x) \right)\left( 1 - \sigma\left( f(x) \right) \right)f'(x)\rbrack\)</span></p>
<p><span class="math notranslate nohighlight">\(= y^{(i)}\frac{1}{\sigma\left( {\mathbf{\beta}^{T}\mathbf{x}}^{(i)} \right)}\sigma\left( {\mathbf{\beta}^{T}\mathbf{x}}^{(i)} \right)\left( 1 - \sigma\left( {\mathbf{\beta}^{T}\mathbf{x}}^{(i)} \right) \right)x_{j}^{(i)}\)</span>
[Applying
<span class="math notranslate nohighlight">\(\frac{\partial}{\beta_{j}}\left\lbrack {\mathbf{\beta}^{T}\mathbf{x}}^{(i)} \right\rbrack = x_{j}\)</span>]</p>
<p>The derivative of the second term will be:</p>
<p><span class="math notranslate nohighlight">\(\frac{\partial}{\partial\beta_{j}}{(1 - y}^{(i)})\log\left( 1 - \sigma\left( {\mathbf{\beta}^{T}\mathbf{x}}^{(i)} \right) \right)\)</span>
[Initial Expression]</p>
<p><span class="math notranslate nohighlight">\(= \left( 1 - y^{(i)} \right)\frac{1}{1 - \sigma\left( {\mathbf{\beta}^{T}\mathbf{x}}^{(i)} \right)}\frac{\partial}{\beta_{j}}\ \lbrack 1 - \sigma\left( {\mathbf{\beta}^{T}\mathbf{x}}^{(i)} \right)\rbrack\)</span>
[Applying
<span class="math notranslate nohighlight">\(D\left\lbrack \log\left( f(x) \right) \right\rbrack = \frac{1}{f(x)}f'(x)\)</span>]</p>
<p><span class="math notranslate nohighlight">\(= \left( 1 - y^{(i)} \right)\frac{1}{1 - \sigma\left( {\mathbf{\beta}^{T}\mathbf{x}}^{(i)} \right)}( - 1)\sigma\left( \mathbf{\beta}^{T}\mathbf{x}^{(i)} \right)\left( 1 - \sigma\left( \mathbf{\beta}^{T}x^{(i)} \right) \right)x_{j}^{(i)}\)</span>
[Applying <span class="math notranslate nohighlight">\(\sigma(x)\left( 1 - \sigma(x) \right)\)</span> and
<span class="math notranslate nohighlight">\(\frac{\partial}{\beta_{j}}\left\lbrack {\mathbf{\beta}^{T}\mathbf{x}}^{(i)} \right\rbrack = x_{j}\)</span>]</p>
<p><span class="math notranslate nohighlight">\(= \frac{y^{(i)} - 1}{1 - \sigma\left( {\mathbf{\beta}^{T}\mathbf{x}}^{(i)} \right)}\sigma\left( \mathbf{\beta}^{T}\mathbf{x}^{(i)} \right)\left( 1 - \sigma\left( \mathbf{\beta}^{T}x^{(i)} \right) \right)x_{j}^{(i)}\)</span>
[Simplifying]</p>
<p>We can write the sum of the last two derivatives as follows:</p>
<p><span class="math notranslate nohighlight">\(\frac{\partial}{\partial\beta_{j}}y^{(i)}\log{\sigma\left( {\mathbf{\beta}^{T}\mathbf{x}}^{(i)} \right)} + \frac{\partial}{\partial\beta_{j}}{(1 - y}^{(i)})\log\left( 1 - \sigma\left( {\mathbf{\beta}^{T}\mathbf{x}}^{(i)} \right) \right)\)</span>
[Initial Expression]</p>
<p><span class="math notranslate nohighlight">\(= \frac{y^{(i)}}{\sigma\left( {\mathbf{\beta}^{T}\mathbf{x}}^{(i)} \right)}\sigma\left( {\mathbf{\beta}^{T}\mathbf{x}}^{(i)} \right)\left( 1 - \sigma\left( {\mathbf{\beta}^{T}\mathbf{x}}^{(i)} \right) \right)x_{j}^{(i)} + \frac{y^{(i)} - 1}{1 - \sigma\left( {\mathbf{\beta}^{T}\mathbf{x}}^{(i)} \right)}\sigma\left( \mathbf{\beta}^{T}\mathbf{x}^{(i)} \right)\left( 1 - \sigma\left( \mathbf{\beta}^{T}x^{(i)} \right) \right)x_{j}^{(i)}\)</span>
[Replacing derivatives]</p>
<p><span class="math notranslate nohighlight">\(= \sigma\left( {\mathbf{\beta}^{T}\mathbf{x}}^{(i)} \right)\left( 1 - \sigma\left( {\mathbf{\beta}^{T}\mathbf{x}}^{(i)} \right) \right)x_{j}^{(i)}\left\lbrack \frac{y^{(i)}}{\sigma\left( {\mathbf{\beta}^{T}\mathbf{x}}^{(i)} \right)} + \frac{y^{(i)} - 1}{1 - \sigma\left( {\mathbf{\beta}^{T}\mathbf{x}}^{(i)} \right)} \right\rbrack\)</span>
[Simplifying]</p>
<p><span class="math notranslate nohighlight">\(= \sigma\left( {\mathbf{\beta}^{T}\mathbf{x}}^{(i)} \right)\left( 1 - \sigma\left( {\mathbf{\beta}^{T}\mathbf{x}}^{(i)} \right) \right)x_{j}^{(i)}\left\lbrack \frac{y^{(i)}\left( 1 - \sigma\left( {\mathbf{\beta}^{T}\mathbf{x}}^{(i)} \right) \right) + (y^{(i)} - 1)\sigma\left( {\mathbf{\beta}^{T}\mathbf{x}}^{(i)} \right)}{\sigma\left( {\mathbf{\beta}^{T}\mathbf{x}}^{(i)} \right)\left( 1 - \sigma\left( {\mathbf{\beta}^{T}\mathbf{x}}^{(i)} \right) \right)} \right\rbrack\)</span>
[Simplifying]</p>
<p><span class="math notranslate nohighlight">\(= \frac{\sigma\left( {\mathbf{\beta}^{T}\mathbf{x}}^{(i)} \right)\left( 1 - \sigma\left( {\mathbf{\beta}^{T}\mathbf{x}}^{(i)} \right) \right)}{\sigma\left( {\mathbf{\beta}^{T}\mathbf{x}}^{(i)} \right)\left( 1 - \sigma\left( {\mathbf{\beta}^{T}\mathbf{x}}^{(i)} \right) \right)}x_{j}^{(i)}\left\lbrack y^{(i)}\left( 1 - \sigma\left( {\mathbf{\beta}^{T}\mathbf{x}}^{(i)} \right) \right) + (y^{(i)} - 1)\sigma\left( {\mathbf{\beta}^{T}\mathbf{x}}^{(i)} \right) \right\rbrack\)</span>
[Simplifying]</p>
<p><span class="math notranslate nohighlight">\(= x_{j}^{(i)}\left\lbrack y^{(i)} - y^{(i)}\sigma\left( {\mathbf{\beta}^{T}\mathbf{x}}^{(i)} \right) + y^{(i)}\sigma\left( {\mathbf{\beta}^{T}\mathbf{x}}^{(i)} \right) - \sigma\left( {\mathbf{\beta}^{T}\mathbf{x}}^{(i)} \right) \right\rbrack\)</span>
[Simplifying]</p>
<p><span class="math notranslate nohighlight">\(= x_{j}^{(i)}\left( y^{(i)} - \sigma\left( {\mathbf{\beta}^{T}\mathbf{x}}^{(i)} \right) \right)\)</span>
[Simplifying]</p>
<p>The derivative of the cost function with respect to the j-th parameter
will hence be:</p>
<div class="math notranslate nohighlight">
\[\frac{\partial J\left( \mathbf{\beta} \right)}{\partial\beta_{j}} = - \sum_{i = 1}^{N}{\frac{\partial}{\partial\beta_{j}}y^{(i)}\log{\sigma\left( {\mathbf{\beta}^{T}\mathbf{x}}^{(i)} \right)} + \frac{\partial}{\partial\beta_{j}}{(1 - y}^{(i)})\log\left( 1 - \sigma\left( {\mathbf{\beta}^{T}\mathbf{x}}^{(i)} \right) \right)} = \sum_{i}^{N}{x_{j}^{(i)}\left( y^{(i)} - \sigma\left( \beta^{T}x^{(i)} \right) \right)}\]</div>
<p>The gradient descent update rule for each parameter will be:</p>
<div class="math notranslate nohighlight">
\[\beta_{j}\mathbf{=}\beta_{j}\mathbf{-}\gamma\sum_{i = 1\ }^{N}{x_{j}^{(i)}\left( \sigma\left( \mathbf{\beta}^{T}\mathbf{x}^{(i)} \right) - y^{(i)} \right)}\]</div>
</div>
</section>
<section id="example-of-logistic-regression">
<h3><span class="section-number">19.9. </span>Example of Logistic Regression<a class="headerlink" href="#example-of-logistic-regression" title="Permalink to this heading">#</a></h3>
<p>Let us now apply logistic regression to a larger set of variables in our regression problem. We will consider the following independent variables:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">radius1</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">texture1</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">perimeter1</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">area1</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">smoothness1</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">compactness1</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">concavity1</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">symmetry1</span></code></p></li>
</ul>
<p>The dependent variable is again <code class="docutils literal notranslate"><span class="pre">Diagnosis</span></code>.</p>
<p>Once fit to the data, we will obtain the following parameters:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p><span class="math notranslate nohighlight">\(R^2\)</span></p></th>
<th class="head"><p>Adj. <span class="math notranslate nohighlight">\(R^2\)</span></p></th>
<th class="head"><p>F-statistic</p></th>
<th class="head"><p>Prob(F-statistic)</p></th>
<th class="head"><p>Log-Likelihood</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0.670</p></td>
<td><p>0.666</p></td>
<td><p>142.4</p></td>
<td><p>1.16e-129</p></td>
<td><p>-78.055</p></td>
</tr>
</tbody>
</table>
<p>All values have interpretations similar to the ones obtained in the case of linear regression. The Log-Likelihood reports the value of the logarithm of the likelihood which was used to train the data.</p>
<p>The estimates for the coefficients are as follows:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<tr>
        <td></td>          <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th>    <td>   -2.6591</td> <td>    0.224</td> <td>  -11.896</td> <td> 0.000</td> <td>   -3.098</td> <td>   -2.220</td>
</tr>
<tr>
  <th>radius1</th>      <td>    0.4688</td> <td>    0.133</td> <td>    3.532</td> <td> 0.000</td> <td>    0.208</td> <td>    0.730</td>
</tr>
<tr>
  <th>texture1</th>     <td>    0.0219</td> <td>    0.003</td> <td>    7.376</td> <td> 0.000</td> <td>    0.016</td> <td>    0.028</td>
</tr>
<tr>
  <th>perimeter1</th>   <td>   -0.0473</td> <td>    0.021</td> <td>   -2.272</td> <td> 0.023</td> <td>   -0.088</td> <td>   -0.006</td>
</tr>
<tr>
  <th>area1</th>        <td>   -0.0009</td> <td>    0.000</td> <td>   -3.985</td> <td> 0.000</td> <td>   -0.001</td> <td>   -0.000</td>
</tr>
<tr>
  <th>smoothness1</th>  <td>    5.1389</td> <td>    1.221</td> <td>    4.208</td> <td> 0.000</td> <td>    2.740</td> <td>    7.538</td>
</tr>
<tr>
  <th>compactness1</th> <td>    0.3080</td> <td>    0.854</td> <td>    0.360</td> <td> 0.719</td> <td>   -1.370</td> <td>    1.986</td>
</tr>
<tr>
  <th>concavity1</th>   <td>    2.0973</td> <td>    0.414</td> <td>    5.065</td> <td> 0.000</td> <td>    1.284</td> <td>    2.911</td>
</tr>
<tr>
  <th>symmetry1</th>    <td>    1.2739</td> <td>    0.568</td> <td>    2.244</td> <td> 0.025</td> <td>    0.159</td> <td>    2.389</td>
</tr>
</table></div></div>
</div>
<p>We notice that not all variables have a statistically relevant relationship with the dependent variable. Applying backward elimination, we remove <code class="docutils literal notranslate"><span class="pre">compactness1</span></code> and obtain the following estimates:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<tr>
       <td></td>          <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th>   <td>   -2.6708</td> <td>    0.221</td> <td>  -12.086</td> <td> 0.000</td> <td>   -3.105</td> <td>   -2.237</td>
</tr>
<tr>
  <th>radius1</th>     <td>    0.4360</td> <td>    0.097</td> <td>    4.517</td> <td> 0.000</td> <td>    0.246</td> <td>    0.626</td>
</tr>
<tr>
  <th>texture1</th>    <td>    0.0219</td> <td>    0.003</td> <td>    7.405</td> <td> 0.000</td> <td>    0.016</td> <td>    0.028</td>
</tr>
<tr>
  <th>perimeter1</th>  <td>   -0.0419</td> <td>    0.014</td> <td>   -2.915</td> <td> 0.004</td> <td>   -0.070</td> <td>   -0.014</td>
</tr>
<tr>
  <th>area1</th>       <td>   -0.0010</td> <td>    0.000</td> <td>   -4.477</td> <td> 0.000</td> <td>   -0.001</td> <td>   -0.001</td>
</tr>
<tr>
  <th>smoothness1</th> <td>    5.3093</td> <td>    1.125</td> <td>    4.719</td> <td> 0.000</td> <td>    3.099</td> <td>    7.519</td>
</tr>
<tr>
  <th>concavity1</th>  <td>    2.1479</td> <td>    0.389</td> <td>    5.517</td> <td> 0.000</td> <td>    1.383</td> <td>    2.913</td>
</tr>
<tr>
  <th>symmetry1</th>   <td>    1.3132</td> <td>    0.557</td> <td>    2.359</td> <td> 0.019</td> <td>    0.220</td> <td>    2.407</td>
</tr>
</table></div></div>
</div>
<p>These are now all statistically relevant. For instance, we can see that:</p>
<ul class="simple">
<li><p>When all variables are set to zero, the odds of the benign tumor are <span class="math notranslate nohighlight">\(e^{-2.6708} \approx 0.07\)</span>, or <span class="math notranslate nohighlight">\(\frac{7}{100}\)</span>. This is a base value.</p></li>
<li><p>An increment in one unit of <code class="docutils literal notranslate"><span class="pre">texture1</span></code> increments the odds of a benign tumor multiplicatively by a factor of <span class="math notranslate nohighlight">\(e^{0.0219} \approx 1.02\)</span> (a +<span class="math notranslate nohighlight">\(2\%\)</span>).</p></li>
<li><p>An increment of one unit of <code class="docutils literal notranslate"><span class="pre">perimeter1</span></code> decrements the odds of benign tumor multiplicatively by a factor of <span class="math notranslate nohighlight">\(e^{-0.0419} \approx 0.96\)</span> (a -<span class="math notranslate nohighlight">\(4\%\)</span>).</p></li>
</ul>
</section>
<section id="multinomial-logistic-regression">
<h3><span class="section-number">19.10. </span>Multinomial Logistic Regression<a class="headerlink" href="#multinomial-logistic-regression" title="Permalink to this heading">#</a></h3>
<p>In many cases, we want to study the relationship between a set of <strong>continuous or categorical independent variable and a non-binary categorical dependent variable</strong>.</p>
<section id="the-iris-dataset">
<h4><span class="section-number">19.10.1. </span>The Iris Dataset<a class="headerlink" href="#the-iris-dataset" title="Permalink to this heading">#</a></h4>
<p>An example is given by Fisher’s Iris dataset.</p>
<p>The dataset was introduced by Ronald Fisher in 1936 and contains observations related to 150 specimens of iris flowers belonging to 3 different species: “setosa”, “versicolor”, and “virginica”. Example images of the three flowers are given below:</p>
<p><img alt="" src="../_images/iris.png" /></p>
<p>For each of the observations, the dataset provides measurements of 4 physical characteristics (length and width of sepals and petals), as illustrated in the image below:</p>
<p><img alt="" src="../_images/sepal_petal.png" /></p>
<p>All the variables in the dataset are numeric, except for <code class="docutils literal notranslate"><span class="pre">species</span></code>, which is categorical. Here are some observations from the dataset:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sepal_length</th>
      <th>sepal_width</th>
      <th>petal_length</th>
      <th>petal_width</th>
      <th>species</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5.1</td>
      <td>3.5</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4.9</td>
      <td>3.0</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4.7</td>
      <td>3.2</td>
      <td>1.3</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4.6</td>
      <td>3.1</td>
      <td>1.5</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5.0</td>
      <td>3.6</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>145</th>
      <td>6.7</td>
      <td>3.0</td>
      <td>5.2</td>
      <td>2.3</td>
      <td>virginica</td>
    </tr>
    <tr>
      <th>146</th>
      <td>6.3</td>
      <td>2.5</td>
      <td>5.0</td>
      <td>1.9</td>
      <td>virginica</td>
    </tr>
    <tr>
      <th>147</th>
      <td>6.5</td>
      <td>3.0</td>
      <td>5.2</td>
      <td>2.0</td>
      <td>virginica</td>
    </tr>
    <tr>
      <th>148</th>
      <td>6.2</td>
      <td>3.4</td>
      <td>5.4</td>
      <td>2.3</td>
      <td>virginica</td>
    </tr>
    <tr>
      <th>149</th>
      <td>5.9</td>
      <td>3.0</td>
      <td>5.1</td>
      <td>1.8</td>
      <td>virginica</td>
    </tr>
  </tbody>
</table>
<p>150 rows × 5 columns</p>
</div></div></div>
</div>
<p>Looking at the scatterplots we can see how the measurements have different ranges (same units, all centimeters):</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/a9889b3ca87b0828a39742ef9d9639169a3855d9e75338e5f277de0a9ae5d88d.png" src="../_images/a9889b3ca87b0828a39742ef9d9639169a3855d9e75338e5f277de0a9ae5d88d.png" />
</div>
</div>
<p>Let us observe the scatter matrix</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/d46123de31e58dfeb8edb21141cb1f953c65d24573a69c0853fcc211c8f60834.png" src="../_images/d46123de31e58dfeb8edb21141cb1f953c65d24573a69c0853fcc211c8f60834.png" />
</div>
</div>
</section>
<section id="additional-limitations-of-a-linear-regression-in-the-presence-of-more-than-two-classes">
<h4><span class="section-number">19.10.2. </span>Additional Limitations of a Linear Regression in the Presence of More than Two Classes<a class="headerlink" href="#additional-limitations-of-a-linear-regression-in-the-presence-of-more-than-two-classes" title="Permalink to this heading">#</a></h4>
<p>Let us consider again a case with a single independent feature. We will select <code class="docutils literal notranslate"><span class="pre">petal_length</span></code>. The following image plots it with respect to the three classes:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/f7d88680b9af0d55dae7bf8b3eabddaebbd9c5bb31e4705c4cba32f8c5e7bb6c.png" src="../_images/f7d88680b9af0d55dae7bf8b3eabddaebbd9c5bb31e4705c4cba32f8c5e7bb6c.png" />
</div>
</div>
<p>From the figure above, one may think that a linear regressor, even if not perfect, could still be an option. However, <strong>to fit a linear regressor, we should first convert species values to numeric values</strong>. A possible outcome could be:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/71a8f8a8c549a685f461dd583e0107d992a711b5d9cad5d4fd824f20e2958a93.png" src="../_images/71a8f8a8c549a685f461dd583e0107d992a711b5d9cad5d4fd824f20e2958a93.png" />
</div>
</div>
<p>However, also the following mapping would be valid:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/0c0257412e34ab0a51337949aa06858231fa01169437fb46e8eaa5572e167482.png" src="../_images/0c0257412e34ab0a51337949aa06858231fa01169437fb46e8eaa5572e167482.png" />
</div>
</div>
<p>Even if the two mappings should be equivalent, we can see how a linear model would find very different results.</p>
<p>This is an example of how the linear model is <strong>even more limited when more than two possible outcomes of the dependent variable are possible</strong>.</p>
</section>
<section id="the-multinomial-logistic-regression-model">
<h4><span class="section-number">19.10.3. </span>The Multinomial Logistic Regression Model<a class="headerlink" href="#the-multinomial-logistic-regression-model" title="Permalink to this heading">#</a></h4>
<p>When the dependent variable can assume more than two values, <strong>we can define the multinomial logistic regression model</strong>. In this case, we select one fo the values of the dependent variable <span class="math notranslate nohighlight">\(Y\)</span> as <strong>a baseline class</strong>. Without loss of generality, let <span class="math notranslate nohighlight">\(K\)</span> be the number of classes and let <span class="math notranslate nohighlight">\(Y=1\)</span> be the baseline class. Recall that in the case of the logistic regressor, we modeled the logarithm of the odd as our linear function:</p>
<div class="math notranslate nohighlight">
\[\log \left(\frac{P(y=1|\mathbf{x})}{1-P(y=1|\mathbf{x})}\right) = \beta_0 + \beta_1 x_1 + \ldots + \beta_n x_n\]</div>
<p>Since we have more than one possible outcomes for the dependent variable, rather than modeling the odds, a multinomial logistic regressor models the logarithm of the ratio between a given class <span class="math notranslate nohighlight">\(k\)</span> and the baseline class <span class="math notranslate nohighlight">\(1\)</span> as follows:</p>
<div class="math notranslate nohighlight">
\[\log\left( \frac{P(Y=k|X=\mathbf{x})}{P(Y=1|X=\mathbf{x})} \right) = \beta_{k0} + \beta_{k1} x_1 + \ldots + \beta_{kn} x_n\]</div>
<p>Note that, in practice, we need to define a different linear function for each class <span class="math notranslate nohighlight">\(k = 1 \ldots K\)</span>, hence we need <span class="math notranslate nohighlight">\((n+1) \times (k-1)\)</span> parameters.</p>
<p>Let <span class="math notranslate nohighlight">\(P(k)=(Y=k|X=\mathcal{x})\)</span> for brevity, <span class="math notranslate nohighlight">\(\mathbf{\beta_k}=(\beta_0,\beta_1,\ldots,\beta_k)\)</span> and <span class="math notranslate nohighlight">\(\mathbf{X}=(1,x_1,\ldots,x_n)\)</span>. We can see that:</p>
<div class="math notranslate nohighlight">
\[\log\left(\frac{P(k)}{P(1)}\right) = \mathbf{\beta_k}^T\mathbf{X} \Rightarrow P(k)= e^{\mathbf{\beta_k}^T\mathbf{X}} P(1)\]</div>
<p>We can divide the last term by <span class="math notranslate nohighlight">\(1=\sum_{l=1}^K P(l)\)</span>:</p>
<div class="math notranslate nohighlight">
\[ P(k) = \frac{e^{\mathbf{\beta_k}^T\mathbf{X}} P(1)}{\sum_{l=1}^K P(l)} = \frac{e^{\mathbf{\beta_k}^T\mathbf{X}}}{\sum_{l=1}^K \frac{P(l)}{P(1)}} = \frac{e^{\mathbf{\beta_k}^T\mathbf{X}}}{\frac{P(1)}{P(1)}+\sum_{l=2}^K \frac{P(l)}{P(1)}} = \frac{e^{\mathbf{\beta_k}^T\mathbf{X}}}{1+\sum_{l=2}^K \mathbf{e^{\beta_l^T\mathbf{X}}}} \text{   (A)}\]</div>
<p>Note that the expression above can also be seen as:</p>
<div class="math notranslate nohighlight">
\[ P(k) = \frac{\frac{P(k)}{P(1)}}{1+\sum_{l=2}^K \mathbf{e^{\beta_l^T\mathbf{X}}}}\]</div>
<p>Hence:</p>
<div class="math notranslate nohighlight">
\[ P(1) = \frac{1}{1+\sum_{l=2}^K e^{\mathbf{\beta}_l^T\mathbf{X}}} \text{   (B)}\]</div>
<p>We can rewrite the results (A) and (B) in the full form:</p>
<div class="math notranslate nohighlight">
\[ P(Y=k|X=\mathbf{x}) = \frac{e^{\mathbf{\beta_k}^T\mathbf{X}}}{1+\sum_{l=2}^K \mathbf{e^{\beta_l^T\mathbf{X}}}}\]</div>
<div class="math notranslate nohighlight">
\[ P(Y=1|X=\mathbf{x}) = \frac{1}{1+\sum_{l=2}^K \mathbf{e^{\beta_l^T\mathbf{X}}}}\]</div>
<p>These two expressions can be used to compute the probabilities of the classes once that the parameters have been estimated and <span class="math notranslate nohighlight">\(\mathcal{x}\)</span> is observed.</p>
<section id="estimating-the-parameters-of-the-multinomial-logistic-regressor-model">
<h5><span class="section-number">19.10.3.1. </span>Estimating the Parameters of the Multinomial Logistic Regressor Model<a class="headerlink" href="#estimating-the-parameters-of-the-multinomial-logistic-regressor-model" title="Permalink to this heading">#</a></h5>
<p>We can estimate the paramters of the multinomial logistic regressor model again by maximizing the likelihood of the model on the data. Assuming that all observations are i.i.d., we can write:</p>
<div class="math notranslate nohighlight">
\[L(\mathbf{\beta}) = \prod_{i=1}^N P(Y=y^{(i)}|X=\mathbf{x}^{(i)};\mathbf{\beta})\]</div>
<p>Again, we minimize the negative log likelihood:</p>
<div class="math notranslate nohighlight">
\[nll(\mathcal{\beta})=-\log L(\mathbf{\beta}) = -\sum_{i=1}^N \log P(Y=y^{(i)}|X=\mathbf{x}^{(i)};\mathbf{\beta}) = -\sum_{i=1}^N [y^{(i)} \neq 1](e^{-\mathbf{\beta}_k^T\mathbf{X}} - \log(1+\sum_{l=2}^K {\beta}_k^T\mathbf{X})) + [y^{(i)} = 1] (- \log(1+\sum_{l=2}^K {\beta}_k^T\mathbf{X}))\]</div>
<p>Where <span class="math notranslate nohighlight">\([\cdot]\)</span> denotes the Iverson brackets:</p>
<div class="math notranslate nohighlight">
\[\begin{split}[x] = \begin{cases}1 &amp; \text{if } x \text{ is true} \\ 0 &amp; \text{otherwise}\end{cases}\end{split}\]</div>
<p>Similarly to the logistic regressor, there is no close form for the estimation of the parameters, but iterative algorithms such as <strong>gradient descent</strong> are in general used for optimization.</p>
</section>
<section id="interpretation-of-the-parameters-of-a-multinomial-logistic-regressor">
<h5><span class="section-number">19.10.3.2. </span>Interpretation of the Parameters of a Multinomial Logistic Regressor<a class="headerlink" href="#interpretation-of-the-parameters-of-a-multinomial-logistic-regressor" title="Permalink to this heading">#</a></h5>
<p>The statistical interpretation of the parameters of a multinomial logistic regressor is similar to the one of a logistic regressor, but we should pay attention to the choice of the baseline.</p>
<p>Let us consider our example of studying the relationship between <code class="docutils literal notranslate"><span class="pre">sepal_lenght</span></code> and <code class="docutils literal notranslate"><span class="pre">species</span></code>. We will map <code class="docutils literal notranslate"><span class="pre">virginica</span></code> to <span class="math notranslate nohighlight">\(0\)</span>, <code class="docutils literal notranslate"><span class="pre">versicolor</span></code> to <span class="math notranslate nohighlight">\(1\)</span> and <code class="docutils literal notranslate"><span class="pre">setosa</span></code> to <span class="math notranslate nohighlight">\(2\)</span>. Once the model is fit, we will find the following values:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Pseudo <span class="math notranslate nohighlight">\(R^2\)</span></p></th>
<th class="head"><p>LogLikelihood</p></th>
<th class="head"><p>LLR p-value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0.4476</p></td>
<td><p>-91.034</p></td>
<td><p>9.276e-33</p></td>
</tr>
</tbody>
</table>
<p>The value of LLR p-value is telling us that the model is statistically relevant, even if the pseudo <span class="math notranslate nohighlight">\(R^2\)</span> is not very high. The relationship is not completely explained by the multinomial logistic regressor.</p>
<p>The coefficients will be as follows:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Optimization terminated successfully.
         Current function value: 0.606893
         Iterations 8
</pre></div>
</div>
<div class="output text_html"><table class="simpletable">
<tr>
    <th>species=1</th>     <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th>    <td>   12.6771</td> <td>    2.906</td> <td>    4.362</td> <td> 0.000</td> <td>    6.981</td> <td>   18.373</td>
</tr>
<tr>
  <th>sepal_length</th> <td>   -2.0307</td> <td>    0.466</td> <td>   -4.361</td> <td> 0.000</td> <td>   -2.943</td> <td>   -1.118</td>
</tr>
<tr>
    <th>species=2</th>     <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th>    <td>   38.7590</td> <td>    5.691</td> <td>    6.811</td> <td> 0.000</td> <td>   27.605</td> <td>   49.913</td>
</tr>
<tr>
  <th>sepal_length</th> <td>   -6.8464</td> <td>    1.022</td> <td>   -6.698</td> <td> 0.000</td> <td>   -8.850</td> <td>   -4.843</td>
</tr>
</table></div></div>
</div>
<p>We can see that there are two sets of coefficients. One for <code class="docutils literal notranslate"><span class="pre">species=1</span></code> (versicolor) and one for <code class="docutils literal notranslate"><span class="pre">species=2</span></code> (setosa). No coefficients have been estimated for <code class="docutils literal notranslate"><span class="pre">virginica</span></code>, because it has been chosen as the baseline. We can see that all p-values are small, so we can keep all variables. Let us see how to interpret the coefficients:</p>
<ul class="simple">
<li><p>The intercept for <code class="docutils literal notranslate"><span class="pre">species=1</span></code> is <span class="math notranslate nohighlight">\(12.6771\)</span>. This indicates that the odd of <code class="docutils literal notranslate"><span class="pre">versicolor</span></code> versus <code class="docutils literal notranslate"><span class="pre">virginica</span></code> is <span class="math notranslate nohighlight">\(e^{12.6771}=320327.76\)</span>, when <code class="docutils literal notranslate"><span class="pre">sepal_length</span></code> is set to zero. This is a very large number, probably due to the fact that <code class="docutils literal notranslate"><span class="pre">sepal_lenght=0</span></code> is not a realistic observation.</p></li>
<li><p>The intercept for <code class="docutils literal notranslate"><span class="pre">species=2</span></code> is <span class="math notranslate nohighlight">\(38.7590\)</span>. This indicates that the odd of <code class="docutils literal notranslate"><span class="pre">setosa</span></code> versus <code class="docutils literal notranslate"><span class="pre">virginica</span></code> is <span class="math notranslate nohighlight">\(e^{38.7590}=6.8e+16\)</span>, when <code class="docutils literal notranslate"><span class="pre">sepal_length</span></code> is set to zero. Also in this case, we obtain a very large number, probably due to the fact that <code class="docutils literal notranslate"><span class="pre">sepal_lenght=0</span></code> is not a realistic observation.</p></li>
<li><p>The coefficient <span class="math notranslate nohighlight">\(-2.0307\)</span> of <code class="docutils literal notranslate"><span class="pre">sepal_length</span></code> for <code class="docutils literal notranslate"><span class="pre">species=1</span></code> indicates that when we observe an increase in one centimeter of <code class="docutils literal notranslate"><span class="pre">sepal_length</span></code>, the odd of <code class="docutils literal notranslate"><span class="pre">versicolor</span></code> versus <code class="docutils literal notranslate"><span class="pre">virginica</span></code> decreases multiplicatively by <span class="math notranslate nohighlight">\(e^{-2.0307} = 0.13\)</span> (a large -<span class="math notranslate nohighlight">\(87\%\)</span>!).</p></li>
<li><p>The coefficient <span class="math notranslate nohighlight">\(-6.8564\)</span> of <code class="docutils literal notranslate"><span class="pre">sepal_length</span></code> for <code class="docutils literal notranslate"><span class="pre">species=2</span></code> indicates that when we observe an increase in one centimeter of <code class="docutils literal notranslate"><span class="pre">sepal_length</span></code>, the odd of <code class="docutils literal notranslate"><span class="pre">setosa</span></code> versus <code class="docutils literal notranslate"><span class="pre">virginica</span></code> decreases multiplicatively by <span class="math notranslate nohighlight">\(e^{-6.8464} = 0.001\)</span> (a large -<span class="math notranslate nohighlight">\(99.9\%\)</span>!).</p></li>
</ul>
</section>
<section id="the-softmax-regressor">
<h5><span class="section-number">19.10.3.3. </span>The Softmax Regressor<a class="headerlink" href="#the-softmax-regressor" title="Permalink to this heading">#</a></h5>
<p>Softmax regression is an alternative formulation of multinomial logistic regression which is designed to avoid the definition of a baseline and it is hence symmetrical. In a softmax regressor, the probabilities are modeled as follows:</p>
<div class="math notranslate nohighlight">
\[ P(Y=k|X=\mathbf{x}) = \frac{e^{\mathbf{\beta_k}^T\mathbf{X}}}{\sum_{l=1}^K \mathbf{e^{\beta_l^T\mathbf{X}}}}, \ \ \ \forall k=1,\ldots,K\]</div>
<p>So, rather than estimating <span class="math notranslate nohighlight">\(K-1\)</span> coefficients, we estimate <span class="math notranslate nohighlight">\(K\)</span> coefficients.</p>
<p>The optimization of the model is performed defining a similar cost function and optimizing it with iterative methods.</p>
<p>The softmax formulation is widely used in predictive analysis and machine learning, but less pervasive in statistics.</p>
</section>
</section>
</section>
<section id="references">
<h3><span class="section-number">19.11. </span>References<a class="headerlink" href="#references" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Chapter <span class="math notranslate nohighlight">\(4\)</span> of [1]</p></li>
</ul>
<p>[1] James, Gareth Gareth Michael. An introduction to statistical learning: with applications in Python, 2023.<a class="reference external" href="https://www.statlearning.com">https://www.statlearning.com</a></p>
</section>
</section>
</div>
<div class="toctree-wrapper compound">
<span id="document-lectures/13_causal_analysis"></span><section class="tex2jax_ignore mathjax_ignore" id="causal-data-analysis">
<h2><span class="section-number">20. </span>Causal Data Analysis<a class="headerlink" href="#causal-data-analysis" title="Permalink to this heading">#</a></h2>
<p>We have seen how to characterize the relationship between two or more variables with correlation and linear regression. We also said that <strong>correlation is not causation</strong>, meaning that, if we observe a correlation between two variables, that does not necessarily implies a cause-effect relationship between them. However, in many cases, it is still useful (or required!) to establish a cause-effect relationship (or lack thereof) between two variables. Consider the following examples:</p>
<ul class="simple">
<li><p>We assess that <strong>a given disease is more frequent among smokers</strong>. Is this just a correlation or is there a cause-effect relationship? If a smoker stops smoking, will their risk to get the disease be reduced?</p></li>
<li><p><strong>We develop a new drug</strong> and assess that people taking this drug are less likely to get disease X. Is this just a correlation or is there a cause-effect relationship? This is important, as people should take the drug only if benefits are clear.</p></li>
<li><p><strong>A large company founds that product sites located in the geographical areas close to the sea are more productive than the others</strong>. Is this just a correlation or is it a cause-effect relationship? Shall we move all sites closer to the sea?</p></li>
</ul>
<p>Luckily, the field of <strong>causal analysis</strong> has, over the years, developed a set of tools which allow to answer those questions.</p>
<p>The goal of this lecture is to provide a primer of causal analysis, introducing the main concepts and discussing some techniques which can be applied in some simple cases.</p>
<section id="sleep-vs-exam-performance">
<h3><span class="section-number">20.1. </span>Sleep vs Exam Performance<a class="headerlink" href="#sleep-vs-exam-performance" title="Permalink to this heading">#</a></h3>
<p>We will consider a simple example which will guide us through the understanding of the main concepts of causal analysis. The data is made up and showing somewhat extreme correlations, but it should serve the purpose of illustrating the main concepts.</p>
<p>We want to study the relationship between sleep and exam performance (in a <span class="math notranslate nohighlight">\(0-100\)</span> scale), so we asked <span class="math notranslate nohighlight">\(50\)</span> students to tell us about their sleeping habits (in particular, we asked if they sleep, in average, 8 hours of more, the recommended number of hours for their age). We put these numbers together with the average exam performance of the students, obtaining the following data:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Average Exam Performance</th>
      <th>Sleep 8 Hours or More</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>77.472070</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>72.081839</td>
      <td>True</td>
    </tr>
    <tr>
      <th>2</th>
      <td>69.676638</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>87.552836</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>70.589191</td>
      <td>False</td>
    </tr>
    <tr>
      <th>5</th>
      <td>60.515116</td>
      <td>False</td>
    </tr>
    <tr>
      <th>6</th>
      <td>100.000000</td>
      <td>True</td>
    </tr>
    <tr>
      <th>7</th>
      <td>82.412677</td>
      <td>False</td>
    </tr>
    <tr>
      <th>8</th>
      <td>53.392221</td>
      <td>True</td>
    </tr>
    <tr>
      <th>9</th>
      <td>81.991137</td>
      <td>False</td>
    </tr>
    <tr>
      <th>10</th>
      <td>55.619006</td>
      <td>False</td>
    </tr>
    <tr>
      <th>11</th>
      <td>73.213549</td>
      <td>True</td>
    </tr>
    <tr>
      <th>12</th>
      <td>84.005579</td>
      <td>True</td>
    </tr>
    <tr>
      <th>13</th>
      <td>42.660374</td>
      <td>True</td>
    </tr>
    <tr>
      <th>14</th>
      <td>62.384583</td>
      <td>True</td>
    </tr>
    <tr>
      <th>15</th>
      <td>68.504934</td>
      <td>True</td>
    </tr>
    <tr>
      <th>16</th>
      <td>68.092290</td>
      <td>True</td>
    </tr>
    <tr>
      <th>17</th>
      <td>92.110403</td>
      <td>False</td>
    </tr>
    <tr>
      <th>18</th>
      <td>58.465878</td>
      <td>True</td>
    </tr>
    <tr>
      <th>19</th>
      <td>48.339601</td>
      <td>True</td>
    </tr>
    <tr>
      <th>20</th>
      <td>75.761343</td>
      <td>False</td>
    </tr>
    <tr>
      <th>21</th>
      <td>59.584134</td>
      <td>False</td>
    </tr>
    <tr>
      <th>22</th>
      <td>69.904265</td>
      <td>True</td>
    </tr>
    <tr>
      <th>23</th>
      <td>59.164038</td>
      <td>True</td>
    </tr>
    <tr>
      <th>24</th>
      <td>67.323081</td>
      <td>True</td>
    </tr>
    <tr>
      <th>25</th>
      <td>79.381058</td>
      <td>True</td>
    </tr>
    <tr>
      <th>26</th>
      <td>58.620083</td>
      <td>True</td>
    </tr>
    <tr>
      <th>27</th>
      <td>88.292321</td>
      <td>False</td>
    </tr>
    <tr>
      <th>28</th>
      <td>61.347045</td>
      <td>True</td>
    </tr>
    <tr>
      <th>29</th>
      <td>94.284754</td>
      <td>True</td>
    </tr>
    <tr>
      <th>30</th>
      <td>70.239607</td>
      <td>False</td>
    </tr>
    <tr>
      <th>31</th>
      <td>79.951206</td>
      <td>False</td>
    </tr>
    <tr>
      <th>32</th>
      <td>59.156103</td>
      <td>False</td>
    </tr>
    <tr>
      <th>33</th>
      <td>64.247615</td>
      <td>True</td>
    </tr>
    <tr>
      <th>34</th>
      <td>75.990821</td>
      <td>False</td>
    </tr>
    <tr>
      <th>35</th>
      <td>64.931568</td>
      <td>True</td>
    </tr>
    <tr>
      <th>36</th>
      <td>76.821012</td>
      <td>False</td>
    </tr>
    <tr>
      <th>37</th>
      <td>49.675010</td>
      <td>True</td>
    </tr>
    <tr>
      <th>38</th>
      <td>48.250202</td>
      <td>True</td>
    </tr>
    <tr>
      <th>39</th>
      <td>56.820140</td>
      <td>False</td>
    </tr>
    <tr>
      <th>40</th>
      <td>72.919516</td>
      <td>False</td>
    </tr>
    <tr>
      <th>41</th>
      <td>80.277671</td>
      <td>False</td>
    </tr>
    <tr>
      <th>42</th>
      <td>70.984455</td>
      <td>False</td>
    </tr>
    <tr>
      <th>43</th>
      <td>54.531575</td>
      <td>True</td>
    </tr>
    <tr>
      <th>44</th>
      <td>56.946589</td>
      <td>True</td>
    </tr>
    <tr>
      <th>45</th>
      <td>66.654732</td>
      <td>True</td>
    </tr>
    <tr>
      <th>46</th>
      <td>56.555038</td>
      <td>False</td>
    </tr>
    <tr>
      <th>47</th>
      <td>82.108473</td>
      <td>False</td>
    </tr>
    <tr>
      <th>48</th>
      <td>74.018270</td>
      <td>False</td>
    </tr>
    <tr>
      <th>49</th>
      <td>40.939895</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We want to understand if sleep has an effect on exam performance. Let us show some boxplots:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/ac500a01e4a11e6984f0a0386f62a5959be1d7feb65b735c9adaab18ce28f18c.png" src="../_images/ac500a01e4a11e6984f0a0386f62a5959be1d7feb65b735c9adaab18ce28f18c.png" />
</div>
</div>
<p>We got a surprising picture! Sleeping <span class="math notranslate nohighlight">\(8\)</span> hours or more, actually affects negatively the average exam performance! To check if everything is fine, we can add some “notch” to the boxplots. The notch will highlight the confidence intervals for the estimation of the median value:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/55b85999a7a8431ef6dd6d909a2bdcd7beb95b8d41834dbf382996012fa34e7e.png" src="../_images/55b85999a7a8431ef6dd6d909a2bdcd7beb95b8d41834dbf382996012fa34e7e.png" />
</div>
</div>
<p>Since the notches do not intersect, there is no overlap between the confidence interval for a C.L. of <span class="math notranslate nohighlight">\(95\)</span>, hence it is very unlikely that the two median values are very close to each other. The difference seem to be statistically relevant. If we want to be very sure we can <strong>compute a two-sample t-Test</strong> to ensure that the mean values of the two samples actually are distinct. The null hypothesis will be that the two samples have the same mean. If we reject this hypothesis, then the two means are distinct. We obtain the following test statistic and p-value:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Test statistic: -2.5330249947772807
P-value: 0.014630790631265746
</pre></div>
</div>
</div>
</div>
<p>Also in this case, the difference seems to be statistically significant.</p>
</section>
<section id="measuring-causation-potential-outcomes-counterfactuals">
<h3><span class="section-number">20.2. </span>Measuring Causation - Potential Outcomes (Counterfactuals)<a class="headerlink" href="#measuring-causation-potential-outcomes-counterfactuals" title="Permalink to this heading">#</a></h3>
<p>We now start formulating hypotheses and theories: it looks counter-intuitive, but this is what the data is telling us. Isn’t it? It might be that sleeping too much makes you less reactive in the morning, so you cannot properly focus and this makes you a worse student.</p>
<p>If this is true, than we could “<strong>prescribe</strong>” students to sleep less than <span class="math notranslate nohighlight">\(8\)</span> hours to obtain gains in performance. But we also know that… <strong>correlation is not (necessarily) causation!</strong>. We are seeing a correlation here - is it also causation? Of course, we want to be able to tell our students whether to sleep less or not!</p>
<p>To be able to truly assess a causal relationship between the two variables, ideally, we would like to <strong>take the same student and ask them to sleep more than <span class="math notranslate nohighlight">\(8\)</span> hours for one year, than less than <span class="math notranslate nohighlight">\(8\)</span> hours for another years, then compare performance</strong>. This is of course unethical and impractical. And even if we could do so, between the two years, different other factors may change, so the two values will never be fully comparable.</p>
<p>We will now <strong>enter the realm of potential outcomes</strong>. In practice, we ask ourselves questions such as <strong>“what if this student slept less than <span class="math notranslate nohighlight">\(8\)</span> hours?”</strong>. Let’s see some notation first. We will define two variables:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(T_i\)</span>: a “treatment” value indicating whether the observation <span class="math notranslate nohighlight">\(i\)</span> (student <span class="math notranslate nohighlight">\(i\)</span>) took the treatment (i.e., slept more than <span class="math notranslate nohighlight">\(8\)</span> hours) or not. Here we use the standard terminology of causal inference which uses the word “treatment” as in health-related sciences. We will assume this variable to be binary: <span class="math notranslate nohighlight">\(T_i=1\)</span> means “took the treatment”, while <span class="math notranslate nohighlight">\(T_i=0\)</span> means “didn’t take the treatment”.</p></li>
<li><p><span class="math notranslate nohighlight">\(Y_i\)</span>: the “outcome” of observation <span class="math notranslate nohighlight">\(i\)</span>. In our case, this is the average performance of student <span class="math notranslate nohighlight">\(i\)</span>.</p></li>
</ul>
<p>If for a unit <span class="math notranslate nohighlight">\(i\)</span>, the treatment value is <span class="math notranslate nohighlight">\(T_i=t\)</span>, we will denote the related observation <span class="math notranslate nohighlight">\(Y_i\)</span> as <span class="math notranslate nohighlight">\(Y_i(t)\)</span>. We note that, for a given unit <span class="math notranslate nohighlight">\(i\)</span>, we will <strong>either observe <span class="math notranslate nohighlight">\(Y_i(0)\)</span> or <span class="math notranslate nohighlight">\(Y_i(1)\)</span>, but never both!</strong>.</p>
<p>Nevertheless, we will introduce the concept of <strong>potential outcome</strong> as the <strong>value we would observe if we were able to intervene on the treatment variable <span class="math notranslate nohighlight">\(T_i\)</span> and change it</strong>. If for a unit <span class="math notranslate nohighlight">\(i\)</span> we have <span class="math notranslate nohighlight">\(T_i=0\)</span>, we will directly observe the outcome <span class="math notranslate nohighlight">\(Y_i(0)\)</span>, but we will also <strong>theoretically define</strong> the potential outcome <span class="math notranslate nohighlight">\(Y_i(1)\)</span>. This <strong>is not real and cannot be observed</strong> but it will serve as a useful theoretical concept.</p>
<p>Potential outcomes are also known as <strong>counterfactuals</strong> because they answer to the question “what if…”.</p>
<p>If we had potential outcomes, for each unit <span class="math notranslate nohighlight">\(i\)</span> we could compute the <strong>individual treatment effect</strong> (the effect of taking the treatment) as:</p>
<div class="math notranslate nohighlight">
\[Y_i(1) - Y_i(0)\]</div>
<p>This is the effect of sleeping less than <span class="math notranslate nohighlight">\(8\)</span> hours. If we average this over the distribution of observations, we obtain the <strong>average treatment effect</strong>:</p>
<div class="math notranslate nohighlight">
\[ATE = E[Y(1) - Y(0)]\]</div>
<p>This value will tell us <strong>how the exam performance varies in average if the same subjects sleep less or more than <span class="math notranslate nohighlight">\(8\)</span> hours</strong>. As such, it would indicate <strong>the causal effect of sleep on examination performance</strong>.</p>
<p>Alternatively, we can compute the <strong>average treatment effect on the treated</strong>:</p>
<div class="math notranslate nohighlight">
\[ATT = E[Y(1) - Y(0)|T=1]\]</div>
<p>This simply restricts the computation to the treated subjects, and <strong>also establishes a causal effect</strong>.</p>
</section>
<section id="the-bias-arising-from-correlation">
<h3><span class="section-number">20.3. </span>The Bias Arising from Correlation<a class="headerlink" href="#the-bias-arising-from-correlation" title="Permalink to this heading">#</a></h3>
<p>Without potential outcomes, we cannot compute the <span class="math notranslate nohighlight">\(ATE\)</span> or <span class="math notranslate nohighlight">\(ATT\)</span> scores. Indeed, we have <strong>two distinct groups</strong>, the <strong>treated</strong> (i.e., those observations <span class="math notranslate nohighlight">\(i\)</span> such that <span class="math notranslate nohighlight">\(T_i=1\)</span>) and the <strong>untreated</strong>, also known as <strong>control group</strong> (i.e., those observations <span class="math notranslate nohighlight">\(i\)</span> such that <span class="math notranslate nohighlight">\(T_i=0\)</span>).</p>
<p>We could think to replace that calculation with the only data we can observe:</p>
<div class="math notranslate nohighlight">
\[E[Y(1)|T=1] - E[Y(0)|T=0]\]</div>
<p>This is what <strong>a correlation can measure</strong>: the change in average value of <span class="math notranslate nohighlight">\(Y\)</span> in two distinct groups with different characteristics.</p>
<p>Note that there are no potential outcome in the expression above as we directly observe <span class="math notranslate nohighlight">\(Y_i(1)\)</span> when <span class="math notranslate nohighlight">\(T_i=1\)</span> and we directly observe <span class="math notranslate nohighlight">\(Y_i(0)\)</span> when <span class="math notranslate nohighlight">\(T_i=0\)</span>. However, the expression above is now <strong>comparing different groups</strong>. Indeed, the subjects who took the treatment are different from the ones who did not take the treatment, and we do not know if their exam performance scores are really comparable. <strong>Imagine that, for some reason, students in group 0 are, by chance, better students, then the difference we measure is going to be biased and will not reveal a cause-effect relationship</strong>.</p>
<p>We can show this in formulas. Let’s add and subtract the counterfactual term <span class="math notranslate nohighlight">\(E[Y(0)|T=1]\)</span> to the expression above:</p>
<div class="math notranslate nohighlight">
\[E[Y(1)|T=1] - E[Y(0)|T=0] = E[Y(1)|T=1] - E[Y(0)|T=0] - E[Y(0)|T=1] + E[Y(0)|T=1]\]</div>
<p>We note that:</p>
<div class="math notranslate nohighlight">
\[ATT = E[Y(1) - Y(0)|T=1] = E[Y(1)|T=1] - E[Y(0)|T=1]\]</div>
<p>Hence, we can see the expression above as follows:</p>
<div class="math notranslate nohighlight">
\[E[Y(1)|T=1] - E[Y(0)|T=0] = E[Y(1)|T=1] - E[Y(0)|T=1] + E[Y(0)|T=1] - E[Y(0)|T=0] = \]</div>
<div class="math notranslate nohighlight">
\[= ATT + E[Y(0)|T=1] - E[Y(0)|T=0]\]</div>
<p>We will call the last term the bias:</p>
<div class="math notranslate nohighlight">
\[BIAS = E[Y(0)|T=1] - E[Y(0)|T=0]\]</div>
<p>So the whole expression can be seen as:</p>
<div class="math notranslate nohighlight">
\[E[Y(1)|T=1] - E[Y(0)|T=0] = ATT + BIAS\]</div>
<p>which shows that the effect given by the correlation (left term) is <strong>biased</strong>. Note that the bias cannot be computed (it contains a counterfactual term), but we can interpret it as follows:</p>
<blockquote>
<div><p>The bias measures how the treated (<span class="math notranslate nohighlight">\(T=1\)</span>) and control (<span class="math notranslate nohighlight">\(T=0\)</span>) groups would differ if no one had taken the treatment.</p>
</div></blockquote>
<p>In practice:</p>
<ul class="simple">
<li><p>If the groups are similar to each other (e.g., treated and control group are mixed students with similar abilities), then the bias will be small or zero. Indeed, in this case, the difference in exam performance among the two groups if everybody sleeps less than <span class="math notranslate nohighlight">\(8\)</span> hours should be same, as students have similar abilities.</p></li>
<li><p>If the groups are dissimilar (e.g., control students are all better students), then the bias will be different from zero. Indeed, if students in the control group are “better students”, if all sleep less than <span class="math notranslate nohighlight">\(8\)</span> hours, students in the control group will perform better in average, but this has nothing to do with sleeping less or more or with cause-effect relationships among the observed variables.</p></li>
</ul>
<p>Note that, given the observations above, we now know <strong>when association allows to establish a cause-effect mechanism</strong>. This happens when the bias is zero:</p>
<div class="math notranslate nohighlight">
\[BIAS = E[Y(0)|T=1] - E[Y(0)|T=0] = 0\]</div>
<p>That is to say, when the difference between treated and untreated is zero (or at least very small).</p>
<p>Given this intuition, we now try to estimate the students’ abilities by asking how many hours they study per day. We get the following data:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Average Study Time</th>
      <th>Average Exam Performance</th>
      <th>Sleep 8 Hours or More</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>6.993428</td>
      <td>77.472070</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5.723471</td>
      <td>72.081839</td>
      <td>True</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7.295377</td>
      <td>69.676638</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>9.046060</td>
      <td>87.552836</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5.531693</td>
      <td>70.589191</td>
      <td>False</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5.531726</td>
      <td>60.515116</td>
      <td>False</td>
    </tr>
    <tr>
      <th>6</th>
      <td>9.158426</td>
      <td>100.000000</td>
      <td>True</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7.534869</td>
      <td>82.412677</td>
      <td>False</td>
    </tr>
    <tr>
      <th>8</th>
      <td>5.061051</td>
      <td>53.392221</td>
      <td>True</td>
    </tr>
    <tr>
      <th>9</th>
      <td>7.085120</td>
      <td>81.991137</td>
      <td>False</td>
    </tr>
    <tr>
      <th>10</th>
      <td>5.073165</td>
      <td>55.619006</td>
      <td>False</td>
    </tr>
    <tr>
      <th>11</th>
      <td>5.068540</td>
      <td>73.213549</td>
      <td>True</td>
    </tr>
    <tr>
      <th>12</th>
      <td>6.483925</td>
      <td>84.005579</td>
      <td>True</td>
    </tr>
    <tr>
      <th>13</th>
      <td>2.173440</td>
      <td>42.660374</td>
      <td>True</td>
    </tr>
    <tr>
      <th>14</th>
      <td>2.550164</td>
      <td>62.384583</td>
      <td>True</td>
    </tr>
    <tr>
      <th>15</th>
      <td>4.875425</td>
      <td>68.504934</td>
      <td>True</td>
    </tr>
    <tr>
      <th>16</th>
      <td>3.974338</td>
      <td>68.092290</td>
      <td>True</td>
    </tr>
    <tr>
      <th>17</th>
      <td>6.628495</td>
      <td>92.110403</td>
      <td>False</td>
    </tr>
    <tr>
      <th>18</th>
      <td>4.183952</td>
      <td>58.465878</td>
      <td>True</td>
    </tr>
    <tr>
      <th>19</th>
      <td>3.175393</td>
      <td>48.339601</td>
      <td>True</td>
    </tr>
    <tr>
      <th>20</th>
      <td>8.931298</td>
      <td>75.761343</td>
      <td>False</td>
    </tr>
    <tr>
      <th>21</th>
      <td>5.548447</td>
      <td>59.584134</td>
      <td>False</td>
    </tr>
    <tr>
      <th>22</th>
      <td>6.135056</td>
      <td>69.904265</td>
      <td>True</td>
    </tr>
    <tr>
      <th>23</th>
      <td>3.150504</td>
      <td>59.164038</td>
      <td>True</td>
    </tr>
    <tr>
      <th>24</th>
      <td>4.911235</td>
      <td>67.323081</td>
      <td>True</td>
    </tr>
    <tr>
      <th>25</th>
      <td>6.221845</td>
      <td>79.381058</td>
      <td>True</td>
    </tr>
    <tr>
      <th>26</th>
      <td>3.698013</td>
      <td>58.620083</td>
      <td>True</td>
    </tr>
    <tr>
      <th>27</th>
      <td>6.751396</td>
      <td>88.292321</td>
      <td>False</td>
    </tr>
    <tr>
      <th>28</th>
      <td>4.798723</td>
      <td>61.347045</td>
      <td>True</td>
    </tr>
    <tr>
      <th>29</th>
      <td>5.416613</td>
      <td>94.284754</td>
      <td>True</td>
    </tr>
    <tr>
      <th>30</th>
      <td>4.796587</td>
      <td>70.239607</td>
      <td>False</td>
    </tr>
    <tr>
      <th>31</th>
      <td>9.704556</td>
      <td>79.951206</td>
      <td>False</td>
    </tr>
    <tr>
      <th>32</th>
      <td>5.973006</td>
      <td>59.156103</td>
      <td>False</td>
    </tr>
    <tr>
      <th>33</th>
      <td>3.884578</td>
      <td>64.247615</td>
      <td>True</td>
    </tr>
    <tr>
      <th>34</th>
      <td>7.645090</td>
      <td>75.990821</td>
      <td>False</td>
    </tr>
    <tr>
      <th>35</th>
      <td>3.558313</td>
      <td>64.931568</td>
      <td>True</td>
    </tr>
    <tr>
      <th>36</th>
      <td>6.417727</td>
      <td>76.821012</td>
      <td>False</td>
    </tr>
    <tr>
      <th>37</th>
      <td>2.080660</td>
      <td>49.675010</td>
      <td>True</td>
    </tr>
    <tr>
      <th>38</th>
      <td>3.343628</td>
      <td>48.250202</td>
      <td>True</td>
    </tr>
    <tr>
      <th>39</th>
      <td>6.393722</td>
      <td>56.820140</td>
      <td>False</td>
    </tr>
    <tr>
      <th>40</th>
      <td>7.476933</td>
      <td>72.919516</td>
      <td>False</td>
    </tr>
    <tr>
      <th>41</th>
      <td>6.342737</td>
      <td>80.277671</td>
      <td>False</td>
    </tr>
    <tr>
      <th>42</th>
      <td>5.768703</td>
      <td>70.984455</td>
      <td>False</td>
    </tr>
    <tr>
      <th>43</th>
      <td>5.397793</td>
      <td>54.531575</td>
      <td>True</td>
    </tr>
    <tr>
      <th>44</th>
      <td>3.042956</td>
      <td>56.946589</td>
      <td>True</td>
    </tr>
    <tr>
      <th>45</th>
      <td>4.560312</td>
      <td>66.654732</td>
      <td>True</td>
    </tr>
    <tr>
      <th>46</th>
      <td>5.078722</td>
      <td>56.555038</td>
      <td>False</td>
    </tr>
    <tr>
      <th>47</th>
      <td>8.114244</td>
      <td>82.108473</td>
      <td>False</td>
    </tr>
    <tr>
      <th>48</th>
      <td>6.687237</td>
      <td>74.018270</td>
      <td>False</td>
    </tr>
    <tr>
      <th>49</th>
      <td>2.473920</td>
      <td>40.939895</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>We cannot measure bias from this data because we do not have access to counterfactual observations</strong>, but we, now that we have access to a proxy for students’ abilities, we ca try to see if, in the two groups, abilities are equally distributed. Let’s see this with a scatterplot:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/440c017958f84c511c14e5aa47dabb1274fed8cb6932be69e350cc043b57fc40.png" src="../_images/440c017958f84c511c14e5aa47dabb1274fed8cb6932be69e350cc043b57fc40.png" />
</div>
</div>
<p>From the picture above, we see that students’ skills are not equally distributed in the two groups. This is not enough to say that the bias is different from zero, as we are not observing counterfactuals, but we now see that the difference in outcomes could be due to two different causes:</p>
<ul class="simple">
<li><p>Sleeping less than <span class="math notranslate nohighlight">\(8\)</span> hours improves exam performance.</p></li>
<li><p>Some of the difference may be due to the fact that students sleeping less than <span class="math notranslate nohighlight">\(8\)</span> hours, incidentally, study more. This might be a sampling problem (we were lucky/unlucky) or an experiment design problem: students who sleep less have more time to study, so they have higher performance. If this is the case, it is not meaningful to look at hours of sleep to establish a cause-effect relationship.</p></li>
</ul>
<p>Now that we have an intuition into what may make correlation be not indicative of causation, let’s see how to reduce bias to establish cause-effect relationships.</p>
</section>
<section id="randomized-controlled-trials-rct">
<h3><span class="section-number">20.4. </span>Randomized Controlled Trials (RCT)<a class="headerlink" href="#randomized-controlled-trials-rct" title="Permalink to this heading">#</a></h3>
<p>We have seen that correlation is causation when the treated and control groups are comparable for everything except the treatment. The most robust method to remove this bias is via <strong>randomized experiments</strong>, or <strong>Randomized Controlled Trials</strong> (RCT).</p>
<p>A randomized experiment <strong>randomly assigns individuals in a population to a treatment or a control group</strong>. By performing a random assignment, we wish to make the two groups indistinguishable. Of course <strong>one of the two groups will take the treatment and this will likely make the two group distinguishable</strong>, but we wish to make sure that, <strong>apart from the treatment, the two groups are indeed indistinguishable</strong>.</p>
<p>It can be shown that random assignment makes sure that the potential outcomes are conditionally independent given the treatment:</p>
<div class="math notranslate nohighlight">
\[Y(0) \perp Y(1) | T\]</div>
<p>So, if the treatment <span class="math notranslate nohighlight">\(T\)</span> is fixed, the potential outcomes are independent. For instance, if we fix <span class="math notranslate nohighlight">\(T=1\)</span> (so we are taking subjects who sleep <span class="math notranslate nohighlight">\(8\)</span> hours or more), then knowing the observed value <span class="math notranslate nohighlight">\(Y_i(1)\)</span> (i.e., the observed exam performance of student <span class="math notranslate nohighlight">\(i\)</span>), does not tell me anything about the potential outcome <span class="math notranslate nohighlight">\(Y_i(1)\)</span> (the exam performance that the same student would obtain if they slept less than <span class="math notranslate nohighlight">\(8\)</span> hours).</p>
<p>If this conditional independence is valid, then:</p>
<div class="math notranslate nohighlight">
\[E[Y(0)|T=0] = E[Y(0)|T=1] = E[Y(0)]\]</div>
<p>and:</p>
<div class="math notranslate nohighlight">
\[E[Y(1)|T=0] = E[Y(1)|T=1] = E[Y(1)]\]</div>
<p>Which leads to:</p>
<div class="math notranslate nohighlight">
\[E[Y(1)|T=1] - E[Y(0)|T=0] = E[Y(1)] - E[Y(0)] = E[Y(1)-Y(10)] = ATE\]</div>
<p>Hence, in this case, <strong>correlation would be causation</strong>.</p>
<section id="example">
<h4><span class="section-number">20.4.1. </span>Example<a class="headerlink" href="#example" title="Permalink to this heading">#</a></h4>
<p>Let us now consider an example. A school wants to see if a new teaching method is effective. To do so, they ask <span class="math notranslate nohighlight">\(50\)</span> students if they want to <strong>voluntarily enroll a tutoring program</strong>. After one year, they measure the average performance of students who participated in the programme and compare it to those of students who did not participate in the programme. We obtain the following data:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>tutoring</th>
      <th>performance</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>76.432447</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>91.550461</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>85.107378</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>69.981030</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>70.111151</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>195</th>
      <td>0</td>
      <td>68.477160</td>
    </tr>
    <tr>
      <th>196</th>
      <td>0</td>
      <td>87.783594</td>
    </tr>
    <tr>
      <th>197</th>
      <td>1</td>
      <td>88.220111</td>
    </tr>
    <tr>
      <th>198</th>
      <td>1</td>
      <td>93.399423</td>
    </tr>
    <tr>
      <th>199</th>
      <td>1</td>
      <td>84.082421</td>
    </tr>
  </tbody>
</table>
<p>200 rows × 2 columns</p>
</div></div></div>
</div>
<p>Let us visualize two boxplots:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/890f83b31343a35e1ad12191bf5482f508ad9201cf8bcfbd9f6334feeb04ae19.png" src="../_images/890f83b31343a35e1ad12191bf5482f508ad9201cf8bcfbd9f6334feeb04ae19.png" />
</div>
</div>
<p>It looks like a significant improvement. Let’s check if this is statistically relevant with a two-sample t-test:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>T-test results - T-statistic: 4.086568160195115, p-value: 6.358186591194311e-05
</pre></div>
</div>
</div>
</div>
<p>It looks like the tutoring program is a great success!</p>
<p>But, is it true? Well, we know that what we see is correlation, not necessarily causation. <strong>What if there is some bias</strong>?</p>
<p>We quickly realize that we did not perform a randomized experiment, because we did not randomly assigned students to one of the two groups. <strong>What if only motivated students decided to enroll in the program and what if those students were the same who tend to study more than others?</strong></p>
<p>Let’s say we could repeat the experiment, now with random assignment. <strong>Word of caution</strong>: this is not always possible. For instance, in this case, it would not be very polite to “force” students to enroll programs, so we may not be able to carry out this experiment, but let us assume for a moment that we can.</p>
<p>We repeat the experiment and obtain these results:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>tutoring</th>
      <th>performance</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>76.432447</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>91.550461</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>85.107378</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>69.981030</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>70.111151</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>195</th>
      <td>0</td>
      <td>68.477160</td>
    </tr>
    <tr>
      <th>196</th>
      <td>0</td>
      <td>87.783594</td>
    </tr>
    <tr>
      <th>197</th>
      <td>0</td>
      <td>87.970111</td>
    </tr>
    <tr>
      <th>198</th>
      <td>1</td>
      <td>93.399423</td>
    </tr>
    <tr>
      <th>199</th>
      <td>1</td>
      <td>84.082421</td>
    </tr>
  </tbody>
</table>
<p>200 rows × 2 columns</p>
</div></div></div>
</div>
<p>Let’s visualize the boxplots:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/0be487a0ed78ae7e81c373a331e51ccd87c1281854bf9fe75925d99d07130af4.png" src="../_images/0be487a0ed78ae7e81c373a331e51ccd87c1281854bf9fe75925d99d07130af4.png" />
</div>
</div>
<p>We now see a less dramatic improvement. What happened?</p>
<p>By performing a random assignment, we got rid of selection bias. Students voluntarily choosing to enroll in the programme were probably more motivated and keen to study. We now see that the impact of tutoring is very small. We can perform a t-test to assess if this is statistically significant:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>T-test results - T-statistic: -1.1327518742165317, p-value: 0.2586882978200426
</pre></div>
</div>
</div>
</div>
<p>We got a large p-value, the difference is not statistically significant.</p>
</section>
</section>
<section id="causal-effect-and-observational-studies">
<h3><span class="section-number">20.5. </span>Causal Effect and Observational Studies<a class="headerlink" href="#causal-effect-and-observational-studies" title="Permalink to this heading">#</a></h3>
<p>We have seen how to interpret an observed association as a cause-effect relationship we need to reduce bias. The gold standard is to use randomized controlled trials, however <strong>this is not always feasible or ethical</strong>. Consider for instance <strong>the problem of estimating the effect of smoking on the development of a given disease</strong>. To perform a randomized experiment, we should select subjects randomly in two groups and ask people in one of the two groups to smoke. <strong>This is of course unethical, considering that we suspect that smoking has a bad effect on health</strong>.</p>
<p>In these cases, we can only resort to <strong>observational data</strong>: we collect data of smokers and non-smokers and observe association in the data. However, we know that this process is <strong>subject to bias</strong>. How do we deal with it? In this part of the lecture, we will see that <strong>graphical causal models</strong> give us a framework to <strong>set our believes on where bias come from</strong>. If we can accurately model the source of bias, we can remove it by <strong>controlling</strong> on the variable “causing” the bias.</p>
<p>Let us consider our past example: students and tutoring. Let us assume that we cannot perform the random assignment (again, it’s unethical!). Since we imagine that <strong>the interest of students towards study can be a source of bias</strong>, we now ask students to also tell us how interested they are in studying in general in a scale from <span class="math notranslate nohighlight">\(1\)</span> to <span class="math notranslate nohighlight">\(5\)</span>. We obtain the following observations:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>tutoring</th>
      <th>performance</th>
      <th>interest</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>76.432447</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>91.550461</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>85.107378</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>69.981030</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>70.111151</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>195</th>
      <td>0</td>
      <td>68.477160</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>196</th>
      <td>0</td>
      <td>87.783594</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>197</th>
      <td>1</td>
      <td>88.220111</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>198</th>
      <td>1</td>
      <td>93.399423</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>199</th>
      <td>1</td>
      <td>84.082421</td>
      <td>4.0</td>
    </tr>
  </tbody>
</table>
<p>200 rows × 3 columns</p>
</div></div></div>
</div>
<p>These are the same observations as the first case (before random assignment), but with an additional variable. We suspected that <strong>interested students have an average higher performance and that interested students are more likely to enroll in the tutoring program</strong>. Let us see graphically if this is true. If we split the data by interest and compute the boxplots of performance, we get the following graph:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/9c56bc1136c715fd41ce8f119360cb407b392d6b2409d9e6ebc9b6603ff4b081.png" src="../_images/9c56bc1136c715fd41ce8f119360cb407b392d6b2409d9e6ebc9b6603ff4b081.png" />
</div>
</div>
<p>We were right! (ok, this is an exaggerated picture, but this example is made up…)</p>
<p>Let us check how correlated are <code class="docutils literal notranslate"><span class="pre">interest</span></code> and <code class="docutils literal notranslate"><span class="pre">tutoring</span></code> with a barplot:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/b7124a48522020a45648ff9ea071f4085cebc5c74042d55346c140b591d466e2.png" src="../_images/b7124a48522020a45648ff9ea071f4085cebc5c74042d55346c140b591d466e2.png" />
</div>
</div>
<p>We can also check the distribution of interest in the two groups:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/b9a337b36c0dd5c7c9ee809b23c183fbf3272c8e05ffe62e0ddec6f0abd05e68.png" src="../_images/b9a337b36c0dd5c7c9ee809b23c183fbf3272c8e05ffe62e0ddec6f0abd05e68.png" />
</div>
</div>
<p>We can go ahead and compute a <span class="math notranslate nohighlight">\(\chi^2\)</span> test of independence to check if the association between the two variables is statistically significant:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chi-square statistic: 31.22
Cramer V statistic: 0.40
Chi-square p-value: 2.761663e-06
</pre></div>
</div>
</div>
</div>
<p>We were right also in this case! Interest affects tutoring, hence interest is our source of bias!</p>
<p>The correlation between the <code class="docutils literal notranslate"><span class="pre">interest</span></code> variable and <code class="docutils literal notranslate"><span class="pre">tutoring</span></code> is making the “treated” (<code class="docutils literal notranslate"><span class="pre">tutoring=1</span></code>) and the “control” (<code class="docutils literal notranslate"><span class="pre">tutoring=0</span></code>) groups not comparable. Indeed, if people in the treated group have more chances of getting a higher response value (performance), then no wonder that we observe such dramatic differences among the two groups! In other words, <strong>the effect we observe may be due to the bias introduced by <code class="docutils literal notranslate"><span class="pre">interest</span></code>, the effect of <code class="docutils literal notranslate"><span class="pre">tutoring</span></code>, or a combination of both</strong>.</p>
<section id="controlling-for-interest">
<h4><span class="section-number">20.5.1. </span>Controlling for <code class="docutils literal notranslate"><span class="pre">interest</span></code><a class="headerlink" href="#controlling-for-interest" title="Permalink to this heading">#</a></h4>
<p>How do we make the groups more comparable? Recall that we want:</p>
<div class="math notranslate nohighlight">
\[Y(0) \perp Y(1) | T\]</div>
<p>We have seen that this is not true because of <code class="docutils literal notranslate"><span class="pre">interest</span></code>. Indeed, if we pick a person in the group <span class="math notranslate nohighlight">\(T=0\)</span> with a high <span class="math notranslate nohighlight">\(Y(0)\)</span>, we can imagine this is due to a large value of <code class="docutils literal notranslate"><span class="pre">interest</span></code>, so we can easily predict that <span class="math notranslate nohighlight">\(Y(1)\)</span> will also be large. <strong>If we can predict <span class="math notranslate nohighlight">\(Y(1)\)</span> from <span class="math notranslate nohighlight">\(Y(0)\)</span>, then they are not independent (conditioned on <span class="math notranslate nohighlight">\(T=1\)</span> in this case)</strong>.</p>
<p>To obtain the statement above, we should <strong>perform a random assignment</strong>, which we cannot do. However, we know that <code class="docutils literal notranslate"><span class="pre">interest</span></code> is the source of bias. Let us assume that it is the <strong>only source of bias</strong>. Then, if <span class="math notranslate nohighlight">\(X\)</span> represents <code class="docutils literal notranslate"><span class="pre">interest</span></code>, we can say that:</p>
<div class="math notranslate nohighlight">
\[Y(0) \perp Y(1) | T, X\]</div>
<p><strong>Indeed, if we pick a person from a group <span class="math notranslate nohighlight">\(T=0\)</span> and with a given interest value <span class="math notranslate nohighlight">\(X=4\)</span>, then, given a large <span class="math notranslate nohighlight">\(Y(0)\)</span> we cannot really say anything about <span class="math notranslate nohighlight">\(Y(1)\)</span>. Indeed, if <span class="math notranslate nohighlight">\(X=4\)</span> and <span class="math notranslate nohighlight">\(Y(0)=80\)</span>, we have a student with great interest and high performance. What can we say about <span class="math notranslate nohighlight">\(Y(1)\)</span>? We could say that it will be high (the student has high interest), but any other student in this group will probably have a high score, so we cannot predict anything which will be significantly different from random (i.e., from the score of another random student within this group)</strong>.</p>
<p>But, how do we condition on <span class="math notranslate nohighlight">\(X\)</span>? Well, the easiest way to do it, is to <strong>divide the data into different groups based on the values of <span class="math notranslate nohighlight">\(X\)</span> and assess any association within the groups</strong>. Let us do it:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/ab3b8967b0b1b26f4e1da66d9068ad2811a34c939e1e6da81dc132958a800b85.png" src="../_images/ab3b8967b0b1b26f4e1da66d9068ad2811a34c939e1e6da81dc132958a800b85.png" />
</div>
</div>
<p>In the plot above, we compare the effect of tutoring in the different <code class="docutils literal notranslate"><span class="pre">interest</span></code> groups. As we can see, the association between <code class="docutils literal notranslate"><span class="pre">tutoring</span></code> and <code class="docutils literal notranslate"><span class="pre">performance</span></code> vanishes within the groups. This is shown by the fact that the notches (confidence intervals) tend to intersect. We can get a clearer picture by performing <span class="math notranslate nohighlight">\(5\)</span> different two-sample statistical tests assessing whether the means of <code class="docutils literal notranslate"><span class="pre">performance</span></code> in the two groups differ in a statistically significant way:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>t_statistic</th>
      <th>p_value</th>
    </tr>
    <tr>
      <th>interest</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1.0</th>
      <td>0.934780</td>
      <td>0.358187</td>
    </tr>
    <tr>
      <th>2.0</th>
      <td>-0.781177</td>
      <td>0.437931</td>
    </tr>
    <tr>
      <th>3.0</th>
      <td>-0.867406</td>
      <td>0.391310</td>
    </tr>
    <tr>
      <th>4.0</th>
      <td>0.164684</td>
      <td>0.869947</td>
    </tr>
    <tr>
      <th>5.0</th>
      <td>-1.383074</td>
      <td>0.178871</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>As we can see, there is no significant association between <code class="docutils literal notranslate"><span class="pre">performance</span></code> and <code class="docutils literal notranslate"><span class="pre">tutoring</span></code>, which suggests the lack of a causal effect.</p>
<p><strong>The act of conditioning on <span class="math notranslate nohighlight">\(X\)</span> (e.g., by dividing into groups) is called “controlling for <span class="math notranslate nohighlight">\(X\)</span>”</strong>.</p>
</section>
</section>
<section id="graphical-causal-models">
<h3><span class="section-number">20.6. </span>Graphical Causal Models<a class="headerlink" href="#graphical-causal-models" title="Permalink to this heading">#</a></h3>
<p>We have seen a simple case in which we could identify the main source of bias which was leading to an observed association not implying a cause-effect mechanism. However, not all cases are so simple and <strong>more than one variable may be responsible for bias</strong>. The question now is</p>
<blockquote>
<div><p>How do we identify the variables we should control for?</p>
</div></blockquote>
<p>To help us in this quest, we can use graphical causal models. A graphical causal model is a <strong>directed acyclic graph</strong> formalizing cause-effect relationships between variables. <strong>Each node is a random variable, while a directed edge <span class="math notranslate nohighlight">\(A \to B\)</span> indicates that <span class="math notranslate nohighlight">\(A\)</span> causes <span class="math notranslate nohighlight">\(B\)</span>.</strong></p>
<p>The causal graph describing the hypotheses we made in this example will look like this:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/c0f0676ae3848f94da0595140cc691d000b02b3d478eef1d5605558840fa1bd0.svg" src="../_images/c0f0676ae3848f94da0595140cc691d000b02b3d478eef1d5605558840fa1bd0.svg" /></div>
</div>
<p>Indeed, we expect <code class="docutils literal notranslate"><span class="pre">interest</span></code> (<span class="math notranslate nohighlight">\(X\)</span>) to influence both <code class="docutils literal notranslate"><span class="pre">performance</span></code> (<span class="math notranslate nohighlight">\(Y\)</span>) and whether a subject belong to the treated or control group, i.e., the <code class="docutils literal notranslate"><span class="pre">tutoring</span></code> variable (<span class="math notranslate nohighlight">\(T\)</span>). From the model above, we can identify <code class="docutils literal notranslate"><span class="pre">interest</span></code> as a source of bias, but <strong>as we will see shortly, we can use a set of rules to identify which variables we should control for or not control for from a graphical model</strong>.</p>
<p>Before proceeding, a short note on <strong>how graphical models are created</strong>: these are generally designed by the data analyst who encodes their own <strong>beliefs</strong> on how the world works. These come from a “Bayesian” view of the world in which we first establish our beliefs and then use a theoretical framework to draw conclusions from them.</p>
<section id="main-structures-of-causal-graphical-models">
<h4><span class="section-number">20.6.1. </span>Main Structures of Causal Graphical Models<a class="headerlink" href="#main-structures-of-causal-graphical-models" title="Permalink to this heading">#</a></h4>
<p>Once we form a graphical model, we can identify a set of standard structures which will allow us to choose which variables to control for. We will see the main structures, but others beside the ones discussed here may exist.</p>
<section id="chains">
<h5><span class="section-number">20.6.1.1. </span>Chains<a class="headerlink" href="#chains" title="Permalink to this heading">#</a></h5>
<p>The most straightforward structure is a chain of this kind:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/66b4423940c3ae52ca69b36ac4741314c80a66bb1c519f79e625c207361f5cbf.svg" src="../_images/66b4423940c3ae52ca69b36ac4741314c80a66bb1c519f79e625c207361f5cbf.svg" /></div>
</div>
<p>The example above, <code class="docutils literal notranslate"><span class="pre">interest</span></code> in studying causes the number of <code class="docutils literal notranslate"><span class="pre">study</span> <span class="pre">hours</span></code>, which in turn causes <code class="docutils literal notranslate"><span class="pre">performance</span></code>. Let us imagine no other variable is involved (i.e., <code class="docutils literal notranslate"><span class="pre">interest</span></code> is the only variable causing <code class="docutils literal notranslate"><span class="pre">study</span> <span class="pre">hours</span></code> and <code class="docutils literal notranslate"><span class="pre">performance</span></code> is only caused by <code class="docutils literal notranslate"><span class="pre">study</span> <span class="pre">hours</span></code>). Then we will easily find that:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">interest</span></code> and <code class="docutils literal notranslate"><span class="pre">study</span> <span class="pre">hours</span></code> will be associated;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">study</span> <span class="pre">hours</span></code> and <code class="docutils literal notranslate"><span class="pre">performance</span></code> will be associated.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">interest</span></code> and <code class="docutils literal notranslate"><span class="pre">performance</span></code> will be associated.</p></li>
</ul>
<p>Indeed, for instance:</p>
<ul class="simple">
<li><p>If a person has a great interest, then they will study a lot and have good performance;</p></li>
<li><p>If a person has good performance, we can infer that it studies a lot and hence has great interest;</p></li>
<li><p>If a person studies a lot, we infer that it has great interest and good performance;</p></li>
</ul>
<p>Let say we <strong>control for <span class="math notranslate nohighlight">\(B\)</span>, <code class="docutils literal notranslate"><span class="pre">study</span> <span class="pre">hours</span></code></strong>. We will denote the graph as follows (variable we are controlling for is in gray):</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/f24e3c66a6515d6d5aa0f2a2ef515029bdcb0c8803875f3994c025dd64adc212.svg" src="../_images/f24e3c66a6515d6d5aa0f2a2ef515029bdcb0c8803875f3994c025dd64adc212.svg" /></div>
</div>
<p>If we <strong>control for <span class="math notranslate nohighlight">\(B\)</span>, <code class="docutils literal notranslate"><span class="pre">study</span> <span class="pre">hours</span></code>, we will find that <code class="docutils literal notranslate"><span class="pre">interest</span></code> and <code class="docutils literal notranslate"><span class="pre">performance</span></code> are not associated anymore</strong>. Indeed:</p>
<blockquote>
<div><p>If we consider a group of people who study the same amount of hours and I take a person with good performance, then I don’t know if they have great interest or not. Or better, I cannot distinguish a person with great interest from a person with little interest as they all study the same amount of hours.</p>
</div></blockquote>
<p>In mathematical terms, we know that in general:</p>
<div class="math notranslate nohighlight">
\[A \not\perp C\]</div>
<p>but, by controlling for <span class="math notranslate nohighlight">\(B\)</span>, we obtain:</p>
<div class="math notranslate nohighlight">
\[A \perp C | B\]</div>
<p>Hence, in groups with the same value of <span class="math notranslate nohighlight">\(B\)</span>, we will see an independence between <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span>.</p>
<p>In general, we say that <strong>conditioning on <span class="math notranslate nohighlight">\(B\)</span> blocks the dependency between <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(C\)</span></strong>, hence <strong>while there is a causal effect between <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(C\)</span>, we cannot see it anymore when we condition on <span class="math notranslate nohighlight">\(B\)</span></strong>.</p>
<p>The graph below shows two identical graphs, except that we are conditioning on <span class="math notranslate nohighlight">\(B\)</span> in the version on the right. Besides solid black arrows denoting cause-effect relationships, we also show <strong>in red how dependency flows</strong>.</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/8c3e9dcfe93bd5579ea47c455b1e672e451c757abcdadb20f3ef7811ad218265.svg" src="../_images/8c3e9dcfe93bd5579ea47c455b1e672e451c757abcdadb20f3ef7811ad218265.svg" /></div>
</div>
<ul class="simple">
<li><p>In the graph on the left, dependency flows in a bidirectional way <strong>through variable <span class="math notranslate nohighlight">\(B\)</span></strong>. This means that <span class="math notranslate nohighlight">\(A\)</span> depends on <span class="math notranslate nohighlight">\(B\)</span> and <span class="math notranslate nohighlight">\(C\)</span> and similarly <span class="math notranslate nohighlight">\(C\)</span> depends on <span class="math notranslate nohighlight">\(B\)</span> and <span class="math notranslate nohighlight">\(A\)</span>;</p></li>
<li><p>In the graph on the right, conditioning on <span class="math notranslate nohighlight">\(B\)</span> “stops” the dependency. Now:</p>
<ul>
<li><p><span class="math notranslate nohighlight">\(C\)</span> and <span class="math notranslate nohighlight">\(A\)</span> are independent of <span class="math notranslate nohighlight">\(B\)</span>. This makes sense because conditioning on <span class="math notranslate nohighlight">\(B\)</span> means fixing a value for <span class="math notranslate nohighlight">\(B\)</span>, so <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(C\)</span> will be independent of the constant;</p></li>
<li><p><span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(C\)</span> are independent (we are conditioning on <span class="math notranslate nohighlight">\(B\)</span>, so we have <span class="math notranslate nohighlight">\(A \perp C | B\)</span>).</p></li>
</ul>
</li>
</ul>
<p>As a result, if we want to study the relation between <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(C\)</span>, we <strong>should not condition on B</strong>, as this conditioning will make the association between <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(C\)</span> vanish, even if there is a causal effect between these variables.</p>
<p>We are encountering an important concept:</p>
<blockquote>
<div><p>Conditioning on <strong>any</strong> variable is not a good way to remove bias. If we condition on the “wrong” variable, we may introduce some bias which was not there in the first place and estimate the lack of a causal effect even in cases in which the causal effect is there.</p>
</div></blockquote>
</section>
</section>
<section id="forks">
<h4><span class="section-number">20.6.2. </span>Forks<a class="headerlink" href="#forks" title="Permalink to this heading">#</a></h4>
<p>We have a fork structure when a variable causes two other variables. Let us see an example:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/d93ca26577b479e82e93cd6fcd61b382ba6bf70572ac42f708138c4617e78138.svg" src="../_images/d93ca26577b479e82e93cd6fcd61b382ba6bf70572ac42f708138c4617e78138.svg" /></div>
</div>
<p>In this case <span class="math notranslate nohighlight">\(B\)</span> (<code class="docutils literal notranslate"><span class="pre">interest</span></code>) is causing both <span class="math notranslate nohighlight">\(A\)</span> (<code class="docutils literal notranslate"><span class="pre">performance</span></code>) and <span class="math notranslate nohighlight">\(C\)</span> (<code class="docutils literal notranslate"><span class="pre">tutoring</span></code>). This is the example we have seen before. In this case, as we have seen, we may see a correlation between <code class="docutils literal notranslate"><span class="pre">tutoring</span></code> and <code class="docutils literal notranslate"><span class="pre">performance</span></code>. Indeed, a large value of <code class="docutils literal notranslate"><span class="pre">performance</span></code> will probably mean that <code class="docutils literal notranslate"><span class="pre">interest</span></code> is high, hence <code class="docutils literal notranslate"><span class="pre">tutoring</span></code> will probably be equal to <span class="math notranslate nohighlight">\(1\)</span>.</p>
<blockquote>
<div><p>We will call <span class="math notranslate nohighlight">\(B\)</span> (or <code class="docutils literal notranslate"><span class="pre">interest</span></code>) the <strong>common cause</strong>.</p>
</div></blockquote>
<p>Although we will likely observe correlations between any pair of the <span class="math notranslate nohighlight">\(A\)</span>, <span class="math notranslate nohighlight">\(B\)</span>, and <span class="math notranslate nohighlight">\(C\)</span> variables, we know from the graph that there is no cause-effect relationship between <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(C\)</span>.</p>
<p>We say that the fork structure <strong>creates a backdoor path such that dependence (or association) flows through <span class="math notranslate nohighlight">\(B\)</span> (the backdoor) to go from <span class="math notranslate nohighlight">\(A\)</span> to <span class="math notranslate nohighlight">\(C\)</span></strong>.</p>
<p>As we noted in the previous example, conditioning on <span class="math notranslate nohighlight">\(B\)</span> (<code class="docutils literal notranslate"><span class="pre">interest</span></code>) makes the association between <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(C\)</span> vanish:</p>
<div class="math notranslate nohighlight">
\[A \perp C | B\]</div>
<p>Hence in the following graph, we will observe no association between <code class="docutils literal notranslate"><span class="pre">performance</span></code> and <code class="docutils literal notranslate"><span class="pre">tutoring</span></code>, hence confirming the lack of a causal effect:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/5eeefb9c698acd89a99324f996f4d2ddd3399c87dc71ebf89a799b407085977b.svg" src="../_images/5eeefb9c698acd89a99324f996f4d2ddd3399c87dc71ebf89a799b407085977b.svg" /></div>
</div>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/69e77494a9d890a12aad00bd754b6f3ffae8fca89f873a47bc34b7babc4712a3.svg" src="../_images/69e77494a9d890a12aad00bd754b6f3ffae8fca89f873a47bc34b7babc4712a3.svg" /></div>
</div>
<p>When we do not condition on <span class="math notranslate nohighlight">\(B\)</span>, dependency (hence association) flows from <span class="math notranslate nohighlight">\(A\)</span> to <span class="math notranslate nohighlight">\(C\)</span> through <span class="math notranslate nohighlight">\(B\)</span>. Hence, <strong>we observe an association which is not due to a causal effect</strong>.</p>
<p>When we condition on <span class="math notranslate nohighlight">\(B\)</span>, dependency (hence association) does not flow through <span class="math notranslate nohighlight">\(B\)</span>, so <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(C\)</span> will be independent and we will measure no association, as it should be.</p>
</section>
<section id="colliders">
<h4><span class="section-number">20.6.3. </span>Colliders<a class="headerlink" href="#colliders" title="Permalink to this heading">#</a></h4>
<p>The last, important structure, is a collider. This is in some sense the opposite of a fork: a variable is caused by two different variables. Let us see this with an example:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/d155cb2a4c49a483683c74f0375da2af78d08a9e1bfc621d0b68fc5f62c722fb.svg" src="../_images/d155cb2a4c49a483683c74f0375da2af78d08a9e1bfc621d0b68fc5f62c722fb.svg" /></div>
</div>
<p>The graph above tells us that performance is caused by <code class="docutils literal notranslate"><span class="pre">study</span> <span class="pre">hours</span></code> and <code class="docutils literal notranslate"><span class="pre">intuitive</span> <span class="pre">intelligence</span></code>. We are making the assumption here that <code class="docutils literal notranslate"><span class="pre">intuitive</span> <span class="pre">intelligence</span></code> does not affect <code class="docutils literal notranslate"><span class="pre">study</span> <span class="pre">hours</span></code> in any way. This might be inaccurate, but we will anyway assume so for the sake of a simple example.</p>
<p>This structure is called a <strong>collider</strong>, because two arrows (from <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(C\)</span>) collide on a single node (<span class="math notranslate nohighlight">\(B\)</span>).</p>
<p>A collider <strong>blocks dependency</strong>. This means that by default, if we do not condition on <code class="docutils literal notranslate"><span class="pre">performance</span></code>, we will observe no association between <code class="docutils literal notranslate"><span class="pre">study</span> <span class="pre">hours</span></code> and <code class="docutils literal notranslate"><span class="pre">intuitive</span> <span class="pre">intelligence</span></code>. Indeed:</p>
<ul class="simple">
<li><p>If we know that a person studies a lot, we cannot really say anything about their intuitive intelligence;</p></li>
<li><p>If we know that a person has intuitive intelligence, we cannot say how much they study.</p></li>
</ul>
<p>So, in the graph above:</p>
<div class="math notranslate nohighlight">
\[A \perp C\]</div>
<p>Let us not consider a case in which we condition on <span class="math notranslate nohighlight">\(B\)</span> (<code class="docutils literal notranslate"><span class="pre">performance</span></code>), as shown in the following graph:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/3add8a639f83fa7b7c31cbe3633e8161f6b33a4eaea2fb5824dd79af994fa43b.svg" src="../_images/3add8a639f83fa7b7c31cbe3633e8161f6b33a4eaea2fb5824dd79af994fa43b.svg" /></div>
</div>
<p>Conditioning on <code class="docutils literal notranslate"><span class="pre">performance</span></code> changes things. Indeed:</p>
<ul class="simple">
<li><p>If we know that a student has a <strong>good performance</strong> (i.e., we consider the group of good performing students when controlling), then <strong>knowing that they do not study a lot, will tell us that they probably have good intuitive intelligence</strong>. Indeed, if the fixed performance cannot be explained by the large number of study hours, it must be due to good intuitive intelligence;</p></li>
<li><p>Conversely, if we know that a good performing student has bad intuitive intelligence, then their performance is probably due to a large number of study hours.</p></li>
</ul>
<p>In practice, conditioning on <code class="docutils literal notranslate"><span class="pre">performance</span></code> makes <code class="docutils literal notranslate"><span class="pre">study</span> <span class="pre">hours</span></code> and <code class="docutils literal notranslate"><span class="pre">intuitive</span> <span class="pre">intelligence</span></code> dependent:</p>
<div class="math notranslate nohighlight">
\[A \not\perp C | B\]</div>
<p>This phenomenon is called <strong>explaining away</strong>, because, one we fix <span class="math notranslate nohighlight">\(B\)</span> (<code class="docutils literal notranslate"><span class="pre">performance</span></code>), knowing <span class="math notranslate nohighlight">\(A\)</span> (<code class="docutils literal notranslate"><span class="pre">study</span> <span class="pre">hours</span></code>) already explains <span class="math notranslate nohighlight">\(B\)</span>, hence making <span class="math notranslate nohighlight">\(C\)</span> less likely.</p>
<p>In general, <strong>a collider blocks dependency, while conditioning on it unblocks a dependency path</strong>. We can use the same conventions as before to illustrate this effect:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/b36774b5fa62943cf4979df850ea360f4d9a9822cac3a3cd555eeb9c7c1044c3.svg" src="../_images/b36774b5fa62943cf4979df850ea360f4d9a9822cac3a3cd555eeb9c7c1044c3.svg" /></div>
</div>
</section>
<section id="dependence-flow-rules">
<h4><span class="section-number">20.6.4. </span>Dependence Flow Rules<a class="headerlink" href="#dependence-flow-rules" title="Permalink to this heading">#</a></h4>
<p>Using these structures, we can deem if two nodes <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span> are dependent by checking <strong>if an unblocked path exists between <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span></strong>. This can be done by combining the rules we have seen above, which are also summarized in the following figure:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/394f7d08578be94d6671cded9c65e4c4c6d58963e18504d51a966916bf4711c2.svg" src="../_images/394f7d08578be94d6671cded9c65e4c4c6d58963e18504d51a966916bf4711c2.svg" /></div>
</div>
<p>The cheat sheet above is replicated from <a class="reference external" href="http://ai.stanford.edu/~paskin/gm-short-course/lec2.pdf">here</a> and <a class="reference external" href="https://matheusfacure.github.io/python-causality-handbook/04-Graphical-Causal-Models.html">here</a>. You can find more information at those URLs.</p>
<p>We will say that a path between <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span> is blocked if:</p>
<blockquote>
<div><ul class="simple">
<li><p>It contains a non-collider that <strong>has been conditioned on</strong>;</p></li>
<li><p>It contains a collider that <strong>has not been conditioned on</strong> and has no descendants that have been conditioned on.</p></li>
</ul>
</div></blockquote>
<p>Let us see an example from <a class="reference external" href="https://matheusfacure.github.io/python-causality-handbook/04-Graphical-Causal-Models.html">here</a> and let us try to answer some questions:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/0ecd28dbf877f34d3029eb955565bed27d2d27e91fbf2ca75d1da128e49192e5.svg" src="../_images/0ecd28dbf877f34d3029eb955565bed27d2d27e91fbf2ca75d1da128e49192e5.svg" /></div>
</div>
<section id="question-1-is-d-perp-c">
<h5><span class="section-number">20.6.4.1. </span>Question 1: is <span class="math notranslate nohighlight">\(D \perp C\)</span>?<a class="headerlink" href="#question-1-is-d-perp-c" title="Permalink to this heading">#</a></h5>
<p>The <span class="math notranslate nohighlight">\(D \to A \leftarrow C\)</span> structure is a <strong>collider</strong>. We know that, when we do not condition on the collider, the collider blocks dependence, so we can say that:</p>
<div class="math notranslate nohighlight">
\[D \perp C\]</div>
</section>
<section id="question-2-is-d-perp-c-a">
<h5><span class="section-number">20.6.4.2. </span>Question 2: is <span class="math notranslate nohighlight">\(D \perp C | A\)</span>?<a class="headerlink" href="#question-2-is-d-perp-c-a" title="Permalink to this heading">#</a></h5>
<p>We have the following graph:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/e31ed900fd14bb984389a24df9c6b9eeb2b6ceeaa799b53405c43084bcf7bb3a.svg" src="../_images/e31ed900fd14bb984389a24df9c6b9eeb2b6ceeaa799b53405c43084bcf7bb3a.svg" /></div>
</div>
<p>We are conditioning on the collider, hence unblocking the dependence, so we can say:</p>
<div class="math notranslate nohighlight">
\[D \not\perp C | A \]</div>
</section>
<section id="question-3-is-d-perp-c-g">
<h5><span class="section-number">20.6.4.3. </span>Question 3: is <span class="math notranslate nohighlight">\(D \perp C | G\)</span>?<a class="headerlink" href="#question-3-is-d-perp-c-g" title="Permalink to this heading">#</a></h5>
<p>We now have this graph:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/eacad1f586eb9c60f41f9879e5c38625832cbd389140897269528fa4cfb1ce35.svg" src="../_images/eacad1f586eb9c60f41f9879e5c38625832cbd389140897269528fa4cfb1ce35.svg" /></div>
</div>
<p>We are not conditioning on the collider <span class="math notranslate nohighlight">\(A\)</span>, but we are conditioning on a descendant of the collider <span class="math notranslate nohighlight">\(A\)</span>. We can see this descendant as <strong>a proxy for <span class="math notranslate nohighlight">\(A\)</span></strong>, so conditioning on it is similar to conditioning on <span class="math notranslate nohighlight">\(A\)</span>. For instance, consider this graph:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/895d16b9a238e18511fb51175efeca01d5d2ad616d5c24308e225d9214be2325.svg" src="../_images/895d16b9a238e18511fb51175efeca01d5d2ad616d5c24308e225d9214be2325.svg" /></div>
</div>
<p>In the example above, <code class="docutils literal notranslate"><span class="pre">competence</span></code> indicates how competent the student is in the considered subjects. If the student is highly competent, we expect them to achieve good performance, hence the cause-effect relationship.</p>
<p>Even if we are not conditioning on <code class="docutils literal notranslate"><span class="pre">competence</span></code>, we are conditioning on a proxy for competence, i.e., <code class="docutils literal notranslate"><span class="pre">performance</span></code>. When we condition on this node, <code class="docutils literal notranslate"><span class="pre">study</span> <span class="pre">hours</span></code> and <code class="docutils literal notranslate"><span class="pre">intuitive</span></code> intelligence will appear as dependent for the “explaining away” effect.</p>
<p>Also, recall that we said that a path between <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span> is blocked if:</p>
<blockquote>
<div><ul class="simple">
<li><p>It contains a non-collider that <strong>has been conditioned on</strong>;</p></li>
<li><p>It contains a collider that <strong>has not been conditioned on</strong> and has no descendants that have been conditioned on.</p></li>
</ul>
</div></blockquote>
<p>In our case, we are conditioning on a descendant of the collider, hence <code class="docutils literal notranslate"><span class="pre">study</span> <span class="pre">hours</span></code> and <code class="docutils literal notranslate"><span class="pre">intuitive</span> <span class="pre">intelligence</span></code> will be dependent. In our general graph, we can say that:</p>
<div class="math notranslate nohighlight">
\[D \not\perp C | G\]</div>
</section>
<section id="question-4-is-a-perp-f">
<h5><span class="section-number">20.6.4.4. </span>Question 4: is <span class="math notranslate nohighlight">\(A \perp F\)</span>?<a class="headerlink" href="#question-4-is-a-perp-f" title="Permalink to this heading">#</a></h5>
<p>We can illustrate the dependence flow with red dashed arrows as follows:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/804c4199aca7f2ffbf1e8f6fe2f31a7edc472e6c4c4461b664d647fbc10497df.svg" src="../_images/804c4199aca7f2ffbf1e8f6fe2f31a7edc472e6c4c4461b664d647fbc10497df.svg" /></div>
</div>
<p>As we can see, <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span> are dependent, but, due to the collider <span class="math notranslate nohighlight">\(E\)</span>, <span class="math notranslate nohighlight">\(B\)</span> is independent from <span class="math notranslate nohighlight">\(F\)</span>, so, the path between <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(F\)</span> is blocked by the collider <span class="math notranslate nohighlight">\(E\)</span> which has not been conditioned on. We can say:</p>
<div class="math notranslate nohighlight">
\[A \perp F\]</div>
</section>
<section id="question-5-is-a-perp-f-e">
<h5><span class="section-number">20.6.4.5. </span>Question 5: is <span class="math notranslate nohighlight">\(A \perp F | E\)</span>?<a class="headerlink" href="#question-5-is-a-perp-f-e" title="Permalink to this heading">#</a></h5>
<p>We now have this dependence flow:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/2c3a4b0fe48dd9ebcf299cb38febcb5f6a838f646d67fe46ff3afc7e4df5eb19.svg" src="../_images/2c3a4b0fe48dd9ebcf299cb38febcb5f6a838f646d67fe46ff3afc7e4df5eb19.svg" /></div>
</div>
<p>Conditioning on <span class="math notranslate nohighlight">\(E\)</span> has opened the path between <span class="math notranslate nohighlight">\(B\)</span> and <span class="math notranslate nohighlight">\(F\)</span> and now the path between <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(F\)</span> is unblocked. In other words, <strong>the path between <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(F\)</span> contains a collider which has been conditioned on</strong>, to the path is unblocked. Since the path is unblocked, the two variables are not independent:</p>
<div class="math notranslate nohighlight">
\[A \not\perp F | E\]</div>
</section>
<section id="question-6-is-a-perp-f-e-c">
<h5><span class="section-number">20.6.4.6. </span>Question 6: is <span class="math notranslate nohighlight">\(A \perp F | E, C\)</span>?<a class="headerlink" href="#question-6-is-a-perp-f-e-c" title="Permalink to this heading">#</a></h5>
<p>Let us see the dependence flow in this case:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/7714d4bbd099f17313e0930cb6d5aaf6dff3a6b6bdf26e703356ac2b729be55d.svg" src="../_images/7714d4bbd099f17313e0930cb6d5aaf6dff3a6b6bdf26e703356ac2b729be55d.svg" /></div>
</div>
<p>Since <span class="math notranslate nohighlight">\(C\)</span> is a non collider node, conditioning on it blocks the path between <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span>. Conditioning on <span class="math notranslate nohighlight">\(E\)</span> unblocks the path between <span class="math notranslate nohighlight">\(B\)</span> and <span class="math notranslate nohighlight">\(F\)</span>, but a block remains in the path between <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(F\)</span>, hence the two variables are independent:</p>
<div class="math notranslate nohighlight">
\[A \perp F | E, C\]</div>
</section>
</section>
</section>
<section id="using-graphical-causal-models-to-diagnose-bias">
<h3><span class="section-number">20.7. </span>Using Graphical Causal Models to Diagnose Bias<a class="headerlink" href="#using-graphical-causal-models-to-diagnose-bias" title="Permalink to this heading">#</a></h3>
<p>We will now see how using graphical causal models allows to diagnose bias and understand which variables we should condition on and which we should not when trying to measure a causal effect through correlation. We will see that we have two main sources of bias: <strong>confounding bias</strong> and <strong>selection bias</strong>.</p>
<section id="confounding-bias">
<h4><span class="section-number">20.7.1. </span>Confounding Bias<a class="headerlink" href="#confounding-bias" title="Permalink to this heading">#</a></h4>
<p>Confounding bias happens when <strong>the treatment and the effect have a common cause</strong>. Let us consider the following example, which we already saw previously:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/c0f0676ae3848f94da0595140cc691d000b02b3d478eef1d5605558840fa1bd0.svg" src="../_images/c0f0676ae3848f94da0595140cc691d000b02b3d478eef1d5605558840fa1bd0.svg" /></div>
</div>
<p>Here, the outcome <span class="math notranslate nohighlight">\(Y\)</span> is <code class="docutils literal notranslate"><span class="pre">performance</span></code>, which is caused by both the treatment <span class="math notranslate nohighlight">\(T\)</span> (<code class="docutils literal notranslate"><span class="pre">tutoring</span></code>) and another common cause <span class="math notranslate nohighlight">\(X\)</span> (<code class="docutils literal notranslate"><span class="pre">interest</span></code>). The common cause <span class="math notranslate nohighlight">\(X\)</span> is called <strong>a counfounder</strong> because it mixes ups the effects of <code class="docutils literal notranslate"><span class="pre">tutoring</span></code> on <code class="docutils literal notranslate"><span class="pre">performance</span></code> and <code class="docutils literal notranslate"><span class="pre">interest</span></code> on <code class="docutils literal notranslate"><span class="pre">performance</span></code>. Indeed, if we measure the correlation between <code class="docutils literal notranslate"><span class="pre">tutoring</span></code> and <code class="docutils literal notranslate"><span class="pre">performance</span></code>, we obtain a large number, but we do not know if this is due to the common cause <code class="docutils literal notranslate"><span class="pre">interest</span></code>. Maybe, people choose tutoring because they are interested and obtain good performance because they are interested as well.</p>
<p>If we want to be able to measure the <strong>direct effect between the treatment and the outcome</strong>, we need to <strong>close the backdoor path between <span class="math notranslate nohighlight">\(Y\)</span> and <span class="math notranslate nohighlight">\(T\)</span></strong>. This is done by <strong>conditioning on the common cause</strong>:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/0070078ec220dc5506f863188ec961b13c6dcdc42e856d817c9f6f3ce99aae53.svg" src="../_images/0070078ec220dc5506f863188ec961b13c6dcdc42e856d817c9f6f3ce99aae53.svg" /></div>
</div>
<p>Note that this corresponds to comparing subjects with the same level of interest. In this case, we will observe the direct effect of <code class="docutils literal notranslate"><span class="pre">tutoring</span></code> on <code class="docutils literal notranslate"><span class="pre">performance</span></code>, since all students in the considered ground have the same level of <code class="docutils literal notranslate"><span class="pre">interest</span></code> (so any association between <code class="docutils literal notranslate"><span class="pre">tutoring</span></code> and <code class="docutils literal notranslate"><span class="pre">performance</span></code> is given by the  causal effect). By conditioning on <span class="math notranslate nohighlight">\(X\)</span>, we obtain:</p>
<div class="math notranslate nohighlight">
\[Y(0) \perp Y(1) | T, X\]</div>
</section>
<section id="multiple-common-causes-and-unmeasurable-variables">
<h4><span class="section-number">20.7.2. </span>Multiple Common Causes and Unmeasurable Variables<a class="headerlink" href="#multiple-common-causes-and-unmeasurable-variables" title="Permalink to this heading">#</a></h4>
<p>Note that we can also have multiple common causes. Let us consider the following example:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/bbf74ef1946cafb8b824223e755ff88e0d0b07207116b1ebd889a3b48349da0b.svg" src="../_images/bbf74ef1946cafb8b824223e755ff88e0d0b07207116b1ebd889a3b48349da0b.svg" /></div>
</div>
<p>We added a new variable <code class="docutils literal notranslate"><span class="pre">parents</span></code>, because we assume that parents may motivate their kids to study more and obtain good performance and to choose tutoring programs to improve their grades. <strong>This is another confounder</strong>, which is going to affect the correlation between <code class="docutils literal notranslate"><span class="pre">tutoring</span></code> and <code class="docutils literal notranslate"><span class="pre">performance</span></code>. Ideally, we wound need to <strong>condition on both <code class="docutils literal notranslate"><span class="pre">parents</span></code> and <code class="docutils literal notranslate"><span class="pre">interest</span></code> to close all backdoor paths between <code class="docutils literal notranslate"><span class="pre">tutoring</span></code> and <code class="docutils literal notranslate"><span class="pre">performance</span></code></strong>. We denoted <code class="docutils literal notranslate"><span class="pre">parents</span></code> as <span class="math notranslate nohighlight">\(U\)</span>, because, as we defined it, this variable is <strong>unmeasurable</strong>. We are hypothesizing that parents will influence students, but we do not have a direct way to check this. Something we can do is to measure <strong>how many hours parents dedicate to their kids in a one-to-one study sessions</strong>. We can do so by introducing a new variable:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/bce0d7e9543456e47a1d09369e2b9be46af9e3b3e43bb279be58a7b2a060d830.svg" src="../_images/bce0d7e9543456e47a1d09369e2b9be46af9e3b3e43bb279be58a7b2a060d830.svg" /></div>
</div>
<p>While we cannot not directly condition on <code class="docutils literal notranslate"><span class="pre">parents</span></code> (<span class="math notranslate nohighlight">\(U\)</span>), we can now condition on the direct effect of <code class="docutils literal notranslate"><span class="pre">parents</span></code>, <code class="docutils literal notranslate"><span class="pre">one-to-one</span></code>, which is measurable (<span class="math notranslate nohighlight">\(X1\)</span>). We now have to condition on all common causes, <span class="math notranslate nohighlight">\(X1\)</span> and <span class="math notranslate nohighlight">\(X2\)</span>, to obtain:</p>
<div class="math notranslate nohighlight">
\[Y(0) \perp Y(1) | T, X1, X2\]</div>
<section id="surrogate-confounders">
<h5><span class="section-number">20.7.2.1. </span>Surrogate Confounders<a class="headerlink" href="#surrogate-confounders" title="Permalink to this heading">#</a></h5>
<p>In some cases, unmeasurable variables do not have a measurable direct effect. Let us consider the following example:</p>
<blockquote>
<div><p>We are interested in studying if a given habit (e.g., smoking) can have a causal effect on the development of a given disease. We observe a strong correlation, i.e., subject how have the habit develop the disease more likely. However, someone argues that a gene may exists that causes both the habit and the disease. For instance, people may have the “smoking gene” which “makes them like smoking” and at the same time makes it more likely for them to get the disease.</p>
</div></blockquote>
<p>The assumption will lead us to the following causal graph:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/1e5cc1ec1f7635ec8621010c95d0394e33e710b8d2bed630f7f21d731bc58535.svg" src="../_images/1e5cc1ec1f7635ec8621010c95d0394e33e710b8d2bed630f7f21d731bc58535.svg" /></div>
</div>
<p>We have confounding bias and we should condition on <code class="docutils literal notranslate"><span class="pre">gene</span></code> to remove bias. However, we are not sure if the gene actually exists and we only have a theory that the presence of the gene causes some symptoms <code class="docutils literal notranslate"><span class="pre">symptom1</span></code> and <code class="docutils literal notranslate"><span class="pre">symptom2</span></code>. We may also expect that if a subject has the “smoking gene”, then also their relatives do so. We hence introduce a proxy variable <code class="docutils literal notranslate"><span class="pre">familiarity</span></code> which counts the number of relatives that we expect to have the gene (because we measured the symptoms or the likelihood of the disease). We obtain the following graph:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/3e90a8011890dd69729988871ac2125d137acdfb99104122fd21b67a881b67fa.svg" src="../_images/3e90a8011890dd69729988871ac2125d137acdfb99104122fd21b67a881b67fa.svg" /></div>
</div>
<p><strong>We should close all backdoor paths between <span class="math notranslate nohighlight">\(T\)</span> and <span class="math notranslate nohighlight">\(Y\)</span> by conditioning on <span class="math notranslate nohighlight">\(U\)</span></strong>, but since we cannot condition on the unobserved variable <code class="docutils literal notranslate"><span class="pre">gene</span></code>, <strong>the best we can do is to condition on the surrogate confounders <span class="math notranslate nohighlight">\(X1\)</span>, <span class="math notranslate nohighlight">\(X2\)</span>, and <span class="math notranslate nohighlight">\(X3\)</span></strong>:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/4ad6877bb34ceacd100ebca11209ef1e14cfacf493722e6ac32c305297b07220.svg" src="../_images/4ad6877bb34ceacd100ebca11209ef1e14cfacf493722e6ac32c305297b07220.svg" /></div>
</div>
<p><strong>This will not close the backdoor path between <span class="math notranslate nohighlight">\(T\)</span> and <span class="math notranslate nohighlight">\(Y\)</span>, as these variables are not in the backdoor path, but it will help reducing the bias</strong>.</p>
</section>
</section>
<section id="selection-bias">
<h4><span class="section-number">20.7.3. </span>Selection Bias<a class="headerlink" href="#selection-bias" title="Permalink to this heading">#</a></h4>
<p>While confounding bias happens when we do not condition on a common cause, selection bias happens when <strong>we control for too many variables</strong>. While one may think that it is a good idea to control on any variable “just in case”, this is not true in general and can lead to <strong>selection bias</strong>.</p>
<section id="controlling-for-a-common-effect">
<h5><span class="section-number">20.7.3.1. </span>Controlling For a Common Effect<a class="headerlink" href="#controlling-for-a-common-effect" title="Permalink to this heading">#</a></h5>
<p>Let us consider the following example in which we want to measure the causal effect of <code class="docutils literal notranslate"><span class="pre">intuitive</span> <span class="pre">intelligence</span></code> on <code class="docutils literal notranslate"><span class="pre">performance</span></code>:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/79477daa51d7df1c58db321a8ffb91229da76d06746ec4f874a97e1b414872d1.svg" src="../_images/79477daa51d7df1c58db321a8ffb91229da76d06746ec4f874a97e1b414872d1.svg" /></div>
</div>
<p>In our data, we also have a score of a test on problem solving. <strong>“Just to be sure”, we condition on <code class="docutils literal notranslate"><span class="pre">problem</span> <span class="pre">solving</span></code></strong>:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/5862bbfe62fb11b2e6e2806eee31b9bd40a16ef19e8771ec4a1308b67f89fa35.svg" src="../_images/5862bbfe62fb11b2e6e2806eee31b9bd40a16ef19e8771ec4a1308b67f89fa35.svg" /></div>
</div>
<p>The problem is that <code class="docutils literal notranslate"><span class="pre">problem</span> <span class="pre">solving</span></code> is a common effect of <code class="docutils literal notranslate"><span class="pre">performance</span></code> and <code class="docutils literal notranslate"><span class="pre">intuitive</span> <span class="pre">intelligence</span></code>. By conditioning on the common effect, we are introducing a form of bias. Indeed, <strong>if we look at people with good problem solving abilities, we are probably looking at people with either good performance or good intuitive intelligence</strong>. Indeed, knowing that the person has good performance <strong>explains away whether they have intuitive intelligence</strong>, hence showing a correlation which does not represent a causal effect. <strong>By conditioning on the common cause, we opened a backdoor path between <span class="math notranslate nohighlight">\(Y\)</span> and <span class="math notranslate nohighlight">\(T\)</span> which affects the perceived association between treatment and outcome</strong>.</p>
<p>Note that the same is true if we condition on a descendant of the common cause. For instance:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/3fad489fe2ff96bbee72e0ec3c524aefc1e17a7f4bc5b1623522bd61747929c4.svg" src="../_images/3fad489fe2ff96bbee72e0ec3c524aefc1e17a7f4bc5b1623522bd61747929c4.svg" /></div>
</div>
</section>
<section id="controlling-on-a-mediator">
<h5><span class="section-number">20.7.3.2. </span>Controlling on a Mediator<a class="headerlink" href="#controlling-on-a-mediator" title="Permalink to this heading">#</a></h5>
<p>Another case of selection bias, arising from cases in which we control for variables we should not control on, is given by the case in which we control on a mediator of the treatment and the outcome. Let us consider this example:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/e6e5fb55c810b850a99d107500d8b6b169f8b76335322fc2d2ad0f85d730c755.svg" src="../_images/e6e5fb55c810b850a99d107500d8b6b169f8b76335322fc2d2ad0f85d730c755.svg" /></div>
</div>
<p>We want to assess the effect of <code class="docutils literal notranslate"><span class="pre">interest</span></code> on performance. Let’s say we could randomize interest (for instance, we selected students with different levels of interest randomly across different schools). <strong>“Just to be sure”, we condition on <code class="docutils literal notranslate"><span class="pre">study</span> <span class="pre">hours</span></code></strong>. Conditioning on the mediator closes a path between <code class="docutils literal notranslate"><span class="pre">interest</span></code> and <code class="docutils literal notranslate"><span class="pre">performance</span></code>, hence reducing the measured effect between <code class="docutils literal notranslate"><span class="pre">interest</span></code> and <code class="docutils literal notranslate"><span class="pre">performance</span></code>.</p>
<p><strong>Indeed, while we expect that interested students will study more and obtain better performance, by observing only people who study a lot, <code class="docutils literal notranslate"><span class="pre">interest</span></code> and <code class="docutils literal notranslate"><span class="pre">performance</span></code> may seem to be little correlated. Indeed, even people with little interest will obtain good performance if they study for long hours.</strong></p>
</section>
<section id="main-sources-of-bias">
<h5><span class="section-number">20.7.3.3. </span>Main Sources of Bias<a class="headerlink" href="#main-sources-of-bias" title="Permalink to this heading">#</a></h5>
<p>To summarize, the main sources of bias are three:</p>
<ul class="simple">
<li><p><strong>Confounders</strong>: we should control on the common cause;</p></li>
<li><p><strong>Selection Bias - Common Effect</strong>: we should not control on the common effect;</p></li>
<li><p><strong>Selection Bias - Mediator</strong>: we should not control on the mediator.</p></li>
</ul>
<p>These are shown in the graph below:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/118e6de3d46d0872e9c687d02c4a4860aa9adcdaa55009c55f7e86093451000d.svg" src="../_images/118e6de3d46d0872e9c687d02c4a4860aa9adcdaa55009c55f7e86093451000d.svg" /></div>
</div>
<p>In the figure above, we mark in red the nodes that are not conditioned on, but should be conditioned on, and the nodes that are conditioned on, but should not be conditioned on.</p>
</section>
</section>
</section>
<section id="linear-regression-for-causal-analysis">
<h3><span class="section-number">20.8. </span>Linear Regression for Causal Analysis<a class="headerlink" href="#linear-regression-for-causal-analysis" title="Permalink to this heading">#</a></h3>
<p>We have seen how to choose a suitable set of variables to control for when we aim to establish a cause-effect relationship. When we said “we control for <span class="math notranslate nohighlight">\(X\)</span>”, we implied that we can divide the data in groups and measure association within each group, to then aggregate results and obtain an average effect.</p>
<p>In this section, we will see how we can automate this process with <strong>linear regression</strong>. Let us consider our previous example in which we wanted to measure the causal effect of <code class="docutils literal notranslate"><span class="pre">tutoring</span></code> on <code class="docutils literal notranslate"><span class="pre">performance</span></code>, when we know that <code class="docutils literal notranslate"><span class="pre">interest</span></code> can be a confounder:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/0dffd0d63cb95a58b30594ef012d7494878da59b8b188f667572f70441777e49.svg" src="../_images/0dffd0d63cb95a58b30594ef012d7494878da59b8b188f667572f70441777e49.svg" /></div>
</div>
<p>This is the data:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>tutoring</th>
      <th>performance</th>
      <th>interest</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>76.432447</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>91.550461</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>85.107378</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>69.981030</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>70.111151</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>195</th>
      <td>0</td>
      <td>68.477160</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>196</th>
      <td>0</td>
      <td>87.783594</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>197</th>
      <td>1</td>
      <td>88.220111</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>198</th>
      <td>1</td>
      <td>93.399423</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>199</th>
      <td>1</td>
      <td>84.082421</td>
      <td>4.0</td>
    </tr>
  </tbody>
</table>
<p>200 rows × 3 columns</p>
</div></div></div>
</div>
<p>Recall that in this case the assignment is not random, so we expect <code class="docutils literal notranslate"><span class="pre">interest</span></code> to influence both <code class="docutils literal notranslate"><span class="pre">tutoring</span></code> and <code class="docutils literal notranslate"><span class="pre">performance</span></code>. If we ignore this bias, we can compute the average difference in the effect of the treated and untreated:</p>
<div class="math notranslate nohighlight">
\[E[performance|tutoring=1] - E[performance|tutoring=0]\]</div>
<p>We can do this in computational terms as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">students</span><span class="p">[</span><span class="n">tutoring</span><span class="o">==</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;performance&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">-</span><span class="n">students</span><span class="p">[</span><span class="n">tutoring</span><span class="o">==</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;performance&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>6.826889013112677
</pre></div>
</div>
</div>
</div>
<p>Another relevant value to compute is the average performance of the untreated:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">students</span><span class="p">[</span><span class="n">students</span><span class="p">[</span><span class="s1">&#39;tutoring&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;performance&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>72.92912990981884
</pre></div>
</div>
</div>
</div>
<p>We can see how these values are <strong>automatically computed within a linear regressor</strong> of the kind:</p>
<div class="math notranslate nohighlight">
\[performance = \beta_0 + \beta_1 tutoring\]</div>
<p>These are the coefficients after fitting:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<tr>
      <td></td>         <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th> <td>   72.9291</td> <td>    1.199</td> <td>   60.832</td> <td> 0.000</td> <td>   70.565</td> <td>   75.293</td>
</tr>
<tr>
  <th>tutoring</th>  <td>    6.8269</td> <td>    1.671</td> <td>    4.087</td> <td> 0.000</td> <td>    3.533</td> <td>   10.121</td>
</tr>
</table></div></div>
</div>
<p>Coherently with the interpretation we previously gave of linear regression, we obtain estimates for those two values:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">intercept</span></code>: is the average performance of the untreated, i.e., the value of <code class="docutils literal notranslate"><span class="pre">performance</span></code> we expect to see in average when <code class="docutils literal notranslate"><span class="pre">tutoring=0</span></code>;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tutoring</span></code>: is the increment of <code class="docutils literal notranslate"><span class="pre">performance</span></code> we expect to see in average when we observe an increment of one unit in <code class="docutils literal notranslate"><span class="pre">tutoring</span></code> (i.e., when passing from <code class="docutils literal notranslate"><span class="pre">tutoring=0</span></code> to <code class="docutils literal notranslate"><span class="pre">tutoring=1</span></code>). This is the average difference of <code class="docutils literal notranslate"><span class="pre">performance</span></code> when comparing the treated <code class="docutils literal notranslate"><span class="pre">tutoring=1</span></code> and the untreated <code class="docutils literal notranslate"><span class="pre">tutoring=0</span></code>.</p></li>
</ul>
<p>Also, when we use a linear regressor, we get confidence intervals and the results of statistical tests “for free”.</p>
<p>If we look at the result above, <strong>there is non-zero correlation between <code class="docutils literal notranslate"><span class="pre">performance</span></code> and <code class="docutils literal notranslate"><span class="pre">tutoring</span></code></strong>. Indeed, the coefficient of <code class="docutils literal notranslate"><span class="pre">tutoring</span></code> allows us to observe that <strong>students who enroll in the <code class="docutils literal notranslate"><span class="pre">tutoring</span></code> programme, increase their average <code class="docutils literal notranslate"><span class="pre">performance</span></code> by <span class="math notranslate nohighlight">\(6.8269\)</span> points</strong> (remember that performance lies in the <span class="math notranslate nohighlight">\([0,100]\)</span> range). However, we also know that this result is biased due to the confounder <code class="docutils literal notranslate"><span class="pre">interest</span></code>. To remove this bias, we should condition on <code class="docutils literal notranslate"><span class="pre">interest</span></code>:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/1b4b2aba845e6f557ac0ecdc774758bba33721b9e27bf3d6ac65753dac5c11a3.svg" src="../_images/1b4b2aba845e6f557ac0ecdc774758bba33721b9e27bf3d6ac65753dac5c11a3.svg" /></div>
</div>
<p>We note that one way to <strong>control for a variable is to include it among the independent variables in the linear regressor</strong>, i.e., fitting a model like this:</p>
<div class="math notranslate nohighlight">
\[performance = \beta_0 + \beta_1 tutoring + \beta_2 interest\]</div>
<p>The result is as follows:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<tr>
      <td></td>         <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th> <td>   54.1697</td> <td>    1.296</td> <td>   41.804</td> <td> 0.000</td> <td>   51.614</td> <td>   56.725</td>
</tr>
<tr>
  <th>tutoring</th>  <td>   -0.9516</td> <td>    1.129</td> <td>   -0.843</td> <td> 0.400</td> <td>   -3.178</td> <td>    1.275</td>
</tr>
<tr>
  <th>interest</th>  <td>    7.8097</td> <td>    0.441</td> <td>   17.711</td> <td> 0.000</td> <td>    6.940</td> <td>    8.679</td>
</tr>
</table></div></div>
</div>
<p>We note that, after adding this variable, the values of the coefficients changed substantially. <strong>We are in particular interested in the coefficient of <code class="docutils literal notranslate"><span class="pre">tutoring</span></code>, which is measuring the correlation between <code class="docutils literal notranslate"><span class="pre">tutoring</span></code> and <code class="docutils literal notranslate"><span class="pre">performance</span></code></strong>. We note that we can now interpret this value as follows:</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(\beta_1\)</span> (coefficient of <code class="docutils literal notranslate"><span class="pre">tutoring</span></code>) is the increment we expect to observe in <code class="docutils literal notranslate"><span class="pre">performance</span></code> when <code class="docutils literal notranslate"><span class="pre">tutoring</span></code> passes from <span class="math notranslate nohighlight">\(0\)</span> to <span class="math notranslate nohighlight">\(1\)</span> <strong>and <code class="docutils literal notranslate"><span class="pre">interest</span></code> is held constant</strong>.</p>
</div></blockquote>
<p>This last bit is the fundamental one: <strong>by including the <code class="docutils literal notranslate"><span class="pre">interest</span></code> variable, we are effectively controlling for <code class="docutils literal notranslate"><span class="pre">interest</span></code></strong>. Indeed, the coefficient of <code class="docutils literal notranslate"><span class="pre">tutoring</span></code> now virtually looks at a subset of the data in which <code class="docutils literal notranslate"><span class="pre">interest</span></code> is constant. This is in practice the average effect of <code class="docutils literal notranslate"><span class="pre">tutoring</span></code> when comparing groups of data with constant <code class="docutils literal notranslate"><span class="pre">interest</span></code>.</p>
<p>Hence, <strong>even if we cannot physically perform a random assignment, linear regression allows us to control for variables, hence enabling the analysis of observational data</strong>. This is fundamental, as it is not in always feasible to perform random tests.</p>
<p>Getting back to our result above, we note that the coefficient of <code class="docutils literal notranslate"><span class="pre">tutoring</span></code> has a p-value of <span class="math notranslate nohighlight">\(0.4\)</span>. This means that, while a value different from zero has been computed for it, the hypothesis test is telling us that <strong>we do not have enough elements to say that this value actually is different from zero</strong>. Hence, we can conclude that <code class="docutils literal notranslate"><span class="pre">tutoring</span></code> does not have a statistically significant impact on <code class="docutils literal notranslate"><span class="pre">performance</span></code>.</p>
<p>Note that, <strong>if we compute a linear regressor on the randomized set (i.e., the one in which we pretended we could perform random assignment)</strong></p>
<div class="math notranslate nohighlight">
\[performance = \beta_0 + \beta_1 tutoring\]</div>
<p>we obtain these results:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<tr>
      <td></td>         <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th> <td>   77.5258</td> <td>    1.281</td> <td>   60.542</td> <td> 0.000</td> <td>   75.001</td> <td>   80.051</td>
</tr>
<tr>
  <th>tutoring</th>  <td>   -1.9648</td> <td>    1.735</td> <td>   -1.133</td> <td> 0.259</td> <td>   -5.385</td> <td>    1.456</td>
</tr>
</table></div></div>
</div>
<p>Coherently with the conclusions made with observational data, there is not a significant relationship between <code class="docutils literal notranslate"><span class="pre">tutoring</span></code> and <code class="docutils literal notranslate"><span class="pre">performance</span></code>.</p>
<section id="example-on-the-lucas-dataset">
<h4><span class="section-number">20.8.1. </span>Example on the LUCAS Dataset<a class="headerlink" href="#example-on-the-lucas-dataset" title="Permalink to this heading">#</a></h4>
<p>We will see some examples on the LUCAS dataset, which can be found here:</p>
<p><a class="reference external" href="https://www.causality.inf.ethz.ch/data/LUCAS.html">https://www.causality.inf.ethz.ch/data/LUCAS.html</a></p>
<p>LUCAS is an <strong>artificial dataset</strong> in which data has been generated drawing values from known distribution to emulate a causal phenomenon. Besides the data, the authors propose the <strong>following true causal graph</strong> (which reflects the way data has been generated):</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/c6acbcbcf75dd2090a321ea89f6292afe2988db08120e552b4c4a48638307c50.svg" src="../_images/c6acbcbcf75dd2090a321ea89f6292afe2988db08120e552b4c4a48638307c50.svg" /></div>
</div>
<p>Let us have a look at the data:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Smoking</th>
      <th>Yellow_Fingers</th>
      <th>Anxiety</th>
      <th>Peer_Pressure</th>
      <th>Genetics</th>
      <th>Attention_Disorder</th>
      <th>Born_an_Even_Day</th>
      <th>Car_Accident</th>
      <th>Fatigue</th>
      <th>Allergy</th>
      <th>Coughing</th>
      <th>Lung_cancer</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1995</th>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1996</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1997</th>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1998</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1999</th>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>2000 rows × 12 columns</p>
</div></div></div>
</div>
<section id="does-smoking-causes-car-accident">
<h5><span class="section-number">20.8.1.1. </span>Does <code class="docutils literal notranslate"><span class="pre">Smoking</span></code> causes <code class="docutils literal notranslate"><span class="pre">Car</span> <span class="pre">Accident</span></code>?<a class="headerlink" href="#does-smoking-causes-car-accident" title="Permalink to this heading">#</a></h5>
<p>We will try to answer the question as to whether there is a causal effect between <code class="docutils literal notranslate"><span class="pre">Smoking</span></code> and <code class="docutils literal notranslate"><span class="pre">Car</span> <span class="pre">Accident</span></code>. We can start by fitting a logistic regressor:</p>
<div class="math notranslate nohighlight">
\[P(Car Accident|Smoking) = \sigma(\beta_0 + \beta_1 Smoking)\]</div>
<p>We need to fit a logistic regressor because the dependent variable is binary (all variables are binary). This is the result:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Optimization terminated successfully.
         Current function value: 0.588796
         Iterations 5
</pre></div>
</div>
<div class="output text_html"><table class="simpletable">
<tr>
      <td></td>         <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th> <td>    0.7668</td> <td>    0.097</td> <td>    7.939</td> <td> 0.000</td> <td>    0.578</td> <td>    0.956</td>
</tr>
<tr>
  <th>Smoking</th>   <td>    0.2596</td> <td>    0.113</td> <td>    2.299</td> <td> 0.022</td> <td>    0.038</td> <td>    0.481</td>
</tr>
</table></div></div>
</div>
<p>From the observation above, it seems that <code class="docutils literal notranslate"><span class="pre">Smoking</span></code> is positively associated with <code class="docutils literal notranslate"><span class="pre">Car</span> <span class="pre">Accident</span></code>. Since <span class="math notranslate nohighlight">\(e^{0.2596} \approx 1.3\)</span>, we can say that smoking is associated by an increase of <span class="math notranslate nohighlight">\(+30%\)</span> in the odds of having a car accident. But, can we say that this is a causal effect? I.e., can we say that <strong>smoking causes an increment in the odd of car accident</strong>?</p>
<p>We know that there might be some bias. To check for that, let us consider the causal graph again, and let us highlight all dependence paths from the <code class="docutils literal notranslate"><span class="pre">Smoking</span></code> node to the <code class="docutils literal notranslate"><span class="pre">Car</span> <span class="pre">Accident</span></code> node. These represent all the different ways in which the two variables can be correlated.</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/acf8ba3afa4a7da9e25af4c41738d34927fa6e91202cac39acd671edb617720b.svg" src="../_images/acf8ba3afa4a7da9e25af4c41738d34927fa6e91202cac39acd671edb617720b.svg" /></div>
</div>
<p>We have three possible paths, highlighted in yellow, red, and green. Arrows indicate whether dependency flows or not. We can see that:</p>
<ul class="simple">
<li><p>The yellow path is blocked because there is a collider (<code class="docutils literal notranslate"><span class="pre">Lung</span> <span class="pre">Cancer</span></code>) that has not been conditioned on. The collider prevents <code class="docutils literal notranslate"><span class="pre">Smoking</span></code> and <code class="docutils literal notranslate"><span class="pre">Genetics</span></code> from being associated. This blocked path is ok for us. We are trying to see if smoking causes car accident, and, since, <code class="docutils literal notranslate"><span class="pre">Lung</span> <span class="pre">Cancer</span></code> does not cause <code class="docutils literal notranslate"><span class="pre">Genetics</span></code>, that path would not be a viable one to check for a causal effect;</p></li>
<li><p>The red and green paths are not blocked. This is not ideal, because now there are two ways <code class="docutils literal notranslate"><span class="pre">Smoking</span></code> could influence <code class="docutils literal notranslate"><span class="pre">Car</span> <span class="pre">Accident</span></code>, i.e., directly through <code class="docutils literal notranslate"><span class="pre">Fatigue</span></code> or via <code class="docutils literal notranslate"><span class="pre">Coughing</span></code>. This may lead to a combined effect which is stronger than it is supposed to be.</p></li>
</ul>
<p>If we want to estimate a causal effect, we need to block one of the two paths. The most sensible thing to do is to <strong>condition on <code class="docutils literal notranslate"><span class="pre">Coughing</span></code></strong>, so that now smoking can affect Car Accident only through Lung Cancer and then Fatigue. This is illustrated as follows:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/df605c5184f1b73efe3b36a635fb560fefc5ca6fa88fb0d6162e6e9420da80f2.svg" src="../_images/df605c5184f1b73efe3b36a635fb560fefc5ca6fa88fb0d6162e6e9420da80f2.svg" /></div>
</div>
<p>To condition on <code class="docutils literal notranslate"><span class="pre">Coughing</span></code>, we can fit the following logistic regressor:</p>
<div class="math notranslate nohighlight">
\[P(Car Accident|Smoking, Coughing) = \sigma(\beta_0 + \beta_1 Smoking + \beta_2 Coughing)\]</div>
<p>We obtain the following coefficients:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Optimization terminated successfully.
         Current function value: 0.569895
         Iterations 5
</pre></div>
</div>
<div class="output text_html"><table class="simpletable">
<tr>
      <td></td>         <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th> <td>    0.3411</td> <td>    0.108</td> <td>    3.153</td> <td> 0.002</td> <td>    0.129</td> <td>    0.553</td>
</tr>
<tr>
  <th>Smoking</th>   <td>   -0.0130</td> <td>    0.120</td> <td>   -0.108</td> <td> 0.914</td> <td>   -0.248</td> <td>    0.222</td>
</tr>
<tr>
  <th>Coughing</th>  <td>    0.9529</td> <td>    0.109</td> <td>    8.717</td> <td> 0.000</td> <td>    0.739</td> <td>    1.167</td>
</tr>
</table></div></div>
</div>
<p>We now get a different picture: the p-value of <code class="docutils literal notranslate"><span class="pre">Smoking</span></code> is very large. This means that, once we removed the influence of <code class="docutils literal notranslate"><span class="pre">Coughing</span></code>, the effect of <code class="docutils literal notranslate"><span class="pre">Smoking</span></code> on <code class="docutils literal notranslate"><span class="pre">Car</span> <span class="pre">Accident</span></code> is negligible (its coefficient is not significantly different from zero). This suggests that there is no significant causal effect between the two variables.</p>
</section>
</section>
</section>
<section id="references">
<h3><span class="section-number">20.9. </span>References<a class="headerlink" href="#references" title="Permalink to this heading">#</a></h3>
<p>[1] Most of the content of this lecture is based on part of the awesome lecture series “<a class="reference external" href="https://matheusfacure.github.io/python-causality-handbook/landing-page.html">Causal Inference for The Brave and True</a>” by Matheus Facure Alves.</p>
<p>[2] Judea Pearl and Dana Mackenzie. “The Book of Why: The New Science of Cause and Effect”. Penguin.</p>
</section>
</section>
</div>
<div class="toctree-wrapper compound">
<span id="document-lectures/14_data_as_nd_points"></span><section class="tex2jax_ignore mathjax_ignore" id="data-as-n-dimensional-points">
<h2><span class="section-number">21. </span>Data as N-Dimensional Points<a class="headerlink" href="#data-as-n-dimensional-points" title="Permalink to this heading">#</a></h2>
<p>So far, we have seen data as a collection of observations of multiple variables. We have often represented a dataset as a table or a data matrix. In all previous analyses, we have focused on the interpretation of the values of each variable.</p>
<p>However, in many cases (and especially when variables are many), it is useful to given a geometric interpretation of data and see observation as <strong>d-dimensional data points</strong>, where <span class="math notranslate nohighlight">\(d\)</span> is the number of variables in the dataset. Consider the following data:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Subject</p></th>
<th class="head"><p>Height (cm)</p></th>
<th class="head"><p>Weight (Kg)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>175</p></td>
<td><p>70</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>160</p></td>
<td><p>60</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>180</p></td>
<td><p>78</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>160</p></td>
<td><p>75</p></td>
</tr>
<tr class="row-even"><td><p>5</p></td>
<td><p>155</p></td>
<td><p>58</p></td>
</tr>
<tr class="row-odd"><td><p>6</p></td>
<td><p>190</p></td>
<td><p>110</p></td>
</tr>
</tbody>
</table>
<p>We can see each of these observations (the rows of the matrix) as a data point. Further, we can geometrically represent such points as follows:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/4cb91a1123c70ff8b38008ef6e3493c1ed0b1b641f1085218de518d93a9cd672.png" src="../_images/4cb91a1123c70ff8b38008ef6e3493c1ed0b1b641f1085218de518d93a9cd672.png" />
</div>
</div>
<p>Each observation, is a 2D point in the Cartesian space. This geometrical interpretation of data is central to data analysis and very convenient in particular <strong>when many different variables are available</strong>.</p>
<section id="features-and-representation-functions">
<h3><span class="section-number">21.1. </span>Features and Representation Functions<a class="headerlink" href="#features-and-representation-functions" title="Permalink to this heading">#</a></h3>
<p>In this context in which we are not always <strong>explicitly giving names or interpretation to the variables</strong>, each of the variables will also be referred to as <strong>a feature of the data</strong>. For instance, <strong>a dataset of images of <span class="math notranslate nohighlight">\(100 \times 100\)</span> pixels can be seen as a collection of <span class="math notranslate nohighlight">\(10000\)</span>-dimensional vectors</strong>, where each vector’s dimension is a “feature”, i.e., the value of a specific pixel of the image.</p>
<p>Given this interpretation of variables as features, it is often common to talk about <strong>feature extraction</strong>, in the case of any process transforming the data <span class="math notranslate nohighlight">\(\mathbf{x} \in \Re^d\)</span> to another form <span class="math notranslate nohighlight">\(\mathbf{y} \in \Re^m\)</span>. In this context, a function:</p>
<div class="math notranslate nohighlight">
\[f : \Re^d \to \Re^m\]</div>
<p>will be often referred to as a “<strong>feature extraction function</strong>” (of feature extractor) or a “<strong>representation function</strong>”. We will recall these terms going further in the course.</p>
<p>We will also refer to <span class="math notranslate nohighlight">\(\Re^d\)</span> and <span class="math notranslate nohighlight">\(\Re^m\)</span> as “<strong>feature spaces</strong>” or “<strong>representation spaces</strong>” as they will be <strong>vector spaces</strong> to which data points (also called <strong>feature vectors</strong>) belong.</p>
</section>
<section id="important-properties-of-feature-spaces">
<h3><span class="section-number">21.2. </span>Important Properties of Feature Spaces<a class="headerlink" href="#important-properties-of-feature-spaces" title="Permalink to this heading">#</a></h3>
<p>Since observations <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> are vectors living in some vector spaces, all <strong>basic properties of vectors and vector spaces introduced in linear algebra will apply here as well</strong>. We’ll recall the most important concepts as we need them in the course, but, for the moment, it is useful to summarize the main important properties.</p>
<section id="norms">
<h4><span class="section-number">21.2.1. </span>Norms<a class="headerlink" href="#norms" title="Permalink to this heading">#</a></h4>
<p>Given a vector space <span class="math notranslate nohighlight">\(S\)</span>, a norm <span class="math notranslate nohighlight">\(p\)</span> is a function from <span class="math notranslate nohighlight">\(S\)</span> to a non negative real number:</p>
<div class="math notranslate nohighlight">
\[p \in S \to \Re^+_0\]</div>
<p>A commonly used family of norms is the one of the L-p norms:</p>
<div class="math notranslate nohighlight">
\[||\mathbf{x}||_p = \left( \sum_{i=1}^{d} |x_i|^p \right)^{1/p}\]</div>
<p>Where <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> is d-dimensional, <span class="math notranslate nohighlight">\(x_i\)</span> is the i-th component of <span class="math notranslate nohighlight">\(\mathbf{x}\)</span>, and <span class="math notranslate nohighlight">\(p\)</span> is a parameter defining the behavior of the norm.</p>
<p>Note that a norm computes some kind of measure of distance of the vector from the origin of the space. In practice, the following norms are commonly used:</p>
<p><strong>L-2 Norm</strong></p>
<div class="math notranslate nohighlight">
\[||\mathbf{x}||_2 = \sqrt{\sum_{i=1}^{d} x_i^2}\]</div>
<p>This is what we know as “computing the magnitude (or modulus) of the vector”. It is the Euclidean distance between the origin and the vector.</p>
<p>When we use the L2 norm, we can omit the <span class="math notranslate nohighlight">\(p=2\)</span> subscript:</p>
<div class="math notranslate nohighlight">
\[||\mathbf{x}||_2 = ||\mathbf{x}||\]</div>
<p>Another commonly used notation is the one for the squared L2 norm:</p>
<div class="math notranslate nohighlight">
\[||\mathbf{x}||_2^2 = ||\mathbf{x}||^2 = \sum_{i=1}^{d} x_i^2\]</div>
<p><strong>L-1 Norm</strong></p>
<div class="math notranslate nohighlight">
\[||\mathbf{x}||_1 = \sum_{i=1}^{d} |x_i|\]</div>
<p>This is the sum of the absolute values of the components of the vector.</p>
<p><strong>L-<span class="math notranslate nohighlight">\(\infty\)</span> Norm</strong></p>
<div class="math notranslate nohighlight">
\[||\mathbf{x}||_\infty = \max\{|x_i|\}_{i=1}^{d}\]</div>
<p>This is the maximum absolute value of the components of the vector.</p>
<p>To visualize the difference between the different norms, it often common to display the <strong>unit circles according to the different norms</strong>. Each of the shape contains <strong>all vectors with unit norm</strong>:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/708b4a81262ac6a6763a5ecfef4762de94f1da07c6bd5062b1999408b7c1e758.png" src="../_images/708b4a81262ac6a6763a5ecfef4762de94f1da07c6bd5062b1999408b7c1e758.png" />
</div>
</div>
</section>
<section id="metrics">
<h4><span class="section-number">21.2.2. </span>Metrics<a class="headerlink" href="#metrics" title="Permalink to this heading">#</a></h4>
<p>Given a space <span class="math notranslate nohighlight">\(S\)</span>, a function</p>
<p><span class="math notranslate nohighlight">\(m : S \times S \to \Re\)</span></p>
<p>is <strong>a metric</strong> if the following properties are satisfied:</p>
<ol class="arabic simple">
<li><p>The distance of a point from itself is zero: <span class="math notranslate nohighlight">\(m(\mathbf{x}, \mathbf{x}) = 0\)</span>;</p></li>
<li><p>The distance between two distinct points is always positive (positivity): <span class="math notranslate nohighlight">\(m(\mathbf{x},\mathbf{y}) \geq 0, \forall \mathbf{x}, \mathbf{y} \in S\)</span>;</p></li>
<li><p>The distance between <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> is the same as the distance between <span class="math notranslate nohighlight">\(y\)</span> and <span class="math notranslate nohighlight">\(x\)</span> (symmetry): <span class="math notranslate nohighlight">\(m(\mathbf{x}, \mathbf{y}) = m(\mathbf{y}, \mathbf{x})\)</span>.</p></li>
<li><p>Triangle inequality: <span class="math notranslate nohighlight">\(m(\mathbf{x},\mathbf{y}) \leq m(\mathbf{x},\mathbf{z}) + m(\mathbf{z},\mathbf{y}), \forall \mathbf{x}, \mathbf{y}, \mathbf{z} \in S\)</span></p></li>
</ol>
<section id="l-p-metrics">
<h5><span class="section-number">21.2.2.1. </span>L-p Metrics<a class="headerlink" href="#l-p-metrics" title="Permalink to this heading">#</a></h5>
<p>From the L-p norms, we can derive <strong>a family of metrics</strong> as follows:</p>
<div class="math notranslate nohighlight">
\[L_p(\mathbf{x},\mathbf{y}) = ||\mathbf{x} - \mathbf{y}||_p = \left( \sum_{i=1}^{d} |x_i - y_i|^p \right)^{1/p}\]</div>
<p><strong>L2 Distance</strong></p>
<p>Note that with <span class="math notranslate nohighlight">\(p=2\)</span> we have the Euclidean (or L-2) distance:</p>
<div class="math notranslate nohighlight">
\[L_2(\mathbf{x},\mathbf{y}) = ||\mathbf{x} - \mathbf{y}||_2 = \sqrt{\sum_{i=1}^{d} (x_i - y_i)^2}\]</div>
<p><strong>L1 Distance</strong></p>
<p>With <span class="math notranslate nohighlight">\(p=1\)</span>, we obtain the L1 distance, which is also known as the <strong>Manhattan distance</strong>:</p>
<div class="math notranslate nohighlight">
\[L_1(\mathbf{x},\mathbf{y}) = ||\mathbf{x} - \mathbf{y}||_1 = \sum_{i=1}^{d} |x_i - y_i|\]</div>
<p><strong>L-<span class="math notranslate nohighlight">\(\infty\)</span> Distance</strong></p>
<p>With <span class="math notranslate nohighlight">\(p=\inf\)</span>, we obtain the L-<span class="math notranslate nohighlight">\(\infty\)</span> distance:</p>
<div class="math notranslate nohighlight">
\[L_\infty(\mathbf{x},\mathbf{y}) = ||\mathbf{x} - \mathbf{y}||_\infty = \max_{i=1}^d\{|x_i - y_i|\}\]</div>
<p>The difference between the L1 and L2 distances is notable, as shown in the figure blow:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/9875267b3656cd73af5b63e55da1108a69cf4731c852cea3aae17b670605f9ba.png" src="../_images/9875267b3656cd73af5b63e55da1108a69cf4731c852cea3aae17b670605f9ba.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Manhattan (L1) Distance: 7.00
Euclidean (L2) Distance: 5.00
L-Inf Distance: 4.00
</pre></div>
</div>
</div>
</div>
<p>While the Euclidean distance measures the length of the straight segment connecting the two points, the Manhattan distance is the one in grey (dashed), which measures the distance that a taxi driver should drive in Manhattan (or any other square-block based city) to reach the destination.</p>
</section>
<section id="cosine-distance">
<h5><span class="section-number">21.2.2.2. </span>Cosine Distance<a class="headerlink" href="#cosine-distance" title="Permalink to this heading">#</a></h5>
<p>The cosine distance is useful when we need to compare two vectors but we do not care about differences arising from scaling factors. Note that the euclidean distance of two proportional vectors is in general non-zero:</p>
<div class="math notranslate nohighlight">
\[||\mathbf{x} - \alpha \mathbf{x}||^2 &gt; 0, \alpha \neq 1\]</div>
<p>Nevertheless, <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> and <span class="math notranslate nohighlight">\(\alpha \mathbf{x}\)</span> are very similar. If we want to compare two vectors considering only <strong>the relationships between their coordinates, rather than their values</strong>, we can use the cosine similarity, which is defined as follows:</p>
<div class="math notranslate nohighlight">
\[S_C (\mathbf{x}, \mathbf{y}) = \frac{\mathbf{x} \cdot \mathbf{y}}{||\mathbf{x}|| ||\mathbf{y}||}\]</div>
<p>The cosine similarity computes the cosine of the angle <span class="math notranslate nohighlight">\(\theta\)</span> comprised between two vectors, as shown in the plot below:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/e64e2c520cf9e4504e6b8df2037730c271b45a5bcfec47f00c3f284020ab8af2.png" src="../_images/e64e2c520cf9e4504e6b8df2037730c271b45a5bcfec47f00c3f284020ab8af2.png" />
</div>
</div>
<p>Note that the cosine similarity would be the same if the two vectors had different scales (i.e., if they were longer but they would have the same orientation).</p>
<p>This kind of similarity measure is useful when the scale of the vector is not important. For instance, if the vectors <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{y}\)</span> are vectors of word counts of two documents of different lengths, we care about the <strong>proportions of words in each document, while longer document will have vectors with larger L2 norms</strong>.</p>
<p>The cosine similarity is a normalized number between <span class="math notranslate nohighlight">\(-1\)</span> and <span class="math notranslate nohighlight">\(1\)</span>, where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(+1\)</span> means maximum alignment (similarity) between the two vectors;</p></li>
<li><p><span class="math notranslate nohighlight">\(-1\)</span> means that the two vectors are dissimilar - they are indeed opposite.</p></li>
<li><p><span class="math notranslate nohighlight">\(0\)</span> means that the two vectors are orthogonal.</p></li>
</ul>
<p>The plot below shows different examples of cosine similarity of vector pairs:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/196b6c029f390b83b1d4259ea91b0c7b50c7948d8ad6313018d8c3c8bbcbad9e.png" src="../_images/196b6c029f390b83b1d4259ea91b0c7b50c7948d8ad6313018d8c3c8bbcbad9e.png" />
</div>
</div>
<p>The cosine distance is defined from the cosine similarity as:</p>
<div class="math notranslate nohighlight">
\[D_C = 1- S_C = 1- \frac{\mathbf{x} \cdot \mathbf{y}}{||\mathbf{x}|| \cdot ||\mathbf{x}||}\]</div>
<p>It should be noted that the cosine similarity is not a metric as it does not satisfy the triangular inequality.</p>
</section>
</section>
</section>
<section id="references">
<h3><span class="section-number">21.3. </span>References<a class="headerlink" href="#references" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Norm_(mathematics)">https://en.wikipedia.org/wiki/Norm_(mathematics)</a></p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Lp_space">https://en.wikipedia.org/wiki/Lp_space</a></p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Metric_space">https://en.wikipedia.org/wiki/Metric_space</a></p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Cosine_similarity">https://en.wikipedia.org/wiki/Cosine_similarity</a></p></li>
<li><p>Parts of Chapter 2 of [1]</p></li>
</ul>
<p>[1] Goodfellow, Ian, Yoshua Bengio, and Aaron Courville. Deep learning. MIT press, 2016.</p>
</section>
</section>
<span id="document-lectures/15_clustering"></span><section class="tex2jax_ignore mathjax_ignore" id="clustering">
<h2><span class="section-number">22. </span>Clustering<a class="headerlink" href="#clustering" title="Permalink to this heading">#</a></h2>
<p>When we deal with complex datasets of multiple observations and variables, it can be useful to be able to understand the underlying structure of the data.</p>
<p>One approach to do so is to determine whether the data can be grouped into <strong>clusters containing points with similar characteristics</strong>. This can be useful in different application scenarios in data analysis:</p>
<ol class="arabic simple">
<li><p><strong>Customer Segmentation:</strong></p>
<ul class="simple">
<li><p>Grouping customers based on their purchasing behavior, preferences, or demographics for targeted marketing strategies.</p></li>
</ul>
</li>
<li><p><strong>Image Segmentation:</strong></p>
<ul class="simple">
<li><p>Dividing an image into meaningful segments or regions based on similarity, aiding in object recognition and computer vision tasks.</p></li>
</ul>
</li>
<li><p><strong>Text Document Clustering:</strong></p>
<ul class="simple">
<li><p>Grouping similar documents together based on their content for tasks such as topic modeling, document organization, and information retrieval.</p></li>
</ul>
</li>
<li><p><strong>Speech and Audio Processing:</strong></p>
<ul class="simple">
<li><p>Clustering <strong>audio data for tasks such as speaker identification, music genre classification, and speech analysis</strong>.</p></li>
</ul>
</li>
<li><p><strong>E-commerce:</strong></p>
<ul class="simple">
<li><p>Grouping products or users based on purchasing patterns to optimize inventory management and improve the user experience.</p></li>
</ul>
</li>
</ol>
<section id="problem-definition">
<h3><span class="section-number">22.1. </span>Problem Definition<a class="headerlink" href="#problem-definition" title="Permalink to this heading">#</a></h3>
<p>Clustering aims to break the data into distinct group with similar properties. Let us consider the “Old Faithful” dataset, which comprises <span class="math notranslate nohighlight">\(272\)</span> observations of the eruption of the Old Faithful geyser at the Yellowstone National Park in USA. Each observation includes two variables:</p>
<ul class="simple">
<li><p>The <strong>duration</strong> of the eruption in minutes;</p></li>
<li><p>The time in minutes to the <strong>next eruption</strong>.</p></li>
</ul>
<p>We can see each observation as 2D vector which can be plotted in a Cartesian coordinate system:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/63f4f700550e363e8b81b830177a04567dddfa9f9834e064179f3c3189299fd0.png" src="../_images/63f4f700550e363e8b81b830177a04567dddfa9f9834e064179f3c3189299fd0.png" />
</div>
</div>
<p>We can see how we clearly have two kinds of eruptions:</p>
<ul class="simple">
<li><p>Short eruptions followed by other short eruptions in a short time (bottom left);</p></li>
<li><p>Long eruptions followed by other long eruptions in a long time (upper right).</p></li>
</ul>
<p>A clustering algorithm aims to automatically find the two groups and assign each data point to the most likely group. Note that the two groups will be referred generically as “cluster <span class="math notranslate nohighlight">\(i\)</span>”, meaning that the algorithm will not assign any semantic to the clusters, but it will aim to put “similar” data points in the same cluster.</p>
<p>Let</p>
<div class="math notranslate nohighlight">
\[\mathbf{X} = \left\{ \mathbf{x}^{(i)} \right\}_{i = 1}^{N},\ \mathbf{x}^{(i)} \in \mathfrak{R}^{n}\]</div>
<p>be a set of observations. The goal of clustering is to split <span class="math notranslate nohighlight">\(\mathbf{X}\)</span> into <span class="math notranslate nohighlight">\(K\)</span> groups (called clusters):</p>
<div class="math notranslate nohighlight">
\[S = \{ S_{1},S_{2},\ldots,S_{K}\}\]</div>
<p>Such that:</p>
<div class="math notranslate nohighlight">
\[\forall\ \mathbf{x}^{(i)} \in \mathbf{X}\ \exists!S_{j} \in S\ :\mathbf{x}^{(i)} \in S_{j}\]</div>
<p>The clusters are expected to be such that elements within a group are
<strong>similar to each other</strong>, whereas elements belonging to different groups are
different from each other.</p>
<p><strong>The number of clusters</strong> <span class="math notranslate nohighlight">\(\mathbf{K}\)</span> <strong>is often a hyper-parameter of
the algorithm.</strong></p>
<section id="graphical-example">
<h4><span class="section-number">22.1.1. </span>Graphical Example<a class="headerlink" href="#graphical-example" title="Permalink to this heading">#</a></h4>
<p>For instance, consider the following 2D points:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/360dcb37a7439df52d0567866db050cca20c3ba8cb039ac6ad087f80703d6479.png" src="../_images/360dcb37a7439df52d0567866db050cca20c3ba8cb039ac6ad087f80703d6479.png" />
</div>
</div>
<p>Even if we the points are not explicitly assigned to given groups (i.e., we are not observing any discrete variable <span class="math notranslate nohighlight">\(y\)</span> indicating the group to which each point belong), we can clearly
see that there are two distinct groups (the one in the top-left part of
the plot, and the one in bottom-right). The goal of clustering is to
split the data into two groups, as it is shown below:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/3773291814ab9f16067daf3ec5a7ea4a4261daefff1192518c8055512b9de37d.png" src="../_images/3773291814ab9f16067daf3ec5a7ea4a4261daefff1192518c8055512b9de37d.png" />
</div>
</div>
<p>Also note that, while different possible partitions of the
2D points are possible, the one outlined in the plot guarantees that points within
the same group are similar to one another (i.e., their Euclidean
distance is small), whereas points from different groups have are
dissimilar (i.e., their Euclidean distance is large).</p>
</section>
</section>
<section id="k-means-clustering">
<h3><span class="section-number">22.2. </span>K-Means Clustering<a class="headerlink" href="#k-means-clustering" title="Permalink to this heading">#</a></h3>
<p>K-Means is the most popular clustering algorithm. As in the definition we just gave of clustering, the goal of K-Means is to break the data</p>
<div class="math notranslate nohighlight">
\[\mathbf{X} = \left\{ \mathbf{x}^{(i)} \right\}_{i = 1}^{N},\ \mathbf{x}^{(i)} \in \mathfrak{R}^{n}\]</div>
<p>into <span class="math notranslate nohighlight">\(K\)</span> clusters</p>
<div class="math notranslate nohighlight">
\[S = \{ S_{1},S_{2},\ldots,S_{K}\}\]</div>
<p>such that:</p>
<div class="math notranslate nohighlight">
\[\forall\ \mathbf{x}^{(i)} \in \mathbf{X}\ \exists!S_{j} \in S\ :\mathbf{x}^{(i)} \in S_{j}\]</div>
<p>More specifically, K-Means attempts to create <span class="math notranslate nohighlight">\(K\)</span> clusters which are <strong>as compact as possible</strong>, where <span class="math notranslate nohighlight">\(K\)</span> is
a parameter specified by the user (its application may depend on the application).</p>
<p>We will start by defining <span class="math notranslate nohighlight">\(K\)</span> different vectors <span class="math notranslate nohighlight">\(\mathbf{\mu}_k \in \Re^n\)</span> which will act as prototypes for the our clusters. We will shortly see that these vectors will be the cluster’s centers.</p>
<p>Hence, we define <span class="math notranslate nohighlight">\(N \times K\)</span> binary variables <span class="math notranslate nohighlight">\(r_{ij}\)</span> which will allow us to establish a mapping between data points <span class="math notranslate nohighlight">\(\mathbf{x}^{(i)}\)</span> and clusters <span class="math notranslate nohighlight">\(S_j\)</span>. In particular, we will define:</p>
<div class="math notranslate nohighlight">
\[\begin{split}r_{ij} = \begin{cases}1 &amp; \text{ if } \mathbf{x}^{(i)} \in S_j \\ 0 &amp; \text{ otherwise} \end{cases} \end{split}\]</div>
<p>The notion that <strong>clusters should be as compact as possible</strong> is formalized by defining the following <strong>cost function</strong>, which is sometimes called also <strong>distortion function</strong>:</p>
<div class="math notranslate nohighlight">
\[J = \sum_{j=1}^K \sum_{i=1}^N r_{ij} ||\mathbf{x}_i-\mathbf{\mu}_j||^2\]</div>
<p>Note that this function accumulates <strong>the sum of square distances between each data point and the prototype of the assigned cluster</strong>. This is possible because <span class="math notranslate nohighlight">\(r_{ij}\)</span> will be one only in the if data point <span class="math notranslate nohighlight">\(i\)</span> is in cluster <span class="math notranslate nohighlight">\(j\)</span> (so many terms in the internal sum will be zero).</p>
<p>We can also note that the variance of cluster <span class="math notranslate nohighlight">\(j\)</span> can be defined as:</p>
<div class="math notranslate nohighlight">
\[\sigma_j^2 = \frac{1}{\sum_{i}^N{r_{ij}}}\sum_{i=1}^N r_{ij} ||\mathbf{x}_i-\mathbf{\mu}_j||^2 = \frac{1}{|S_j|}\sum_{i=1}^N r_{ij} ||\mathbf{x}_i-\mathbf{\mu}_j||^2\]</div>
<p>We can hence see the cost function also as:</p>
<div class="math notranslate nohighlight">
\[J = \sum_{j=1}^K |S_j|\sigma_j^2\]</div>
<p>Hence, minimizing <span class="math notranslate nohighlight">\(J\)</span> will effectively minimize the variances <span class="math notranslate nohighlight">\(\sigma_j^2\)</span> and the number of elements in each cluster <span class="math notranslate nohighlight">\(|S_j|\)</span>, which will hence be encouraged to have similar numbers of elements.</p>
<p>The K-Means problem is solved by finding a partition  <span class="math notranslate nohighlight">\(\widehat{S}\)</span> minimizing the cost function:</p>
<div class="math notranslate nohighlight">
\[\{\hat r_{ij}\}_{ij}, \{ \hat{\mathbf{\mu}_j} \}_j = \arg{\min{\sum_{j = 1}^{K}{\sum_{i = 1}^{N}{r_{ij}\left\| \mathbf{x}^{(i)} - \mathbf{\mu}_{i} \right\|^{2}}}}}\]</div>
<section id="optimization">
<h4><span class="section-number">22.2.1. </span>Optimization<a class="headerlink" href="#optimization" title="Permalink to this heading">#</a></h4>
<p>The minimization above can be performed using an iterative algorithm.
The first step of the algorithm is to choose <span class="math notranslate nohighlight">\(K\)</span> random centroids
<span class="math notranslate nohighlight">\(\mathbf{\mu}_{i}\)</span>. After this initialization, the algorithm iterates
the following two steps:</p>
<blockquote>
<div><p><strong>Assignment</strong></p>
<p>Eeach element <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> is assigned to the set
with the closest centroid</p>
<div class="math notranslate nohighlight">
\[\begin{split}r_{ij} = \begin{cases}1 &amp; \text{ if } j=\arg_k\min ||\mathbf{x}^{(i)}-\mathbf{\mu}_j||^2 \\ 0 &amp; \text{otherwise} \end{cases}, \forall i,j\end{split}\]</div>
<p>Which will lead to the partition:</p>
<div class="math notranslate nohighlight">
\[S_{i} = \left\{ \mathbf{x} \in \mathbf{X} :\ \left\| \mathbf{x} - \mathbf{\mu}_{i} \right\|^{2} \leq \left\| \mathbf{x} - \mathbf{\mu}_{j} \right\|^{2}\ \ \forall\ j \in \left\{ 1,\ldots K \right\} \right\}\]</div>
</div></blockquote>
<blockquote>
<div><p><strong>Update</strong></p>
<p>The centroids <span class="math notranslate nohighlight">\(\mathbf{\mu}_{i}\)</span> are re-computed from
the assigned sets</p>
<div class="math notranslate nohighlight">
\[\mathbf{\mu}_{j} = \frac{1}{|S_{j}|}\sum_{\mathbf{x} \in S_{j}}^{}\mathbf{x} = \frac{\sum_{i = 1}^{N}{r_{ij}\mathbf{x}^{(i)}}}{\sum_{i = 1}^{N}{r_{ij}}}\]</div>
</div></blockquote>
<p>The algorithm converges when the update does not change any centroid. In
some cases, the algorithms may never actually converge, hence it is
often common to introduce as a termination criterion a maximum number of
iterations.</p>
<p><em>The algorithm is not guaranteed to find the global optimum and the
solution reached may depend on the random initialization. However, in
practice it usually leads to a reasonable solution.</em></p>
<section id="pseudocode">
<h5><span class="section-number">22.2.1.1. </span>Pseudocode<a class="headerlink" href="#pseudocode" title="Permalink to this heading">#</a></h5>
<p>We can see the optimization algorithm in pseudo-code as follows:</p>
<blockquote>
<div><p>Randomly initialize <span class="math notranslate nohighlight">\(K\)</span> cluster centroids <span class="math notranslate nohighlight">\(\mu_{1},\mu_{2},\ldots,\mu_{K} \in \mathfrak{R}^{n}\)</span></p>
<p>Repeat until termination criterion is reached {</p>
<p>         for i = 1 to N</p>
<p>                 <span class="math notranslate nohighlight">\(r_{ij} = \begin{cases}1 &amp; \text{ if } j=\arg_k\min ||\mathbf{x}^{(i)}-\mathbf{\mu}_j||^2 \\ 0 &amp; \text{otherwise} \end{cases}, \forall i,j\)</span> //assignment</p>
<p>         for j = 1 to K</p>
<p>                 <span class="math notranslate nohighlight">\(\mathbf{\mu}_{j} = \frac{\sum_{i = 1}^{N}{r_{ij}\mathbf{x}^{(i)}}}{\sum_{i = 1}^{N}{r_{ij}}}\)</span> //update</p>
<p>}</p>
</div></blockquote>
</section>
</section>
<section id="example-execution">
<h4><span class="section-number">22.2.2. </span>Example Execution<a class="headerlink" href="#example-execution" title="Permalink to this heading">#</a></h4>
<p>Let us see a graphical example of the process.</p>
<p><strong>Dataset</strong></p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/0e6ee79ba9995a7f99a7d42318ab054565b3b4c386eb0844fcb619377ba7e4de.png" src="../_images/0e6ee79ba9995a7f99a7d42318ab054565b3b4c386eb0844fcb619377ba7e4de.png" />
</div>
</div>
<p><strong>Initialization (Random)</strong></p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/4d1fb98072edc5b14f1b9ed4b6bfaa182bed43d9ccde3dad139e4398728e74a9.png" src="../_images/4d1fb98072edc5b14f1b9ed4b6bfaa182bed43d9ccde3dad139e4398728e74a9.png" />
</div>
</div>
<p><strong>Assignment (1)</strong></p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/99c387f5f21ee8e5a9804138d58cc348fd7242f2ab878e245c86d6bd57750129.png" src="../_images/99c387f5f21ee8e5a9804138d58cc348fd7242f2ab878e245c86d6bd57750129.png" />
</div>
</div>
<p><strong>Update (1)</strong></p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/36e1c90ebc5bcfc520ce481efc45034f2c5e20046dd2a895aed3ea36825e49fb.png" src="../_images/36e1c90ebc5bcfc520ce481efc45034f2c5e20046dd2a895aed3ea36825e49fb.png" />
</div>
</div>
<p><strong>Assignment (2)</strong></p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/4bc56fc212456df58d1de947a5a290f5e8aa8e14f5996c6d4bf0fbf7c03dda94.png" src="../_images/4bc56fc212456df58d1de947a5a290f5e8aa8e14f5996c6d4bf0fbf7c03dda94.png" />
</div>
</div>
<p><strong>Update (2)</strong></p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/f1271611d0fa2ce218ce866265a36f3e38edead921def7186dfe97179c4296b4.png" src="../_images/f1271611d0fa2ce218ce866265a36f3e38edead921def7186dfe97179c4296b4.png" />
</div>
</div>
<p><strong>Assignment (3)</strong></p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/20aeadd9bf300693e6b010914d5a74d5c7941761918018079342fc8913bb8059.png" src="../_images/20aeadd9bf300693e6b010914d5a74d5c7941761918018079342fc8913bb8059.png" />
</div>
</div>
<p><strong>Update (3)</strong></p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/9880baa80546e7243adb633ba2a3f0dffcda330919e706ebd361f0cb61d9c4d8.png" src="../_images/9880baa80546e7243adb633ba2a3f0dffcda330919e706ebd361f0cb61d9c4d8.png" />
</div>
</div>
<p><strong>Assignment (4)</strong></p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/75b13263fb63875972f94039764f3cba63085bb43f6ae0f678fbcd898677db0d.png" src="../_images/75b13263fb63875972f94039764f3cba63085bb43f6ae0f678fbcd898677db0d.png" />
</div>
</div>
<p><strong>Update (4)</strong></p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/ccc4efb1512ab07339a128d1a9ea519287b5614aa2e115bf36f6cfb4423a7e02.png" src="../_images/ccc4efb1512ab07339a128d1a9ea519287b5614aa2e115bf36f6cfb4423a7e02.png" />
</div>
</div>
<p>The optimization procedure terminates here as the centroids did not move in the last update step. The data is now clustered in two groups.</p>
<p>The plot below shows the value of the cost function at the end of each iteration:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/b2accded7842cdfbb330249ed6b47961f1a41d846b22523a11ca017f2e1ed554.png" src="../_images/b2accded7842cdfbb330249ed6b47961f1a41d846b22523a11ca017f2e1ed554.png" />
</div>
</div>
</section>
<section id="choosing-the-right-value-for-k">
<h4><span class="section-number">22.2.3. </span>Choosing the Right Value for K<a class="headerlink" href="#choosing-the-right-value-for-k" title="Permalink to this heading">#</a></h4>
<p>In the K-Means clustering algorithm, <span class="math notranslate nohighlight">\(K\)</span> is a <strong>hyper-parameter</strong>. This means that, <strong>it is a parameter of the method, affecting the final model we obtain after the optimization procedure</strong>, but <strong>its value is not automatically determined by the optimization procedure</strong>.</p>
<p>One common approach to determine the values of hyper-parameters is to make some guesses and fit different models with the guessed values of the hyper-parameters. We can then choose the model which has the “best value” of the considered hyper-parameters.</p>
<p>When it turns to determining the optimal <span class="math notranslate nohighlight">\(K\)</span> value for K-Means clustering, there are two main techniques which are commonly used: <strong>the elbow method</strong> and <strong>the silhouette method</strong>, which are discussed in the following.</p>
<p>Note that these are bot <strong>heuristic methods not giving many guarantees on the final selection of <span class="math notranslate nohighlight">\(K\)</span></strong>, but they can still help decide on the number of clusters, in particular if guided by an intuition of what a good value of <span class="math notranslate nohighlight">\(K\)</span> would look like.</p>
<section id="elbow-method">
<h5><span class="section-number">22.2.3.1. </span>Elbow Method<a class="headerlink" href="#elbow-method" title="Permalink to this heading">#</a></h5>
<p>The elbow method consists in fitting K-Means models for different values of <span class="math notranslate nohighlight">\(K\)</span>. For each <span class="math notranslate nohighlight">\(K\)</span>, we then plot the final value of the cost function. We expect that <strong>as <span class="math notranslate nohighlight">\(K\)</span> increases, the cost will decrease</strong>. Indeed, if <span class="math notranslate nohighlight">\(K\)</span> is very large (even larger than it should be), we will anyway get a smaller cost due to the fact that the presence of more clusters will inevitably lower their individual variances.</p>
<p>However, we expect the cost function to <strong>slow the speed of decrease in the presence of the optimal (or a good) <span class="math notranslate nohighlight">\(K\)</span></strong>. This is called the “elbow point” as the curve should look like an elbow. We can see it in the example below:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/f1d5a00e177d743540c151cfdbeb5dcfe56534cf266cd62719872f6a6b7d8c25.png" src="../_images/f1d5a00e177d743540c151cfdbeb5dcfe56534cf266cd62719872f6a6b7d8c25.png" />
</div>
</div>
</section>
<section id="silhouette-method">
<h5><span class="section-number">22.2.3.2. </span>Silhouette Method<a class="headerlink" href="#silhouette-method" title="Permalink to this heading">#</a></h5>
<p>The silhouette method tries to assess how good a given clustering model is by measuring <strong>how well the data is grouped in the identified clusters</strong>. This is done by computing, <strong>for each data point</strong> a score indicating whether <strong>how well the data point fits the assigned cluster with respect to all others</strong>.</p>
<p>If the model is a good one (hence a good <span class="math notranslate nohighlight">\(K\)</span> value), we would expect each data point to fit well its assigned cluster and not to fit well any other cluster. If this does not happen, it means that the clusters are not very well separated and we <strong>either have more or less clusters</strong>.</p>
<p>To do so, for a given data point <span class="math notranslate nohighlight">\(i\)</span> assigned to cluster <span class="math notranslate nohighlight">\(C_I\)</span>, the silhouette method computes the following score:</p>
<div class="math notranslate nohighlight">
\[a(i) = \frac{1}{|C_I|-1} \sum_{j \in C_i, i \neq j} d(i,j)\]</div>
<p>where <span class="math notranslate nohighlight">\(d(i,j)\)</span> is the Euclidean distance between data point <span class="math notranslate nohighlight">\(i\)</span> and data point <span class="math notranslate nohighlight">\(j\)</span>. In practice, the score <span class="math notranslate nohighlight">\(a(i)\)</span> is the <strong>average distance of data point <span class="math notranslate nohighlight">\(i\)</span> with any other data point assigned to the same cluster</strong>. We expect this number to be small if the cluster has a low variance.</p>
<p>We now want to compare this number to the value we would have <strong>if <span class="math notranslate nohighlight">\(i\)</span> were to be assigned to another cluster <span class="math notranslate nohighlight">\(C_J\)</span></strong>. In particular, we will choose the cluster <span class="math notranslate nohighlight">\(C_J\)</span> which minimizes the average distance. This is done by computing the following score:</p>
<div class="math notranslate nohighlight">
\[b(i) = \min_{J \neq I} \frac{1}{|C_J|} \sum_{j \in C_J} d(i,j)\]</div>
<p>Now we compare <span class="math notranslate nohighlight">\(a(i)\)</span> with <span class="math notranslate nohighlight">\(b(i)\)</span>. Ideally, <span class="math notranslate nohighlight">\(a(i)\)</span> should be much smaller than <span class="math notranslate nohighlight">\(b(i)\)</span>. If this happens, this means that the data point <span class="math notranslate nohighlight">\(i\)</span> fits in the cluster <span class="math notranslate nohighlight">\(C_I\)</span> much better than it would in any other cluster. To do so, we compute the <strong>silhouette score</strong> of data point <span class="math notranslate nohighlight">\(i\)</span> as follows:</p>
<div class="math notranslate nohighlight">
\[\begin{split}s(i) = \begin{cases}\frac{b(i)-a(i)}{\max\{a(i),b(i)\}} &amp; \text{ if } |C_I|&gt;1\\0 &amp; \text{ otherwise}\end{cases}\end{split}\]</div>
<p>The obtained score is such that:</p>
<div class="math notranslate nohighlight">
\[-1 \leq s(i) \leq 1\]</div>
<p>In practice:</p>
<ul class="simple">
<li><p>A value of <span class="math notranslate nohighlight">\(s(i)\)</span> close to <span class="math notranslate nohighlight">\(1\)</span> is obtained when <span class="math notranslate nohighlight">\(a(i) &lt;&lt; b(i)\)</span>, meaning that <span class="math notranslate nohighlight">\(i\)</span> fits in <span class="math notranslate nohighlight">\(C_I\)</span> much better than it would fit in any other cluster;</p></li>
<li><p>A value of <span class="math notranslate nohighlight">\(s(i)\)</span> close to <span class="math notranslate nohighlight">\(-1\)</span> is obtained when <span class="math notranslate nohighlight">\(a(i) &gt;&gt; b(i)\)</span>, meaning that another cluster <span class="math notranslate nohighlight">\(C_J\)</span> exists in which <span class="math notranslate nohighlight">\(a(i)\)</span> fits better.</p></li>
<li><p>A value of <span class="math notranslate nohighlight">\(s(i)\)</span> close to <span class="math notranslate nohighlight">\(0\)</span> indicates that the data point is close to the <strong>border between two natural clusters</strong>.</p></li>
</ul>
<p>The score above is arbitrarily set to <span class="math notranslate nohighlight">\(0\)</span> if <span class="math notranslate nohighlight">\(|C_I|=1\)</span> as in that case, the cluster would only contain the data point <span class="math notranslate nohighlight">\(i\)</span>. Note that this is <strong>an assumption of neutrality</strong>.</p>
<p>The correct number of clusters is usually chosen by showing the silhouette plot, which displays all the silhouette scores of data points within each clusters, arranged from largest to smallest. The plots below are taken from the <a class="reference external" href="https://scikit-learn.org/stable/auto_examples/cluster/plot_kmeans_silhouette_analysis.html">scikit-learn documentation</a> and show examples of silhouette plots for different choices of <span class="math notranslate nohighlight">\(K\)</span> in an example datest:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/d4905a3611e95874e694a173b13817bed5320bc3147546c6e13620df3e6148cc.png" src="../_images/d4905a3611e95874e694a173b13817bed5320bc3147546c6e13620df3e6148cc.png" />
<img alt="../_images/c9ae75e6ae7b88460d3d78bd6a33c015f463f84d701da4532fc311f370bcc668.png" src="../_images/c9ae75e6ae7b88460d3d78bd6a33c015f463f84d701da4532fc311f370bcc668.png" />
<img alt="../_images/0957f560e99936f0acb8677364364e972cd4b436a4e90a243c03582652e58b8f.png" src="../_images/0957f560e99936f0acb8677364364e972cd4b436a4e90a243c03582652e58b8f.png" />
<img alt="../_images/6299d0de1b96682a227bce45dd6e8109b4098acd017b7b1a8e5725d7523d15ec.png" src="../_images/6299d0de1b96682a227bce45dd6e8109b4098acd017b7b1a8e5725d7523d15ec.png" />
<img alt="../_images/a9dd38401a6443e27071ebe180da299e4e174c68ac8f6ae8cdbce16ba40d83ac.png" src="../_images/a9dd38401a6443e27071ebe180da299e4e174c68ac8f6ae8cdbce16ba40d83ac.png" />
</div>
</div>
<p>The vertical line in red displays the average silhouette score. Good choices of cluster numbers will have silhouette plots which achieve values similar to each other and close to the average one. For example <span class="math notranslate nohighlight">\(n=2\)</span> and <span class="math notranslate nohighlight">\(n=4\)</span> seem to be the best pick.</p>
<p>In practice, it is also useful to plot the average silhouette score versus the number of clusters and choose value of <span class="math notranslate nohighlight">\(K\)</span> which maximize the average score.</p>
<p>Such plot would be as follows for the previous example:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/dc460bed0fff84bbf845fc6dd12524459a19b2145767d993f73739c3e44aa1c1.png" src="../_images/dc460bed0fff84bbf845fc6dd12524459a19b2145767d993f73739c3e44aa1c1.png" />
</div>
</div>
<p>The plot below shows another example of such plot for a different dataset:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/3b9e151b3bc1e3d663f656139d2f01f71f844194eac631bbd3f4e3cb9173870f.png" src="../_images/3b9e151b3bc1e3d663f656139d2f01f71f844194eac631bbd3f4e3cb9173870f.png" />
</div>
</div>
</section>
</section>
</section>
<section id="other-clustering-algorithms">
<h3><span class="section-number">22.3. </span>Other Clustering Algorithms<a class="headerlink" href="#other-clustering-algorithms" title="Permalink to this heading">#</a></h3>
<p>It is important to note that various clustering algorithms exist beyond the commonly discussed k-means method. While k-means is a popular and widely used algorithm for partitioning data into distinct groups based on similarity, it is one approach among many. Numerous other clustering algorithms offer different perspectives and address specific challenges. Some examples include <strong>hierarchical clustering</strong>, <strong>DBSCAN</strong> (Density-Based Spatial Clustering of Applications with Noise), and <strong>spectral clustering</strong>. These alternatives provide unique strengths and are tailored to different types of data and scenarios. While our focus has been on understanding clustering in general and the k-means algorithm in particular, it is important to know that other approaches may be more suitable depending on the specific problem at hand. In the next lectures, we will see <strong>Gaussian Mixture Models (GMMs)</strong>, a probabilistic model for density estimation which can also be interpreted as a clustering algorithm.</p>
</section>
<section id="references">
<h3><span class="section-number">22.4. </span>References<a class="headerlink" href="#references" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Section 10.3.1 of [1]</p></li>
<li><p>Section 2.3.9 of [2]</p></li>
<li><p>Section 9.2 of [2]</p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Silhouette_(clustering)">https://en.wikipedia.org/wiki/Silhouette_(clustering)</a></p></li>
</ul>
<p>[1] James, G., Witten, D., Hastie, T., &amp; Tibshirani, R. (2013). <a class="reference external" href="http://faculty.marshall.usc.edu/gareth-james/ISL/">An
introduction to statistical
learning</a>. New York:
springer.</p>
<p>[2] Bishop, Christopher M., and Nasser M. Nasrabadi. Pattern recognition and machine learning. Vol. 4. No. 4. New York: springer, 2006.</p>
</section>
</section>
</div>
<div class="toctree-wrapper compound">
<span id="document-laboratories/10_statistical_inference"></span><section class="tex2jax_ignore mathjax_ignore" id="laboratory-on-statistical-inference">
<h2><span class="section-number">23. </span>Laboratory on Statistical Inference<a class="headerlink" href="#laboratory-on-statistical-inference" title="Permalink to this heading">#</a></h2>
<p>In this laboratory, we will see the main tools to perform statistical inference. We will contextualize better these tools with real data analysis later.</p>
<section id="sampling">
<h3><span class="section-number">23.1. </span>Sampling<a class="headerlink" href="#sampling" title="Permalink to this heading">#</a></h3>
<p>In Python we can easily sample from known distributions using numpy <code class="docutils literal notranslate"><span class="pre">random</span></code> module, as shown in the example below:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Set the sample size</span>
<span class="n">sample_size</span> <span class="o">=</span> <span class="mi">1000</span>

<span class="c1"># Sample from the Normal (Gaussian) Distribution</span>
<span class="n">mean_normal</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">std_dev_normal</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">samples_normal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">mean_normal</span><span class="p">,</span> <span class="n">std_dev_normal</span><span class="p">,</span> <span class="n">sample_size</span><span class="p">)</span>

<span class="c1"># Sample from the Exponential Distribution</span>
<span class="n">rate_exponential</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">samples_exponential</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">exponential</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">rate_exponential</span><span class="p">,</span> <span class="n">sample_size</span><span class="p">)</span>

<span class="c1"># Sample from the Uniform Distribution</span>
<span class="n">low_uniform</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">high_uniform</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">samples_uniform</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">low_uniform</span><span class="p">,</span> <span class="n">high_uniform</span><span class="p">,</span> <span class="n">sample_size</span><span class="p">)</span>

<span class="c1"># Sample from the Laplace Distribution</span>
<span class="n">loc_laplace</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">scale_laplace</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">samples_laplace</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">laplace</span><span class="p">(</span><span class="n">loc_laplace</span><span class="p">,</span> <span class="n">scale_laplace</span><span class="p">,</span> <span class="n">sample_size</span><span class="p">)</span>

<span class="c1"># Sample from the Poisson Distribution</span>
<span class="n">lam_poisson</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">samples_poisson</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">poisson</span><span class="p">(</span><span class="n">lam_poisson</span><span class="p">,</span> <span class="n">sample_size</span><span class="p">)</span>

<span class="c1"># Create histograms to visualize the distributions</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">samples_normal</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Normal Distribution&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">samples_exponential</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Exponential Distribution&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">samples_uniform</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Uniform Distribution&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">samples_laplace</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;purple&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Laplace Distribution&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">samples_poisson</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Poisson Distribution&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/333ea43c7d351f74181a064ee6fdb63cc0c84816cd3691751bf801ff04976cda.png" src="../_images/333ea43c7d351f74181a064ee6fdb63cc0c84816cd3691751bf801ff04976cda.png" />
</div>
</div>
<p>We can also sample from an existing sample to obtain a <strong>subsample</strong>. This can be done starting from a dataset. For instance, let us consider the <em>weight-height</em> dataset:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;http://antoninofurnari.it/downloads/height_weight.csv&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 4231 entries, 0 to 4230
Data columns (total 4 columns):
 #   Column  Non-Null Count  Dtype  
---  ------  --------------  -----  
 0   sex     4231 non-null   object 
 1   BMI     4231 non-null   float64
 2   height  4231 non-null   float64
 3   weight  4231 non-null   float64
dtypes: float64(3), object(1)
memory usage: 132.3+ KB
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sex</th>
      <th>BMI</th>
      <th>height</th>
      <th>weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>M</td>
      <td>33.36</td>
      <td>187.96</td>
      <td>117.933920</td>
    </tr>
    <tr>
      <th>1</th>
      <td>M</td>
      <td>26.54</td>
      <td>177.80</td>
      <td>83.914520</td>
    </tr>
    <tr>
      <th>2</th>
      <td>F</td>
      <td>32.13</td>
      <td>154.94</td>
      <td>77.110640</td>
    </tr>
    <tr>
      <th>3</th>
      <td>M</td>
      <td>26.62</td>
      <td>172.72</td>
      <td>79.378600</td>
    </tr>
    <tr>
      <th>4</th>
      <td>F</td>
      <td>27.13</td>
      <td>167.64</td>
      <td>76.203456</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We can obtain a subsample of 1000 observations as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample1</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">sample1</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
<span class="n">sample1</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Int64Index: 1000 entries, 3135 to 376
Data columns (total 4 columns):
 #   Column  Non-Null Count  Dtype  
---  ------  --------------  -----  
 0   sex     1000 non-null   object 
 1   BMI     1000 non-null   float64
 2   height  1000 non-null   float64
 3   weight  1000 non-null   float64
dtypes: float64(3), object(1)
memory usage: 39.1+ KB
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sex</th>
      <th>BMI</th>
      <th>height</th>
      <th>weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3135</th>
      <td>M</td>
      <td>24.02</td>
      <td>162.56</td>
      <td>63.50288</td>
    </tr>
    <tr>
      <th>2885</th>
      <td>M</td>
      <td>28.90</td>
      <td>172.72</td>
      <td>86.18248</td>
    </tr>
    <tr>
      <th>3136</th>
      <td>M</td>
      <td>22.80</td>
      <td>172.72</td>
      <td>68.03880</td>
    </tr>
    <tr>
      <th>3774</th>
      <td>M</td>
      <td>33.50</td>
      <td>180.34</td>
      <td>108.86208</td>
    </tr>
    <tr>
      <th>2203</th>
      <td>M</td>
      <td>26.52</td>
      <td>180.34</td>
      <td>86.18248</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Sampling will be random. As can be seen the indexes of the rows are shuffled. By default, Pandas will sample without replacement. We can sample with replacement specifying <code class="docutils literal notranslate"><span class="pre">replace=True</span></code>. For instance, we can obtain a larger sample (with repetitions) as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample2</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">5000</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">sample2</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
<span class="n">sample2</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Int64Index: 5000 entries, 1724 to 2400
Data columns (total 4 columns):
 #   Column  Non-Null Count  Dtype  
---  ------  --------------  -----  
 0   sex     5000 non-null   object 
 1   BMI     5000 non-null   float64
 2   height  5000 non-null   float64
 3   weight  5000 non-null   float64
dtypes: float64(3), object(1)
memory usage: 195.3+ KB
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sex</th>
      <th>BMI</th>
      <th>height</th>
      <th>weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1724</th>
      <td>M</td>
      <td>28.24</td>
      <td>187.96</td>
      <td>99.79024</td>
    </tr>
    <tr>
      <th>1714</th>
      <td>M</td>
      <td>24.43</td>
      <td>180.34</td>
      <td>79.37860</td>
    </tr>
    <tr>
      <th>2737</th>
      <td>F</td>
      <td>21.93</td>
      <td>157.48</td>
      <td>54.43104</td>
    </tr>
    <tr>
      <th>3262</th>
      <td>F</td>
      <td>32.13</td>
      <td>154.94</td>
      <td>77.11064</td>
    </tr>
    <tr>
      <th>3154</th>
      <td>M</td>
      <td>25.81</td>
      <td>177.80</td>
      <td>81.64656</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We expect the samples to show similar distributions. Let’s check it:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">data</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">box</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">131</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">sample1</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">box</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">132</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">sample2</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">box</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">133</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/6c43b57b257c1d9b84877aa7de4681f5506c36092148e3369446333dd645c139.png" src="../_images/6c43b57b257c1d9b84877aa7de4681f5506c36092148e3369446333dd645c139.png" />
</div>
</div>
<p>Alternatively, we can sample using <code class="docutils literal notranslate"><span class="pre">np.random.choice</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample3</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">),</span><span class="mi">100</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)]</span>
<span class="n">sample3</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
<span class="n">sample3</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Int64Index: 100 entries, 217 to 708
Data columns (total 4 columns):
 #   Column  Non-Null Count  Dtype  
---  ------  --------------  -----  
 0   sex     100 non-null    object 
 1   BMI     100 non-null    float64
 2   height  100 non-null    float64
 3   weight  100 non-null    float64
dtypes: float64(3), object(1)
memory usage: 3.9+ KB
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sex</th>
      <th>BMI</th>
      <th>height</th>
      <th>weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>217</th>
      <td>F</td>
      <td>37.11</td>
      <td>152.40</td>
      <td>86.182480</td>
    </tr>
    <tr>
      <th>4036</th>
      <td>F</td>
      <td>33.28</td>
      <td>165.10</td>
      <td>90.718400</td>
    </tr>
    <tr>
      <th>2512</th>
      <td>F</td>
      <td>28.01</td>
      <td>160.02</td>
      <td>71.667536</td>
    </tr>
    <tr>
      <th>2235</th>
      <td>F</td>
      <td>27.45</td>
      <td>167.64</td>
      <td>77.110640</td>
    </tr>
    <tr>
      <th>1299</th>
      <td>M</td>
      <td>27.30</td>
      <td>175.26</td>
      <td>83.914520</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Note that, bu default <code class="docutils literal notranslate"><span class="pre">np.random.choice</span></code> will set <code class="docutils literal notranslate"><span class="pre">replace=True</span></code>. We can perform stratified sampling as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define the stratification variable (e.g., &#39;Gender&#39;)</span>
<span class="n">strata_variable</span> <span class="o">=</span> <span class="s1">&#39;sex&#39;</span>

<span class="c1"># Number of samples per stratum</span>
<span class="n">samples_per_stratum</span> <span class="o">=</span> <span class="mi">500</span>

<span class="c1"># Perform stratified sampling</span>
<span class="n">stratified_sample</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">strata_variable</span><span class="p">,</span> <span class="n">group_keys</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">samples_per_stratum</span><span class="p">))</span>

<span class="n">stratified_sample</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
<span class="n">stratified_sample</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Int64Index: 1000 entries, 3274 to 358
Data columns (total 4 columns):
 #   Column  Non-Null Count  Dtype  
---  ------  --------------  -----  
 0   sex     1000 non-null   object 
 1   BMI     1000 non-null   float64
 2   height  1000 non-null   float64
 3   weight  1000 non-null   float64
dtypes: float64(3), object(1)
memory usage: 39.1+ KB
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sex</th>
      <th>BMI</th>
      <th>height</th>
      <th>weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3274</th>
      <td>F</td>
      <td>20.58</td>
      <td>162.56</td>
      <td>54.43104</td>
    </tr>
    <tr>
      <th>2188</th>
      <td>F</td>
      <td>18.87</td>
      <td>162.56</td>
      <td>49.89512</td>
    </tr>
    <tr>
      <th>950</th>
      <td>F</td>
      <td>21.18</td>
      <td>149.86</td>
      <td>47.62716</td>
    </tr>
    <tr>
      <th>2623</th>
      <td>F</td>
      <td>26.59</td>
      <td>162.56</td>
      <td>70.30676</td>
    </tr>
    <tr>
      <th>2350</th>
      <td>F</td>
      <td>28.80</td>
      <td>175.26</td>
      <td>88.45044</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Note that, with this method, sampled observations will be sorted by <code class="docutils literal notranslate"><span class="pre">sex</span></code>. To get rid of this bias, we can shuffle the dataframe as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stratified_sample</span> <span class="o">=</span> <span class="n">stratified_sample</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">stratified_sample</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">stratified_sample</span><span class="p">),</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)]</span>
<span class="n">stratified_sample</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sex</th>
      <th>BMI</th>
      <th>height</th>
      <th>weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2894</th>
      <td>F</td>
      <td>24.36</td>
      <td>162.56</td>
      <td>64.410064</td>
    </tr>
    <tr>
      <th>2479</th>
      <td>F</td>
      <td>26.63</td>
      <td>165.10</td>
      <td>72.574720</td>
    </tr>
    <tr>
      <th>275</th>
      <td>F</td>
      <td>29.76</td>
      <td>170.18</td>
      <td>86.182480</td>
    </tr>
    <tr>
      <th>2394</th>
      <td>F</td>
      <td>22.32</td>
      <td>162.56</td>
      <td>58.966960</td>
    </tr>
    <tr>
      <th>1125</th>
      <td>F</td>
      <td>22.85</td>
      <td>160.02</td>
      <td>58.513368</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Males and females will be perfectly balanced by design in this stratified sample:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stratified_sample</span><span class="p">[</span><span class="s1">&#39;sex&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>F    500
M    500
Name: sex, dtype: int64
</pre></div>
</div>
</div>
</div>
</section>
<section id="confidence-intervals">
<h3><span class="section-number">23.2. </span>Confidence Intervals<a class="headerlink" href="#confidence-intervals" title="Permalink to this heading">#</a></h3>
<p>Let us see how to compute confidence intervals in Python.</p>
<section id="confidence-intervals-for-means">
<h4><span class="section-number">23.2.1. </span>Confidence Intervals for Means<a class="headerlink" href="#confidence-intervals-for-means" title="Permalink to this heading">#</a></h4>
<p>We can compute confidence intervals for the estimation of means with <code class="docutils literal notranslate"><span class="pre">scipy</span></code>. Let us see how to compute confidence intervals for the mean of <code class="docutils literal notranslate"><span class="pre">height</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>
<span class="n">mean</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">])</span>
<span class="n">standard_error</span> <span class="o">=</span> <span class="n">std</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>

<span class="n">confidence_level</span> <span class="o">=</span> <span class="mf">0.95</span>

<span class="n">interval</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">interval</span><span class="p">(</span><span class="n">confidence_level</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">mean</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">standard_error</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Estimated mean: </span><span class="si">{</span><span class="n">mean</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Standard deviation of the sample: </span><span class="si">{</span><span class="n">std</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Standard error of the sample: </span><span class="si">{</span><span class="n">standard_error</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Confidence interval: [</span><span class="si">{</span><span class="n">interval</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">interval</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Estimated mean: 169.89
Standard deviation of the sample: 9.96
Standard error of the sample: 0.15
Confidence interval: [169.59, 170.19]
</pre></div>
</div>
</div>
</div>
<p>Let us set the confidence level to <span class="math notranslate nohighlight">\(0.99\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>
<span class="n">mean</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">])</span>
<span class="n">standard_error</span> <span class="o">=</span> <span class="n">std</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>

<span class="n">confidence_level</span> <span class="o">=</span> <span class="mf">0.99</span>

<span class="n">interval</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">interval</span><span class="p">(</span><span class="n">confidence_level</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">mean</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">standard_error</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Estimated mean: </span><span class="si">{</span><span class="n">mean</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Standard deviation of the sample: </span><span class="si">{</span><span class="n">std</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Standard error of the sample: </span><span class="si">{</span><span class="n">standard_error</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Confidence interval: [</span><span class="si">{</span><span class="n">interval</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">interval</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Estimated mean: 169.89
Standard deviation of the sample: 9.96
Standard error of the sample: 0.15
Confidence interval: [169.50, 170.29]
</pre></div>
</div>
</div>
</div>
</section>
<section id="confidence-intervals-for-variances">
<h4><span class="section-number">23.2.2. </span>Confidence Intervals for Variances<a class="headerlink" href="#confidence-intervals-for-variances" title="Permalink to this heading">#</a></h4>
<p>To compute confidence intervals for the estimation of variances, we have to use the <span class="math notranslate nohighlight">\(\chi^2\)</span> distribution:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>

<span class="c1"># Set the desired confidence level</span>
<span class="n">confidence_level</span> <span class="o">=</span> <span class="mf">0.95</span>  <span class="c1"># Change this to the desired confidence level (e.g., 0.95 for 95% confidence)</span>

<span class="c1"># Calculate the confidence interval for the population variance</span>
<span class="n">confidence_interval</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">chi2</span><span class="o">.</span><span class="n">interval</span><span class="p">(</span><span class="n">confidence_level</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># Calculate the sample variance</span>
<span class="n">sample_variance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">],</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># ddof=1 for sample variance</span>

<span class="c1"># Calculate the lower and upper bounds of the confidence interval</span>
<span class="n">variance_lower</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">sample_variance</span> <span class="o">/</span> <span class="n">confidence_interval</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">variance_upper</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">sample_variance</span> <span class="o">/</span> <span class="n">confidence_interval</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sample Variance: </span><span class="si">{</span><span class="n">sample_variance</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Confidence Interval for Variance: (</span><span class="si">{</span><span class="n">variance_lower</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">variance_upper</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sample Variance: 99.13
Confidence Interval for Variance: (95.04, 103.49)
</pre></div>
</div>
</div>
</div>
</section>
<section id="confidence-intervals-for-proportion">
<h4><span class="section-number">23.2.3. </span>Confidence Intervals for Proportion<a class="headerlink" href="#confidence-intervals-for-proportion" title="Permalink to this heading">#</a></h4>
<p>Let us see how to compute confidence intervals for the proportion of females over males:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">females</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;sex&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()[</span><span class="s1">&#39;F&#39;</span><span class="p">]</span>
<span class="n">total</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="c1"># Set the desired confidence level</span>
<span class="n">confidence_level</span> <span class="o">=</span> <span class="mf">0.95</span>  <span class="c1"># Change this to the desired confidence level (e.g., 0.95 for 95% confidence)</span>

<span class="c1"># Calculate the proportion (sample proportion)</span>
<span class="n">proportion</span> <span class="o">=</span> <span class="n">females</span> <span class="o">/</span> <span class="n">total</span>

<span class="c1"># Compute the confidence interval for the proportion</span>
<span class="n">conf_interval</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">proportion_confint</span><span class="p">(</span><span class="n">females</span><span class="p">,</span> <span class="n">total</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span> <span class="o">-</span> <span class="n">confidence_level</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;normal&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sample Proportion: </span><span class="si">{</span><span class="n">proportion</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Confidence Interval for Proportion: (</span><span class="si">{</span><span class="n">conf_interval</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">conf_interval</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sample Proportion: 0.54
Confidence Interval for Proportion: (0.53, 0.56)
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="hypothesis-testing">
<h3><span class="section-number">23.3. </span>Hypothesis Testing<a class="headerlink" href="#hypothesis-testing" title="Permalink to this heading">#</a></h3>
<p>Let us see now the main hypothesis tests.</p>
<section id="one-sample-t-test">
<h4><span class="section-number">23.3.1. </span>One sample t-test<a class="headerlink" href="#one-sample-t-test" title="Permalink to this heading">#</a></h4>
<p>This test allows to assess whether a sample has a given mean. Let us check if the average height in our dataset is equal to <span class="math notranslate nohighlight">\(170cm\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>

<span class="c1"># Define the null hypothesis mean (population mean you want to test against)</span>
<span class="n">null_hypothesis_mean</span> <span class="o">=</span> <span class="mi">170</span>

<span class="c1"># Perform a one-sample t-test</span>
<span class="n">t_stat</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">ttest_1samp</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">],</span> <span class="n">null_hypothesis_mean</span><span class="p">)</span>

<span class="c1"># Set the desired significance level (alpha)</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.05</span>

<span class="c1"># Check the p-value against the significance level</span>
<span class="k">if</span> <span class="n">p_value</span> <span class="o">&lt;</span> <span class="n">alpha</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Reject the null hypothesis. The data provides enough evidence to conclude that the population mean is different from </span><span class="si">{</span><span class="n">null_hypothesis_mean</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fail to reject the null hypothesis. The data does not provide enough evidence to conclude that the population mean is different from </span><span class="si">{</span><span class="n">null_hypothesis_mean</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;t-statistic: </span><span class="si">{</span><span class="n">t_stat</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;P-value: </span><span class="si">{</span><span class="n">p_value</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Fail to reject the null hypothesis. The data does not provide enough evidence to conclude that the population mean is different from 170.
t-statistic: -0.69
P-value: 0.4872
</pre></div>
</div>
</div>
</div>
<p>Let us now check if the average height is <span class="math notranslate nohighlight">\(170\)</span> among males only:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>

<span class="c1"># Define the null hypothesis mean (population mean you want to test against)</span>
<span class="n">null_hypothesis_mean</span> <span class="o">=</span> <span class="mi">170</span>

<span class="n">data2</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;sex&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;M&#39;</span><span class="p">]</span>

<span class="c1"># Perform a one-sample t-test</span>
<span class="n">t_stat</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">ttest_1samp</span><span class="p">(</span><span class="n">data2</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">],</span> <span class="n">null_hypothesis_mean</span><span class="p">)</span>

<span class="c1"># Set the desired significance level (alpha)</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.05</span>

<span class="c1"># Check the p-value against the significance level</span>
<span class="k">if</span> <span class="n">p_value</span> <span class="o">&lt;</span> <span class="n">alpha</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Reject the null hypothesis. The data provides enough evidence to conclude that the population mean is different from </span><span class="si">{</span><span class="n">null_hypothesis_mean</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fail to reject the null hypothesis. The data does not provide enough evidence to conclude that the population mean is different from </span><span class="si">{</span><span class="n">null_hypothesis_mean</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;t-statistic: </span><span class="si">{</span><span class="n">t_stat</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;P-value: </span><span class="si">{</span><span class="n">p_value</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Reject the null hypothesis. The data provides enough evidence to conclude that the population mean is different from 170.
t-statistic: 45.52
P-value: 0.0000
</pre></div>
</div>
</div>
</div>
</section>
<section id="two-sample-t-test">
<h4><span class="section-number">23.3.2. </span>Two-sample t-test<a class="headerlink" href="#two-sample-t-test" title="Permalink to this heading">#</a></h4>
<p>Let us now check if males and females have the same average height:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">scipy.stats</span> <span class="k">as</span> <span class="nn">stats</span>

<span class="n">male_h</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;sex&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;M&#39;</span><span class="p">][</span><span class="s1">&#39;height&#39;</span><span class="p">]</span>
<span class="n">female_h</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;sex&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;F&#39;</span><span class="p">][</span><span class="s1">&#39;height&#39;</span><span class="p">]</span>

<span class="c1"># Perform independent two-sample t-test</span>
<span class="n">t_stat</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">ttest_ind</span><span class="p">(</span><span class="n">male_h</span><span class="p">,</span> <span class="n">female_h</span><span class="p">)</span>

<span class="c1"># Define significance level (alpha)</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.05</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Test statistic: </span><span class="si">{</span><span class="n">t_stat</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Significance level: </span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;P-value: </span><span class="si">{</span><span class="n">p_value</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Comment on result</span>
<span class="k">if</span> <span class="n">p_value</span> <span class="o">&lt;</span> <span class="n">alpha</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Conclusion: there is a significant difference between the mean exam scores of the two classes.&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Conclusion: there is no significant difference between the mean exam scores of the two classes.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Test statistic: 66.95
Significance level: 0.05
P-value: 0.00
Conclusion: there is a significant difference between the mean exam scores of the two classes.
</pre></div>
</div>
</div>
</div>
<p>Let us now compare the average heights in two samples we previously obtained via random sampling. We expect no differences:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">scipy.stats</span> <span class="k">as</span> <span class="nn">stats</span>

<span class="n">h1</span> <span class="o">=</span> <span class="n">sample1</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">]</span>
<span class="n">h2</span> <span class="o">=</span> <span class="n">sample2</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">]</span>

<span class="c1"># Perform independent two-sample t-test</span>
<span class="n">t_stat</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">ttest_ind</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">)</span>

<span class="c1"># Define significance level (alpha)</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.05</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Test statistic: </span><span class="si">{</span><span class="n">t_stat</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Significance level: </span><span class="si">{</span><span class="n">alpha</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;P-value: </span><span class="si">{</span><span class="n">p_value</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Comment on result</span>
<span class="k">if</span> <span class="n">p_value</span> <span class="o">&lt;</span> <span class="n">alpha</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Conclusion: there is a significant difference between the mean exam scores of the two classes.&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Conclusion: there is no significant difference between the mean exam scores of the two classes.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Test statistic: 0.52
Significance level: 0.05
P-value: 0.60
Conclusion: there is no significant difference between the mean exam scores of the two classes.
</pre></div>
</div>
</div>
</div>
</section>
<section id="chi-square-test-of-independence">
<h4><span class="section-number">23.3.3. </span>Chi-square test of independence<a class="headerlink" href="#chi-square-test-of-independence" title="Permalink to this heading">#</a></h4>
<p>Let us consider the Titanic dataset:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">titanic</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/agconti/kaggle-titanic/master/data/train.csv&#39;</span><span class="p">,</span>
                     <span class="n">index_col</span><span class="o">=</span><span class="s1">&#39;PassengerId&#39;</span><span class="p">)</span>
<span class="n">titanic</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Name</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>Cabin</th>
      <th>Embarked</th>
    </tr>
    <tr>
      <th>PassengerId</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>3</td>
      <td>Braund, Mr. Owen Harris</td>
      <td>male</td>
      <td>22.0</td>
      <td>1</td>
      <td>0</td>
      <td>A/5 21171</td>
      <td>7.2500</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>1</td>
      <td>Cumings, Mrs. John Bradley (Florence Briggs Th...</td>
      <td>female</td>
      <td>38.0</td>
      <td>1</td>
      <td>0</td>
      <td>PC 17599</td>
      <td>71.2833</td>
      <td>C85</td>
      <td>C</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>3</td>
      <td>Heikkinen, Miss. Laina</td>
      <td>female</td>
      <td>26.0</td>
      <td>0</td>
      <td>0</td>
      <td>STON/O2. 3101282</td>
      <td>7.9250</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>1</td>
      <td>Futrelle, Mrs. Jacques Heath (Lily May Peel)</td>
      <td>female</td>
      <td>35.0</td>
      <td>1</td>
      <td>0</td>
      <td>113803</td>
      <td>53.1000</td>
      <td>C123</td>
      <td>S</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0</td>
      <td>3</td>
      <td>Allen, Mr. William Henry</td>
      <td>male</td>
      <td>35.0</td>
      <td>0</td>
      <td>0</td>
      <td>373450</td>
      <td>8.0500</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>887</th>
      <td>0</td>
      <td>2</td>
      <td>Montvila, Rev. Juozas</td>
      <td>male</td>
      <td>27.0</td>
      <td>0</td>
      <td>0</td>
      <td>211536</td>
      <td>13.0000</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>888</th>
      <td>1</td>
      <td>1</td>
      <td>Graham, Miss. Margaret Edith</td>
      <td>female</td>
      <td>19.0</td>
      <td>0</td>
      <td>0</td>
      <td>112053</td>
      <td>30.0000</td>
      <td>B42</td>
      <td>S</td>
    </tr>
    <tr>
      <th>889</th>
      <td>0</td>
      <td>3</td>
      <td>Johnston, Miss. Catherine Helen "Carrie"</td>
      <td>female</td>
      <td>NaN</td>
      <td>1</td>
      <td>2</td>
      <td>W./C. 6607</td>
      <td>23.4500</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>890</th>
      <td>1</td>
      <td>1</td>
      <td>Behr, Mr. Karl Howell</td>
      <td>male</td>
      <td>26.0</td>
      <td>0</td>
      <td>0</td>
      <td>111369</td>
      <td>30.0000</td>
      <td>C148</td>
      <td>C</td>
    </tr>
    <tr>
      <th>891</th>
      <td>0</td>
      <td>3</td>
      <td>Dooley, Mr. Patrick</td>
      <td>male</td>
      <td>32.0</td>
      <td>0</td>
      <td>0</td>
      <td>370376</td>
      <td>7.7500</td>
      <td>NaN</td>
      <td>Q</td>
    </tr>
  </tbody>
</table>
<p>891 rows × 11 columns</p>
</div></div></div>
</div>
<p>We want to check if <code class="docutils literal notranslate"><span class="pre">Sex</span></code> and <code class="docutils literal notranslate"><span class="pre">Survived</span></code> are independent. Let us see the contingency table:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">contingency_table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Sex&#39;</span><span class="p">],</span> <span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Survived&#39;</span><span class="p">])</span>
<span class="n">contingency_table</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Survived</th>
      <th>0</th>
      <th>1</th>
    </tr>
    <tr>
      <th>Sex</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>female</th>
      <td>81</td>
      <td>233</td>
    </tr>
    <tr>
      <th>male</th>
      <td>468</td>
      <td>109</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Let us visualize the result:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Sex&#39;</span><span class="p">],</span> <span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Survived&#39;</span><span class="p">],</span> <span class="n">normalize</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">stacked</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/6dcd1b619d7a54ad8883c0425936607758f6cc057733643f4ee757b9effa56ee.png" src="../_images/6dcd1b619d7a54ad8883c0425936607758f6cc057733643f4ee757b9effa56ee.png" />
</div>
</div>
<p>We expect some form of correlation. Indeed, if we compute Pearson <span class="math notranslate nohighlight">\(\chi^2\)</span> statistic and Cramer V statistic, we obtain:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">chi2_contingency</span>
<span class="kn">from</span> <span class="nn">scipy.stats.contingency</span> <span class="kn">import</span> <span class="n">association</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Chi-square statistic: </span><span class="si">{</span><span class="n">chi2_contingency</span><span class="p">(</span><span class="n">contingency_table</span><span class="p">)</span><span class="o">.</span><span class="n">statistic</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cramer V statistic: </span><span class="si">{</span><span class="n">association</span><span class="p">(</span><span class="n">contingency_table</span><span class="p">)</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chi-square statistic: 260.72
Cramer V statistic: 0.54
</pre></div>
</div>
</div>
</div>
<p>Let us check if this is statistically significant with a <span class="math notranslate nohighlight">\(\chi^2\)</span> test of independence:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">chi2_contingency</span>

<span class="c1"># Perform the Chi-Square Test for Independence</span>
<span class="n">chi2</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">chi2_contingency</span><span class="p">(</span><span class="n">contingency_table</span><span class="p">)</span>

<span class="c1"># Set the significance level (alpha)</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.05</span>

<span class="c1"># Print the results</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Chi-Square Statistic:&quot;</span><span class="p">,</span> <span class="n">chi2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;p-value:&quot;</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>

<span class="c1"># Interpret the results</span>
<span class="k">if</span> <span class="n">p</span> <span class="o">&lt;</span> <span class="n">alpha</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">There is a significant association between &#39;Sex&#39; and &#39;survived&#39;.&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">There is no significant association between &#39;Sex&#39; and &#39;survived&#39;.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chi-Square Statistic: 260.71702016732104
p-value: 1.1973570627755645e-58

There is a significant association between &#39;Sex&#39; and &#39;survived&#39;.
</pre></div>
</div>
</div>
</div>
</section>
<section id="chi-square-goodness-of-fit-test">
<h4><span class="section-number">23.3.4. </span>Chi-Square Goodness-of-Fit Test<a class="headerlink" href="#chi-square-goodness-of-fit-test" title="Permalink to this heading">#</a></h4>
<p>The Chi-Square Goodness of Fit test allows to determine whether observed frequencies fit a specified distribution or expected frequencies.</p>
<p>As we can imagine, the distribution of <code class="docutils literal notranslate"><span class="pre">sex</span></code> in the Titanic dataset is not uniform:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Sex&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/50df7af5ea698983406532a20440cf98eb0a4663fa30902355d2b0e095a330e9.png" src="../_images/50df7af5ea698983406532a20440cf98eb0a4663fa30902355d2b0e095a330e9.png" />
</div>
</div>
<p>The counts of males and females are:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Sex&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>male      577
female    314
Name: Sex, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>This difference is probably not just due to sampling. Let us run a <span class="math notranslate nohighlight">\(\chi^2\)</span> goodness of fit test to check if this distribution is significantly different from the uniform distribution of frequencies:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">chisquare</span>

<span class="n">observed_frequencies</span> <span class="o">=</span> <span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Sex&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># Define expected frequencies that closely match the observed data</span>
<span class="n">expected_frequencies</span> <span class="o">=</span> <span class="p">[</span><span class="n">observed_frequencies</span><span class="o">.</span><span class="n">mean</span><span class="p">()]</span><span class="o">*</span><span class="mi">2</span>

<span class="n">chi2</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">chisquare</span><span class="p">(</span><span class="n">f_obs</span><span class="o">=</span><span class="n">observed_frequencies</span><span class="p">,</span> <span class="n">f_exp</span><span class="o">=</span><span class="n">expected_frequencies</span><span class="p">)</span>

<span class="c1"># Set the significance level (alpha)</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.05</span>

<span class="c1"># Print the results</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Observed Frequencies:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">observed_frequencies</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Expected Frequencies:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">expected_frequencies</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Chi-Square Statistic:&quot;</span><span class="p">,</span> <span class="n">chi2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;p-value:&quot;</span><span class="p">,</span> <span class="n">p_value</span><span class="p">)</span>

<span class="c1"># Interpret the results</span>
<span class="k">if</span> <span class="n">p_value</span> <span class="o">&lt;</span> <span class="n">alpha</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">The observed data significantly deviates from the expected distribution.&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">The observed data fits the expected distribution.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Observed Frequencies:
[577 314]

Expected Frequencies:
[445.5, 445.5]

Chi-Square Statistic: 77.63075196408529
p-value: 1.2422095313910336e-18

The observed data significantly deviates from the expected distribution.
</pre></div>
</div>
</div>
</div>
<p>As expected, there is a significant deviation. As seen in the lecture, let us now check if <code class="docutils literal notranslate"><span class="pre">sex</span></code> is equally distributed among kids:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">minor</span><span class="o">=</span><span class="n">titanic</span><span class="p">[</span><span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">18</span><span class="p">]</span>
<span class="n">observed_frequencies</span> <span class="o">=</span> <span class="n">minor</span><span class="p">[</span><span class="s1">&#39;Sex&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="n">observed_frequencies</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">observed_frequencies</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/88bdfbf63a201fd6efcfd0f15004652f39282a265ad23fdbe225619bb8f7d373.png" src="../_images/88bdfbf63a201fd6efcfd0f15004652f39282a265ad23fdbe225619bb8f7d373.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>male      58
female    55
Name: Sex, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>This looks less biased, but there are still minor differences between the counts. Are these due to chance? Let us run a <span class="math notranslate nohighlight">\(\chi^2\)</span> goodness of fit test:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">chisquare</span>

<span class="c1"># Load the Titanic dataset</span>
<span class="n">titanic_data</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;titanic&quot;</span><span class="p">)</span>

<span class="n">observed_frequencies</span> <span class="o">=</span> <span class="n">minor</span><span class="p">[</span><span class="s1">&#39;Sex&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># Define expected frequencies that closely match the observed data</span>
<span class="n">expected_frequencies</span> <span class="o">=</span> <span class="p">[</span><span class="mi">113</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">113</span><span class="o">/</span><span class="mi">2</span><span class="p">]</span>

<span class="n">chi2</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">chisquare</span><span class="p">(</span><span class="n">f_obs</span><span class="o">=</span><span class="n">observed_frequencies</span><span class="p">,</span> <span class="n">f_exp</span><span class="o">=</span><span class="n">expected_frequencies</span><span class="p">)</span>

<span class="c1"># Set the significance level (alpha)</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.05</span>

<span class="c1"># Print the results</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Observed Frequencies:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">observed_frequencies</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Expected Frequencies:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">expected_frequencies</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Chi-Square Statistic:&quot;</span><span class="p">,</span> <span class="n">chi2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;p-value:&quot;</span><span class="p">,</span> <span class="n">p_value</span><span class="p">)</span>

<span class="c1"># Interpret the results</span>
<span class="k">if</span> <span class="n">p_value</span> <span class="o">&lt;</span> <span class="n">alpha</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">The observed data significantly deviates from the expected distribution.&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">The observed data fits the expected distribution.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Observed Frequencies:
[58 55]

Expected Frequencies:
[56.5, 56.5]

Chi-Square Statistic: 0.07964601769911504
p-value: 0.7777776907897473

The observed data fits the expected distribution.
</pre></div>
</div>
</div>
</div>
<p>Since the p-value is large, we could not reject the null hypothesis and we can conclude that there is no significant difference between observed and expected frequencies.</p>
</section>
<section id="pearson-spearman-kendall-correlation-test">
<h4><span class="section-number">23.3.5. </span>Pearson/Spearman/Kendall Correlation Test<a class="headerlink" href="#pearson-spearman-kendall-correlation-test" title="Permalink to this heading">#</a></h4>
<p>We can easily compute correlation coefficients and the p-value of the related statistical tests using <code class="docutils literal notranslate"><span class="pre">scipy</span></code>. Let us see some examples:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">pearsonr</span><span class="p">,</span> <span class="n">spearmanr</span><span class="p">,</span> <span class="n">kendalltau</span>

<span class="n">pr</span><span class="p">,</span> <span class="n">pr_pvalue</span> <span class="o">=</span> <span class="n">pearsonr</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">])</span>
<span class="n">sr</span><span class="p">,</span> <span class="n">sr_pvalue</span> <span class="o">=</span> <span class="n">spearmanr</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">])</span>
<span class="n">kt</span><span class="p">,</span> <span class="n">kt_pvalue</span> <span class="o">=</span> <span class="n">kendalltau</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Person r: </span><span class="si">{</span><span class="n">pr</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">. P-value: </span><span class="si">{</span><span class="n">pr_pvalue</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Spearman r: </span><span class="si">{</span><span class="n">sr</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">. P-value: </span><span class="si">{</span><span class="n">sr_pvalue</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Kendall Tau r: </span><span class="si">{</span><span class="n">kt</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">. P-value: </span><span class="si">{</span><span class="n">kt_pvalue</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Person r: 0.52. P-value: 0.00
Spearman r: 0.53. P-value: 0.00
Kendall Tau r: 0.39. P-value: 0.00
</pre></div>
</div>
</div>
</div>
<p>All correlations are statistically relevant. Let us now check if there is a significant correlation between <code class="docutils literal notranslate"><span class="pre">Age</span></code> and <code class="docutils literal notranslate"><span class="pre">Fare</span></code>. Let us first visualize the scatterplot:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">titanic</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Age&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Fare&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/9af90fc2a2513ed1854ac8bb175a1dcbe0f4c650ea2add3ab0d284378bcd4bef.png" src="../_images/9af90fc2a2513ed1854ac8bb175a1dcbe0f4c650ea2add3ab0d284378bcd4bef.png" />
</div>
</div>
<p>It looks like there is no correlation. If we compute Pearson correlation coefficient, we get a value close to zero:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pr</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">pearsonr</span><span class="p">(</span><span class="n">titanic</span><span class="o">.</span><span class="n">dropna</span><span class="p">()[</span><span class="s1">&#39;Age&#39;</span><span class="p">],</span> <span class="n">titanic</span><span class="o">.</span><span class="n">dropna</span><span class="p">()[</span><span class="s1">&#39;Fare&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">pr</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-0.09
</pre></div>
</div>
</div>
</div>
<p>Is this a small negative correlation, or is this value due to chance? Let us have a look at p-values:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pr</span><span class="p">,</span> <span class="n">pr_pvalue</span> <span class="o">=</span> <span class="n">pearsonr</span><span class="p">(</span><span class="n">titanic</span><span class="o">.</span><span class="n">dropna</span><span class="p">()[</span><span class="s1">&#39;Age&#39;</span><span class="p">],</span> <span class="n">titanic</span><span class="o">.</span><span class="n">dropna</span><span class="p">()[</span><span class="s1">&#39;Fare&#39;</span><span class="p">])</span>
<span class="n">sr</span><span class="p">,</span> <span class="n">sr_pvalue</span> <span class="o">=</span> <span class="n">spearmanr</span><span class="p">(</span><span class="n">titanic</span><span class="o">.</span><span class="n">dropna</span><span class="p">()[</span><span class="s1">&#39;Age&#39;</span><span class="p">],</span> <span class="n">titanic</span><span class="o">.</span><span class="n">dropna</span><span class="p">()[</span><span class="s1">&#39;Fare&#39;</span><span class="p">])</span>
<span class="n">kt</span><span class="p">,</span> <span class="n">kt_pvalue</span> <span class="o">=</span> <span class="n">kendalltau</span><span class="p">(</span><span class="n">titanic</span><span class="o">.</span><span class="n">dropna</span><span class="p">()[</span><span class="s1">&#39;Age&#39;</span><span class="p">],</span> <span class="n">titanic</span><span class="o">.</span><span class="n">dropna</span><span class="p">()[</span><span class="s1">&#39;Fare&#39;</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Person r: </span><span class="si">{</span><span class="n">pr</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">. P-value: </span><span class="si">{</span><span class="n">pr_pvalue</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Spearman r: </span><span class="si">{</span><span class="n">sr</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">. P-value: </span><span class="si">{</span><span class="n">sr_pvalue</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Kendall Tau r: </span><span class="si">{</span><span class="n">kt</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">. P-value: </span><span class="si">{</span><span class="n">kt_pvalue</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Person r: -0.09. P-value: 0.21
Spearman r: -0.08. P-value: 0.31
Kendall Tau r: -0.05. P-value: 0.31
</pre></div>
</div>
</div>
</div>
<p>P-values are large (<span class="math notranslate nohighlight">\(&gt;0.05\)</span>), so whatever we measured as a correlation is not reliable.</p>
</section>
</section>
<section id="normality-tests">
<h3><span class="section-number">23.4. </span>Normality Tests<a class="headerlink" href="#normality-tests" title="Permalink to this heading">#</a></h3>
<p>We can check for the normality of sample using Q-Q plots and normality tests. Let us see a Q-Q plot to check if <code class="docutils literal notranslate"><span class="pre">BMI</span></code> is normally distributed:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">statsmodels.graphics.gofplots</span> <span class="kn">import</span> <span class="n">qqplot</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="n">qqplot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;BMI&#39;</span><span class="p">],</span> <span class="n">fit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="s1">&#39;45&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/223674732c45acae757b10bce65254eaacfecc27a261ec0c20f81c0289025c26.png" src="../_images/223674732c45acae757b10bce65254eaacfecc27a261ec0c20f81c0289025c26.png" />
</div>
</div>
<p>We see deviations due to a skewed distribution. Let us check this against the density plot:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;BMI&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">density</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:ylabel=&#39;Density&#39;&gt;
</pre></div>
</div>
<img alt="../_images/c408bcf8988d16547000d7e292a3bb1440cb332cd2879a10557ff27f8b375275.png" src="../_images/c408bcf8988d16547000d7e292a3bb1440cb332cd2879a10557ff27f8b375275.png" />
</div>
</div>
<p>We can formally check with a Shapiro-Wilk test:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">shapiro</span>

<span class="c1"># Perform the Shapiro-Wilk test</span>
<span class="n">statistic</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">shapiro</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;BMI&#39;</span><span class="p">])</span>

<span class="c1"># Set the significance level (alpha)</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.05</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Test statistic: </span><span class="si">{</span><span class="n">statistic</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;P-value: </span><span class="si">{</span><span class="n">p_value</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Check the p-value against the significance level</span>
<span class="k">if</span> <span class="n">p_value</span> <span class="o">&gt;</span> <span class="n">alpha</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sample looks Gaussian (fail to reject H0)&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sample does not look Gaussian (reject H0)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Test statistic: 0.96
P-value: 0.00
Sample does not look Gaussian (reject H0)
</pre></div>
</div>
</div>
</div>
<p>For D’Agostino’s K-squares test, we just need to use <code class="docutils literal notranslate"><span class="pre">normaltest</span></code> instead of <code class="docutils literal notranslate"><span class="pre">shapiro</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">normaltest</span>

<span class="n">statistic</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">normaltest</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;BMI&#39;</span><span class="p">])</span>

<span class="c1"># Set the significance level (alpha)</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.05</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Test statistic: </span><span class="si">{</span><span class="n">statistic</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;P-value: </span><span class="si">{</span><span class="n">p_value</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Check the p-value against the significance level</span>
<span class="k">if</span> <span class="n">p_value</span> <span class="o">&gt;</span> <span class="n">alpha</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sample looks Gaussian (fail to reject H0)&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sample does not look Gaussian (reject H0)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Test statistic: 484.80
P-value: 0.00
Sample does not look Gaussian (reject H0)
</pre></div>
</div>
</div>
</div>
<p><strong>Word of Caution</strong>: normality tests such as the Shapiro-Wilk test may reject the hypothesis of Gaussianity for any large sample (even if approximately Gaussian), so we should use this test with caution.</p>
</section>
<section id="exercises">
<h3><span class="section-number">23.5. </span>Exercises<a class="headerlink" href="#exercises" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><p>🧑‍💻 Exercise 1</p>
<p>Consider the sample of all passengers in the titanic dataset. Compute the mean age of all passengers. Then, compute the confidence bounds for this mean setting the confidence level to 0.95. Is the estimated mean a reliable estimate of the population mean?</p>
</div></blockquote>
<blockquote>
<div><p>🧑‍💻 Exercise 2</p>
<p>Consider the samples of all passengers in the titanic dataset. Compute the variance of the ages of all passengers. Then, compute the confidence bounds for this variance setting the confidence level to 0.95. Is the estimated variance a reliable estimate of the population variance?</p>
</div></blockquote>
<blockquote>
<div><p>🧑‍💻 Exercise 3</p>
<p>Extract the sample of values of Sex of passengers in second class in the titanic dataset. Compute the contingency table of absolute counts of the Sex column. Compute the confidence bounds for the proportions of Sex in the sample. Are the estimated bounds reliable? Repeat the analysis for class 1 and 3.</p>
</div></blockquote>
<blockquote>
<div><p>🧑‍💻 Exercise 4</p>
<p>The average age of women in the US population is 40. Run a statistical test to assess whether the sample of ages in the <code class="docutils literal notranslate"><span class="pre">infert</span></code> dataset has the same mean as the US population. What is the result of the test? Are women in <code class="docutils literal notranslate"><span class="pre">infert</span></code> younger or older than the average?</p>
<p>You can load the dataset installing the <code class="docutils literal notranslate"><span class="pre">pydataset</span></code> library with <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">pydataset</span></code> and then:</p>
<p><code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">pydataset</span> <span class="pre">import</span> <span class="pre">data;</span> <span class="pre">infert</span> <span class="pre">=</span> <span class="pre">data(&quot;infert&quot;)</span></code></p>
</div></blockquote>
<blockquote>
<div><p>🧑‍💻 Exercise 5</p>
<p>Consider the <code class="docutils literal notranslate"><span class="pre">titanic</span></code> dataset. Follow these steps to assess that males and females <strong>are not equally distributed</strong>:</p>
<ul class="simple">
<li><p>Obtain a table of absolute frequencies of the values of <code class="docutils literal notranslate"><span class="pre">Sex</span></code>;</p></li>
<li><p>Show a barplot comparing the proportions of male and female passengers. Do these look equally distributed?</p></li>
<li><p>Run a statistical test to assess whether the proportion of males and females are equal (<span class="math notranslate nohighlight">\(p=0.5\)</span>). What is the result of the test?</p></li>
<li><p>Run the statistical test setting <span class="math notranslate nohighlight">\(p=1/3\)</span>. Is the result different? Can we reject the null hypothesis? Why?</p></li>
</ul>
</div></blockquote>
<blockquote>
<div><p>🧑‍💻 Exercise 6</p>
<p>Consider the samples of male and female passengers in the <code class="docutils literal notranslate"><span class="pre">titanic</span></code> dataset. Follow these steps to assess if the two populations related to the samples have significantly different ages:</p>
</div></blockquote>
<blockquote>
<div><ul class="simple">
<li><p>Show a barplot to compare the average age of female and male passengers. Are the ages different? Which group contain the younger subjects?</p></li>
<li><p>Obtain two separate samples of the ages of males and females;</p></li>
<li><p>Run a t-test to check if the means of the populations related to the two samples are significantly different or not. Comment on the results of the test.</p></li>
</ul>
</div></blockquote>
<blockquote>
<div><p>🧑‍💻 Exercise 7
Consider the <code class="docutils literal notranslate"><span class="pre">titanic</span></code> dataset and study the relationship between the <code class="docutils literal notranslate"><span class="pre">Pclass</span></code> and <code class="docutils literal notranslate"><span class="pre">Survived</span></code> variables following these steps:</p>
<ul class="simple">
<li><p>Compute the contingency table of absolute frequencies of the two variables;</p></li>
<li><p>Compute the table of conditional probabilities <span class="math notranslate nohighlight">\(P(Survived|Pclass)\)</span>;</p></li>
<li><p>Show a stacked bar plot reporting the proportions between survived and non-survived passengers with respect to the <code class="docutils literal notranslate"><span class="pre">Pclass</span></code> variable;</p></li>
<li><p>Run a Pearson’s Chi-Square test of independence to check if the differences in the observed proportions are statistically significant or not. Set the significance level to <span class="math notranslate nohighlight">\(0.95\)</span>.</p></li>
</ul>
</div></blockquote>
<blockquote>
<div><p>🧑‍💻 Exercise 8
Add a new <code class="docutils literal notranslate"><span class="pre">Old</span></code> column to the <code class="docutils literal notranslate"><span class="pre">titanic_train</span></code> dataframe. The values in the column should be <span class="math notranslate nohighlight">\(1\)</span> if the value of <code class="docutils literal notranslate"><span class="pre">Age</span></code> is larger than the median value of all ages in the dataframe and <span class="math notranslate nohighlight">\(0\)</span> otherwise. Study the influence of the variable <code class="docutils literal notranslate"><span class="pre">Sex</span></code> on the proportions of <code class="docutils literal notranslate"><span class="pre">Old</span></code> following these steps:</p>
<ul class="simple">
<li><p>Create a contingency table with the <code class="docutils literal notranslate"><span class="pre">Sex</span></code> variable on the rows and the <code class="docutils literal notranslate"><span class="pre">Old</span></code> variable on the columns;</p></li>
<li><p>Obtain a table of the conditional probabilities <span class="math notranslate nohighlight">\(P(Old|Sex)\)</span>. Are the proportions different in the groups defined by the <code class="docutils literal notranslate"><span class="pre">Sex</span></code> variable?</p></li>
<li><p>Show a stacked bar plot to display these proportions;</p></li>
<li><p>Run a Pearson’s Chi-Squared test of independence to assess if the observed differences are statistically relevant.</p></li>
</ul>
</div></blockquote>
</section>
</section>
<span id="document-laboratories/11_regressione_lineare"></span><section class="tex2jax_ignore mathjax_ignore" id="laboratorio-su-regressione-lineare">
<h2><span class="section-number">24. </span>Laboratorio su Regressione Lineare<a class="headerlink" href="#laboratorio-su-regressione-lineare" title="Permalink to this heading">#</a></h2>
<p>La regressione lineare ci permette di modellare la relazione tra una <strong>variabile dipendente</strong> <span class="math notranslate nohighlight">\(y\)</span> e una o più <strong>variabili indipendenti</strong> (o regressori) <span class="math notranslate nohighlight">\(x_i\)</span>. Ciò avviene definendo il seguente modello parametrico:</p>
<div class="math notranslate nohighlight">
\[
y = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + \ldots + \beta_n x_n + \epsilon
\]</div>
<p>dove:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\beta_0, \ldots, \beta_n\)</span> sono i parametri del modello;</p></li>
<li><p><span class="math notranslate nohighlight">\(\beta_0\)</span> è l’intercetta;</p></li>
<li><p><span class="math notranslate nohighlight">\(\beta_1, \ldots, \beta_n\)</span> sono detti <em>coefficienti di regressione</em>;</p></li>
<li><p><span class="math notranslate nohighlight">\(n\)</span> è il numero di variabili indipendenti <span class="math notranslate nohighlight">\(x_i\)</span>;</p></li>
<li><p><span class="math notranslate nohighlight">\(\epsilon\)</span> è il termine di errore (o rumore), ovvero la parte di <span class="math notranslate nohighlight">\(y\)</span> che la regressione “non riesce a spiegare”.</p></li>
</ul>
<p>Dato un insieme di dati, è possibile stimare i parametri ottimali <span class="math notranslate nohighlight">\(\beta_0\)</span> e <span class="math notranslate nohighlight">\(\mathbf{\beta}\)</span> del regressore lineare mediante una procedura di ottimizzazione. Il regressore calcolato fornisce un modello in grado di spiegare le relazioni (lineari) tra le variabili indipendenti e la variabile dipendente.</p>
<p>Inizieremo considerando il solito <em>height-weight</em> dataset:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;http://antoninofurnari.it/downloads/height_weight.csv&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 4231 entries, 0 to 4230
Data columns (total 4 columns):
 #   Column  Non-Null Count  Dtype  
---  ------  --------------  -----  
 0   sex     4231 non-null   object 
 1   BMI     4231 non-null   float64
 2   height  4231 non-null   float64
 3   weight  4231 non-null   float64
dtypes: float64(3), object(1)
memory usage: 132.3+ KB
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sex</th>
      <th>BMI</th>
      <th>height</th>
      <th>weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>M</td>
      <td>33.36</td>
      <td>187.96</td>
      <td>117.933920</td>
    </tr>
    <tr>
      <th>1</th>
      <td>M</td>
      <td>26.54</td>
      <td>177.80</td>
      <td>83.914520</td>
    </tr>
    <tr>
      <th>2</th>
      <td>F</td>
      <td>32.13</td>
      <td>154.94</td>
      <td>77.110640</td>
    </tr>
    <tr>
      <th>3</th>
      <td>M</td>
      <td>26.62</td>
      <td>172.72</td>
      <td>79.378600</td>
    </tr>
    <tr>
      <th>4</th>
      <td>F</td>
      <td>27.13</td>
      <td>167.64</td>
      <td>76.203456</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="regressione-lineare-semplice">
<h3><span class="section-number">24.1. </span>Regressione Lineare Semplice<a class="headerlink" href="#regressione-lineare-semplice" title="Permalink to this heading">#</a></h3>
<p>Vediamo un esempio di regressione semplice (ovvero rispetto a una sola variabile indipendente <span class="math notranslate nohighlight">\(x_1\)</span>). Consideriamo le variabili <code class="docutils literal notranslate"><span class="pre">weight</span></code> e <code class="docutils literal notranslate"><span class="pre">BMI</span></code>, cercando di prevedere i valori di <code class="docutils literal notranslate"><span class="pre">BMI</span></code> da <code class="docutils literal notranslate"><span class="pre">weight</span></code>. Costruiremo dunque un modello lineare di questo tipo:</p>
<div class="math notranslate nohighlight">
\[
BMI = \beta_0 + \beta_1 \cdot weight
\]</div>
<p>dove:</p>
<ul class="simple">
<li><p><strong>weight</strong> è la variabile indipendente;</p></li>
<li><p><strong>BMI</strong> è la variabile dipendente;</p></li>
<li><p><span class="math notranslate nohighlight">\(\beta_1\)</span> è il coefficiente di <code class="docutils literal notranslate"><span class="pre">weight</span></code>;</p></li>
<li><p><span class="math notranslate nohighlight">\(\beta_0\)</span> è l’intercetta.</p></li>
</ul>
<p>Per definire e calcolare il modello di regressione lineare, utilizzeremo il metodo dei minimi quadrati (Ordinary Least Squares - OLS), implementato dalla libreria <strong>statsmodels</strong>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">statsmodels.formula.api</span> <span class="kn">import</span> <span class="n">ols</span>
<span class="c1">#la notazione y ~ x indica che y è la variabile</span>
<span class="c1">#dipendente e x è la variabile indipendente</span>
<span class="c1">#le altre variabili del dataframe saranno scartate</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">ols</span><span class="p">(</span><span class="s2">&quot;BMI ~ weight&quot;</span><span class="p">,</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

<span class="c1">#visualizziamo i parametri del modello</span>
<span class="n">model</span><span class="o">.</span><span class="n">params</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Intercept    7.371959
weight       0.252028
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Abbiamo calcolato il modello lineare:</p>
<div class="math notranslate nohighlight">
\[
BMI = 0.25 \cdot weight + 7.37
\]</div>
<p>che ci permette di calcolare il valore di <code class="docutils literal notranslate"><span class="pre">BMI</span></code> dai valori di <code class="docutils literal notranslate"><span class="pre">weight</span></code>.</p>
<blockquote>
<div><p><strong>🙋‍♂️ Domanda 1</strong></p>
<p>Secondo il modello lineare trovato, che valore di BMI ha un soggetto che pesa 69 Kg? E per un soggetto che pesa 90 Kg?</p>
</div></blockquote>
<p>Il modello mette a disposizione il metodo <strong>predict</strong> per effettuare questo tipo di calcoli. Il metodo però vuole che specifichiamo il nome delle variabili indipendenti per le quali stiamo fornendo i valori. Ciò si può fare definendo al volo un dizionario:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">({</span><span class="s1">&#39;weight&#39;</span><span class="p">:[</span><span class="mi">69</span><span class="p">,</span> <span class="mi">90</span><span class="p">]})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    24.761904
1    30.054496
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Il modello calcolato non è altro che una retta che fa corrispondere valori di <code class="docutils literal notranslate"><span class="pre">weight</span></code> a valori di <code class="docutils literal notranslate"><span class="pre">BMI</span></code>. Possiamo facilmente visualizzare la retta utilizzando la libreria <code class="docutils literal notranslate"><span class="pre">seaborn</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;BMI&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;weight&#39;</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d5da2571821c47800695b6260230723e1907fe9996b11e2a87f431249f360b58.png" src="../_images/d5da2571821c47800695b6260230723e1907fe9996b11e2a87f431249f360b58.png" />
</div>
</div>
<blockquote>
<div><p><strong>🙋‍♂️ Domanda 2</strong></p>
<p>Cosa possiamo dire della retta visualizzata? Esistono valori per i quali l’errore commesso è maggiore? Qual è l’equazione della retta mostrata nel grafico?</p>
</div></blockquote>
<section id="analisi-di-un-regressore-lineare-semplice">
<h4><span class="section-number">24.1.1. </span>Analisi di un regressore lineare semplice<a class="headerlink" href="#analisi-di-un-regressore-lineare-semplice" title="Permalink to this heading">#</a></h4>
<p>Analizziamo adesso il regrssore ottenuto e vediamo che interpretazione hanno i parametri individuati. Possiamo visualizzare un sommario sul regressore mediante il metodo <code class="docutils literal notranslate"><span class="pre">summary</span></code> dell’oggetto <code class="docutils literal notranslate"><span class="pre">ols</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>           <td>BMI</td>       <th>  R-squared:         </th> <td>   0.704</td> 
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.704</td> 
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>1.006e+04</td>
</tr>
<tr>
  <th>Date:</th>             <td>Tue, 31 Oct 2023</td> <th>  Prob (F-statistic):</th>  <td>  0.00</td>  
</tr>
<tr>
  <th>Time:</th>                 <td>06:41:15</td>     <th>  Log-Likelihood:    </th> <td> -10476.</td> 
</tr>
<tr>
  <th>No. Observations:</th>      <td>  4231</td>      <th>  AIC:               </th> <td>2.096e+04</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>  4229</td>      <th>  BIC:               </th> <td>2.097e+04</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     1</td>      <th>                     </th>     <td> </td>    
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>    
</tr>
</table>
<table class="simpletable">
<tr>
      <td></td>         <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th> <td>    7.3720</td> <td>    0.203</td> <td>   36.253</td> <td> 0.000</td> <td>    6.973</td> <td>    7.771</td>
</tr>
<tr>
  <th>weight</th>    <td>    0.2520</td> <td>    0.003</td> <td>  100.290</td> <td> 0.000</td> <td>    0.247</td> <td>    0.257</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>342.463</td> <th>  Durbin-Watson:     </th> <td>   2.007</td> 
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.000</td>  <th>  Jarque-Bera (JB):  </th> <td> 467.107</td> 
</tr>
<tr>
  <th>Skew:</th>          <td> 0.679</td>  <th>  Prob(JB):          </th> <td>3.71e-102</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 3.896</td>  <th>  Cond. No.          </th> <td>    372.</td> 
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.</div></div>
</div>
<p>Il sommario presenta molte informazioni. Alcune di esse sono autoesplicative, come ad esempio “Dep. Variable”, “Model”, “Method”, “Date”, “Time”, “No. Observations”, “coef”. Altre sono invece molto specifiche. Tra tutti i valori mostrati, alcuni importanti sono:</p>
<ul class="simple">
<li><p>R-squared e Adjusted R-squared;</p></li>
<li><p>F-statistic e prob(F-statistic);</p></li>
<li><p>Valori <span class="math notranslate nohighlight">\(t\)</span> dei singoli parametri e relativi valori di <span class="math notranslate nohighlight">\(P&gt;|t|\)</span> (p-value);</p></li>
<li><p>I valori trovati per i singoli parametri.
Analizziamo il significato di ciascuno di questi valori:</p></li>
</ul>
<p>Il valore di <span class="math notranslate nohighlight">\(R^2\)</span> indica che la conoscenza di <code class="docutils literal notranslate"><span class="pre">weight</span></code> permette di ridurre l’errore sulle predizioni di <code class="docutils literal notranslate"><span class="pre">BMI</span></code> del <span class="math notranslate nohighlight">\(70\%\)</span>. Ciò vuol dire che, benché <code class="docutils literal notranslate"><span class="pre">weight</span></code> da sola non riesca a spiegare (linearmente) <code class="docutils literal notranslate"><span class="pre">BMI</span></code>, le due variabili sono piuttosto correlate. (Si noti che in realtà sappiamo che <code class="docutils literal notranslate"><span class="pre">BMI</span></code> si calcola a partire da <code class="docutils literal notranslate"><span class="pre">height</span></code> e <code class="docutils literal notranslate"><span class="pre">weight</span></code>, quindi questa non dovrebbe essere una scoperta sorprendente). Il valore della F-statistic è alto, mentre quello di Prob(F-statistic) è nullo. Possiamo concludere che il regressore è statisticamente significativo.</p>
<p>I p-value relativi a entrambi i parametri sono nulli, pertanto entrambi i parametri sono statisticamente rilevanti. Il valore dell’intercetta è pari a <span class="math notranslate nohighlight">\(7.38\)</span>. Ciò indica che a un peso di <span class="math notranslate nohighlight">\(0\ Kg\)</span> corrisponde un BMI pari a <span class="math notranslate nohighlight">\(7.38\)</span> secondo il modello trovato. Il valore del coefficiente di <code class="docutils literal notranslate"><span class="pre">weight</span></code> è pari a <span class="math notranslate nohighlight">\(0.25\)</span>. Ciò significa che incrementando il peso di un kilogrammo, il BMI aumenta di <span class="math notranslate nohighlight">\(0.25\ Kg/m^2\)</span>.</p>
</section>
</section>
<section id="regressione-lineare-multipla">
<h3><span class="section-number">24.2. </span>Regressione Lineare Multipla<a class="headerlink" href="#regressione-lineare-multipla" title="Permalink to this heading">#</a></h3>
<p>Vediamo adesso un esempio di regressione multipla. La regressione lineare multipla permette di studiare le relazioni tra una variabile dipendente e un insieme di variabili indipendenti. Calcoliamo un regressore lineare per predire i valori di <code class="docutils literal notranslate"><span class="pre">BMI</span></code> da quelli di <code class="docutils literal notranslate"><span class="pre">height</span></code> e <code class="docutils literal notranslate"><span class="pre">weight</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">ols</span><span class="p">(</span><span class="s1">&#39;BMI ~ height + weight&#39;</span><span class="p">,</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>           <td>BMI</td>       <th>  R-squared:         </th> <td>   0.986</td> 
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.986</td> 
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>1.513e+05</td>
</tr>
<tr>
  <th>Date:</th>             <td>Fri, 26 Oct 2018</td> <th>  Prob (F-statistic):</th>  <td>  0.00</td>  
</tr>
<tr>
  <th>Time:</th>                 <td>19:48:28</td>     <th>  Log-Likelihood:    </th> <td> -3987.0</td> 
</tr>
<tr>
  <th>No. Observations:</th>      <td>  4231</td>      <th>  AIC:               </th> <td>   7980.</td> 
</tr>
<tr>
  <th>Df Residuals:</th>          <td>  4228</td>      <th>  BIC:               </th> <td>   7999.</td> 
</tr>
<tr>
  <th>Df Model:</th>              <td>     2</td>      <th>                     </th>     <td> </td>    
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>    
</tr>
</table>
<table class="simpletable">
<tr>
      <td></td>         <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th> <td>   55.8865</td> <td>    0.171</td> <td>  327.627</td> <td> 0.000</td> <td>   55.552</td> <td>   56.221</td>
</tr>
<tr>
  <th>height</th>    <td>   -0.3310</td> <td>    0.001</td> <td> -294.311</td> <td> 0.000</td> <td>   -0.333</td> <td>   -0.329</td>
</tr>
<tr>
  <th>weight</th>    <td>    0.3497</td> <td>    0.001</td> <td>  550.104</td> <td> 0.000</td> <td>    0.348</td> <td>    0.351</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>441.026</td> <th>  Durbin-Watson:     </th> <td>   1.980</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.000</td>  <th>  Jarque-Bera (JB):  </th> <td>3489.395</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 0.132</td>  <th>  Prob(JB):          </th> <td>    0.00</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 7.441</td>  <th>  Cond. No.          </th> <td>3.36e+03</td>
</tr>
</table><br/><br/>Warnings:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.<br/>[2] The condition number is large, 3.36e+03. This might indicate that there are<br/>strong multicollinearity or other numerical problems.</div></div>
</div>
<p>Il regressore lineare trovato ha un valore di <span class="math notranslate nohighlight">\(R^2\)</span> molto alto (<span class="math notranslate nohighlight">\(0.986\)</span>), una F-statistic alta e un valore di Prob(F-statistic) nullo. Possiamo concludere che il regressore è significativo. I p-value dei parametri sono tutti nulli, il che significa che le variabili contribuiscono tutte significativamente alla regressione.</p>
<p>L’intercetta ha un valore pari a <span class="math notranslate nohighlight">\(55.88\)</span>, il che indica che, idealmente, un soggetto di peso e altezza nulla avrebbe un <code class="docutils literal notranslate"><span class="pre">BMI</span></code> pari a <span class="math notranslate nohighlight">\(55.88\ Kg/m^2\)</span>. Il coefficiente di <code class="docutils literal notranslate"><span class="pre">height</span></code> indica che quando l’altezza viene incrementata di un metro, il BMI viene decrementato di <span class="math notranslate nohighlight">\(0.33\ Kg/m^2\)</span>. Analogamente, quando il peso viene incrementato di un kilogrammo, il BMI viene incrementato di <span class="math notranslate nohighlight">\(0.35\ Kg/m^2\)</span>.</p>
<section id="boston-house-pricing-dataset">
<h4><span class="section-number">24.2.1. </span>Boston House Pricing Dataset<a class="headerlink" href="#boston-house-pricing-dataset" title="Permalink to this heading">#</a></h4>
<p>Vediamo adesso un esempio con un dataset più complesso. Utilizzeremo il dataset “Boston” che contiene osservazioni relativi ai prezzi di diverse case nei sobborghi di Boston. Carichiamo il dataset mediante la funzione <code class="docutils literal notranslate"><span class="pre">get_rdataset</span></code> di <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code>, che permette di caricare dataset contenuti nelle librerie del linguaggio R:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">statsmodels.datasets</span> <span class="kn">import</span> <span class="n">get_rdataset</span>
<span class="n">boston</span> <span class="o">=</span> <span class="n">get_rdataset</span><span class="p">(</span><span class="s1">&#39;Boston&#39;</span><span class="p">,</span> <span class="n">package</span><span class="o">=</span><span class="s1">&#39;MASS&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>I dataset caricati mediante <code class="docutils literal notranslate"><span class="pre">get_rdataset</span></code> presentano la medesima struttura. Esiste una documentazione nella proprietà <code class="docutils literal notranslate"><span class="pre">__doc__</span></code>. Stampiamola per farci un’idea più precisa sul dataset:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">boston</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>.. container::

   ====== ===============
   Boston R Documentation
   ====== ===============

   .. rubric:: Housing Values in Suburbs of Boston
      :name: Boston

   .. rubric:: Description
      :name: description

   The ``Boston`` data frame has 506 rows and 14 columns.

   .. rubric:: Usage
      :name: usage

   .. code:: R

      Boston

   .. rubric:: Format
      :name: format

   This data frame contains the following columns:

   ``crim``
      per capita crime rate by town.

   ``zn``
      proportion of residential land zoned for lots over 25,000 sq.ft.

   ``indus``
      proportion of non-retail business acres per town.

   ``chas``
      Charles River dummy variable (= 1 if tract bounds river; 0
      otherwise).

   ``nox``
      nitrogen oxides concentration (parts per 10 million).

   ``rm``
      average number of rooms per dwelling.

   ``age``
      proportion of owner-occupied units built prior to 1940.

   ``dis``
      weighted mean of distances to five Boston employment centres.

   ``rad``
      index of accessibility to radial highways.

   ``tax``
      full-value property-tax rate per $10,000.

   ``ptratio``
      pupil-teacher ratio by town.

   ``black``
      ``1000(Bk - 0.63)^2`` where ``Bk`` is the proportion of blacks by
      town.

   ``lstat``
      lower status of the population (percent).

   ``medv``
      median value of owner-occupied homes in $1000s.

   .. rubric:: Source
      :name: source

   Harrison, D. and Rubinfeld, D.L. (1978) Hedonic prices and the demand
   for clean air. *J. Environ. Economics and Management* **5**, 81–102.

   Belsley D.A., Kuh, E. and Welsch, R.E. (1980) *Regression
   Diagnostics. Identifying Influential Data and Sources of
   Collinearity.* New York: Wiley.
</pre></div>
</div>
</div>
</div>
<p>Il dataframe contenente le osservazioni si trova all’interno della proprietà <code class="docutils literal notranslate"><span class="pre">data</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">boston</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>crim</th>
      <th>zn</th>
      <th>indus</th>
      <th>chas</th>
      <th>nox</th>
      <th>rm</th>
      <th>age</th>
      <th>dis</th>
      <th>rad</th>
      <th>tax</th>
      <th>ptratio</th>
      <th>black</th>
      <th>lstat</th>
      <th>medv</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.00632</td>
      <td>18.0</td>
      <td>2.31</td>
      <td>0</td>
      <td>0.538</td>
      <td>6.575</td>
      <td>65.2</td>
      <td>4.0900</td>
      <td>1</td>
      <td>296</td>
      <td>15.3</td>
      <td>396.90</td>
      <td>4.98</td>
      <td>24.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.02731</td>
      <td>0.0</td>
      <td>7.07</td>
      <td>0</td>
      <td>0.469</td>
      <td>6.421</td>
      <td>78.9</td>
      <td>4.9671</td>
      <td>2</td>
      <td>242</td>
      <td>17.8</td>
      <td>396.90</td>
      <td>9.14</td>
      <td>21.6</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.02729</td>
      <td>0.0</td>
      <td>7.07</td>
      <td>0</td>
      <td>0.469</td>
      <td>7.185</td>
      <td>61.1</td>
      <td>4.9671</td>
      <td>2</td>
      <td>242</td>
      <td>17.8</td>
      <td>392.83</td>
      <td>4.03</td>
      <td>34.7</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.03237</td>
      <td>0.0</td>
      <td>2.18</td>
      <td>0</td>
      <td>0.458</td>
      <td>6.998</td>
      <td>45.8</td>
      <td>6.0622</td>
      <td>3</td>
      <td>222</td>
      <td>18.7</td>
      <td>394.63</td>
      <td>2.94</td>
      <td>33.4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.06905</td>
      <td>0.0</td>
      <td>2.18</td>
      <td>0</td>
      <td>0.458</td>
      <td>7.147</td>
      <td>54.2</td>
      <td>6.0622</td>
      <td>3</td>
      <td>222</td>
      <td>18.7</td>
      <td>396.90</td>
      <td>5.33</td>
      <td>36.2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Questo dataset è generalmente utilizzato come un dataset di regressione, nel quale l’obiettivo è quello di predire il valore di <code class="docutils literal notranslate"><span class="pre">medv</span></code> (prezzo medio delle case in migliaia di dollari) a partire dai valori delle altre variabili.</p>
</section>
<section id="regressori-lineari-variabili-categoriche-e-variabili-dummy">
<h4><span class="section-number">24.2.2. </span>Regressori lineari, variabili categoriche e variabili dummy<a class="headerlink" href="#regressori-lineari-variabili-categoriche-e-variabili-dummy" title="Permalink to this heading">#</a></h4>
<p>Notiamo che le variabili <code class="docutils literal notranslate"><span class="pre">rad</span></code> e <code class="docutils literal notranslate"><span class="pre">chas</span></code> sono categoriche. Quando si lavora con regressori lineari e variabili categoriche bisogna fare attenzione:</p>
<ul class="simple">
<li><p>Le variabili categoriche non vanno utilizzate come variabili dipendenti di un regressore lineare;</p></li>
<li><p>Le variabili categoriche possono essere utilizzate invece come variabili indipendenti solo se binarie.
<code class="docutils literal notranslate"><span class="pre">chas</span></code> è binaria, quindi possiamo includerla tra le variabili indipendenti. <code class="docutils literal notranslate"><span class="pre">rad</span></code> invece non è binaria, pertanto non può essere inclusa tra le variabili per la regressione.</p></li>
</ul>
<p>Se vogliamo includere <code class="docutils literal notranslate"><span class="pre">rad</span></code> tra le variabili per la regressione lineare, dobbiamo trasformarla in un insiem di variabili binarie “dummy”. Ogni variabile “dummy” indicherà per ogni osservazione, se essa appartiene a una specifica classe tra quelle della variabile categorica considerata.</p>
<p>Vediamo un esempio:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">var</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">])</span>
<span class="n">var</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    A
1    A
2    B
3    A
4    C
5    C
6    B
7    A
8    C
9    B
dtype: object
</pre></div>
</div>
</div>
</div>
<p>Si consideri <code class="docutils literal notranslate"><span class="pre">var</span></code> come una variabile categorica che consta di <span class="math notranslate nohighlight">\(10\)</span> osservazioni e <span class="math notranslate nohighlight">\(3\)</span> classi. Possiamo sostituire la variabile <code class="docutils literal notranslate"><span class="pre">var</span></code> con tre variabili <code class="docutils literal notranslate"><span class="pre">A</span></code>,<code class="docutils literal notranslate"><span class="pre">B</span></code>,<code class="docutils literal notranslate"><span class="pre">C</span></code> tali che <code class="docutils literal notranslate"><span class="pre">A</span></code> sarà pari a <span class="math notranslate nohighlight">\(1\)</span> solo quando <code class="docutils literal notranslate"><span class="pre">var</span></code> è uguale ad <code class="docutils literal notranslate"><span class="pre">A</span></code>, <code class="docutils literal notranslate"><span class="pre">C</span></code> sarà pari a <span class="math notranslate nohighlight">\(1\)</span> solo quando <code class="docutils literal notranslate"><span class="pre">var</span></code> è uguale ad <code class="docutils literal notranslate"><span class="pre">C</span></code>. Possiamo ottenere queste tre variabili dummy mediante la funzione <code class="docutils literal notranslate"><span class="pre">get_dummies</span></code> di Pandas:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Confrontiamo ad esempio l’osservazione di indice <span class="math notranslate nohighlight">\(5\)</span> della serie e del DataFrame di variabili dummy:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">var</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">var</span><span class="p">)</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C 

A    0
B    0
C    1
Name: 5, dtype: uint8
</pre></div>
</div>
</div>
</div>
<p>Il valore di <code class="docutils literal notranslate"><span class="pre">var</span></code> è <span class="math notranslate nohighlight">\(5\)</span>. In maniera corrispondente, la variabile dummy <code class="docutils literal notranslate"><span class="pre">C</span></code> è pari a <span class="math notranslate nohighlight">\(1\)</span>, mentre le altre sono pari a zero. Questo tipo di rappresentazione di <code class="docutils literal notranslate"><span class="pre">var</span></code> è tuttavia ridondante. Infatti, se sappiamo che <span class="math notranslate nohighlight">\(B=0\)</span> e <span class="math notranslate nohighlight">\(C=0\)</span>, possiamo facilmente dedurre che <span class="math notranslate nohighlight">\(A=1\)</span>. Questa semplice ridondanza può creare problemi di clacolo numerico nell’ottimizzazione del regressore lineare. Per evitarla, generalmente si esclude una delle variabili dummy. Possiamo ottenere questo risultato come segue:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">var</span><span class="p">,</span><span class="n">drop_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Possiamo convertire la variabile categorica <code class="docutils literal notranslate"><span class="pre">rad</span></code> in un insieme di variabili dummy come segue:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">boston_mod</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">boston</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;rad&#39;</span><span class="p">],</span><span class="n">drop_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">boston_mod</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>crim</th>
      <th>zn</th>
      <th>indus</th>
      <th>chas</th>
      <th>nox</th>
      <th>rm</th>
      <th>age</th>
      <th>dis</th>
      <th>tax</th>
      <th>ptratio</th>
      <th>...</th>
      <th>lstat</th>
      <th>medv</th>
      <th>rad_2</th>
      <th>rad_3</th>
      <th>rad_4</th>
      <th>rad_5</th>
      <th>rad_6</th>
      <th>rad_7</th>
      <th>rad_8</th>
      <th>rad_24</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.00632</td>
      <td>18.0</td>
      <td>2.31</td>
      <td>0</td>
      <td>0.538</td>
      <td>6.575</td>
      <td>65.2</td>
      <td>4.0900</td>
      <td>296</td>
      <td>15.3</td>
      <td>...</td>
      <td>4.98</td>
      <td>24.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.02731</td>
      <td>0.0</td>
      <td>7.07</td>
      <td>0</td>
      <td>0.469</td>
      <td>6.421</td>
      <td>78.9</td>
      <td>4.9671</td>
      <td>242</td>
      <td>17.8</td>
      <td>...</td>
      <td>9.14</td>
      <td>21.6</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.02729</td>
      <td>0.0</td>
      <td>7.07</td>
      <td>0</td>
      <td>0.469</td>
      <td>7.185</td>
      <td>61.1</td>
      <td>4.9671</td>
      <td>242</td>
      <td>17.8</td>
      <td>...</td>
      <td>4.03</td>
      <td>34.7</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.03237</td>
      <td>0.0</td>
      <td>2.18</td>
      <td>0</td>
      <td>0.458</td>
      <td>6.998</td>
      <td>45.8</td>
      <td>6.0622</td>
      <td>222</td>
      <td>18.7</td>
      <td>...</td>
      <td>2.94</td>
      <td>33.4</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.06905</td>
      <td>0.0</td>
      <td>2.18</td>
      <td>0</td>
      <td>0.458</td>
      <td>7.147</td>
      <td>54.2</td>
      <td>6.0622</td>
      <td>222</td>
      <td>18.7</td>
      <td>...</td>
      <td>5.33</td>
      <td>36.2</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 21 columns</p>
</div></div></div>
</div>
<p>Ispezioniamo i nomi delle colonne:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">boston_mod</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;crim&#39;, &#39;zn&#39;, &#39;indus&#39;, &#39;chas&#39;, &#39;nox&#39;, &#39;rm&#39;, &#39;age&#39;, &#39;dis&#39;, &#39;tax&#39;,
       &#39;ptratio&#39;, &#39;black&#39;, &#39;lstat&#39;, &#39;medv&#39;, &#39;rad_2&#39;, &#39;rad_3&#39;, &#39;rad_4&#39;, &#39;rad_5&#39;,
       &#39;rad_6&#39;, &#39;rad_7&#39;, &#39;rad_8&#39;, &#39;rad_24&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<p>Notiamo che <code class="docutils literal notranslate"><span class="pre">rad</span></code> è stata rimossa e sostituita da diverse variabili dummy, rappresentanti i vari valori assunti da <code class="docutils literal notranslate"><span class="pre">rad</span></code>. Possiamo adesso procedere al calcolo del regressore lineare multiplo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">=</span><span class="n">ols</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;medv ~ crim + zn + indus + chas + nox + rm +age + dis + tax + </span>
<span class="s2">          ptratio + black + lstat + rad_2 + rad_3 + rad_4 + rad_5 + rad_6 + </span>
<span class="s2">          rad_7 + rad_8 + rad_24&quot;&quot;&quot;</span><span class="p">,</span> <span class="n">boston_mod</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>          <td>medv</td>       <th>  R-squared:         </th> <td>   0.750</td> 
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.740</td> 
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   72.70</td> 
</tr>
<tr>
  <th>Date:</th>             <td>Tue, 31 Oct 2023</td> <th>  Prob (F-statistic):</th> <td>8.29e-132</td>
</tr>
<tr>
  <th>Time:</th>                 <td>06:43:47</td>     <th>  Log-Likelihood:    </th> <td> -1489.6</td> 
</tr>
<tr>
  <th>No. Observations:</th>      <td>   506</td>      <th>  AIC:               </th> <td>   3021.</td> 
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   485</td>      <th>  BIC:               </th> <td>   3110.</td> 
</tr>
<tr>
  <th>Df Model:</th>              <td>    20</td>      <th>                     </th>     <td> </td>    
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>    
</tr>
</table>
<table class="simpletable">
<tr>
      <td></td>         <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th> <td>   35.2596</td> <td>    5.434</td> <td>    6.489</td> <td> 0.000</td> <td>   24.583</td> <td>   45.936</td>
</tr>
<tr>
  <th>crim</th>      <td>   -0.1088</td> <td>    0.033</td> <td>   -3.329</td> <td> 0.001</td> <td>   -0.173</td> <td>   -0.045</td>
</tr>
<tr>
  <th>zn</th>        <td>    0.0549</td> <td>    0.014</td> <td>    3.880</td> <td> 0.000</td> <td>    0.027</td> <td>    0.083</td>
</tr>
<tr>
  <th>indus</th>     <td>    0.0238</td> <td>    0.064</td> <td>    0.373</td> <td> 0.709</td> <td>   -0.101</td> <td>    0.149</td>
</tr>
<tr>
  <th>chas</th>      <td>    2.5242</td> <td>    0.863</td> <td>    2.924</td> <td> 0.004</td> <td>    0.828</td> <td>    4.220</td>
</tr>
<tr>
  <th>nox</th>       <td>  -17.5731</td> <td>    3.896</td> <td>   -4.510</td> <td> 0.000</td> <td>  -25.229</td> <td>   -9.917</td>
</tr>
<tr>
  <th>rm</th>        <td>    3.6655</td> <td>    0.421</td> <td>    8.703</td> <td> 0.000</td> <td>    2.838</td> <td>    4.493</td>
</tr>
<tr>
  <th>age</th>       <td>    0.0005</td> <td>    0.013</td> <td>    0.035</td> <td> 0.972</td> <td>   -0.026</td> <td>    0.026</td>
</tr>
<tr>
  <th>dis</th>       <td>   -1.5545</td> <td>    0.202</td> <td>   -7.699</td> <td> 0.000</td> <td>   -1.951</td> <td>   -1.158</td>
</tr>
<tr>
  <th>tax</th>       <td>   -0.0087</td> <td>    0.004</td> <td>   -2.246</td> <td> 0.025</td> <td>   -0.016</td> <td>   -0.001</td>
</tr>
<tr>
  <th>ptratio</th>   <td>   -0.9724</td> <td>    0.144</td> <td>   -6.731</td> <td> 0.000</td> <td>   -1.256</td> <td>   -0.689</td>
</tr>
<tr>
  <th>black</th>     <td>    0.0094</td> <td>    0.003</td> <td>    3.531</td> <td> 0.000</td> <td>    0.004</td> <td>    0.015</td>
</tr>
<tr>
  <th>lstat</th>     <td>   -0.5292</td> <td>    0.051</td> <td>  -10.451</td> <td> 0.000</td> <td>   -0.629</td> <td>   -0.430</td>
</tr>
<tr>
  <th>rad_2</th>     <td>    1.4889</td> <td>    1.478</td> <td>    1.008</td> <td> 0.314</td> <td>   -1.414</td> <td>    4.392</td>
</tr>
<tr>
  <th>rad_3</th>     <td>    4.6813</td> <td>    1.335</td> <td>    3.506</td> <td> 0.000</td> <td>    2.058</td> <td>    7.305</td>
</tr>
<tr>
  <th>rad_4</th>     <td>    2.5762</td> <td>    1.187</td> <td>    2.170</td> <td> 0.031</td> <td>    0.243</td> <td>    4.909</td>
</tr>
<tr>
  <th>rad_5</th>     <td>    2.9185</td> <td>    1.208</td> <td>    2.417</td> <td> 0.016</td> <td>    0.546</td> <td>    5.291</td>
</tr>
<tr>
  <th>rad_6</th>     <td>    1.1858</td> <td>    1.464</td> <td>    0.810</td> <td> 0.418</td> <td>   -1.691</td> <td>    4.062</td>
</tr>
<tr>
  <th>rad_7</th>     <td>    4.8790</td> <td>    1.571</td> <td>    3.105</td> <td> 0.002</td> <td>    1.792</td> <td>    7.966</td>
</tr>
<tr>
  <th>rad_8</th>     <td>    4.8398</td> <td>    1.492</td> <td>    3.245</td> <td> 0.001</td> <td>    1.909</td> <td>    7.771</td>
</tr>
<tr>
  <th>rad_24</th>    <td>    7.4617</td> <td>    1.789</td> <td>    4.172</td> <td> 0.000</td> <td>    3.947</td> <td>   10.976</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>183.890</td> <th>  Durbin-Watson:     </th> <td>   1.089</td> 
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.000</td>  <th>  Jarque-Bera (JB):  </th> <td> 858.805</td> 
</tr>
<tr>
  <th>Skew:</th>          <td> 1.554</td>  <th>  Prob(JB):          </th> <td>3.26e-187</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 8.575</td>  <th>  Cond. No.          </th> <td>1.60e+04</td> 
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.<br/>[2] The condition number is large, 1.6e+04. This might indicate that there are<br/>strong multicollinearity or other numerical problems.</div></div>
</div>
<p>Il regressore ottenuto presenta un valore di <span class="math notranslate nohighlight">\(R^2\)</span> piuttosto alto. Ciò vuol dire che, globalmente, le variabili indipendenti sono correlate con la variabile dipendente. La F-statistic è alta e il p-value corrispondente è molto basso. Il regressore è, globalmente, statisticamente significativo.</p>
<p>Passiamo all’analisi dei p-value dei singoli parametri trovati. I p-value delle seguenti variabili sono più alti di <span class="math notranslate nohighlight">\(0.05\)</span>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">indus</span></code>;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">age</span></code>;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rad2</span></code>;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rad6</span></code>.</p></li>
</ul>
<p>Queste variabili non contribuiscono significativamente alla regressione. Analizziamo i valori dei parametri relativi a varabili che contribuiscono statisticamente alla regressione:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">intercept</span></code>: quando tutte le altre variabili assumono valori nulli, <code class="docutils literal notranslate"><span class="pre">medv</span></code> assume il valore <span class="math notranslate nohighlight">\(35.26\)</span>. Ricordiamo che <code class="docutils literal notranslate"><span class="pre">medv</span></code> esprime il prezzo medio delle case in migliaia di dollari, per cui il “prezzo medio base” delle case è di circa <span class="math notranslate nohighlight">\(35260\)</span> dollari;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">crim</span></code>: l’incremento di una unità del tasso di criminalità pro-capite abbassa il valore delle case di cica <span class="math notranslate nohighlight">\(108\)</span> dollari;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">zn</span></code>: l’incremento di una unità della proporzione di terre destinate a uso residenziale aumenta il valore delle case di circa <span class="math notranslate nohighlight">\(54\)</span> dollari;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">chas</span></code>: quando la variabile è pari a <span class="math notranslate nohighlight">\(1\)</span> (ricordiamo che si tratta di una variabile categorica), il prezzo delle case sale di circa <span class="math notranslate nohighlight">\(2500\)</span> dollari. Possiamo dire che le case vicine al fiume tendono ad essere più care;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nox</span></code>: l’aumento di una unità della concentrazione di ossido di azoto abbassa i prezzi delle case di circa <span class="math notranslate nohighlight">\(17500\)</span> dollari. Questo può sembrare un numero altissimo, ma si noti che i valori di <code class="docutils literal notranslate"><span class="pre">nox</span></code> variano tra un minimo di <span class="math notranslate nohighlight">\(0.38\)</span> a un massimo di <span class="math notranslate nohighlight">\(0.87\)</span>, per cui non si verificheranno decrementi dei prezzi delle case così grandi;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rm</span></code>: l’incremento del numero di stanze di una unità incrementa il prezzo della casa di circa <span class="math notranslate nohighlight">\(3600\)</span> dollari;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dis</span></code>: l’incremento di una unità della distanza media dal centro diminuisce il prezzo delle case di circa <span class="math notranslate nohighlight">\(1500\)</span> dollari (le case più distanti dal centro valgono di meno);</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tax</span></code>: l’aumento di un unità del tax-rate della proprietà ne diminuisce il valore di 8 dollari. Sembra un decremento trascurabile, tuttavia, si consideri che il range di <code class="docutils literal notranslate"><span class="pre">tax</span></code> è compreso tra <span class="math notranslate nohighlight">\(187\)</span> e <span class="math notranslate nohighlight">\(711\)</span>;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ptratio</span></code>: l’aumento di una unità del rapporto insegnante-alunni diminuisce il valore della proprietà di circa <span class="math notranslate nohighlight">\(1000\)</span> dollari;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">black</span></code>: l’aumento di una unità del valore di <code class="docutils literal notranslate"><span class="pre">black</span></code> (una variabile dipendente dalla proporzione tra abitanti bianchi e neri) incrementa il valore delle case di pochi dollari. Si consideri che il range di <code class="docutils literal notranslate"><span class="pre">black</span></code> va da circa <span class="math notranslate nohighlight">\(0\)</span> a <span class="math notranslate nohighlight">\(396\)</span>;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lstat</span></code>: l’aumento di una unità del valore di questa variabile (percenutale di abitanti meno abbienti) diminuisce il prezzo delle case di circa <span class="math notranslate nohighlight">\(500\)</span> dollari;</p></li>
<li><p>I coefficienti appresi per le variabili dummy di <code class="docutils literal notranslate"><span class="pre">rad</span></code> indicano che quando <code class="docutils literal notranslate"><span class="pre">rad</span></code> assume il valore 24, il valore delle case aumenta di circa <span class="math notranslate nohighlight">\(7500\)</span> dollari. Altri valori di <code class="docutils literal notranslate"><span class="pre">rad</span></code> contribuiscono differentemente all’incremento del valore di <code class="docutils literal notranslate"><span class="pre">medv</span></code>;</p></li>
</ul>
<blockquote>
<div><p><strong>🙋‍♂️ Domanda 3</strong></p>
<p>Dati i risultati del regressore lineare, qual è la variabile più influente nella regressione?</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">=</span><span class="n">ols</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;medv ~ crim + zn + indus + chas + nox + rm +age + dis + tax + </span>
<span class="s2">          ptratio + black + lstat + rad&quot;&quot;&quot;</span><span class="p">,</span> <span class="n">boston</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>          <td>medv</td>       <th>  R-squared:         </th> <td>   0.741</td> 
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.734</td> 
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   108.1</td> 
</tr>
<tr>
  <th>Date:</th>             <td>Tue, 31 Oct 2023</td> <th>  Prob (F-statistic):</th> <td>6.72e-135</td>
</tr>
<tr>
  <th>Time:</th>                 <td>06:48:40</td>     <th>  Log-Likelihood:    </th> <td> -1498.8</td> 
</tr>
<tr>
  <th>No. Observations:</th>      <td>   506</td>      <th>  AIC:               </th> <td>   3026.</td> 
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   492</td>      <th>  BIC:               </th> <td>   3085.</td> 
</tr>
<tr>
  <th>Df Model:</th>              <td>    13</td>      <th>                     </th>     <td> </td>    
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>    
</tr>
</table>
<table class="simpletable">
<tr>
      <td></td>         <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th> <td>   36.4595</td> <td>    5.103</td> <td>    7.144</td> <td> 0.000</td> <td>   26.432</td> <td>   46.487</td>
</tr>
<tr>
  <th>crim</th>      <td>   -0.1080</td> <td>    0.033</td> <td>   -3.287</td> <td> 0.001</td> <td>   -0.173</td> <td>   -0.043</td>
</tr>
<tr>
  <th>zn</th>        <td>    0.0464</td> <td>    0.014</td> <td>    3.382</td> <td> 0.001</td> <td>    0.019</td> <td>    0.073</td>
</tr>
<tr>
  <th>indus</th>     <td>    0.0206</td> <td>    0.061</td> <td>    0.334</td> <td> 0.738</td> <td>   -0.100</td> <td>    0.141</td>
</tr>
<tr>
  <th>chas</th>      <td>    2.6867</td> <td>    0.862</td> <td>    3.118</td> <td> 0.002</td> <td>    0.994</td> <td>    4.380</td>
</tr>
<tr>
  <th>nox</th>       <td>  -17.7666</td> <td>    3.820</td> <td>   -4.651</td> <td> 0.000</td> <td>  -25.272</td> <td>  -10.262</td>
</tr>
<tr>
  <th>rm</th>        <td>    3.8099</td> <td>    0.418</td> <td>    9.116</td> <td> 0.000</td> <td>    2.989</td> <td>    4.631</td>
</tr>
<tr>
  <th>age</th>       <td>    0.0007</td> <td>    0.013</td> <td>    0.052</td> <td> 0.958</td> <td>   -0.025</td> <td>    0.027</td>
</tr>
<tr>
  <th>dis</th>       <td>   -1.4756</td> <td>    0.199</td> <td>   -7.398</td> <td> 0.000</td> <td>   -1.867</td> <td>   -1.084</td>
</tr>
<tr>
  <th>tax</th>       <td>   -0.0123</td> <td>    0.004</td> <td>   -3.280</td> <td> 0.001</td> <td>   -0.020</td> <td>   -0.005</td>
</tr>
<tr>
  <th>ptratio</th>   <td>   -0.9527</td> <td>    0.131</td> <td>   -7.283</td> <td> 0.000</td> <td>   -1.210</td> <td>   -0.696</td>
</tr>
<tr>
  <th>black</th>     <td>    0.0093</td> <td>    0.003</td> <td>    3.467</td> <td> 0.001</td> <td>    0.004</td> <td>    0.015</td>
</tr>
<tr>
  <th>lstat</th>     <td>   -0.5248</td> <td>    0.051</td> <td>  -10.347</td> <td> 0.000</td> <td>   -0.624</td> <td>   -0.425</td>
</tr>
<tr>
  <th>rad</th>       <td>    0.3060</td> <td>    0.066</td> <td>    4.613</td> <td> 0.000</td> <td>    0.176</td> <td>    0.436</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>178.041</td> <th>  Durbin-Watson:     </th> <td>   1.078</td> 
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.000</td>  <th>  Jarque-Bera (JB):  </th> <td> 783.126</td> 
</tr>
<tr>
  <th>Skew:</th>          <td> 1.521</td>  <th>  Prob(JB):          </th> <td>8.84e-171</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 8.281</td>  <th>  Cond. No.          </th> <td>1.51e+04</td> 
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.<br/>[2] The condition number is large, 1.51e+04. This might indicate that there are<br/>strong multicollinearity or other numerical problems.</div></div>
</div>
<p>It should be noted that, when it is obvious that a variable is categorical, <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code> automatically create dummy variables internally. For instance, let us modify the dataframe so that <code class="docutils literal notranslate"><span class="pre">rad</span></code> becomes text:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">boston2</span> <span class="o">=</span> <span class="n">boston</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">boston2</span><span class="p">[</span><span class="s1">&#39;rad&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">boston2</span><span class="p">[</span><span class="s1">&#39;rad&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
<span class="n">boston2</span><span class="p">[</span><span class="s1">&#39;rad&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0      1
1      2
2      2
3      3
4      3
      ..
501    1
502    1
503    1
504    1
505    1
Name: rad, Length: 506, dtype: object
</pre></div>
</div>
</div>
</div>
<p>If we fit a linear regressor model on the modified dataset, <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code> will introduce different dummy variables for the different values of <code class="docutils literal notranslate"><span class="pre">rad</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">=</span><span class="n">ols</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;medv ~ crim + zn + indus + chas + nox + rm +age + dis + tax + </span>
<span class="s2">          ptratio + black + lstat + rad&quot;&quot;&quot;</span><span class="p">,</span> <span class="n">boston2</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>          <td>medv</td>       <th>  R-squared:         </th> <td>   0.750</td> 
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.740</td> 
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   72.70</td> 
</tr>
<tr>
  <th>Date:</th>             <td>Tue, 31 Oct 2023</td> <th>  Prob (F-statistic):</th> <td>8.29e-132</td>
</tr>
<tr>
  <th>Time:</th>                 <td>06:57:15</td>     <th>  Log-Likelihood:    </th> <td> -1489.6</td> 
</tr>
<tr>
  <th>No. Observations:</th>      <td>   506</td>      <th>  AIC:               </th> <td>   3021.</td> 
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   485</td>      <th>  BIC:               </th> <td>   3110.</td> 
</tr>
<tr>
  <th>Df Model:</th>              <td>    20</td>      <th>                     </th>     <td> </td>    
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>    
</tr>
</table>
<table class="simpletable">
<tr>
      <td></td>         <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th> <td>   35.2596</td> <td>    5.434</td> <td>    6.489</td> <td> 0.000</td> <td>   24.583</td> <td>   45.936</td>
</tr>
<tr>
  <th>rad[T.2]</th>  <td>    1.4889</td> <td>    1.478</td> <td>    1.008</td> <td> 0.314</td> <td>   -1.414</td> <td>    4.392</td>
</tr>
<tr>
  <th>rad[T.24]</th> <td>    7.4617</td> <td>    1.789</td> <td>    4.172</td> <td> 0.000</td> <td>    3.947</td> <td>   10.976</td>
</tr>
<tr>
  <th>rad[T.3]</th>  <td>    4.6813</td> <td>    1.335</td> <td>    3.506</td> <td> 0.000</td> <td>    2.058</td> <td>    7.305</td>
</tr>
<tr>
  <th>rad[T.4]</th>  <td>    2.5762</td> <td>    1.187</td> <td>    2.170</td> <td> 0.031</td> <td>    0.243</td> <td>    4.909</td>
</tr>
<tr>
  <th>rad[T.5]</th>  <td>    2.9185</td> <td>    1.208</td> <td>    2.417</td> <td> 0.016</td> <td>    0.546</td> <td>    5.291</td>
</tr>
<tr>
  <th>rad[T.6]</th>  <td>    1.1858</td> <td>    1.464</td> <td>    0.810</td> <td> 0.418</td> <td>   -1.691</td> <td>    4.062</td>
</tr>
<tr>
  <th>rad[T.7]</th>  <td>    4.8790</td> <td>    1.571</td> <td>    3.105</td> <td> 0.002</td> <td>    1.792</td> <td>    7.966</td>
</tr>
<tr>
  <th>rad[T.8]</th>  <td>    4.8398</td> <td>    1.492</td> <td>    3.245</td> <td> 0.001</td> <td>    1.909</td> <td>    7.771</td>
</tr>
<tr>
  <th>crim</th>      <td>   -0.1088</td> <td>    0.033</td> <td>   -3.329</td> <td> 0.001</td> <td>   -0.173</td> <td>   -0.045</td>
</tr>
<tr>
  <th>zn</th>        <td>    0.0549</td> <td>    0.014</td> <td>    3.880</td> <td> 0.000</td> <td>    0.027</td> <td>    0.083</td>
</tr>
<tr>
  <th>indus</th>     <td>    0.0238</td> <td>    0.064</td> <td>    0.373</td> <td> 0.709</td> <td>   -0.101</td> <td>    0.149</td>
</tr>
<tr>
  <th>chas</th>      <td>    2.5242</td> <td>    0.863</td> <td>    2.924</td> <td> 0.004</td> <td>    0.828</td> <td>    4.220</td>
</tr>
<tr>
  <th>nox</th>       <td>  -17.5731</td> <td>    3.896</td> <td>   -4.510</td> <td> 0.000</td> <td>  -25.229</td> <td>   -9.917</td>
</tr>
<tr>
  <th>rm</th>        <td>    3.6655</td> <td>    0.421</td> <td>    8.703</td> <td> 0.000</td> <td>    2.838</td> <td>    4.493</td>
</tr>
<tr>
  <th>age</th>       <td>    0.0005</td> <td>    0.013</td> <td>    0.035</td> <td> 0.972</td> <td>   -0.026</td> <td>    0.026</td>
</tr>
<tr>
  <th>dis</th>       <td>   -1.5545</td> <td>    0.202</td> <td>   -7.699</td> <td> 0.000</td> <td>   -1.951</td> <td>   -1.158</td>
</tr>
<tr>
  <th>tax</th>       <td>   -0.0087</td> <td>    0.004</td> <td>   -2.246</td> <td> 0.025</td> <td>   -0.016</td> <td>   -0.001</td>
</tr>
<tr>
  <th>ptratio</th>   <td>   -0.9724</td> <td>    0.144</td> <td>   -6.731</td> <td> 0.000</td> <td>   -1.256</td> <td>   -0.689</td>
</tr>
<tr>
  <th>black</th>     <td>    0.0094</td> <td>    0.003</td> <td>    3.531</td> <td> 0.000</td> <td>    0.004</td> <td>    0.015</td>
</tr>
<tr>
  <th>lstat</th>     <td>   -0.5292</td> <td>    0.051</td> <td>  -10.451</td> <td> 0.000</td> <td>   -0.629</td> <td>   -0.430</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>183.890</td> <th>  Durbin-Watson:     </th> <td>   1.089</td> 
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.000</td>  <th>  Jarque-Bera (JB):  </th> <td> 858.805</td> 
</tr>
<tr>
  <th>Skew:</th>          <td> 1.554</td>  <th>  Prob(JB):          </th> <td>3.26e-187</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 8.575</td>  <th>  Cond. No.          </th> <td>1.60e+04</td> 
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.<br/>[2] The condition number is large, 1.6e+04. This might indicate that there are<br/>strong multicollinearity or other numerical problems.</div></div>
</div>
<p>Alternatively, we can instruct statsmodels to use a variable as a categorical one with the <code class="docutils literal notranslate"><span class="pre">C(variable)</span></code> tag:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">=</span><span class="n">ols</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;medv ~ crim + zn + indus + chas + nox + rm +age + dis + tax + </span>
<span class="s2">          ptratio + black + lstat + C(rad)&quot;&quot;&quot;</span><span class="p">,</span> <span class="n">boston</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>          <td>medv</td>       <th>  R-squared:         </th> <td>   0.750</td> 
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.740</td> 
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   72.70</td> 
</tr>
<tr>
  <th>Date:</th>             <td>Tue, 31 Oct 2023</td> <th>  Prob (F-statistic):</th> <td>8.29e-132</td>
</tr>
<tr>
  <th>Time:</th>                 <td>07:05:32</td>     <th>  Log-Likelihood:    </th> <td> -1489.6</td> 
</tr>
<tr>
  <th>No. Observations:</th>      <td>   506</td>      <th>  AIC:               </th> <td>   3021.</td> 
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   485</td>      <th>  BIC:               </th> <td>   3110.</td> 
</tr>
<tr>
  <th>Df Model:</th>              <td>    20</td>      <th>                     </th>     <td> </td>    
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>    
</tr>
</table>
<table class="simpletable">
<tr>
        <td></td>          <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th>    <td>   35.2596</td> <td>    5.434</td> <td>    6.489</td> <td> 0.000</td> <td>   24.583</td> <td>   45.936</td>
</tr>
<tr>
  <th>C(rad)[T.2]</th>  <td>    1.4889</td> <td>    1.478</td> <td>    1.008</td> <td> 0.314</td> <td>   -1.414</td> <td>    4.392</td>
</tr>
<tr>
  <th>C(rad)[T.3]</th>  <td>    4.6813</td> <td>    1.335</td> <td>    3.506</td> <td> 0.000</td> <td>    2.058</td> <td>    7.305</td>
</tr>
<tr>
  <th>C(rad)[T.4]</th>  <td>    2.5762</td> <td>    1.187</td> <td>    2.170</td> <td> 0.031</td> <td>    0.243</td> <td>    4.909</td>
</tr>
<tr>
  <th>C(rad)[T.5]</th>  <td>    2.9185</td> <td>    1.208</td> <td>    2.417</td> <td> 0.016</td> <td>    0.546</td> <td>    5.291</td>
</tr>
<tr>
  <th>C(rad)[T.6]</th>  <td>    1.1858</td> <td>    1.464</td> <td>    0.810</td> <td> 0.418</td> <td>   -1.691</td> <td>    4.062</td>
</tr>
<tr>
  <th>C(rad)[T.7]</th>  <td>    4.8790</td> <td>    1.571</td> <td>    3.105</td> <td> 0.002</td> <td>    1.792</td> <td>    7.966</td>
</tr>
<tr>
  <th>C(rad)[T.8]</th>  <td>    4.8398</td> <td>    1.492</td> <td>    3.245</td> <td> 0.001</td> <td>    1.909</td> <td>    7.771</td>
</tr>
<tr>
  <th>C(rad)[T.24]</th> <td>    7.4617</td> <td>    1.789</td> <td>    4.172</td> <td> 0.000</td> <td>    3.947</td> <td>   10.976</td>
</tr>
<tr>
  <th>crim</th>         <td>   -0.1088</td> <td>    0.033</td> <td>   -3.329</td> <td> 0.001</td> <td>   -0.173</td> <td>   -0.045</td>
</tr>
<tr>
  <th>zn</th>           <td>    0.0549</td> <td>    0.014</td> <td>    3.880</td> <td> 0.000</td> <td>    0.027</td> <td>    0.083</td>
</tr>
<tr>
  <th>indus</th>        <td>    0.0238</td> <td>    0.064</td> <td>    0.373</td> <td> 0.709</td> <td>   -0.101</td> <td>    0.149</td>
</tr>
<tr>
  <th>chas</th>         <td>    2.5242</td> <td>    0.863</td> <td>    2.924</td> <td> 0.004</td> <td>    0.828</td> <td>    4.220</td>
</tr>
<tr>
  <th>nox</th>          <td>  -17.5731</td> <td>    3.896</td> <td>   -4.510</td> <td> 0.000</td> <td>  -25.229</td> <td>   -9.917</td>
</tr>
<tr>
  <th>rm</th>           <td>    3.6655</td> <td>    0.421</td> <td>    8.703</td> <td> 0.000</td> <td>    2.838</td> <td>    4.493</td>
</tr>
<tr>
  <th>age</th>          <td>    0.0005</td> <td>    0.013</td> <td>    0.035</td> <td> 0.972</td> <td>   -0.026</td> <td>    0.026</td>
</tr>
<tr>
  <th>dis</th>          <td>   -1.5545</td> <td>    0.202</td> <td>   -7.699</td> <td> 0.000</td> <td>   -1.951</td> <td>   -1.158</td>
</tr>
<tr>
  <th>tax</th>          <td>   -0.0087</td> <td>    0.004</td> <td>   -2.246</td> <td> 0.025</td> <td>   -0.016</td> <td>   -0.001</td>
</tr>
<tr>
  <th>ptratio</th>      <td>   -0.9724</td> <td>    0.144</td> <td>   -6.731</td> <td> 0.000</td> <td>   -1.256</td> <td>   -0.689</td>
</tr>
<tr>
  <th>black</th>        <td>    0.0094</td> <td>    0.003</td> <td>    3.531</td> <td> 0.000</td> <td>    0.004</td> <td>    0.015</td>
</tr>
<tr>
  <th>lstat</th>        <td>   -0.5292</td> <td>    0.051</td> <td>  -10.451</td> <td> 0.000</td> <td>   -0.629</td> <td>   -0.430</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>183.890</td> <th>  Durbin-Watson:     </th> <td>   1.089</td> 
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.000</td>  <th>  Jarque-Bera (JB):  </th> <td> 858.805</td> 
</tr>
<tr>
  <th>Skew:</th>          <td> 1.554</td>  <th>  Prob(JB):          </th> <td>3.26e-187</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 8.575</td>  <th>  Cond. No.          </th> <td>1.60e+04</td> 
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.<br/>[2] The condition number is large, 1.6e+04. This might indicate that there are<br/>strong multicollinearity or other numerical problems.</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ols</span><span class="p">(</span><span class="s2">&quot;weight ~ BMI + height + sex&quot;</span><span class="p">,</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>         <td>weight</td>      <th>  R-squared:         </th> <td>   0.990</td> 
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.990</td> 
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>1.392e+05</td>
</tr>
<tr>
  <th>Date:</th>             <td>Tue, 31 Oct 2023</td> <th>  Prob (F-statistic):</th>  <td>  0.00</td>  
</tr>
<tr>
  <th>Time:</th>                 <td>06:54:01</td>     <th>  Log-Likelihood:    </th> <td> -8403.1</td> 
</tr>
<tr>
  <th>No. Observations:</th>      <td>  4231</td>      <th>  AIC:               </th> <td>1.681e+04</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>  4227</td>      <th>  BIC:               </th> <td>1.684e+04</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     3</td>      <th>                     </th>     <td> </td>    
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>    
</tr>
</table>
<table class="simpletable">
<tr>
      <td></td>         <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th> <td> -158.3473</td> <td>    0.670</td> <td> -236.287</td> <td> 0.000</td> <td> -159.661</td> <td> -157.033</td>
</tr>
<tr>
  <th>sex[T.M]</th>  <td>    0.0592</td> <td>    0.079</td> <td>    0.753</td> <td> 0.451</td> <td>   -0.095</td> <td>    0.213</td>
</tr>
<tr>
  <th>BMI</th>       <td>    2.8199</td> <td>    0.005</td> <td>  546.155</td> <td> 0.000</td> <td>    2.810</td> <td>    2.830</td>
</tr>
<tr>
  <th>height</th>    <td>    0.9440</td> <td>    0.004</td> <td>  240.347</td> <td> 0.000</td> <td>    0.936</td> <td>    0.952</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>412.503</td> <th>  Durbin-Watson:     </th> <td>   1.978</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.000</td>  <th>  Jarque-Bera (JB):  </th> <td>2913.710</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 0.146</td>  <th>  Prob(JB):          </th> <td>    0.00</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 7.055</td>  <th>  Cond. No.          </th> <td>4.27e+03</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.<br/>[2] The condition number is large, 4.27e+03. This might indicate that there are<br/>strong multicollinearity or other numerical problems.</div></div>
</div>
<p>However, there is less control on which dummy variables to include or not in the model, as seen in the next section.</p>
</section>
<section id="backward-elimination">
<h4><span class="section-number">24.2.3. </span>Backward Elimination<a class="headerlink" href="#backward-elimination" title="Permalink to this heading">#</a></h4>
<p>Il modello di regressione lineare calcolato è in generale buono, ma include alcune variabili che non contribuiscono significativamente alla regressione. In pratica, queste variabili possono inficiare il calcolo del regressore lineare e quindi sarebbe ideale non averle dentro. Potremmo rimuoverle tutte, ma non siamo sicuri che, in assenza di alcune, le altre non acquisiscano una qualche significatività. Esistono diverse tecniche per eliminare tali variabili. Una delle possibilità consiste nell’usare il metodo della <strong>backward elimination</strong>, che è definito come segue:</p>
<ol class="arabic simple">
<li><p>Si calcola il regressore lineare considerando tutte le variabili dipendenti;</p></li>
</ol>
<ul class="simple">
<li><p>Se tutte le variabili sono significative, il regressore trovato è quello finale;</p></li>
<li><p>Se qualche variabile non è significativa, si rimuove la variabile con p-value più alto, si ricalcola il regressore lineare e si va al punto 2.</p></li>
</ul>
<p>Alla fine del processo, otterremo un regressore in cui tutte le variabili sono significative.</p>
<p>Applichiamo il processo al nostro esempio. La variabile con p-value più alto è <code class="docutils literal notranslate"><span class="pre">age</span></code>. Riomuoviamola e ricalcoliamo il regressore:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">=</span><span class="n">ols</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;medv ~ crim + zn + indus + chas + nox + rm + dis + tax + </span>
<span class="s2">          ptratio + black + lstat + rad_2 + rad_3 + rad_4 + rad_5 + rad_6 + </span>
<span class="s2">          rad_7 + rad_8 + rad_24&quot;&quot;&quot;</span><span class="p">,</span> <span class="n">boston_mod</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>          <td>medv</td>       <th>  R-squared:         </th> <td>   0.750</td> 
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.740</td> 
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   76.68</td> 
</tr>
<tr>
  <th>Date:</th>             <td>Tue, 31 Oct 2023</td> <th>  Prob (F-statistic):</th> <td>9.34e-133</td>
</tr>
<tr>
  <th>Time:</th>                 <td>06:44:13</td>     <th>  Log-Likelihood:    </th> <td> -1489.6</td> 
</tr>
<tr>
  <th>No. Observations:</th>      <td>   506</td>      <th>  AIC:               </th> <td>   3019.</td> 
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   486</td>      <th>  BIC:               </th> <td>   3104.</td> 
</tr>
<tr>
  <th>Df Model:</th>              <td>    19</td>      <th>                     </th>     <td> </td>    
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>    
</tr>
</table>
<table class="simpletable">
<tr>
      <td></td>         <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th> <td>   35.2429</td> <td>    5.407</td> <td>    6.518</td> <td> 0.000</td> <td>   24.619</td> <td>   45.867</td>
</tr>
<tr>
  <th>crim</th>      <td>   -0.1088</td> <td>    0.033</td> <td>   -3.333</td> <td> 0.001</td> <td>   -0.173</td> <td>   -0.045</td>
</tr>
<tr>
  <th>zn</th>        <td>    0.0548</td> <td>    0.014</td> <td>    3.900</td> <td> 0.000</td> <td>    0.027</td> <td>    0.082</td>
</tr>
<tr>
  <th>indus</th>     <td>    0.0238</td> <td>    0.064</td> <td>    0.374</td> <td> 0.709</td> <td>   -0.101</td> <td>    0.149</td>
</tr>
<tr>
  <th>chas</th>      <td>    2.5256</td> <td>    0.861</td> <td>    2.932</td> <td> 0.004</td> <td>    0.833</td> <td>    4.218</td>
</tr>
<tr>
  <th>nox</th>       <td>  -17.5386</td> <td>    3.765</td> <td>   -4.659</td> <td> 0.000</td> <td>  -24.936</td> <td>  -10.142</td>
</tr>
<tr>
  <th>rm</th>        <td>    3.6682</td> <td>    0.414</td> <td>    8.869</td> <td> 0.000</td> <td>    2.856</td> <td>    4.481</td>
</tr>
<tr>
  <th>dis</th>       <td>   -1.5566</td> <td>    0.193</td> <td>   -8.058</td> <td> 0.000</td> <td>   -1.936</td> <td>   -1.177</td>
</tr>
<tr>
  <th>tax</th>       <td>   -0.0087</td> <td>    0.004</td> <td>   -2.250</td> <td> 0.025</td> <td>   -0.016</td> <td>   -0.001</td>
</tr>
<tr>
  <th>ptratio</th>   <td>   -0.9719</td> <td>    0.144</td> <td>   -6.769</td> <td> 0.000</td> <td>   -1.254</td> <td>   -0.690</td>
</tr>
<tr>
  <th>black</th>     <td>    0.0094</td> <td>    0.003</td> <td>    3.544</td> <td> 0.000</td> <td>    0.004</td> <td>    0.015</td>
</tr>
<tr>
  <th>lstat</th>     <td>   -0.5286</td> <td>    0.047</td> <td>  -11.130</td> <td> 0.000</td> <td>   -0.622</td> <td>   -0.435</td>
</tr>
<tr>
  <th>rad_2</th>     <td>    1.4910</td> <td>    1.475</td> <td>    1.011</td> <td> 0.313</td> <td>   -1.407</td> <td>    4.389</td>
</tr>
<tr>
  <th>rad_3</th>     <td>    4.6798</td> <td>    1.333</td> <td>    3.510</td> <td> 0.000</td> <td>    2.060</td> <td>    7.300</td>
</tr>
<tr>
  <th>rad_4</th>     <td>    2.5748</td> <td>    1.185</td> <td>    2.172</td> <td> 0.030</td> <td>    0.246</td> <td>    4.904</td>
</tr>
<tr>
  <th>rad_5</th>     <td>    2.9185</td> <td>    1.206</td> <td>    2.419</td> <td> 0.016</td> <td>    0.548</td> <td>    5.289</td>
</tr>
<tr>
  <th>rad_6</th>     <td>    1.1833</td> <td>    1.461</td> <td>    0.810</td> <td> 0.418</td> <td>   -1.687</td> <td>    4.053</td>
</tr>
<tr>
  <th>rad_7</th>     <td>    4.8767</td> <td>    1.568</td> <td>    3.110</td> <td> 0.002</td> <td>    1.795</td> <td>    7.958</td>
</tr>
<tr>
  <th>rad_8</th>     <td>    4.8423</td> <td>    1.488</td> <td>    3.253</td> <td> 0.001</td> <td>    1.918</td> <td>    7.767</td>
</tr>
<tr>
  <th>rad_24</th>    <td>    7.4563</td> <td>    1.780</td> <td>    4.188</td> <td> 0.000</td> <td>    3.958</td> <td>   10.954</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>184.084</td> <th>  Durbin-Watson:     </th> <td>   1.088</td> 
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.000</td>  <th>  Jarque-Bera (JB):  </th> <td> 861.138</td> 
</tr>
<tr>
  <th>Skew:</th>          <td> 1.555</td>  <th>  Prob(JB):          </th> <td>1.01e-187</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 8.583</td>  <th>  Cond. No.          </th> <td>1.57e+04</td> 
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.<br/>[2] The condition number is large, 1.57e+04. This might indicate that there are<br/>strong multicollinearity or other numerical problems.</div></div>
</div>
<p>Notiamo che il valore di <span class="math notranslate nohighlight">\(R^2\)</span> è rimasto invariato. Esistono ancora variabili non statisticamente rilevanti. Rimuoviamo <code class="docutils literal notranslate"><span class="pre">indus</span></code>, che ha il p-value più alto:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">=</span><span class="n">ols</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;medv ~ crim + zn + chas + nox + rm + dis + tax + </span>
<span class="s2">          ptratio + black + lstat + rad_2 + rad_3 + rad_4 + rad_5 + rad_6 + </span>
<span class="s2">          rad_7 + rad_8 + rad_24&quot;&quot;&quot;</span><span class="p">,</span> <span class="n">boston_mod</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>          <td>medv</td>       <th>  R-squared:         </th> <td>   0.750</td> 
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.741</td> 
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   81.08</td> 
</tr>
<tr>
  <th>Date:</th>             <td>Tue, 31 Oct 2023</td> <th>  Prob (F-statistic):</th> <td>1.10e-133</td>
</tr>
<tr>
  <th>Time:</th>                 <td>06:44:17</td>     <th>  Log-Likelihood:    </th> <td> -1489.7</td> 
</tr>
<tr>
  <th>No. Observations:</th>      <td>   506</td>      <th>  AIC:               </th> <td>   3017.</td> 
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   487</td>      <th>  BIC:               </th> <td>   3098.</td> 
</tr>
<tr>
  <th>Df Model:</th>              <td>    18</td>      <th>                     </th>     <td> </td>    
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>    
</tr>
</table>
<table class="simpletable">
<tr>
      <td></td>         <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th> <td>   35.1757</td> <td>    5.399</td> <td>    6.515</td> <td> 0.000</td> <td>   24.567</td> <td>   45.784</td>
</tr>
<tr>
  <th>crim</th>      <td>   -0.1094</td> <td>    0.033</td> <td>   -3.355</td> <td> 0.001</td> <td>   -0.173</td> <td>   -0.045</td>
</tr>
<tr>
  <th>zn</th>        <td>    0.0541</td> <td>    0.014</td> <td>    3.891</td> <td> 0.000</td> <td>    0.027</td> <td>    0.081</td>
</tr>
<tr>
  <th>chas</th>      <td>    2.5593</td> <td>    0.856</td> <td>    2.990</td> <td> 0.003</td> <td>    0.878</td> <td>    4.241</td>
</tr>
<tr>
  <th>nox</th>       <td>  -17.1366</td> <td>    3.605</td> <td>   -4.754</td> <td> 0.000</td> <td>  -24.219</td> <td>  -10.054</td>
</tr>
<tr>
  <th>rm</th>        <td>    3.6519</td> <td>    0.411</td> <td>    8.887</td> <td> 0.000</td> <td>    2.845</td> <td>    4.459</td>
</tr>
<tr>
  <th>dis</th>       <td>   -1.5711</td> <td>    0.189</td> <td>   -8.312</td> <td> 0.000</td> <td>   -1.943</td> <td>   -1.200</td>
</tr>
<tr>
  <th>tax</th>       <td>   -0.0081</td> <td>    0.004</td> <td>   -2.312</td> <td> 0.021</td> <td>   -0.015</td> <td>   -0.001</td>
</tr>
<tr>
  <th>ptratio</th>   <td>   -0.9691</td> <td>    0.143</td> <td>   -6.765</td> <td> 0.000</td> <td>   -1.251</td> <td>   -0.688</td>
</tr>
<tr>
  <th>black</th>     <td>    0.0094</td> <td>    0.003</td> <td>    3.537</td> <td> 0.000</td> <td>    0.004</td> <td>    0.015</td>
</tr>
<tr>
  <th>lstat</th>     <td>   -0.5275</td> <td>    0.047</td> <td>  -11.138</td> <td> 0.000</td> <td>   -0.621</td> <td>   -0.434</td>
</tr>
<tr>
  <th>rad_2</th>     <td>    1.5671</td> <td>    1.459</td> <td>    1.074</td> <td> 0.283</td> <td>   -1.300</td> <td>    4.435</td>
</tr>
<tr>
  <th>rad_3</th>     <td>    4.6605</td> <td>    1.331</td> <td>    3.501</td> <td> 0.001</td> <td>    2.045</td> <td>    7.276</td>
</tr>
<tr>
  <th>rad_4</th>     <td>    2.6052</td> <td>    1.182</td> <td>    2.205</td> <td> 0.028</td> <td>    0.284</td> <td>    4.927</td>
</tr>
<tr>
  <th>rad_5</th>     <td>    2.9000</td> <td>    1.204</td> <td>    2.408</td> <td> 0.016</td> <td>    0.534</td> <td>    5.266</td>
</tr>
<tr>
  <th>rad_6</th>     <td>    1.1244</td> <td>    1.451</td> <td>    0.775</td> <td> 0.439</td> <td>   -1.726</td> <td>    3.975</td>
</tr>
<tr>
  <th>rad_7</th>     <td>    4.8734</td> <td>    1.567</td> <td>    3.110</td> <td> 0.002</td> <td>    1.795</td> <td>    7.952</td>
</tr>
<tr>
  <th>rad_8</th>     <td>    4.7944</td> <td>    1.482</td> <td>    3.236</td> <td> 0.001</td> <td>    1.883</td> <td>    7.706</td>
</tr>
<tr>
  <th>rad_24</th>    <td>    7.3362</td> <td>    1.749</td> <td>    4.194</td> <td> 0.000</td> <td>    3.899</td> <td>   10.774</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>184.119</td> <th>  Durbin-Watson:     </th> <td>   1.089</td> 
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.000</td>  <th>  Jarque-Bera (JB):  </th> <td> 861.392</td> 
</tr>
<tr>
  <th>Skew:</th>          <td> 1.555</td>  <th>  Prob(JB):          </th> <td>8.93e-188</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 8.584</td>  <th>  Cond. No.          </th> <td>1.56e+04</td> 
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.<br/>[2] The condition number is large, 1.56e+04. This might indicate that there are<br/>strong multicollinearity or other numerical problems.</div></div>
</div>
<p>Notiamo che l’adjusted <span class="math notranslate nohighlight">\(R^2\)</span> è leggermente salito. Ciò indica che il regressore trovato è leggermente migliore degli altri. Esistono ancora variabili non rilvanti statisticamente. Rimuoviamo <code class="docutils literal notranslate"><span class="pre">rad6</span></code> che ha il p-value più alto:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">=</span><span class="n">ols</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;medv ~ crim + zn + chas + nox + rm + dis + tax + </span>
<span class="s2">          ptratio + black + lstat + rad_2 + rad_3 + rad_4 + rad_5 + </span>
<span class="s2">          rad_7 + rad_8 + rad_24&quot;&quot;&quot;</span><span class="p">,</span> <span class="n">boston_mod</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>          <td>medv</td>       <th>  R-squared:         </th> <td>   0.749</td> 
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.741</td> 
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   85.88</td> 
</tr>
<tr>
  <th>Date:</th>             <td>Tue, 31 Oct 2023</td> <th>  Prob (F-statistic):</th> <td>1.56e-134</td>
</tr>
<tr>
  <th>Time:</th>                 <td>06:44:22</td>     <th>  Log-Likelihood:    </th> <td> -1490.0</td> 
</tr>
<tr>
  <th>No. Observations:</th>      <td>   506</td>      <th>  AIC:               </th> <td>   3016.</td> 
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   488</td>      <th>  BIC:               </th> <td>   3092.</td> 
</tr>
<tr>
  <th>Df Model:</th>              <td>    17</td>      <th>                     </th>     <td> </td>    
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>    
</tr>
</table>
<table class="simpletable">
<tr>
      <td></td>         <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th> <td>   36.0716</td> <td>    5.272</td> <td>    6.842</td> <td> 0.000</td> <td>   25.713</td> <td>   46.430</td>
</tr>
<tr>
  <th>crim</th>      <td>   -0.1099</td> <td>    0.033</td> <td>   -3.375</td> <td> 0.001</td> <td>   -0.174</td> <td>   -0.046</td>
</tr>
<tr>
  <th>zn</th>        <td>    0.0529</td> <td>    0.014</td> <td>    3.830</td> <td> 0.000</td> <td>    0.026</td> <td>    0.080</td>
</tr>
<tr>
  <th>chas</th>      <td>    2.5397</td> <td>    0.855</td> <td>    2.970</td> <td> 0.003</td> <td>    0.860</td> <td>    4.220</td>
</tr>
<tr>
  <th>nox</th>       <td>  -17.4021</td> <td>    3.587</td> <td>   -4.852</td> <td> 0.000</td> <td>  -24.449</td> <td>  -10.355</td>
</tr>
<tr>
  <th>rm</th>        <td>    3.6414</td> <td>    0.411</td> <td>    8.870</td> <td> 0.000</td> <td>    2.835</td> <td>    4.448</td>
</tr>
<tr>
  <th>dis</th>       <td>   -1.5824</td> <td>    0.188</td> <td>   -8.400</td> <td> 0.000</td> <td>   -1.953</td> <td>   -1.212</td>
</tr>
<tr>
  <th>tax</th>       <td>   -0.0077</td> <td>    0.003</td> <td>   -2.216</td> <td> 0.027</td> <td>   -0.014</td> <td>   -0.001</td>
</tr>
<tr>
  <th>ptratio</th>   <td>   -0.9780</td> <td>    0.143</td> <td>   -6.851</td> <td> 0.000</td> <td>   -1.258</td> <td>   -0.698</td>
</tr>
<tr>
  <th>black</th>     <td>    0.0094</td> <td>    0.003</td> <td>    3.554</td> <td> 0.000</td> <td>    0.004</td> <td>    0.015</td>
</tr>
<tr>
  <th>lstat</th>     <td>   -0.5262</td> <td>    0.047</td> <td>  -11.123</td> <td> 0.000</td> <td>   -0.619</td> <td>   -0.433</td>
</tr>
<tr>
  <th>rad_2</th>     <td>    0.9497</td> <td>    1.222</td> <td>    0.777</td> <td> 0.438</td> <td>   -1.452</td> <td>    3.351</td>
</tr>
<tr>
  <th>rad_3</th>     <td>    4.0559</td> <td>    1.078</td> <td>    3.762</td> <td> 0.000</td> <td>    1.938</td> <td>    6.174</td>
</tr>
<tr>
  <th>rad_4</th>     <td>    1.9660</td> <td>    0.846</td> <td>    2.324</td> <td> 0.021</td> <td>    0.304</td> <td>    3.628</td>
</tr>
<tr>
  <th>rad_5</th>     <td>    2.2505</td> <td>    0.865</td> <td>    2.603</td> <td> 0.010</td> <td>    0.552</td> <td>    3.949</td>
</tr>
<tr>
  <th>rad_7</th>     <td>    4.2718</td> <td>    1.360</td> <td>    3.140</td> <td> 0.002</td> <td>    1.599</td> <td>    6.945</td>
</tr>
<tr>
  <th>rad_8</th>     <td>    4.1634</td> <td>    1.237</td> <td>    3.365</td> <td> 0.001</td> <td>    1.732</td> <td>    6.595</td>
</tr>
<tr>
  <th>rad_24</th>    <td>    6.5600</td> <td>    1.434</td> <td>    4.575</td> <td> 0.000</td> <td>    3.743</td> <td>    9.377</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>183.149</td> <th>  Durbin-Watson:     </th> <td>   1.089</td> 
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.000</td>  <th>  Jarque-Bera (JB):  </th> <td> 853.017</td> 
</tr>
<tr>
  <th>Skew:</th>          <td> 1.548</td>  <th>  Prob(JB):          </th> <td>5.89e-186</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 8.557</td>  <th>  Cond. No.          </th> <td>1.52e+04</td> 
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.<br/>[2] The condition number is large, 1.52e+04. This might indicate that there are<br/>strong multicollinearity or other numerical problems.</div></div>
</div>
<p>Proseguiamo rimuovendo <code class="docutils literal notranslate"><span class="pre">rad2</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">=</span><span class="n">ols</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;medv ~ crim + zn + chas + nox + rm + dis + tax + </span>
<span class="s2">          ptratio + black + lstat  + rad_3 + rad_4 + rad_5  + </span>
<span class="s2">          rad_7 + rad_8 + rad_24&quot;&quot;&quot;</span><span class="p">,</span> <span class="n">boston_mod</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>          <td>medv</td>       <th>  R-squared:         </th> <td>   0.749</td> 
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.741</td> 
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   91.29</td> 
</tr>
<tr>
  <th>Date:</th>             <td>Tue, 31 Oct 2023</td> <th>  Prob (F-statistic):</th> <td>2.17e-135</td>
</tr>
<tr>
  <th>Time:</th>                 <td>06:44:23</td>     <th>  Log-Likelihood:    </th> <td> -1490.3</td> 
</tr>
<tr>
  <th>No. Observations:</th>      <td>   506</td>      <th>  AIC:               </th> <td>   3015.</td> 
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   489</td>      <th>  BIC:               </th> <td>   3087.</td> 
</tr>
<tr>
  <th>Df Model:</th>              <td>    16</td>      <th>                     </th>     <td> </td>    
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>    
</tr>
</table>
<table class="simpletable">
<tr>
      <td></td>         <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th> <td>   36.5878</td> <td>    5.228</td> <td>    6.999</td> <td> 0.000</td> <td>   26.316</td> <td>   46.859</td>
</tr>
<tr>
  <th>crim</th>      <td>   -0.1104</td> <td>    0.033</td> <td>   -3.393</td> <td> 0.001</td> <td>   -0.174</td> <td>   -0.046</td>
</tr>
<tr>
  <th>zn</th>        <td>    0.0528</td> <td>    0.014</td> <td>    3.829</td> <td> 0.000</td> <td>    0.026</td> <td>    0.080</td>
</tr>
<tr>
  <th>chas</th>      <td>    2.5090</td> <td>    0.854</td> <td>    2.938</td> <td> 0.003</td> <td>    0.831</td> <td>    4.187</td>
</tr>
<tr>
  <th>nox</th>       <td>  -17.5190</td> <td>    3.582</td> <td>   -4.891</td> <td> 0.000</td> <td>  -24.557</td> <td>  -10.481</td>
</tr>
<tr>
  <th>rm</th>        <td>    3.6650</td> <td>    0.409</td> <td>    8.956</td> <td> 0.000</td> <td>    2.861</td> <td>    4.469</td>
</tr>
<tr>
  <th>dis</th>       <td>   -1.5974</td> <td>    0.187</td> <td>   -8.527</td> <td> 0.000</td> <td>   -1.965</td> <td>   -1.229</td>
</tr>
<tr>
  <th>tax</th>       <td>   -0.0082</td> <td>    0.003</td> <td>   -2.430</td> <td> 0.015</td> <td>   -0.015</td> <td>   -0.002</td>
</tr>
<tr>
  <th>ptratio</th>   <td>   -0.9814</td> <td>    0.143</td> <td>   -6.881</td> <td> 0.000</td> <td>   -1.262</td> <td>   -0.701</td>
</tr>
<tr>
  <th>black</th>     <td>    0.0094</td> <td>    0.003</td> <td>    3.551</td> <td> 0.000</td> <td>    0.004</td> <td>    0.015</td>
</tr>
<tr>
  <th>lstat</th>     <td>   -0.5240</td> <td>    0.047</td> <td>  -11.100</td> <td> 0.000</td> <td>   -0.617</td> <td>   -0.431</td>
</tr>
<tr>
  <th>rad_3</th>     <td>    3.7017</td> <td>    0.977</td> <td>    3.790</td> <td> 0.000</td> <td>    1.783</td> <td>    5.621</td>
</tr>
<tr>
  <th>rad_4</th>     <td>    1.6623</td> <td>    0.750</td> <td>    2.217</td> <td> 0.027</td> <td>    0.189</td> <td>    3.135</td>
</tr>
<tr>
  <th>rad_5</th>     <td>    1.9304</td> <td>    0.760</td> <td>    2.541</td> <td> 0.011</td> <td>    0.438</td> <td>    3.423</td>
</tr>
<tr>
  <th>rad_7</th>     <td>    3.9667</td> <td>    1.302</td> <td>    3.047</td> <td> 0.002</td> <td>    1.408</td> <td>    6.525</td>
</tr>
<tr>
  <th>rad_8</th>     <td>    3.8288</td> <td>    1.160</td> <td>    3.302</td> <td> 0.001</td> <td>    1.550</td> <td>    6.107</td>
</tr>
<tr>
  <th>rad_24</th>    <td>    6.4209</td> <td>    1.422</td> <td>    4.515</td> <td> 0.000</td> <td>    3.627</td> <td>    9.215</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>182.880</td> <th>  Durbin-Watson:     </th> <td>   1.086</td> 
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.000</td>  <th>  Jarque-Bera (JB):  </th> <td> 852.759</td> 
</tr>
<tr>
  <th>Skew:</th>          <td> 1.545</td>  <th>  Prob(JB):          </th> <td>6.69e-186</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 8.559</td>  <th>  Cond. No.          </th> <td>1.51e+04</td> 
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.<br/>[2] The condition number is large, 1.51e+04. This might indicate that there are<br/>strong multicollinearity or other numerical problems.</div></div>
</div>
<p>Non ci sono più variabili non significative. Il regressore trovato è quello finale. Va notato che i coefficienti delle variabili sono leggermente cambiati rispetto al regressore che conteneva tutte le variabili.</p>
<blockquote>
<div><p><strong>🙋‍♂️ Domanda 4</strong></p>
<p>Si calcolino i valori MSE per il primo regressore trovato (quello contenente tutte le variabili) e l’ultimo (quello contenente solo variabili significative). Esistono differenze tra i due valori?</p>
</div></blockquote>
</section>
</section>
<section id="residual-plots">
<h3><span class="section-number">24.3. </span>Residual Plots<a class="headerlink" href="#residual-plots" title="Permalink to this heading">#</a></h3>
<p>Possiamo visualizzare i residual plots e i Q-Q plot dei residui di un regressore lineare mediante <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="n">model</span><span class="o">=</span><span class="n">ols</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;medv ~ crim + zn + chas + nox + rm + dis + tax + </span>
<span class="s2">          ptratio + black + lstat  + rad_3 + rad_4 + rad_5  + </span>
<span class="s2">          rad_7 + rad_8 + rad_24&quot;&quot;&quot;</span><span class="p">,</span> <span class="n">boston_mod</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

<span class="c1">#otteniamo i valori predetti dal modello:</span>
<span class="n">fitted</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fittedvalues</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c1">#rimpiazzo eventuali NaN con zero</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">22</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">residplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">fitted</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;medv&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">boston_mod</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span><span class="n">lowess</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">line_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;lw&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">},</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">421</span><span class="p">))</span>
<span class="n">sm</span><span class="o">.</span><span class="n">qqplot</span><span class="p">(</span><span class="n">fitted</span><span class="o">-</span><span class="n">boston_mod</span><span class="o">.</span><span class="n">dropna</span><span class="p">()[</span><span class="s1">&#39;medv&#39;</span><span class="p">],</span> <span class="n">line</span><span class="o">=</span><span class="s1">&#39;45&#39;</span><span class="p">,</span><span class="n">fit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">422</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/7a851529652e8c157a5a1af5d1fc3ded0473c3075702649199a2a73dbf795c2b.png" src="../_images/7a851529652e8c157a5a1af5d1fc3ded0473c3075702649199a2a73dbf795c2b.png" />
</div>
</div>
</section>
<section id="estensioni-al-modello-lineare">
<h3><span class="section-number">24.4. </span>Estensioni al Modello Lineare<a class="headerlink" href="#estensioni-al-modello-lineare" title="Permalink to this heading">#</a></h3>
<p>La API <code class="docutils literal notranslate"><span class="pre">formula</span></code> di <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code> rende semplice inserire deviazioni dal modello lineare. Vediamo degli esempi con il dataset <strong>Auto MPG</strong>. Carichiamo il dataset:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ucimlrepo</span> <span class="kn">import</span> <span class="n">fetch_ucirepo</span> 
  
<span class="c1"># fetch dataset </span>
<span class="n">auto_mpg</span> <span class="o">=</span> <span class="n">fetch_ucirepo</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span> 
  
<span class="c1"># data (as pandas dataframes) </span>
<span class="n">X</span> <span class="o">=</span> <span class="n">auto_mpg</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">features</span> 
<span class="n">y</span> <span class="o">=</span> <span class="n">auto_mpg</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">targets</span> 
  
<span class="n">data</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>displacement</th>
      <th>cylinders</th>
      <th>horsepower</th>
      <th>weight</th>
      <th>acceleration</th>
      <th>model_year</th>
      <th>origin</th>
      <th>mpg</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>307.0</td>
      <td>8</td>
      <td>130.0</td>
      <td>3504</td>
      <td>12.0</td>
      <td>70</td>
      <td>1</td>
      <td>18.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>350.0</td>
      <td>8</td>
      <td>165.0</td>
      <td>3693</td>
      <td>11.5</td>
      <td>70</td>
      <td>1</td>
      <td>15.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>318.0</td>
      <td>8</td>
      <td>150.0</td>
      <td>3436</td>
      <td>11.0</td>
      <td>70</td>
      <td>1</td>
      <td>18.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>304.0</td>
      <td>8</td>
      <td>150.0</td>
      <td>3433</td>
      <td>12.0</td>
      <td>70</td>
      <td>1</td>
      <td>16.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>302.0</td>
      <td>8</td>
      <td>140.0</td>
      <td>3449</td>
      <td>10.5</td>
      <td>70</td>
      <td>1</td>
      <td>17.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>393</th>
      <td>140.0</td>
      <td>4</td>
      <td>86.0</td>
      <td>2790</td>
      <td>15.6</td>
      <td>82</td>
      <td>1</td>
      <td>27.0</td>
    </tr>
    <tr>
      <th>394</th>
      <td>97.0</td>
      <td>4</td>
      <td>52.0</td>
      <td>2130</td>
      <td>24.6</td>
      <td>82</td>
      <td>2</td>
      <td>44.0</td>
    </tr>
    <tr>
      <th>395</th>
      <td>135.0</td>
      <td>4</td>
      <td>84.0</td>
      <td>2295</td>
      <td>11.6</td>
      <td>82</td>
      <td>1</td>
      <td>32.0</td>
    </tr>
    <tr>
      <th>396</th>
      <td>120.0</td>
      <td>4</td>
      <td>79.0</td>
      <td>2625</td>
      <td>18.6</td>
      <td>82</td>
      <td>1</td>
      <td>28.0</td>
    </tr>
    <tr>
      <th>397</th>
      <td>119.0</td>
      <td>4</td>
      <td>82.0</td>
      <td>2720</td>
      <td>19.4</td>
      <td>82</td>
      <td>1</td>
      <td>31.0</td>
    </tr>
  </tbody>
</table>
<p>398 rows × 8 columns</p>
</div></div></div>
</div>
<p>Calcoliamo un semplice regressore lineare:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ols</span><span class="p">(</span><span class="s2">&quot;mpg ~ horsepower + weight&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>           <td>mpg</td>       <th>  R-squared:         </th> <td>   0.706</td> 
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.705</td> 
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   467.9</td> 
</tr>
<tr>
  <th>Date:</th>             <td>Tue, 31 Oct 2023</td> <th>  Prob (F-statistic):</th> <td>3.06e-104</td>
</tr>
<tr>
  <th>Time:</th>                 <td>07:08:31</td>     <th>  Log-Likelihood:    </th> <td> -1121.0</td> 
</tr>
<tr>
  <th>No. Observations:</th>      <td>   392</td>      <th>  AIC:               </th> <td>   2248.</td> 
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   389</td>      <th>  BIC:               </th> <td>   2260.</td> 
</tr>
<tr>
  <th>Df Model:</th>              <td>     2</td>      <th>                     </th>     <td> </td>    
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>    
</tr>
</table>
<table class="simpletable">
<tr>
       <td></td>         <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th>  <td>   45.6402</td> <td>    0.793</td> <td>   57.540</td> <td> 0.000</td> <td>   44.081</td> <td>   47.200</td>
</tr>
<tr>
  <th>horsepower</th> <td>   -0.0473</td> <td>    0.011</td> <td>   -4.267</td> <td> 0.000</td> <td>   -0.069</td> <td>   -0.026</td>
</tr>
<tr>
  <th>weight</th>     <td>   -0.0058</td> <td>    0.001</td> <td>  -11.535</td> <td> 0.000</td> <td>   -0.007</td> <td>   -0.005</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>35.336</td> <th>  Durbin-Watson:     </th> <td>   0.858</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.000</td> <th>  Jarque-Bera (JB):  </th> <td>  45.973</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 0.683</td> <th>  Prob(JB):          </th> <td>1.04e-10</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 3.974</td> <th>  Cond. No.          </th> <td>1.15e+04</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.<br/>[2] The condition number is large, 1.15e+04. This might indicate that there are<br/>strong multicollinearity or other numerical problems.</div></div>
</div>
<p>Il regressore è statisticamente lineare e ha un <span class="math notranslate nohighlight">\(R^2=0.706\)</span>. Visualizziamo residual e Q-Q plot:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="n">model</span><span class="o">=</span><span class="n">ols</span><span class="p">(</span><span class="s2">&quot;mpg ~ horsepower + weight&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

<span class="c1">#otteniamo i valori predetti dal modello:</span>
<span class="n">fitted</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fittedvalues</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c1">#rimpiazzo eventuali NaN con zero</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">22</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">residplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">fitted</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;mpg&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span><span class="n">lowess</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">line_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;lw&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">},</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">421</span><span class="p">))</span>
<span class="n">sm</span><span class="o">.</span><span class="n">qqplot</span><span class="p">(</span><span class="n">fitted</span><span class="o">-</span><span class="n">data</span><span class="o">.</span><span class="n">dropna</span><span class="p">()[</span><span class="s1">&#39;mpg&#39;</span><span class="p">],</span> <span class="n">line</span><span class="o">=</span><span class="s1">&#39;45&#39;</span><span class="p">,</span><span class="n">fit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">422</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/69e2d5c808a76cce3a54e9e82d4af7876687f8dd9601df83463f438094238f53.png" src="../_images/69e2d5c808a76cce3a54e9e82d4af7876687f8dd9601df83463f438094238f53.png" />
</div>
</div>
<section id="interaction-terms">
<h4><span class="section-number">24.4.1. </span>Interaction terms<a class="headerlink" href="#interaction-terms" title="Permalink to this heading">#</a></h4>
<p>Aggiungiamo un termine di interazione tra “weight” e “horsepower”:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ols</span><span class="p">(</span><span class="s2">&quot;mpg ~ horsepower + weight + weight*horsepower&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>           <td>mpg</td>       <th>  R-squared:         </th> <td>   0.748</td> 
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.746</td> 
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   384.8</td> 
</tr>
<tr>
  <th>Date:</th>             <td>Tue, 31 Oct 2023</td> <th>  Prob (F-statistic):</th> <td>7.26e-116</td>
</tr>
<tr>
  <th>Time:</th>                 <td>07:17:40</td>     <th>  Log-Likelihood:    </th> <td> -1090.7</td> 
</tr>
<tr>
  <th>No. Observations:</th>      <td>   392</td>      <th>  AIC:               </th> <td>   2189.</td> 
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   388</td>      <th>  BIC:               </th> <td>   2205.</td> 
</tr>
<tr>
  <th>Df Model:</th>              <td>     3</td>      <th>                     </th>     <td> </td>    
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>    
</tr>
</table>
<table class="simpletable">
<tr>
          <td></td>             <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th>         <td>   63.5579</td> <td>    2.343</td> <td>   27.127</td> <td> 0.000</td> <td>   58.951</td> <td>   68.164</td>
</tr>
<tr>
  <th>horsepower</th>        <td>   -0.2508</td> <td>    0.027</td> <td>   -9.195</td> <td> 0.000</td> <td>   -0.304</td> <td>   -0.197</td>
</tr>
<tr>
  <th>weight</th>            <td>   -0.0108</td> <td>    0.001</td> <td>  -13.921</td> <td> 0.000</td> <td>   -0.012</td> <td>   -0.009</td>
</tr>
<tr>
  <th>weight:horsepower</th> <td> 5.355e-05</td> <td> 6.65e-06</td> <td>    8.054</td> <td> 0.000</td> <td> 4.05e-05</td> <td> 6.66e-05</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>34.175</td> <th>  Durbin-Watson:     </th> <td>   0.904</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.000</td> <th>  Jarque-Bera (JB):  </th> <td>  54.522</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 0.577</td> <th>  Prob(JB):          </th> <td>1.45e-12</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 4.417</td> <th>  Cond. No.          </th> <td>4.77e+06</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.<br/>[2] The condition number is large, 4.77e+06. This might indicate that there are<br/>strong multicollinearity or other numerical problems.</div></div>
</div>
<p>Il valore di <span class="math notranslate nohighlight">\(R^2\)</span> si è alzato di un po’ ed è ora <span class="math notranslate nohighlight">\(0.748\)</span>. La relazione introdotto è statisticamente rilevante. Visualizziamo i residual plot:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="n">model</span><span class="o">=</span><span class="n">ols</span><span class="p">(</span><span class="s2">&quot;mpg ~ horsepower + weight + horsepower*weight&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

<span class="c1">#otteniamo i valori predetti dal modello:</span>
<span class="n">fitted</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fittedvalues</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c1">#rimpiazzo eventuali NaN con zero</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">22</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">residplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">fitted</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;mpg&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span><span class="n">lowess</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">line_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;lw&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">},</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">421</span><span class="p">))</span>
<span class="n">sm</span><span class="o">.</span><span class="n">qqplot</span><span class="p">(</span><span class="n">fitted</span><span class="o">-</span><span class="n">data</span><span class="o">.</span><span class="n">dropna</span><span class="p">()[</span><span class="s1">&#39;mpg&#39;</span><span class="p">],</span> <span class="n">line</span><span class="o">=</span><span class="s1">&#39;45&#39;</span><span class="p">,</span><span class="n">fit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">422</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/5ff046e1b21ab71d3e33391538ee704af2c69891bd2047a054ffef01786b2320.png" src="../_images/5ff046e1b21ab71d3e33391538ee704af2c69891bd2047a054ffef01786b2320.png" />
</div>
</div>
<p>I residui sono meno correlati con la variabile predetta e il Q-Q plot mostra una deviazione minore dalla Gaussiana. Il modello “spiega” meglio i dati.</p>
</section>
<section id="modello-quadratico">
<h4><span class="section-number">24.4.2. </span>Modello Quadratico<a class="headerlink" href="#modello-quadratico" title="Permalink to this heading">#</a></h4>
<p>Proviamo a fare fit di un modello quadratico:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ols</span><span class="p">(</span><span class="s2">&quot;mpg ~ horsepower + I(horsepower**2)&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>           <td>mpg</td>       <th>  R-squared:         </th> <td>   0.688</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.686</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   428.0</td>
</tr>
<tr>
  <th>Date:</th>             <td>Tue, 31 Oct 2023</td> <th>  Prob (F-statistic):</th> <td>5.40e-99</td>
</tr>
<tr>
  <th>Time:</th>                 <td>07:25:55</td>     <th>  Log-Likelihood:    </th> <td> -1133.2</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>   392</td>      <th>  AIC:               </th> <td>   2272.</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   389</td>      <th>  BIC:               </th> <td>   2284.</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     2</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
           <td></td>             <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th>          <td>   56.9001</td> <td>    1.800</td> <td>   31.604</td> <td> 0.000</td> <td>   53.360</td> <td>   60.440</td>
</tr>
<tr>
  <th>horsepower</th>         <td>   -0.4662</td> <td>    0.031</td> <td>  -14.978</td> <td> 0.000</td> <td>   -0.527</td> <td>   -0.405</td>
</tr>
<tr>
  <th>I(horsepower ** 2)</th> <td>    0.0012</td> <td>    0.000</td> <td>   10.080</td> <td> 0.000</td> <td>    0.001</td> <td>    0.001</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>16.158</td> <th>  Durbin-Watson:     </th> <td>   1.078</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.000</td> <th>  Jarque-Bera (JB):  </th> <td>  30.662</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 0.218</td> <th>  Prob(JB):          </th> <td>2.20e-07</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 4.299</td> <th>  Cond. No.          </th> <td>1.29e+05</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.<br/>[2] The condition number is large, 1.29e+05. This might indicate that there are<br/>strong multicollinearity or other numerical problems.</div></div>
</div>
<p>Da notare che è necessario specificare <code class="docutils literal notranslate"><span class="pre">I(horsepower**2)</span></code> per aggiungere il termine quadratico (semplicemente <code class="docutils literal notranslate"><span class="pre">horsepower**2</span></code> verrebbe ignorato). Il modello ha un <span class="math notranslate nohighlight">\(R^2\)</span> inferiore al modello con termine di interazione, ma comunque superiore al modello base:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ols</span><span class="p">(</span><span class="s2">&quot;mpg ~ horsepower&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>           <td>mpg</td>       <th>  R-squared:         </th> <td>   0.606</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.605</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   599.7</td>
</tr>
<tr>
  <th>Date:</th>             <td>Tue, 31 Oct 2023</td> <th>  Prob (F-statistic):</th> <td>7.03e-81</td>
</tr>
<tr>
  <th>Time:</th>                 <td>07:27:30</td>     <th>  Log-Likelihood:    </th> <td> -1178.7</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>   392</td>      <th>  AIC:               </th> <td>   2361.</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   390</td>      <th>  BIC:               </th> <td>   2369.</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     1</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
       <td></td>         <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th>  <td>   39.9359</td> <td>    0.717</td> <td>   55.660</td> <td> 0.000</td> <td>   38.525</td> <td>   41.347</td>
</tr>
<tr>
  <th>horsepower</th> <td>   -0.1578</td> <td>    0.006</td> <td>  -24.489</td> <td> 0.000</td> <td>   -0.171</td> <td>   -0.145</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>16.432</td> <th>  Durbin-Watson:     </th> <td>   0.920</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.000</td> <th>  Jarque-Bera (JB):  </th> <td>  17.305</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 0.492</td> <th>  Prob(JB):          </th> <td>0.000175</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 3.299</td> <th>  Cond. No.          </th> <td>    322.</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.</div></div>
</div>
<p>Vediamo i residual plot:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">model</span><span class="o">=</span><span class="n">ols</span><span class="p">(</span><span class="s2">&quot;mpg ~ horsepower + I(horsepower**2)&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

<span class="c1">#otteniamo i valori predetti dal modello:</span>
<span class="n">fitted</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fittedvalues</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c1">#rimpiazzo eventuali NaN con zero</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">22</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">residplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">fitted</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;mpg&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span><span class="n">lowess</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">line_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;lw&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">},</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">421</span><span class="p">))</span>
<span class="n">sm</span><span class="o">.</span><span class="n">qqplot</span><span class="p">(</span><span class="n">fitted</span><span class="o">-</span><span class="n">data</span><span class="o">.</span><span class="n">dropna</span><span class="p">()[</span><span class="s1">&#39;mpg&#39;</span><span class="p">],</span> <span class="n">line</span><span class="o">=</span><span class="s1">&#39;45&#39;</span><span class="p">,</span><span class="n">fit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">422</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/6eea5677b16039f33c162a500bf7c6ca37ee5ff9f742214cd7d70ebad0e6643a.png" src="../_images/6eea5677b16039f33c162a500bf7c6ca37ee5ff9f742214cd7d70ebad0e6643a.png" />
</div>
</div>
<p>Anche in questo caso, i residual plot sono “migliori” di quelli del modello base:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">model</span><span class="o">=</span><span class="n">ols</span><span class="p">(</span><span class="s2">&quot;mpg ~ horsepower&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

<span class="c1">#otteniamo i valori predetti dal modello:</span>
<span class="n">fitted</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fittedvalues</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c1">#rimpiazzo eventuali NaN con zero</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">22</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">residplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">fitted</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;mpg&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span><span class="n">lowess</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">line_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;lw&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">},</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">421</span><span class="p">))</span>
<span class="n">sm</span><span class="o">.</span><span class="n">qqplot</span><span class="p">(</span><span class="n">fitted</span><span class="o">-</span><span class="n">data</span><span class="o">.</span><span class="n">dropna</span><span class="p">()[</span><span class="s1">&#39;mpg&#39;</span><span class="p">],</span> <span class="n">line</span><span class="o">=</span><span class="s1">&#39;45&#39;</span><span class="p">,</span><span class="n">fit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">422</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/43f89489fe82317010c9442f9853dad5b872ede58bac473088a25fc3696987fe.png" src="../_images/43f89489fe82317010c9442f9853dad5b872ede58bac473088a25fc3696987fe.png" />
</div>
</div>
</section>
<section id="regressione-polinomiale">
<h4><span class="section-number">24.4.3. </span>Regressione Polinomiale<a class="headerlink" href="#regressione-polinomiale" title="Permalink to this heading">#</a></h4>
<p>Sembra comunque che il modello con termini di interazione sia migliore di quello quadratico. Potremmo pensare di unire le due cose facendo fit di un regressore polinomiale:</p>
<div class="math notranslate nohighlight">
\[mpg = \beta_0 + \beta_1 horsepower^2 + \beta_2 weight^2 + \beta_3 horsepower\cdot weight + \beta_4 horsepower + \beta_5 weight\]</div>
<p>Ciò si fa facilmente in statsmodels come segue:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ols</span><span class="p">(</span><span class="s2">&quot;mpg ~ I(horsepower**2) + I(weight**2) + horsepower*weight + horsepower + weight&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>           <td>mpg</td>       <th>  R-squared:         </th> <td>   0.749</td> 
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.746</td> 
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   230.9</td> 
</tr>
<tr>
  <th>Date:</th>             <td>Tue, 31 Oct 2023</td> <th>  Prob (F-statistic):</th> <td>1.30e-113</td>
</tr>
<tr>
  <th>Time:</th>                 <td>07:31:26</td>     <th>  Log-Likelihood:    </th> <td> -1089.9</td> 
</tr>
<tr>
  <th>No. Observations:</th>      <td>   392</td>      <th>  AIC:               </th> <td>   2192.</td> 
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   386</td>      <th>  BIC:               </th> <td>   2216.</td> 
</tr>
<tr>
  <th>Df Model:</th>              <td>     5</td>      <th>                     </th>     <td> </td>    
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>    
</tr>
</table>
<table class="simpletable">
<tr>
           <td></td>             <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th>          <td>   63.4053</td> <td>    2.939</td> <td>   21.572</td> <td> 0.000</td> <td>   57.626</td> <td>   69.184</td>
</tr>
<tr>
  <th>I(horsepower ** 2)</th> <td>    0.0003</td> <td>    0.000</td> <td>    1.138</td> <td> 0.256</td> <td>   -0.000</td> <td>    0.001</td>
</tr>
<tr>
  <th>I(weight ** 2)</th>     <td> 2.438e-07</td> <td> 7.94e-07</td> <td>    0.307</td> <td> 0.759</td> <td>-1.32e-06</td> <td>  1.8e-06</td>
</tr>
<tr>
  <th>horsepower</th>         <td>   -0.2646</td> <td>    0.052</td> <td>   -5.093</td> <td> 0.000</td> <td>   -0.367</td> <td>   -0.162</td>
</tr>
<tr>
  <th>weight</th>             <td>   -0.0102</td> <td>    0.003</td> <td>   -3.558</td> <td> 0.000</td> <td>   -0.016</td> <td>   -0.005</td>
</tr>
<tr>
  <th>horsepower:weight</th>  <td> 3.594e-05</td> <td> 2.53e-05</td> <td>    1.421</td> <td> 0.156</td> <td>-1.38e-05</td> <td> 8.57e-05</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>31.272</td> <th>  Durbin-Watson:     </th> <td>   0.917</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.000</td> <th>  Jarque-Bera (JB):  </th> <td>  50.516</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 0.531</td> <th>  Prob(JB):          </th> <td>1.07e-11</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 4.402</td> <th>  Cond. No.          </th> <td>1.63e+08</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.<br/>[2] The condition number is large, 1.63e+08. This might indicate that there are<br/>strong multicollinearity or other numerical problems.</div></div>
</div>
<p>Notiamo che i p-value dei termini quadratici e dell’interaction term sono alti. Applichiamo backward elimination e iniziamo rimuovendo il termine <span class="math notranslate nohighlight">\(horsepower^2\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ols</span><span class="p">(</span><span class="s2">&quot;mpg ~ I(weight**2) + horsepower*weight + horsepower + weight&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>           <td>mpg</td>       <th>  R-squared:         </th> <td>   0.749</td> 
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.746</td> 
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   288.1</td> 
</tr>
<tr>
  <th>Date:</th>             <td>Tue, 31 Oct 2023</td> <th>  Prob (F-statistic):</th> <td>1.37e-114</td>
</tr>
<tr>
  <th>Time:</th>                 <td>07:32:20</td>     <th>  Log-Likelihood:    </th> <td> -1090.6</td> 
</tr>
<tr>
  <th>No. Observations:</th>      <td>   392</td>      <th>  AIC:               </th> <td>   2191.</td> 
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   387</td>      <th>  BIC:               </th> <td>   2211.</td> 
</tr>
<tr>
  <th>Df Model:</th>              <td>     4</td>      <th>                     </th>     <td> </td>    
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>    
</tr>
</table>
<table class="simpletable">
<tr>
          <td></td>             <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th>         <td>   62.7418</td> <td>    2.882</td> <td>   21.771</td> <td> 0.000</td> <td>   57.076</td> <td>   68.408</td>
</tr>
<tr>
  <th>I(weight ** 2)</th>    <td>-3.068e-07</td> <td>  6.3e-07</td> <td>   -0.487</td> <td> 0.626</td> <td>-1.54e-06</td> <td> 9.31e-07</td>
</tr>
<tr>
  <th>horsepower</th>        <td>   -0.2721</td> <td>    0.052</td> <td>   -5.281</td> <td> 0.000</td> <td>   -0.373</td> <td>   -0.171</td>
</tr>
<tr>
  <th>weight</th>            <td>   -0.0095</td> <td>    0.003</td> <td>   -3.388</td> <td> 0.001</td> <td>   -0.015</td> <td>   -0.004</td>
</tr>
<tr>
  <th>horsepower:weight</th> <td> 5.971e-05</td> <td> 1.43e-05</td> <td>    4.183</td> <td> 0.000</td> <td> 3.16e-05</td> <td> 8.78e-05</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>32.870</td> <th>  Durbin-Watson:     </th> <td>   0.913</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.000</td> <th>  Jarque-Bera (JB):  </th> <td>  52.237</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 0.560</td> <th>  Prob(JB):          </th> <td>4.54e-12</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 4.395</td> <th>  Cond. No.          </th> <td>1.60e+08</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.<br/>[2] The condition number is large, 1.6e+08. This might indicate that there are<br/>strong multicollinearity or other numerical problems.</div></div>
</div>
<p>Rimuoviamo ora <span class="math notranslate nohighlight">\(weight^2\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ols</span><span class="p">(</span><span class="s2">&quot;mpg ~  horsepower*weight + horsepower + weight&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>           <td>mpg</td>       <th>  R-squared:         </th> <td>   0.748</td> 
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.746</td> 
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   384.8</td> 
</tr>
<tr>
  <th>Date:</th>             <td>Tue, 31 Oct 2023</td> <th>  Prob (F-statistic):</th> <td>7.26e-116</td>
</tr>
<tr>
  <th>Time:</th>                 <td>07:32:46</td>     <th>  Log-Likelihood:    </th> <td> -1090.7</td> 
</tr>
<tr>
  <th>No. Observations:</th>      <td>   392</td>      <th>  AIC:               </th> <td>   2189.</td> 
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   388</td>      <th>  BIC:               </th> <td>   2205.</td> 
</tr>
<tr>
  <th>Df Model:</th>              <td>     3</td>      <th>                     </th>     <td> </td>    
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>    
</tr>
</table>
<table class="simpletable">
<tr>
          <td></td>             <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th>         <td>   63.5579</td> <td>    2.343</td> <td>   27.127</td> <td> 0.000</td> <td>   58.951</td> <td>   68.164</td>
</tr>
<tr>
  <th>horsepower</th>        <td>   -0.2508</td> <td>    0.027</td> <td>   -9.195</td> <td> 0.000</td> <td>   -0.304</td> <td>   -0.197</td>
</tr>
<tr>
  <th>weight</th>            <td>   -0.0108</td> <td>    0.001</td> <td>  -13.921</td> <td> 0.000</td> <td>   -0.012</td> <td>   -0.009</td>
</tr>
<tr>
  <th>horsepower:weight</th> <td> 5.355e-05</td> <td> 6.65e-06</td> <td>    8.054</td> <td> 0.000</td> <td> 4.05e-05</td> <td> 6.66e-05</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>34.175</td> <th>  Durbin-Watson:     </th> <td>   0.904</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.000</td> <th>  Jarque-Bera (JB):  </th> <td>  54.522</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 0.577</td> <th>  Prob(JB):          </th> <td>1.45e-12</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 4.417</td> <th>  Cond. No.          </th> <td>4.77e+06</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.<br/>[2] The condition number is large, 4.77e+06. This might indicate that there are<br/>strong multicollinearity or other numerical problems.</div></div>
</div>
<p>Ci siamo ricondotti al modello con interaction term. Da qui deduciamo che un modello polinomiale non modella i dati meglio del modello con termini di interazione.</p>
</section>
</section>
<section id="ridge-e-lasso-regression">
<h3><span class="section-number">24.5. </span>Ridge e Lasso Regression<a class="headerlink" href="#ridge-e-lasso-regression" title="Permalink to this heading">#</a></h3>
<p>È possibile eseguire la Ridge regression in <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code> come segue:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">zscore</span>
<span class="kn">from</span> <span class="nn">ucimlrepo</span> <span class="kn">import</span> <span class="n">fetch_ucirepo</span> 
<span class="kn">from</span> <span class="nn">statsmodels.formula.api</span> <span class="kn">import</span> <span class="n">ols</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
  
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="c1"># fetch dataset </span>
<span class="n">auto_mpg</span> <span class="o">=</span> <span class="n">fetch_ucirepo</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span> 
  
<span class="c1"># data (as pandas dataframes) </span>
<span class="n">X</span> <span class="o">=</span> <span class="n">auto_mpg</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">features</span> 
<span class="n">y</span> <span class="o">=</span> <span class="n">auto_mpg</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">targets</span> 
  
<span class="n">data</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

<span class="c1"># Apply z-scoring and drop NA</span>
<span class="n">data2</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;mpg&#39;</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">zscore</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">dropna</span><span class="p">()[</span><span class="s1">&#39;mpg&#39;</span><span class="p">])</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">ols</span><span class="p">(</span><span class="s2">&quot;mpg ~ displacement + cylinders + horsepower + weight + acceleration + model_year + origin&quot;</span><span class="p">,</span> <span class="n">data2</span><span class="p">)</span><span class="o">.</span><span class="n">fit_regularized</span><span class="p">(</span><span class="n">L1_wt</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>

<span class="n">params</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;variables&#39;</span><span class="p">:[</span><span class="s1">&#39;Intercept&#39;</span><span class="p">,</span><span class="s1">&#39;displacement&#39;</span><span class="p">,</span><span class="s1">&#39;cylinders&#39;</span> <span class="p">,</span> <span class="s1">&#39;horsepower&#39;</span> <span class="p">,</span> <span class="s1">&#39;weight&#39;</span> <span class="p">,</span> <span class="s1">&#39;acceleration&#39;</span> <span class="p">,</span> <span class="s1">&#39;model_year&#39;</span> <span class="p">,</span> <span class="s1">&#39;origin&#39;</span><span class="p">],</span> <span class="s1">&#39;params&#39;</span><span class="p">:</span><span class="n">model</span><span class="o">.</span><span class="n">params</span><span class="p">})</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;variables&#39;</span><span class="p">)</span>
<span class="n">params</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>params</th>
    </tr>
    <tr>
      <th>variables</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Intercept</th>
      <td>21.314471</td>
    </tr>
    <tr>
      <th>displacement</th>
      <td>-0.363361</td>
    </tr>
    <tr>
      <th>cylinders</th>
      <td>-0.698638</td>
    </tr>
    <tr>
      <th>horsepower</th>
      <td>-1.090416</td>
    </tr>
    <tr>
      <th>weight</th>
      <td>-3.001519</td>
    </tr>
    <tr>
      <th>acceleration</th>
      <td>-0.149495</td>
    </tr>
    <tr>
      <th>model_year</th>
      <td>2.385728</td>
    </tr>
    <tr>
      <th>origin</th>
      <td>1.028683</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Si può ottenere un ridge regressor ponendo il parametro <code class="docutils literal notranslate"><span class="pre">L1_wt</span></code> a <span class="math notranslate nohighlight">\(1\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">ols</span><span class="p">(</span><span class="s2">&quot;mpg ~ displacement + cylinders + horsepower + weight + acceleration + model_year + origin&quot;</span><span class="p">,</span> <span class="n">data2</span><span class="p">)</span><span class="o">.</span><span class="n">fit_regularized</span><span class="p">(</span><span class="n">L1_wt</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>

<span class="n">params</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;variables&#39;</span><span class="p">:[</span><span class="s1">&#39;Intercept&#39;</span><span class="p">,</span><span class="s1">&#39;displacement&#39;</span><span class="p">,</span><span class="s1">&#39;cylinders&#39;</span> <span class="p">,</span> <span class="s1">&#39;horsepower&#39;</span> <span class="p">,</span> <span class="s1">&#39;weight&#39;</span> <span class="p">,</span> <span class="s1">&#39;acceleration&#39;</span> <span class="p">,</span> <span class="s1">&#39;model_year&#39;</span> <span class="p">,</span> <span class="s1">&#39;origin&#39;</span><span class="p">],</span> <span class="s1">&#39;params&#39;</span><span class="p">:</span><span class="n">model</span><span class="o">.</span><span class="n">params</span><span class="p">})</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;variables&#39;</span><span class="p">)</span>
<span class="n">params</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>params</th>
    </tr>
    <tr>
      <th>variables</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Intercept</th>
      <td>23.345918</td>
    </tr>
    <tr>
      <th>displacement</th>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>cylinders</th>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>horsepower</th>
      <td>-0.381223</td>
    </tr>
    <tr>
      <th>weight</th>
      <td>-4.718045</td>
    </tr>
    <tr>
      <th>acceleration</th>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>model_year</th>
      <td>2.646279</td>
    </tr>
    <tr>
      <th>origin</th>
      <td>0.891852</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Come si può vedere il lasso regressor ha impostato dei pesi esattamente a zero.</p>
</section>
<section id="esercizi">
<h3><span class="section-number">24.6. </span>Esercizi<a class="headerlink" href="#esercizi" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><p>🧑‍💻 Esercizio 1</p>
<p>Si consideri il dataset delle iris di Fisher. Si effettui uno scatterplot per studiare le relazioni tra le variabili. Si calcoli la matrice di correlazione usando gli indici di correlazione di Pearson, Spearman e Kendall. Esistono correlazioni deboli, medie o forti? Si calcoli l’indice di correlazione di Pearson tra le due coppie di variabili che individuano le correlazioni più forti. Si tratta di correlazioni significative?</p>
</div></blockquote>
<blockquote>
<div><p>🧑‍💻 Esercizio 2</p>
<p>Si effettui la normalizzazione <strong>z-scoring</strong> su tutte le variabili del dataset delle iris di Fisher. Si calcoli la matrice di covarianza delle variabili normalizzate. Si confronti la matrice ottenuta con la matrice di correlazione calcolata mediante l’indice di Pearson. Ci sono differenze tra le due matrici? Perché?</p>
</div></blockquote>
<blockquote>
<div><p>🧑‍💻 Esercizio 3</p>
<p>Si consideri il dataset Titanic. Si calcoli un regressore lineare che predica i valori di <code class="docutils literal notranslate"><span class="pre">Fare</span></code> dai valori di <code class="docutils literal notranslate"><span class="pre">Survived</span></code>, <code class="docutils literal notranslate"><span class="pre">Pclass</span></code>, <code class="docutils literal notranslate"><span class="pre">Sex</span></code> e <code class="docutils literal notranslate"><span class="pre">Age</span></code>. Si inseriscano variabili dummy ove opportuno. Il regressore ottenuto è un buon regressore? Quali variabili contribuiscono significativamente alla regressione? Esistono variabili non rilevanti? Si eliminino tali variabili mediante la tecnica della backward elimination. Si discuta il significato dei coefficienti individuati.</p>
</div></blockquote>
<blockquote>
<div><p>🧑‍💻 Esercizio 4</p>
<p>Si consideri il dataset Titanic. Si calcoli un regressore lineare che predica i valori di <code class="docutils literal notranslate"><span class="pre">Age</span></code> dai valori di <code class="docutils literal notranslate"><span class="pre">Survived</span></code>, <code class="docutils literal notranslate"><span class="pre">Pclass</span></code>, <code class="docutils literal notranslate"><span class="pre">Sex</span></code> e <code class="docutils literal notranslate"><span class="pre">Fare</span></code>. Si inseriscano variabili dummy ove opportuno. Il regressore ottenuto è un buon regressore? Si tratta di un regressore migliore o peggiore del regressore calcolato nell’esercizio precedente? Quali variabili contribuiscono significativamente alla regressione? Esistono variabili non rilevanti? Si eliminino tali variabili mediante la tecnica della backward elimination. Si discuta il significato dei coefficienti individuati.</p>
</div></blockquote>
<blockquote>
<div><p>🧑‍💻 Esercizio 5</p>
<p>Si consideri il dataset Boston. Si calcoli un regressore lineare che predica i valori di <code class="docutils literal notranslate"><span class="pre">crim</span></code> dai valori delle altre variabili. Si inseriscano variabili dummy ove opportuno. Quali variabili contribuiscono significativamente alla regressione? Esistono variabili non rilevanti? Si eliminino tali variabili mediante la tecnica della backward elimination. Si discuta il significato dei coefficienti individuati.</p>
</div></blockquote>
</section>
</section>
<span id="document-laboratories/12_regressione_logistica"></span><section class="tex2jax_ignore mathjax_ignore" id="laboratorio-su-regressione-logistica">
<h2><span class="section-number">25. </span>Laboratorio su regressione logistica<a class="headerlink" href="#laboratorio-su-regressione-logistica" title="Permalink to this heading">#</a></h2>
<p>Supponiamo di voler studiare la correlazione tra due variabili, di cui una (la variabile dipendente) sia categorica e binaria (ovvero, che può assumere solo i valori <span class="math notranslate nohighlight">\(0\)</span> e <span class="math notranslate nohighlight">\(1\)</span>). Per studiare questo caso, considereremo un esempio riadattato da <a class="reference external" href="http://nbviewer.jupyter.org/github/justmarkham/DAT8/blob/master/notebooks/12_logistic_regression.ipynb">http://nbviewer.jupyter.org/github/justmarkham/DAT8/blob/master/notebooks/12_logistic_regression.ipynb</a>.</p>
<p>Consideriamo il <strong>Glass Identification Data Set</strong> (<a class="reference external" href="https://archive.ics.uci.edu/ml/datasets/glass+identification">https://archive.ics.uci.edu/ml/datasets/glass+identification</a>). Si tratta di un dataset che contiene una serie di misurazioni per diversi campioni di vetro. Carichiamo il dataset mediante la API di UCI ML:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ucimlrepo</span> <span class="kn">import</span> <span class="n">fetch_ucirepo</span> 
  
<span class="c1"># fetch dataset </span>
<span class="n">glass_identification</span> <span class="o">=</span> <span class="n">fetch_ucirepo</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span> 
  
<span class="c1"># data (as pandas dataframes) </span>
<span class="n">X</span> <span class="o">=</span> <span class="n">glass_identification</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">features</span> 
<span class="n">y</span> <span class="o">=</span> <span class="n">glass_identification</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">targets</span> 

<span class="n">glass</span><span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="n">glass</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
<span class="n">glass</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 214 entries, 0 to 213
Data columns (total 10 columns):
 #   Column         Non-Null Count  Dtype  
---  ------         --------------  -----  
 0   RI             214 non-null    float64
 1   Na             214 non-null    float64
 2   Mg             214 non-null    float64
 3   Al             214 non-null    float64
 4   Si             214 non-null    float64
 5   K              214 non-null    float64
 6   Ca             214 non-null    float64
 7   Ba             214 non-null    float64
 8   Fe             214 non-null    float64
 9   Type_of_glass  214 non-null    int64  
dtypes: float64(9), int64(1)
memory usage: 16.8 KB
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>RI</th>
      <th>Na</th>
      <th>Mg</th>
      <th>Al</th>
      <th>Si</th>
      <th>K</th>
      <th>Ca</th>
      <th>Ba</th>
      <th>Fe</th>
      <th>Type_of_glass</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.52101</td>
      <td>13.64</td>
      <td>4.49</td>
      <td>1.10</td>
      <td>71.78</td>
      <td>0.06</td>
      <td>8.75</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.51761</td>
      <td>13.89</td>
      <td>3.60</td>
      <td>1.36</td>
      <td>72.73</td>
      <td>0.48</td>
      <td>7.83</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.51618</td>
      <td>13.53</td>
      <td>3.55</td>
      <td>1.54</td>
      <td>72.99</td>
      <td>0.39</td>
      <td>7.78</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.51766</td>
      <td>13.21</td>
      <td>3.69</td>
      <td>1.29</td>
      <td>72.61</td>
      <td>0.57</td>
      <td>8.22</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.51742</td>
      <td>13.27</td>
      <td>3.62</td>
      <td>1.24</td>
      <td>73.08</td>
      <td>0.55</td>
      <td>8.07</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Il dataset contiene <span class="math notranslate nohighlight">\(214\)</span> osservazioni e <span class="math notranslate nohighlight">\(10\)</span> colonne. I significati delle variabili sono i seguenti:</p>
<ul class="simple">
<li><p><strong>id</strong>: l’id della riga del DataFrame;</p></li>
<li><p><strong>ri</strong>: indice di rifrazione del vetro;</p></li>
<li><p><strong>na</strong>: percentuale di sodio;</p></li>
<li><p><strong>mg</strong>: percentuale di mercurio;</p></li>
<li><p><strong>al</strong>: percentuale di alluminio;</p></li>
<li><p><strong>si</strong>: percentuale di silicio;</p></li>
<li><p><strong>k</strong>: percentuale di potassio;</p></li>
<li><p><strong>ca</strong>: percentuale di calcio;</p></li>
<li><p><strong>ba</strong>: percentuale di bario;</p></li>
<li><p><strong>fe</strong>: percentuale di ferro;</p></li>
<li><p><strong>Type of Glass</strong>:</p>
<ol class="arabic simple">
<li><p>building_windows_float_processed;</p></li>
<li><p>building_windows_non_float_processed;</p></li>
<li><p>vehicle_windows_float_processed;</p></li>
<li><p>vehicle_windows_non_float_processed (questo tipo di vetro non è presente nel dataset!);</p></li>
<li><p>containers;</p></li>
<li><p>tableware;</p></li>
<li><p>headlamps.</p></li>
</ol>
</li>
</ul>
<p>I diversi tipi di vetro possono essere raggruppati in due macro-categorie:</p>
<ul class="simple">
<li><p>vetro da finestre (edifici o veicoli): classi 1, 2, 3 (la classe 4 non è presente nel dataset);</p></li>
<li><p>vetro non da finestre: classi 5, 6, 7;</p></li>
</ul>
<p>Costruiamo una nuova variabile <strong>window_glass</strong> binaria che mappi le calssi come appena definito. Ciò può essere fatto mediante il metodo <code class="docutils literal notranslate"><span class="pre">replace</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">glass</span><span class="p">[</span><span class="s1">&#39;window_glass&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">glass</span><span class="p">[</span><span class="s1">&#39;Type_of_glass&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="mi">7</span><span class="p">:</span><span class="mi">0</span><span class="p">})</span>
<span class="n">glass</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>RI</th>
      <th>Na</th>
      <th>Mg</th>
      <th>Al</th>
      <th>Si</th>
      <th>K</th>
      <th>Ca</th>
      <th>Ba</th>
      <th>Fe</th>
      <th>Type_of_glass</th>
      <th>window_glass</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.52101</td>
      <td>13.64</td>
      <td>4.49</td>
      <td>1.10</td>
      <td>71.78</td>
      <td>0.06</td>
      <td>8.75</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.51761</td>
      <td>13.89</td>
      <td>3.60</td>
      <td>1.36</td>
      <td>72.73</td>
      <td>0.48</td>
      <td>7.83</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.51618</td>
      <td>13.53</td>
      <td>3.55</td>
      <td>1.54</td>
      <td>72.99</td>
      <td>0.39</td>
      <td>7.78</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.51766</td>
      <td>13.21</td>
      <td>3.69</td>
      <td>1.29</td>
      <td>72.61</td>
      <td>0.57</td>
      <td>8.22</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.51742</td>
      <td>13.27</td>
      <td>3.62</td>
      <td>1.24</td>
      <td>73.08</td>
      <td>0.55</td>
      <td>8.07</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="regressione-logistica-semplice">
<h3><span class="section-number">25.1. </span>Regressione Logistica Semplice<a class="headerlink" href="#regressione-logistica-semplice" title="Permalink to this heading">#</a></h3>
<p>Supponiamo adesso di voler indagare la correlazione tra la percentuale di alluminio presente nel vetro (variabile <code class="docutils literal notranslate"><span class="pre">Al</span></code>) e la variabile dicotomica <code class="docutils literal notranslate"><span class="pre">window_glass</span></code>. In particolare, vogliamo capire se la variabile <code class="docutils literal notranslate"><span class="pre">Al</span></code> influenza l’esito di <code class="docutils literal notranslate"><span class="pre">window_glass</span></code>, ovvero fino a che punto è possibile prevedere il tipo di vetro conoscendo solo la percentuale di alluminio presente. Iniziamo a studiare la correlazione mediante uno scatterplot:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">glass</span><span class="o">.</span><span class="n">Al</span><span class="p">,</span><span class="n">glass</span><span class="o">.</span><span class="n">window_glass</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/3cfaa2b294a6c65e6cca9ad05b72c0c15e0b2931feccdbf90391f2eb0f0bfec1.png" src="../_images/3cfaa2b294a6c65e6cca9ad05b72c0c15e0b2931feccdbf90391f2eb0f0bfec1.png" />
</div>
</div>
<blockquote>
<div><p><strong>🙋‍♂️ Domanda 1</strong></p>
<p>Sembra esserci una correlazione tra le due variabili? Quale tipo di vetro sembra contere in genere maggiori concentrazioni di alluminio?</p>
</div></blockquote>
<section id="limiti-della-regressione-lineare-con-variabile-dipendente-categorica">
<h4><span class="section-number">25.1.1. </span>Limiti della regressione lineare con variabile dipendente categorica<a class="headerlink" href="#limiti-della-regressione-lineare-con-variabile-dipendente-categorica" title="Permalink to this heading">#</a></h4>
<p>Proviamo adesso a visualizzare la retta di regressione relativa alle due variabili:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="s1">&#39;Al&#39;</span><span class="p">,</span><span class="s1">&#39;window_glass&#39;</span><span class="p">,</span><span class="n">glass</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/c60d23cfa8791646b3854f33efee007812701a6bd8f32b7637a36cea3c9d6a31.png" src="../_images/c60d23cfa8791646b3854f33efee007812701a6bd8f32b7637a36cea3c9d6a31.png" />
</div>
</div>
<blockquote>
<div><p><strong>🙋‍♂️ Domanda 2</strong></p>
<p>Guardando il grafico con la retta di regressione, che tipo di vetro prevediamo per i seguenti valori di <strong>Al</strong>?</p>
<ul class="simple">
<li><p>Al = 3.5</p></li>
<li><p>Al = 0.8</p></li>
<li><p>Al = 1.5</p></li>
<li><p>Al = 2.5</p></li>
<li><p>Al = 0.5</p></li>
</ul>
<p>Sulla base di quale criterio basiamo le nostre predizioni?</p>
</div></blockquote>
<p>Il regressore lineare, in pratica, ci permette di ottenere un numero reale che ci da qualche indicazione sul valore più verosimile della variabile dicotomica <code class="docutils literal notranslate"><span class="pre">window_glass</span></code>. Se il valore ottenuto mediante il regressore lineare è maggiore o uguale a <span class="math notranslate nohighlight">\(0.5\)</span>, ha senso prevedere che <strong>window_glass</strong> sia uguale a <strong>1</strong>, altrimenti ha senso prevedere che <strong>window_glass</strong> sia uguale a <strong>0</strong>. Possiamo dunque ottenere delle predizioni binarie sogliando i valori ottenuti mediante il regressore:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">statsmodels.formula.api</span> <span class="kn">import</span> <span class="n">ols</span>
<span class="c1">#calcoliamo il regressore lineare</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">ols</span><span class="p">(</span><span class="s1">&#39;window_glass ~ Al&#39;</span><span class="p">,</span><span class="n">glass</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="c1">#otteniamo le predizioni</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">glass</span><span class="p">)</span>
<span class="c1">#arrotondiamo le predizioni al valore più vicino</span>
<span class="c1">#ciò corrisponde a sogliare con 0.5</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">predictions</span><span class="o">.</span><span class="n">round</span><span class="p">()</span>
<span class="c1">#i valori predetti sono adesso binari</span>
<span class="n">predictions</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([1., 0.])
</pre></div>
</div>
</div>
</div>
<p>Plottiamo le predizioni sul grafico di regressione visto prima:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="c1">#ordiniamo i valori di al in ordine crescente</span>
<span class="c1">#prima troviamo gli indici che ordinano l&#39;array</span>
<span class="n">idx</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">glass</span><span class="p">[</span><span class="s1">&#39;Al&#39;</span><span class="p">])</span>
<span class="c1">#poi applichiamo lo stesso ordinamento sia ad al che alle predizioni</span>
<span class="n">al</span> <span class="o">=</span> <span class="n">glass</span><span class="p">[</span><span class="s1">&#39;Al&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
<span class="n">pred</span> <span class="o">=</span> <span class="n">predictions</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>

<span class="c1">#infine plottiamo</span>
<span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Al&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;window_glass&#39;</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">glass</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">al</span><span class="p">,</span><span class="n">pred</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/9a4bc4447928ff374f65b5248dbe4563fd37c486d7ad4e62974b06d658fe00ca.png" src="../_images/9a4bc4447928ff374f65b5248dbe4563fd37c486d7ad4e62974b06d658fe00ca.png" />
</div>
</div>
<p>Abbiamo individuato un punto di soglia per <code class="docutils literal notranslate"><span class="pre">al</span></code> (vicino a <span class="math notranslate nohighlight">\(2.0\)</span>) che permette di distinguere gli elementi appartenenti alle due classi con qualche errore (si pensi ai valori a sinistra di <span class="math notranslate nohighlight">\(2.0\)</span> con classe <code class="docutils literal notranslate"><span class="pre">window_glass</span></code> pari a zero).</p>
<p>Benché il regressore lineare trovato possa essere utilizzato per la classificazione, esso ha diversi limiti:</p>
<ul class="simple">
<li><p>Non è chiaro come interpretare i valori ottenuti dal regressore. Si noti che, dato che essi possono essere inferiori a <span class="math notranslate nohighlight">\(0\)</span> o superiori a <span class="math notranslate nohighlight">\(1\)</span>, essi non possono essere interpretati come probabilità;</p></li>
<li><p>Il metodo non è molto robusto agli outliers. Si immagini che il nostro campione contenga molti punti di classe  <code class="docutils literal notranslate"><span class="pre">window_glass</span></code> pari a <span class="math notranslate nohighlight">\(0\)</span> e valori di <code class="docutils literal notranslate"><span class="pre">al</span></code> molto alti (es. <span class="math notranslate nohighlight">\(300\)</span>). La retta di regressione trovata in questo caso sarebbe molto più orizzontale e molti degli elementi con valori bassi di <code class="docutils literal notranslate"><span class="pre">al</span></code> (es. <span class="math notranslate nohighlight">\(2.5\)</span>) verrebbero assegnati alla classe <code class="docutils literal notranslate"><span class="pre">window_glass=0</span></code>;</p></li>
<li><p>Il metodo non cattura l’incertezza con la quale possiamo prevedere le classi alle quali appartengono gli elementi. Si considerino ad esempio i punti di valori <code class="docutils literal notranslate"><span class="pre">al=2.5</span></code> e <code class="docutils literal notranslate"><span class="pre">al=2.0</span></code>. Ci aspetteremmo che il modello è “più certo” della classe di appartenenza del primo punto, piuttosto che del secondo.</p></li>
</ul>
</section>
<section id="regressione-logistica">
<h4><span class="section-number">25.1.2. </span>Regressione Logistica<a class="headerlink" href="#regressione-logistica" title="Permalink to this heading">#</a></h4>
<p>Possiamo calcolare un <strong>regressore logistico</strong> come segue:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">statsmodels.formula.api</span> <span class="kn">import</span> <span class="n">logit</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">logit</span><span class="p">(</span><span class="s1">&#39;window_glass ~ Al&#39;</span><span class="p">,</span> <span class="n">glass</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Optimization terminated successfully.
         Current function value: 0.354364
         Iterations 7
</pre></div>
</div>
</div>
</div>
<p>Vedremo come analizzare il regressore e interpretare i coefficienti trovati in seguito.</p>
<p>Possiamo ottenere le probabilità predette per i valori delle variabili indipendenti come segue:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">probs</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">glass</span><span class="p">)</span>
<span class="n">probs</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    0.957513
1    0.883730
2    0.781728
3    0.910590
4    0.926211
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Si noti che i valori ottenuti sono adesso compresi tra <span class="math notranslate nohighlight">\(0\)</span> e <span class="math notranslate nohighlight">\(1\)</span> e dunque interpretabili come probabilità:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">probs</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">probs</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0.0009889852519933211, 0.9985007304335234)
</pre></div>
</div>
</div>
</div>
<p>Considereremo un elemento come appartenente alla classe <code class="docutils literal notranslate"><span class="pre">window_glass=1</span></code> se la sua probabilità predetta è superiore a <span class="math notranslate nohighlight">\(0.5\)</span>. In tal caso infatti, la probabilità di <code class="docutils literal notranslate"><span class="pre">window_glass=0</span></code> sarà inferiore a <span class="math notranslate nohighlight">\(0.5\)</span>, e dunque l’esito più probabile sarà che l’elemento appartiene alla classe <code class="docutils literal notranslate"><span class="pre">window_glass</span></code>.</p>
<p>Plottiamo le predizioni come fatto in precedenza:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#riordiniamo le probabilità utilizzando </span>
<span class="c1">#gli indici trovati prima</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">probs</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>

<span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Al&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;window_glass&#39;</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">glass</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">al</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/a7dbaacb4506256951cbd02e7b1b7cb7d47cd1a65e3ce344f06b218814c5c6b7.png" src="../_images/a7dbaacb4506256951cbd02e7b1b7cb7d47cd1a65e3ce344f06b218814c5c6b7.png" />
</div>
</div>
<p>Le probabilità ottenute mostrano adesso “dove” il modello è più incerto e permettono di <strong>prevedere la probabilità che un dato elemento sia di classe <code class="docutils literal notranslate"><span class="pre">window_glass=1</span></code></strong>. Possiamo ottenere un plot di regressione logistica con seaborn come segue:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">glass</span><span class="p">[</span><span class="s1">&#39;Al&#39;</span><span class="p">],</span><span class="n">glass</span><span class="p">[</span><span class="s1">&#39;window_glass&#39;</span><span class="p">],</span><span class="n">logistic</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/furnari/opt/anaconda3/lib/python3.9/site-packages/seaborn/_decorators.py:36: FutureWarning: Pass the following variables as keyword args: x, y. From version 0.12, the only valid positional argument will be `data`, and passing other arguments without an explicit keyword will result in an error or misinterpretation.
  warnings.warn(
</pre></div>
</div>
<img alt="../_images/7de5236b907a753df9a10505449b4e4b8616eaa3766f5fbd8367c63a6e382750.png" src="../_images/7de5236b907a753df9a10505449b4e4b8616eaa3766f5fbd8367c63a6e382750.png" />
</div>
</div>
<blockquote>
<div><p><strong>🙋‍♂️ Domanda 3</strong></p>
<p>Il regressore logistico individua, in maniera simile a quanto visto per il regressore lineare, una soglia oltre la quale i punti vengono assegnati a una classe piuttosto che a un’altra. Si confronti questo punto di soglia con quello ottenuto nel caso del regressore lineare. I due punti sono diversi? Perché?</p>
</div></blockquote>
</section>
<section id="analisi-del-regressore-logistico">
<h4><span class="section-number">25.1.3. </span>Analisi del regressore logistico<a class="headerlink" href="#analisi-del-regressore-logistico" title="Permalink to this heading">#</a></h4>
<p>Visualizziamo il summary del regressore logistico calcolato in precedenza:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<caption>Logit Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>     <td>window_glass</td>   <th>  No. Observations:  </th>  <td>   214</td>  
</tr>
<tr>
  <th>Model:</th>                 <td>Logit</td>      <th>  Df Residuals:      </th>  <td>   212</td>  
</tr>
<tr>
  <th>Method:</th>                 <td>MLE</td>       <th>  Df Model:          </th>  <td>     1</td>  
</tr>
<tr>
  <th>Date:</th>            <td>Tue, 31 Oct 2023</td> <th>  Pseudo R-squ.:     </th>  <td>0.3547</td>  
</tr>
<tr>
  <th>Time:</th>                <td>07:41:22</td>     <th>  Log-Likelihood:    </th> <td> -75.834</td> 
</tr>
<tr>
  <th>converged:</th>             <td>True</td>       <th>  LL-Null:           </th> <td> -117.51</td> 
</tr>
<tr>
  <th>Covariance Type:</th>     <td>nonrobust</td>    <th>  LLR p-value:       </th> <td>6.835e-20</td>
</tr>
</table>
<table class="simpletable">
<tr>
      <td></td>         <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th> <td>    7.7136</td> <td>    1.078</td> <td>    7.158</td> <td> 0.000</td> <td>    5.602</td> <td>    9.826</td>
</tr>
<tr>
  <th>Al</th>        <td>   -4.1804</td> <td>    0.660</td> <td>   -6.338</td> <td> 0.000</td> <td>   -5.473</td> <td>   -2.888</td>
</tr>
</table></div></div>
</div>
<section id="significativita">
<h5><span class="section-number">25.1.3.1. </span>Significatività<a class="headerlink" href="#significativita" title="Permalink to this heading">#</a></h5>
<p>Il summary presenta diversi elementi. Analizziamone i più importanti:</p>
<ul class="simple">
<li><p>Pseudo R-squared: va interpretato come l’R-Squared nel caso della regressione lineare. Ci dice quanto il modello “spiega” bene i dati;</p></li>
<li><p>LLR p-value: è il p-value calcolato da un “Likelihood-ratio test” (Rapporto di verosimiglianza). Se il valore del p-value è al di sotto di una soglia critica, (es. <span class="math notranslate nohighlight">\(0.0\)</span>), il regressore logistico è statisticamente rilevante;</p></li>
<li><p>P-value dei coefficienti (<span class="math notranslate nohighlight">\(P&gt;|z|\)</span>): vanno interpretati come nel caso della regressione lineare. P-value piccoli indicano che le variabili coinvolte contribuiscono significativamente alla regressione.</p></li>
</ul>
<p>Nel caso specifico del regressore allenato, possiamo dire che:</p>
<ul class="simple">
<li><p>Il regressore logistico spiega parte della relazione tra le variabili (pseudo <span class="math notranslate nohighlight">\(R^2\)</span> pari a circa <span class="math notranslate nohighlight">\(0.35\)</span>);</p></li>
<li><p>Il regressore logistico è statisticamente rilevante (p-value al di sotto di <span class="math notranslate nohighlight">\(0.05\)</span>);</p></li>
<li><p>I coefficienti sono tutti statisticamente rilevanti (p-value bassi);</p></li>
</ul>
</section>
<section id="analisi-dei-coefficienti">
<h5><span class="section-number">25.1.3.2. </span>Analisi dei coefficienti<a class="headerlink" href="#analisi-dei-coefficienti" title="Permalink to this heading">#</a></h5>
<p>Analizziamo i coefficienti del regressore logistico calcolato prima. Visualizziamo nuovamente il summary:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<caption>Logit Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>     <td>window_glass</td>   <th>  No. Observations:  </th>  <td>   214</td>  
</tr>
<tr>
  <th>Model:</th>                 <td>Logit</td>      <th>  Df Residuals:      </th>  <td>   212</td>  
</tr>
<tr>
  <th>Method:</th>                 <td>MLE</td>       <th>  Df Model:          </th>  <td>     1</td>  
</tr>
<tr>
  <th>Date:</th>            <td>Tue, 31 Oct 2023</td> <th>  Pseudo R-squ.:     </th>  <td>0.3547</td>  
</tr>
<tr>
  <th>Time:</th>                <td>07:41:53</td>     <th>  Log-Likelihood:    </th> <td> -75.834</td> 
</tr>
<tr>
  <th>converged:</th>             <td>True</td>       <th>  LL-Null:           </th> <td> -117.51</td> 
</tr>
<tr>
  <th>Covariance Type:</th>     <td>nonrobust</td>    <th>  LLR p-value:       </th> <td>6.835e-20</td>
</tr>
</table>
<table class="simpletable">
<tr>
      <td></td>         <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th> <td>    7.7136</td> <td>    1.078</td> <td>    7.158</td> <td> 0.000</td> <td>    5.602</td> <td>    9.826</td>
</tr>
<tr>
  <th>Al</th>        <td>   -4.1804</td> <td>    0.660</td> <td>   -6.338</td> <td> 0.000</td> <td>   -5.473</td> <td>   -2.888</td>
</tr>
</table></div></div>
</div>
<p>Calcoliamo l’esponenziale dei valori dei coefficienti:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">params</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Intercept    2238.577657
Al              0.015292
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Possiamo dire che:</p>
<ul class="simple">
<li><p>Per <span class="math notranslate nohighlight">\(al=0\)</span>, l’odds che il vetro sia da finestra (<code class="docutils literal notranslate"><span class="pre">window_glass=1</span></code>) è pari a circa <span class="math notranslate nohighlight">\(2238\)</span>. E’ dunque <span class="math notranslate nohighlight">\(2238\)</span> volte più probabile che il vetro sia da finestra;</p></li>
<li><p>L’incremento di una unità del valore della variabile <code class="docutils literal notranslate"><span class="pre">al</span></code> corrisponde a un incremento moltiplicativo di <span class="math notranslate nohighlight">\(0.015\)</span>. Dato che il numero è minore di 1, ciò corrisponde a un decremento moltiplicativo pari a <span class="math notranslate nohighlight">\(1-0.015=0.985\)</span>. Possiamo dire dunque che l’incremento di una unità del valore di <code class="docutils literal notranslate"><span class="pre">al</span></code> corrisponde a un decremento del <span class="math notranslate nohighlight">\(98.5\%\)</span> dell’odds.</p></li>
</ul>
<blockquote>
<div><p><strong>🙋‍♂️ Domanda 4</strong></p>
<p>Le considerazioni tratte dall’analisi dei coefficienti sono coerenti con quanto visualizzato nel plot di regressione logistica visto in precedenza?</p>
</div></blockquote>
</section>
</section>
</section>
<section id="regressione-logistica-multipla">
<h3><span class="section-number">25.2. </span>Regressione Logistica Multipla<a class="headerlink" href="#regressione-logistica-multipla" title="Permalink to this heading">#</a></h3>
<p>E’ possibile calcolare un regressore logistico a partire da più variabili indipendenti semplicemente rivedendo il modello come:</p>
<p>\begin{equation}
logit(p)=\beta_0 + \beta_1 x_1 + \ldots + \beta_n x_n
\end{equation}</p>
<p>Proviamo a calcolare il modello scegliendo come variabili indipendenti <strong>na</strong> e <strong>si</strong> e mantenendo <strong>window_glass</strong> come variabile dipendente. Possiamo visualizzare lo scatterplot con le classi evidenziate utilizzando searborn:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Na&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;Si&#39;</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">glass</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;window_glass&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/eeaa4019646c3aaa653bf7a7621880fe8f34b61bafd12ab2b6c0a1a10237db30.png" src="../_images/eeaa4019646c3aaa653bf7a7621880fe8f34b61bafd12ab2b6c0a1a10237db30.png" />
</div>
</div>
<blockquote>
<div><p><strong>🙋‍♂️ Domanda 5</strong></p>
<p>Come si distribuiscono i dati delle due classi nello spazio? Quale potrebbe essere un buon criterio per classificarli?</p>
</div></blockquote>
<p>Calcoliamo il regressore logistico multiplo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">logit</span><span class="p">(</span><span class="s1">&#39;window_glass ~ Na + Si&#39;</span><span class="p">,</span><span class="n">glass</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Optimization terminated successfully.
         Current function value: 0.409695
         Iterations 7
</pre></div>
</div>
<div class="output text_html"><table class="simpletable">
<caption>Logit Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>     <td>window_glass</td>   <th>  No. Observations:  </th>  <td>   214</td>  
</tr>
<tr>
  <th>Model:</th>                 <td>Logit</td>      <th>  Df Residuals:      </th>  <td>   211</td>  
</tr>
<tr>
  <th>Method:</th>                 <td>MLE</td>       <th>  Df Model:          </th>  <td>     2</td>  
</tr>
<tr>
  <th>Date:</th>            <td>Tue, 31 Oct 2023</td> <th>  Pseudo R-squ.:     </th>  <td>0.2539</td>  
</tr>
<tr>
  <th>Time:</th>                <td>07:43:20</td>     <th>  Log-Likelihood:    </th> <td> -87.675</td> 
</tr>
<tr>
  <th>converged:</th>             <td>True</td>       <th>  LL-Null:           </th> <td> -117.51</td> 
</tr>
<tr>
  <th>Covariance Type:</th>     <td>nonrobust</td>    <th>  LLR p-value:       </th> <td>1.098e-13</td>
</tr>
</table>
<table class="simpletable">
<tr>
      <td></td>         <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th> <td>   91.9716</td> <td>   22.944</td> <td>    4.008</td> <td> 0.000</td> <td>   47.002</td> <td>  136.941</td>
</tr>
<tr>
  <th>Na</th>        <td>   -1.8780</td> <td>    0.306</td> <td>   -6.143</td> <td> 0.000</td> <td>   -2.477</td> <td>   -1.279</td>
</tr>
<tr>
  <th>Si</th>        <td>   -0.8988</td> <td>    0.292</td> <td>   -3.075</td> <td> 0.002</td> <td>   -1.472</td> <td>   -0.326</td>
</tr>
</table></div></div>
</div>
<p>Analizziamo in breve il risultato della regressione logistica:</p>
<ul class="simple">
<li><p>Il modello spiega parte della relazione tra le variabili indipendenti e la variabile dipendente (<span class="math notranslate nohighlight">\(R^2=0.2539\)</span>);</p></li>
<li><p>Il regressore si distingue in maniera rilevante dal regressore nullo (p-value sotto la soglia critica <span class="math notranslate nohighlight">\(0.05\)</span>);</p></li>
<li><p>I parametri del regressore sono tutti statisticamente rilevanti (p-value tutti sotto la soglia <span class="math notranslate nohighlight">\(0.05\)</span>);
Calcoliamo l’esponenziale dei parametri:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">params</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Intercept    8.764972e+39
Na           1.528937e-01
Si           4.070460e-01
dtype: float64
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Se <code class="docutils literal notranslate"><span class="pre">Na=0</span></code> e <code class="docutils literal notranslate"><span class="pre">Si=0</span></code>, il vetro è da finestra in maniera quasi certa;</p></li>
<li><p>Se la variabile <code class="docutils literal notranslate"><span class="pre">Si=0</span></code>, l’incremento di una unità della variabile <code class="docutils literal notranslate"><span class="pre">na</span></code> causa un decremento dell’odds di circa il <span class="math notranslate nohighlight">\(98.48\%\)</span>;</p></li>
<li><p>Se la variabile <code class="docutils literal notranslate"><span class="pre">Na=0</span></code>, l’incremento di una unità della variabile <code class="docutils literal notranslate"><span class="pre">si</span></code> causa un decremento dell’odds pari a circa il <span class="math notranslate nohighlight">\(96\%\)</span>.</p></li>
</ul>
<blockquote>
<div><p><strong>🙋‍♂️ Domanda 6</strong></p>
<p>Considerato che <code class="docutils literal notranslate"><span class="pre">Si</span></code> e <code class="docutils literal notranslate"><span class="pre">Na</span></code> hanno la stessa unità di misura (misurano entrambe delle concentrazioni), quali delle due variabili influenza maggiormente l’esito dell’appartenenza o meno alla classe <code class="docutils literal notranslate"><span class="pre">window_glass</span></code>? Se le unità di misura fossero diverse, potremmo fare le stesse considerazioni?</p>
</div></blockquote>
<section id="esempio-di-regressione-logistica-con-piu-di-due-variabili-indipendenti">
<h4><span class="section-number">25.2.1. </span>Esempio di regressione logistica con più di due variabili indipendenti<a class="headerlink" href="#esempio-di-regressione-logistica-con-piu-di-due-variabili-indipendenti" title="Permalink to this heading">#</a></h4>
<p>Vediamo un esempio di regressione logistica con più di due variabili indipendenti. Utilizzeremo il dataset di R <code class="docutils literal notranslate"><span class="pre">biopsy</span></code>. Possiamo caricarlo mediante <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">statsmodels.datasets</span> <span class="kn">import</span> <span class="n">get_rdataset</span>
<span class="n">biopsy</span> <span class="o">=</span> <span class="n">get_rdataset</span><span class="p">(</span><span class="s1">&#39;biopsy&#39;</span><span class="p">,</span><span class="n">package</span><span class="o">=</span><span class="s1">&#39;MASS&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">biopsy</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>.. container::

   ====== ===============
   biopsy R Documentation
   ====== ===============

   .. rubric:: Biopsy Data on Breast Cancer Patients
      :name: biopsy

   .. rubric:: Description
      :name: description

   This breast cancer database was obtained from the University of
   Wisconsin Hospitals, Madison from Dr. William H. Wolberg. He assessed
   biopsies of breast tumours for 699 patients up to 15 July 1992; each
   of nine attributes has been scored on a scale of 1 to 10, and the
   outcome is also known. There are 699 rows and 11 columns.

   .. rubric:: Usage
      :name: usage

   .. code:: R

      biopsy

   .. rubric:: Format
      :name: format

   This data frame contains the following columns:

   ``ID``
      sample code number (not unique).

   ``V1``
      clump thickness.

   ``V2``
      uniformity of cell size.

   ``V3``
      uniformity of cell shape.

   ``V4``
      marginal adhesion.

   ``V5``
      single epithelial cell size.

   ``V6``
      bare nuclei (16 values are missing).

   ``V7``
      bland chromatin.

   ``V8``
      normal nucleoli.

   ``V9``
      mitoses.

   ``class``
      ``&quot;benign&quot;`` or ``&quot;malignant&quot;``.

   .. rubric:: Source
      :name: source

   P. M. Murphy and D. W. Aha (1992). UCI Repository of machine learning
   databases. [Machine-readable data repository]. Irvine, CA: University
   of California, Department of Information and Computer Science.

   O. L. Mangasarian and W. H. Wolberg (1990) Cancer diagnosis via
   linear programming. *SIAM News* **23**, pp 1 &amp; 18.

   William H. Wolberg and O.L. Mangasarian (1990) Multisurface method of
   pattern separation for medical diagnosis applied to breast cytology.
   *Proceedings of the National Academy of Sciences, U.S.A.* **87**, pp.
   9193–9196.

   O. L. Mangasarian, R. Setiono and W.H. Wolberg (1990) Pattern
   recognition via linear programming: Theory and application to medical
   diagnosis. In *Large-scale Numerical Optimization* eds Thomas F.
   Coleman and Yuying Li, SIAM Publications, Philadelphia, pp 22–30.

   K. P. Bennett and O. L. Mangasarian (1992) Robust linear programming
   discrimination of two linearly inseparable sets. *Optimization
   Methods and Software* **1**, pp. 23–34 (Gordon &amp; Breach Science
   Publishers).

   .. rubric:: References
      :name: references

   Venables, W. N. and Ripley, B. D. (2002) *Modern Applied Statistics
   with S-PLUS.* Fourth Edition. Springer.
</pre></div>
</div>
</div>
</div>
<p>Il dataset contiene <span class="math notranslate nohighlight">\(699\)</span> osservazioni e <span class="math notranslate nohighlight">\(11\)</span> colonne. Ogni osservazioni contiene misurazioni di <span class="math notranslate nohighlight">\(9\)</span> grandezze relative a campioni di tessuto che possono essere tumori “benigni” o “maligni”. Iniziamo manipolando un po’ i dati. Visualizziamo i valori della variabile <code class="docutils literal notranslate"><span class="pre">class</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">biopsy</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;benign&#39;, &#39;malignant&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<p>Per calcolare il modello di regressione logistica mediante statsmodels è necessario convertire questi valori in interi (<span class="math notranslate nohighlight">\(0\)</span> o <span class="math notranslate nohighlight">\(1\)</span>). Inoltre, conviene evitare di chiamare la colonna <code class="docutils literal notranslate"><span class="pre">class</span></code> in quanto questa è una parola riservata per statsmodels. Costruiamo una nuova colonna <code class="docutils literal notranslate"><span class="pre">cl</span></code> che contiene i valori di <code class="docutils literal notranslate"><span class="pre">class</span></code> modificati:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">biopsy</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;cl&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">biopsy</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="s1">&#39;benign&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;malignant&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<p>Procediamo a calcolare il regressore logistico considerando tutte le variabili:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">logit</span><span class="p">(</span><span class="s1">&#39;cl ~ V1 + V2 + V3 + V4 + V5 + V6 + V7 + V8 + V9&#39;</span><span class="p">,</span><span class="n">biopsy</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Optimization terminated successfully.
         Current function value: 0.075321
         Iterations 10
</pre></div>
</div>
<div class="output text_html"><table class="simpletable">
<caption>Logit Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>          <td>cl</td>        <th>  No. Observations:  </th>   <td>   683</td>  
</tr>
<tr>
  <th>Model:</th>                 <td>Logit</td>      <th>  Df Residuals:      </th>   <td>   673</td>  
</tr>
<tr>
  <th>Method:</th>                 <td>MLE</td>       <th>  Df Model:          </th>   <td>     9</td>  
</tr>
<tr>
  <th>Date:</th>            <td>Tue, 31 Oct 2023</td> <th>  Pseudo R-squ.:     </th>   <td>0.8837</td>  
</tr>
<tr>
  <th>Time:</th>                <td>07:44:51</td>     <th>  Log-Likelihood:    </th>  <td> -51.444</td> 
</tr>
<tr>
  <th>converged:</th>             <td>True</td>       <th>  LL-Null:           </th>  <td> -442.18</td> 
</tr>
<tr>
  <th>Covariance Type:</th>     <td>nonrobust</td>    <th>  LLR p-value:       </th> <td>2.077e-162</td>
</tr>
</table>
<table class="simpletable">
<tr>
      <td></td>         <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th> <td>  -10.1039</td> <td>    1.175</td> <td>   -8.600</td> <td> 0.000</td> <td>  -12.407</td> <td>   -7.801</td>
</tr>
<tr>
  <th>V1</th>        <td>    0.5350</td> <td>    0.142</td> <td>    3.767</td> <td> 0.000</td> <td>    0.257</td> <td>    0.813</td>
</tr>
<tr>
  <th>V2</th>        <td>   -0.0063</td> <td>    0.209</td> <td>   -0.030</td> <td> 0.976</td> <td>   -0.416</td> <td>    0.404</td>
</tr>
<tr>
  <th>V3</th>        <td>    0.3227</td> <td>    0.231</td> <td>    1.399</td> <td> 0.162</td> <td>   -0.129</td> <td>    0.775</td>
</tr>
<tr>
  <th>V4</th>        <td>    0.3306</td> <td>    0.123</td> <td>    2.678</td> <td> 0.007</td> <td>    0.089</td> <td>    0.573</td>
</tr>
<tr>
  <th>V5</th>        <td>    0.0966</td> <td>    0.157</td> <td>    0.617</td> <td> 0.537</td> <td>   -0.210</td> <td>    0.404</td>
</tr>
<tr>
  <th>V6</th>        <td>    0.3830</td> <td>    0.094</td> <td>    4.082</td> <td> 0.000</td> <td>    0.199</td> <td>    0.567</td>
</tr>
<tr>
  <th>V7</th>        <td>    0.4472</td> <td>    0.171</td> <td>    2.609</td> <td> 0.009</td> <td>    0.111</td> <td>    0.783</td>
</tr>
<tr>
  <th>V8</th>        <td>    0.2130</td> <td>    0.113</td> <td>    1.887</td> <td> 0.059</td> <td>   -0.008</td> <td>    0.434</td>
</tr>
<tr>
  <th>V9</th>        <td>    0.5348</td> <td>    0.329</td> <td>    1.627</td> <td> 0.104</td> <td>   -0.110</td> <td>    1.179</td>
</tr>
</table></div></div>
</div>
<p>Il regressore logistico spiega bene la relazione tra le variabili (<span class="math notranslate nohighlight">\(R^2\)</span> alto) ed è significativo (p-value quasi nullo). Alcuni coefficienti hanno un p-value alto. Iniziamo eliminando la variabile <code class="docutils literal notranslate"><span class="pre">V2</span></code>, che ha il p-value più alto:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">logit</span><span class="p">(</span><span class="s1">&#39;cl ~ V1 + V3 + V4 + V5 + V6 + V7 + V8 + V9&#39;</span><span class="p">,</span><span class="n">biopsy</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Optimization terminated successfully.
         Current function value: 0.075321
         Iterations 10
</pre></div>
</div>
<div class="output text_html"><table class="simpletable">
<caption>Logit Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>          <td>cl</td>        <th>  No. Observations:  </th>   <td>   683</td>  
</tr>
<tr>
  <th>Model:</th>                 <td>Logit</td>      <th>  Df Residuals:      </th>   <td>   674</td>  
</tr>
<tr>
  <th>Method:</th>                 <td>MLE</td>       <th>  Df Model:          </th>   <td>     8</td>  
</tr>
<tr>
  <th>Date:</th>            <td>Tue, 31 Oct 2023</td> <th>  Pseudo R-squ.:     </th>   <td>0.8837</td>  
</tr>
<tr>
  <th>Time:</th>                <td>07:45:00</td>     <th>  Log-Likelihood:    </th>  <td> -51.445</td> 
</tr>
<tr>
  <th>converged:</th>             <td>True</td>       <th>  LL-Null:           </th>  <td> -442.18</td> 
</tr>
<tr>
  <th>Covariance Type:</th>     <td>nonrobust</td>    <th>  LLR p-value:       </th> <td>2.036e-163</td>
</tr>
</table>
<table class="simpletable">
<tr>
      <td></td>         <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th> <td>  -10.0976</td> <td>    1.155</td> <td>   -8.739</td> <td> 0.000</td> <td>  -12.362</td> <td>   -7.833</td>
</tr>
<tr>
  <th>V1</th>        <td>    0.5346</td> <td>    0.141</td> <td>    3.784</td> <td> 0.000</td> <td>    0.258</td> <td>    0.811</td>
</tr>
<tr>
  <th>V3</th>        <td>    0.3182</td> <td>    0.174</td> <td>    1.826</td> <td> 0.068</td> <td>   -0.023</td> <td>    0.660</td>
</tr>
<tr>
  <th>V4</th>        <td>    0.3299</td> <td>    0.121</td> <td>    2.723</td> <td> 0.006</td> <td>    0.092</td> <td>    0.567</td>
</tr>
<tr>
  <th>V5</th>        <td>    0.0961</td> <td>    0.156</td> <td>    0.618</td> <td> 0.537</td> <td>   -0.209</td> <td>    0.401</td>
</tr>
<tr>
  <th>V6</th>        <td>    0.3831</td> <td>    0.094</td> <td>    4.082</td> <td> 0.000</td> <td>    0.199</td> <td>    0.567</td>
</tr>
<tr>
  <th>V7</th>        <td>    0.4465</td> <td>    0.170</td> <td>    2.628</td> <td> 0.009</td> <td>    0.114</td> <td>    0.779</td>
</tr>
<tr>
  <th>V8</th>        <td>    0.2125</td> <td>    0.112</td> <td>    1.902</td> <td> 0.057</td> <td>   -0.006</td> <td>    0.432</td>
</tr>
<tr>
  <th>V9</th>        <td>    0.5341</td> <td>    0.328</td> <td>    1.630</td> <td> 0.103</td> <td>   -0.108</td> <td>    1.176</td>
</tr>
</table></div></div>
</div>
<p>Procediamo rimuovendo <code class="docutils literal notranslate"><span class="pre">V5</span></code>, che ha p-value pari a <span class="math notranslate nohighlight">\(0.537\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">logit</span><span class="p">(</span><span class="s1">&#39;cl ~ V1 + V3 + V4 + V6 + V7 + V8 + V9&#39;</span><span class="p">,</span><span class="n">biopsy</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Optimization terminated successfully.
         Current function value: 0.075598
         Iterations 10
</pre></div>
</div>
<div class="output text_html"><table class="simpletable">
<caption>Logit Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>          <td>cl</td>        <th>  No. Observations:  </th>   <td>   683</td>  
</tr>
<tr>
  <th>Model:</th>                 <td>Logit</td>      <th>  Df Residuals:      </th>   <td>   675</td>  
</tr>
<tr>
  <th>Method:</th>                 <td>MLE</td>       <th>  Df Model:          </th>   <td>     7</td>  
</tr>
<tr>
  <th>Date:</th>            <td>Tue, 31 Oct 2023</td> <th>  Pseudo R-squ.:     </th>   <td>0.8832</td>  
</tr>
<tr>
  <th>Time:</th>                <td>07:45:02</td>     <th>  Log-Likelihood:    </th>  <td> -51.633</td> 
</tr>
<tr>
  <th>converged:</th>             <td>True</td>       <th>  LL-Null:           </th>  <td> -442.18</td> 
</tr>
<tr>
  <th>Covariance Type:</th>     <td>nonrobust</td>    <th>  LLR p-value:       </th> <td>2.240e-164</td>
</tr>
</table>
<table class="simpletable">
<tr>
      <td></td>         <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th> <td>   -9.9828</td> <td>    1.126</td> <td>   -8.865</td> <td> 0.000</td> <td>  -12.190</td> <td>   -7.776</td>
</tr>
<tr>
  <th>V1</th>        <td>    0.5340</td> <td>    0.141</td> <td>    3.793</td> <td> 0.000</td> <td>    0.258</td> <td>    0.810</td>
</tr>
<tr>
  <th>V3</th>        <td>    0.3453</td> <td>    0.172</td> <td>    2.012</td> <td> 0.044</td> <td>    0.009</td> <td>    0.682</td>
</tr>
<tr>
  <th>V4</th>        <td>    0.3425</td> <td>    0.119</td> <td>    2.873</td> <td> 0.004</td> <td>    0.109</td> <td>    0.576</td>
</tr>
<tr>
  <th>V6</th>        <td>    0.3883</td> <td>    0.094</td> <td>    4.150</td> <td> 0.000</td> <td>    0.205</td> <td>    0.572</td>
</tr>
<tr>
  <th>V7</th>        <td>    0.4619</td> <td>    0.168</td> <td>    2.746</td> <td> 0.006</td> <td>    0.132</td> <td>    0.792</td>
</tr>
<tr>
  <th>V8</th>        <td>    0.2261</td> <td>    0.111</td> <td>    2.037</td> <td> 0.042</td> <td>    0.009</td> <td>    0.444</td>
</tr>
<tr>
  <th>V9</th>        <td>    0.5312</td> <td>    0.324</td> <td>    1.637</td> <td> 0.102</td> <td>   -0.105</td> <td>    1.167</td>
</tr>
</table></div></div>
</div>
<p>Rimuoviamo <code class="docutils literal notranslate"><span class="pre">V9</span></code>, che ha p-value superiore a <span class="math notranslate nohighlight">\(0.05\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">logit</span><span class="p">(</span><span class="s1">&#39;cl ~ V1 + V3 + V4 + V6 + V7 + V8&#39;</span><span class="p">,</span><span class="n">biopsy</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Optimization terminated successfully.
         Current function value: 0.078436
         Iterations 9
</pre></div>
</div>
<div class="output text_html"><table class="simpletable">
<caption>Logit Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>          <td>cl</td>        <th>  No. Observations:  </th>   <td>   683</td>  
</tr>
<tr>
  <th>Model:</th>                 <td>Logit</td>      <th>  Df Residuals:      </th>   <td>   676</td>  
</tr>
<tr>
  <th>Method:</th>                 <td>MLE</td>       <th>  Df Model:          </th>   <td>     6</td>  
</tr>
<tr>
  <th>Date:</th>            <td>Tue, 31 Oct 2023</td> <th>  Pseudo R-squ.:     </th>   <td>0.8788</td>  
</tr>
<tr>
  <th>Time:</th>                <td>07:45:06</td>     <th>  Log-Likelihood:    </th>  <td> -53.572</td> 
</tr>
<tr>
  <th>converged:</th>             <td>True</td>       <th>  LL-Null:           </th>  <td> -442.18</td> 
</tr>
<tr>
  <th>Covariance Type:</th>     <td>nonrobust</td>    <th>  LLR p-value:       </th> <td>1.294e-164</td>
</tr>
</table>
<table class="simpletable">
<tr>
      <td></td>         <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th> <td>   -9.7671</td> <td>    1.085</td> <td>   -9.001</td> <td> 0.000</td> <td>  -11.894</td> <td>   -7.640</td>
</tr>
<tr>
  <th>V1</th>        <td>    0.6225</td> <td>    0.137</td> <td>    4.540</td> <td> 0.000</td> <td>    0.354</td> <td>    0.891</td>
</tr>
<tr>
  <th>V3</th>        <td>    0.3495</td> <td>    0.165</td> <td>    2.118</td> <td> 0.034</td> <td>    0.026</td> <td>    0.673</td>
</tr>
<tr>
  <th>V4</th>        <td>    0.3375</td> <td>    0.116</td> <td>    2.920</td> <td> 0.004</td> <td>    0.111</td> <td>    0.564</td>
</tr>
<tr>
  <th>V6</th>        <td>    0.3786</td> <td>    0.094</td> <td>    4.035</td> <td> 0.000</td> <td>    0.195</td> <td>    0.562</td>
</tr>
<tr>
  <th>V7</th>        <td>    0.4713</td> <td>    0.166</td> <td>    2.837</td> <td> 0.005</td> <td>    0.146</td> <td>    0.797</td>
</tr>
<tr>
  <th>V8</th>        <td>    0.2432</td> <td>    0.109</td> <td>    2.240</td> <td> 0.025</td> <td>    0.030</td> <td>    0.456</td>
</tr>
</table></div></div>
</div>
<p>Tutti i coefficienti hanno adesso un p-value accettabile. Proseguiamo all’analisi dei coefficienti. Calcoliamo gli esponenziali:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">params</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Intercept    0.000057
V1           1.863641
V3           1.418374
V4           1.401487
V6           1.460166
V7           1.602133
V8           1.275287
dtype: float64
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Il valore dell’esponenziale dell’intercetta quasi nullo indica che, quando tutte le variabili assumono valori nulli, l’odds è molto basso. Ciò indica che <span class="math notranslate nohighlight">\(p\)</span> è basso, mentre <span class="math notranslate nohighlight">\(1-p\)</span> è molto alto. La probabilità di avere un tumore maligno è quindi molto bassa se tutte le variabili assumono valori nulli;</p></li>
<li><p>L’incremento di una unità del valore di <code class="docutils literal notranslate"><span class="pre">V1</span></code> corrisponde all’incremento di circa l’<span class="math notranslate nohighlight">\(86\%\)</span> dell’odds, il che rende la possibilità di un tumore maligno più alta;</p></li>
<li><p>L’incremento di una unità del valore di <code class="docutils literal notranslate"><span class="pre">V3</span></code> corrisponde all’incremento di circa il <span class="math notranslate nohighlight">\(41\%\)</span> dell’odds;</p></li>
<li><p>L’incremento di una unità del valore di <code class="docutils literal notranslate"><span class="pre">V4</span></code> corrisponde all’incremento di circa il <span class="math notranslate nohighlight">\(40\%\)</span> dell’odds;</p></li>
<li><p>L’incremento di una unità del valore di <code class="docutils literal notranslate"><span class="pre">V6</span></code> corrisponde all’incremento di circa il <span class="math notranslate nohighlight">\(46\%\)</span> dell’odds;</p></li>
<li><p>L’incremento di una unità del valore di <code class="docutils literal notranslate"><span class="pre">V7</span></code> corrisponde all’incremento di circa il <span class="math notranslate nohighlight">\(60\%\)</span> dell’odds;</p></li>
<li><p>L’incremento di una unità del valore di <code class="docutils literal notranslate"><span class="pre">V8</span></code> corrisponde all’incremento di circa il <span class="math notranslate nohighlight">\(27\%\)</span> dell’odds;</p></li>
</ul>
<p>L’incremento delle variabili, in genere, causa un incremento dell’odds. Pertanto ci aspettiamo che i valori delle variabili siano piccoli in presenza di tumori benigni.</p>
<blockquote>
<div><p><strong>🙋‍♂️ Domanda 7</strong></p>
<p>Si legga la documentazione del dataset considerato per capire su quale scala sono stati registrati i valori delle variabili indipendenti. Si calcolino inoltre le deviazioni standard delle singole variabili nel dataset. Possiamo dire che qualcuna di queste variabili è più influente sulla presenza di un tumore maligno rispetto alle altre?</p>
</div></blockquote>
</section>
</section>
<section id="regressore-logistico-multinomiale">
<h3><span class="section-number">25.3. </span>Regressore Logistico Multinomiale<a class="headerlink" href="#regressore-logistico-multinomiale" title="Permalink to this heading">#</a></h3>
<p>Vediamo un esempio di regressore logistico multinomiale sul dataset delle Iris di Fisher. Carichiamo il dataset con <code class="docutils literal notranslate"><span class="pre">seaborn</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">iris</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="s1">&#39;iris&#39;</span><span class="p">)</span>
<span class="n">iris</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sepal_length</th>
      <th>sepal_width</th>
      <th>petal_length</th>
      <th>petal_width</th>
      <th>species</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5.1</td>
      <td>3.5</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4.9</td>
      <td>3.0</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4.7</td>
      <td>3.2</td>
      <td>1.3</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4.6</td>
      <td>3.1</td>
      <td>1.5</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5.0</td>
      <td>3.6</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>145</th>
      <td>6.7</td>
      <td>3.0</td>
      <td>5.2</td>
      <td>2.3</td>
      <td>virginica</td>
    </tr>
    <tr>
      <th>146</th>
      <td>6.3</td>
      <td>2.5</td>
      <td>5.0</td>
      <td>1.9</td>
      <td>virginica</td>
    </tr>
    <tr>
      <th>147</th>
      <td>6.5</td>
      <td>3.0</td>
      <td>5.2</td>
      <td>2.0</td>
      <td>virginica</td>
    </tr>
    <tr>
      <th>148</th>
      <td>6.2</td>
      <td>3.4</td>
      <td>5.4</td>
      <td>2.3</td>
      <td>virginica</td>
    </tr>
    <tr>
      <th>149</th>
      <td>5.9</td>
      <td>3.0</td>
      <td>5.1</td>
      <td>1.8</td>
      <td>virginica</td>
    </tr>
  </tbody>
</table>
<p>150 rows × 5 columns</p>
</div></div></div>
</div>
<p>Come visto a lezione, considereremo intanto una unica feature <code class="docutils literal notranslate"><span class="pre">petal_length</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;petal_length&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;species&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">iris</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/f7d88680b9af0d55dae7bf8b3eabddaebbd9c5bb31e4705c4cba32f8c5e7bb6c.png" src="../_images/f7d88680b9af0d55dae7bf8b3eabddaebbd9c5bb31e4705c4cba32f8c5e7bb6c.png" />
</div>
</div>
<p>Posso calcolare il regressore multinomiale mediante <code class="docutils literal notranslate"><span class="pre">MNLogit</span></code> di <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code>. Prima però dovrò effettuare un mapping delle classe su valori interi:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">statsmodels.formula.api</span> <span class="kn">import</span> <span class="n">mnlogit</span>
<span class="n">iris2</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">copy</span><span class="p">();</span> 
<span class="n">iris2</span><span class="p">[</span><span class="s1">&#39;species&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">iris2</span><span class="p">[</span><span class="s1">&#39;species&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="s1">&#39;setosa&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;versicolor&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;virginica&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">})</span>
<span class="n">mnlogit</span><span class="p">(</span><span class="s2">&quot;species ~ sepal_length&quot;</span><span class="p">,</span> <span class="n">iris2</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Optimization terminated successfully.
         Current function value: 0.606893
         Iterations 8
</pre></div>
</div>
<div class="output text_html"><table class="simpletable">
<caption>MNLogit Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>        <td>species</td>     <th>  No. Observations:  </th>  <td>   150</td>  
</tr>
<tr>
  <th>Model:</th>                <td>MNLogit</td>     <th>  Df Residuals:      </th>  <td>   146</td>  
</tr>
<tr>
  <th>Method:</th>                 <td>MLE</td>       <th>  Df Model:          </th>  <td>     2</td>  
</tr>
<tr>
  <th>Date:</th>            <td>Tue, 31 Oct 2023</td> <th>  Pseudo R-squ.:     </th>  <td>0.4476</td>  
</tr>
<tr>
  <th>Time:</th>                <td>07:49:17</td>     <th>  Log-Likelihood:    </th> <td> -91.034</td> 
</tr>
<tr>
  <th>converged:</th>             <td>True</td>       <th>  LL-Null:           </th> <td> -164.79</td> 
</tr>
<tr>
  <th>Covariance Type:</th>     <td>nonrobust</td>    <th>  LLR p-value:       </th> <td>9.276e-33</td>
</tr>
</table>
<table class="simpletable">
<tr>
    <th>species=1</th>     <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th>    <td>   12.6771</td> <td>    2.906</td> <td>    4.362</td> <td> 0.000</td> <td>    6.981</td> <td>   18.373</td>
</tr>
<tr>
  <th>sepal_length</th> <td>   -2.0307</td> <td>    0.466</td> <td>   -4.361</td> <td> 0.000</td> <td>   -2.943</td> <td>   -1.118</td>
</tr>
<tr>
    <th>species=2</th>     <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th>    <td>   38.7590</td> <td>    5.691</td> <td>    6.811</td> <td> 0.000</td> <td>   27.605</td> <td>   49.913</td>
</tr>
<tr>
  <th>sepal_length</th> <td>   -6.8464</td> <td>    1.022</td> <td>   -6.698</td> <td> 0.000</td> <td>   -8.850</td> <td>   -4.843</td>
</tr>
</table></div></div>
</div>
<p>Il regressore logistico multinomiale è statisticamente rilevante (p-value basso) e che tutti i coefficienti hanno p-value bassi.</p>
<p>Possiamo notare che ci sono due insiemi di coefficienti: uno per <code class="docutils literal notranslate"><span class="pre">species=1</span></code> (versicolor) e uno per <code class="docutils literal notranslate"><span class="pre">species=2</span></code> (setosa). Non sono stati stimati coefficienti per <code class="docutils literal notranslate"><span class="pre">virginica</span></code>, perché è stata scelta come linea di base. Tutti i valori p sono bassi, quindi possiamo mantenere tutte le variabili. Vediamo come interpretare i coefficienti:</p>
<ul class="simple">
<li><p>L’intercetta per <code class="docutils literal notranslate"><span class="pre">species=1</span></code> è <span class="math notranslate nohighlight">\(12.6771\)</span>. Ciò indica che la probabilità di <code class="docutils literal notranslate"><span class="pre">versicolor</span></code> rispetto a <code class="docutils literal notranslate"><span class="pre">virginica</span></code> è <span class="math notranslate nohighlight">\(e^{12.6771}=320327.76\)</span>, quando <code class="docutils literal notranslate"><span class="pre">sepal_length</span></code> è impostato a zero. Questo è un numero molto grande, probabilmente a causa del fatto che <code class="docutils literal notranslate"><span class="pre">sepal_length=0</span></code> non è un’osservazione realistica.</p></li>
<li><p>L’intercetta per <code class="docutils literal notranslate"><span class="pre">species=2</span></code> è <span class="math notranslate nohighlight">\(38.7590\)</span>. Ciò indica che la probabilità di <code class="docutils literal notranslate"><span class="pre">setosa</span></code> rispetto a <code class="docutils literal notranslate"><span class="pre">virginica</span></code> è <span class="math notranslate nohighlight">\(e^{38.7590}=6.8e+16\)</span>, quando <code class="docutils literal notranslate"><span class="pre">sepal_length</span></code> è impostato a zero. Anche in questo caso, otteniamo un numero molto grande, probabilmente a causa del fatto che <code class="docutils literal notranslate"><span class="pre">sepal_length=0</span></code> non è un’osservazione realistica.</p></li>
<li><p>Il coefficiente <span class="math notranslate nohighlight">\(-2.0307\)</span> di <code class="docutils literal notranslate"><span class="pre">sepal_length</span></code> per <code class="docutils literal notranslate"><span class="pre">species=1</span></code> indica che quando osserviamo un aumento di un centimetro di <code class="docutils literal notranslate"><span class="pre">sepal_length</span></code>, la probabilità di <code class="docutils literal notranslate"><span class="pre">versicolor</span></code> rispetto a <code class="docutils literal notranslate"><span class="pre">virginica</span></code> diminuisce moltiplicativamente del <span class="math notranslate nohighlight">\(e^{-2.0307} = 0.13\)</span> (una diminuzione del -87%).</p></li>
<li><p>Il coefficiente <span class="math notranslate nohighlight">\(-6.8564\)</span> di <code class="docutils literal notranslate"><span class="pre">sepal_length</span></code> per <code class="docutils literal notranslate"><span class="pre">species=2</span></code> indica che quando osserviamo un aumento di un centimetro di <code class="docutils literal notranslate"><span class="pre">sepal_length</span></code>, la probabilità di <code class="docutils literal notranslate"><span class="pre">setosa</span></code> rispetto a <code class="docutils literal notranslate"><span class="pre">virginica</span></code> diminuisce moltiplicativamente del <span class="math notranslate nohighlight">\(e^{-6.8464} = 0.001\)</span> (una diminuzione del -99.9%).</p></li>
</ul>
</section>
<section id="esercizi">
<h3><span class="section-number">25.4. </span>Esercizi<a class="headerlink" href="#esercizi" title="Permalink to this heading">#</a></h3>
<blockquote>
<div><p>🧑‍💻 Esercizio 1</p>
<p>Si calcoli un regressore logistico per predire i valori della variabile <code class="docutils literal notranslate"><span class="pre">Survived</span></code> a partire dalle altre variabili del dataset Titanic. Si gestiscano adeguatamente le variabili categoriche. Si utilizzi il metodo della backward elimination per eliminare le variabili che non contribuiscono significativamente alla regressione. Si analizzi il regressore trovato e si discuta il significato dei suoi parametri.</p>
</div></blockquote>
<blockquote>
<div><p>🧑‍💻 Esercizio 2</p>
<p>Si scelgano due variabili significative del regressore calcolato al punto precedente e si calcoli un regressore bivariato usando solo queste due variabili. Si visualizzi un plot di regressione logistica sui dati bidimensionali individuati dalle due variabili. Si plotti il decision boundary individuato dal regressore sullo scatterplot delle due variabili.</p>
</div></blockquote>
<blockquote>
<div><p>🧑‍💻 Esercizio 3</p>
<p>Si consideri il dataset Boston. Si costruisca un regressore logistico per prevedere i valori della variabile <code class="docutils literal notranslate"><span class="pre">chas</span></code> a partire dai valori delle altre variabili. Si gesticano adeguatamente le variabili categoriche mediante l’introduzione di variabili dummy. Si utilizzi il metodo della backward elimination per eliminare le variabili che non contribuiscono significativamente alla regressione.</p>
</div></blockquote>
</section>
</section>
</div>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./lectures"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <p aria-level="2" class="caption" role="heading"><span class="caption-text">Lecture 1</span></p>
<ul class="visible nav section-nav flex-column">
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="lectures/index.html#document-laboratories/01_setup">1. Introduzione ai laboratori e Installazione dell’Ambiente di Lavoro</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="lectures/index.html#document-laboratories/02_intro_python">2. Introduzione a Python</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Lecture 2</span></p>
<ul class="nav section-nav flex-column">
<li class="toctree-l1 nav-item toc-entry"><a class="reference internal nav-link" href="lectures/index.html#document-lectures/03_main_data_analysis_concepts">3. Introduction to Data Analysis and Key Concepts</a></li>
<li class="toctree-l1 nav-item toc-entry"><a class="reference internal nav-link" href="lectures/index.html#document-lectures/07_probability">4. Probability for Data Manipulation</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Lecture 3</span></p>
<ul class="nav section-nav flex-column">
<li class="toctree-l1 nav-item toc-entry"><a class="reference internal nav-link" href="lectures/index.html#document-lectures/08_common_distributions">5. Probability Distributions</a></li>
<li class="toctree-l1 nav-item toc-entry"><a class="reference internal nav-link" href="lectures/index.html#document-lectures/09_information_theory">6. Basic Elements of Information Theory</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Laboratory 1</span></p>
<ul class="nav section-nav flex-column">
<li class="toctree-l1 nav-item toc-entry"><a class="reference internal nav-link" href="lectures/index.html#document-laboratories/03_intro_numpy">7. Introduzione a Numpy</a></li>
<li class="toctree-l1 nav-item toc-entry"><a class="reference internal nav-link" href="lectures/index.html#document-laboratories/04_intro_matplotlib">8. Introduzione a Matplotlib</a></li>
<li class="toctree-l1 nav-item toc-entry"><a class="reference internal nav-link" href="lectures/index.html#document-laboratories/05_intro_pandas">9. Introduzione a Pandas</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Lecture 4</span></p>
<ul class="nav section-nav flex-column">
<li class="toctree-l1 nav-item toc-entry"><a class="reference internal nav-link" href="lectures/index.html#document-lectures/04_misure_di_frequenze_e_rappresentazione_grafica_dei_dati">10. Misure di Frequenze e Rappresentazione Grafica dei Dati</a></li>
<li class="toctree-l1 nav-item toc-entry"><a class="reference internal nav-link" href="lectures/index.html#document-lectures/05_misure_di_tendenza_centrale_dispersione_e_forma">11. Misure di Tendenza Centrale, Dispersione e Forma</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Lecture 5</span></p>
<ul class="nav section-nav flex-column">
<li class="toctree-l1 nav-item toc-entry"><a class="reference internal nav-link" href="lectures/index.html#document-lectures/06_associazione_variabili">12. Associazione tra Variabili</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Laboratory 2</span></p>
<ul class="nav section-nav flex-column">
<li class="toctree-l1 nav-item toc-entry"><a class="reference internal nav-link" href="lectures/index.html#document-laboratories/06_misure_di_frequenze_e_rappresentazioni_grafiche_dei_dati">13. Laboratorio su Misure di Frequenze e Rappresentazione Grafica dei Dati</a></li>
<li class="toctree-l1 nav-item toc-entry"><a class="reference internal nav-link" href="lectures/index.html#document-laboratories/07_misure_di_tendenza_centrale_dispersione_e_forma">14. Laboratorio su Misure di Tendenza Centrale, Dispersione e Forma</a></li>
<li class="toctree-l1 nav-item toc-entry"><a class="reference internal nav-link" href="lectures/index.html#document-laboratories/08_associazione_variabili">15. Associazione tra Variabili</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Lecture 6</span></p>
<ul class="nav section-nav flex-column">
<li class="toctree-l1 nav-item toc-entry"><a class="reference internal nav-link" href="lectures/index.html#document-lectures/10_statistical_inference">16. Statistical Inference</a></li>
<li class="toctree-l1 nav-item toc-entry"><a class="reference internal nav-link" href="lectures/index.html#d-agostino-s-k-squared-test">17. D’Agostino’s K-squared test</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Lecture 7 &amp; 8</span></p>
<ul class="nav section-nav flex-column">
<li class="toctree-l1 nav-item toc-entry"><a class="reference internal nav-link" href="lectures/index.html#document-lectures/11_linear_regression">18. Linear Regression</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Lecture 9</span></p>
<ul class="nav section-nav flex-column">
<li class="toctree-l1 nav-item toc-entry"><a class="reference internal nav-link" href="lectures/index.html#document-lectures/12_logistic_regression">19. Logistic Regression</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Lecture 10</span></p>
<ul class="nav section-nav flex-column">
<li class="toctree-l1 nav-item toc-entry"><a class="reference internal nav-link" href="lectures/index.html#document-lectures/13_causal_analysis">20. Causal Data Analysis</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Lecture 11</span></p>
<ul class="nav section-nav flex-column">
<li class="toctree-l1 nav-item toc-entry"><a class="reference internal nav-link" href="lectures/index.html#document-lectures/14_data_as_nd_points">21. Data as N-Dimensional Points</a></li>
<li class="toctree-l1 nav-item toc-entry"><a class="reference internal nav-link" href="lectures/index.html#document-lectures/15_clustering">22. Clustering</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Laboratory 3</span></p>
<ul class="nav section-nav flex-column">
<li class="toctree-l1 nav-item toc-entry"><a class="reference internal nav-link" href="lectures/index.html#document-laboratories/10_statistical_inference">23. Laboratory on Statistical Inference</a></li>
<li class="toctree-l1 nav-item toc-entry"><a class="reference internal nav-link" href="lectures/index.html#document-laboratories/11_regressione_lineare">24. Laboratorio su Regressione Lineare</a></li>
<li class="toctree-l1 nav-item toc-entry"><a class="reference internal nav-link" href="lectures/index.html#document-laboratories/12_regressione_logistica">25. Laboratorio su regressione logistica</a></li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Antonino Furnari
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>